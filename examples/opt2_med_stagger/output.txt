Number of global vertices: 40401
Number of global cells: 80000
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (386.67, 273.33).
Turbine added at (386.67, 273.33).
Turbine added at (386.67, 500.00).
Turbine added at (386.67, 500.00).
Turbine added at (386.67, 273.33).
Turbine added at (386.67, 500.00).
Turbine added at (386.67, 726.67).
Turbine added at (386.67, 726.67).
Turbine added at (613.33, 160.00).
Turbine added at (386.67, 726.67).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 840.00).
Turbine added at (613.33, 840.00).
Turbine added at (613.33, 840.00).
Turbine added at (840.00, 273.33).
Turbine added at (840.00, 500.00).
Turbine added at (840.00, 273.33).
Turbine added at (840.00, 500.00).
Turbine added at (840.00, 273.33).
Turbine added at (840.00, 500.00).
Turbine added at (840.00, 726.67).
Turbine added at (840.00, 726.67).
Added 16 turbines to the site in an 4x4 rectangular array.
Added 16 turbines to the site in an 4x4 rectangular array.
Turbine added at (840.00, 726.67).
Added 16 turbines to the site in an 4x4 rectangular array.
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (386.67, 273.33).
Turbine added at (386.67, 500.00).
Turbine added at (386.67, 726.67).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 840.00).
Turbine added at (840.00, 273.33).
Turbine added at (840.00, 500.00).
Turbine added at (840.00, 726.67).
Added 16 turbines to the site in an 4x4 rectangular array.
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

Start evaluation of j
  NIT    FC           OBJFUN            GNORM
found a tidal farm, computing functional
Start evaluation of j
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Start evaluation of j
Start evaluation of j
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.005e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.022e+02 (tol = 1.000e-10) r (rel) = 2.551e+00 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.782e+01 (tol = 1.000e-10) r (rel) = 4.449e-01 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.344e+00 (tol = 1.000e-10) r (rel) = 3.356e-02 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.032e-02 (tol = 1.000e-10) r (rel) = 2.577e-04 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.534e-07 (tol = 1.000e-10) r (rel) = 1.632e-08 (tol = 1.000e-09)
  Newton iteration 6: r (abs) = 2.550e-12 (tol = 1.000e-10) r (rel) = 6.366e-14 (tol = 1.000e-09)
  Newton solver finished in 6 iterations and 6 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 85.314987 s.
j = 7.969231e+05.
Runtime: 85.318419 s.
j = 7.969231e+05.
Computing derivative to determine the automatic scaling factor
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 85.321511 s.
j = 7.969231e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 85.323289 s.
j = 7.969231e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 15.220236063 s
Runtime: 15.2186601162 s
Runtime: 15.2196440697 s
|dj| = 1388.09634688
Runtime: 15.2202060223 s
|dj| = 1388.09634688
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 1.786782e-01.
|dj| = 1388.09634688
found a tidal farm, computing _set_automatic_scaling_factor
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 1.786782e-01.
Set automatic scaling factor to 1.786782e-01.
|dj| = 1388.09634688
found a tidal farm, computing _set_automatic_scaling_factor
Start evaluation of dj
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Use checkpoint value.
found a tidal farm, computing _dj
Set automatic scaling factor to 1.786782e-01.
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Runtime: 0.023815870285 s
|dj| = 1388.09634688
Runtime: 0.0244829654694 s
|dj| = 1388.09634688
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 0.0354311466217 s
|dj| = 1388.09634688
Start evaluation of j
Updating the turbine cache
Runtime: 0.0379891395569 s
|dj| = 1388.09634688
    1     1    -1.423928E+05     2.480226E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.879e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.466e+01 (tol = 1.000e-10) r (rel) = 2.496e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.135e+00 (tol = 1.000e-10) r (rel) = 2.161e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.552e-02 (tol = 1.000e-10) r (rel) = 2.583e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.574e-06 (tol = 1.000e-10) r (rel) = 6.654e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.340e-11 (tol = 1.000e-10) r (rel) = 2.369e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 66.327408 s.
j = 7.135389e+05.
Runtime: 66.314365 s.
j = 7.135389e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 66.340208 s.
j = 7.135389e+05.
End of time loop.
Runtime: 66.324679 s.
Start evaluation of j
j = 7.135389e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.862e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.376e+01 (tol = 1.000e-10) r (rel) = 2.409e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.867e+00 (tol = 1.000e-10) r (rel) = 1.893e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.971e-02 (tol = 1.000e-10) r (rel) = 1.998e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.480e-06 (tol = 1.000e-10) r (rel) = 3.528e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.327e-11 (tol = 1.000e-10) r (rel) = 1.345e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 56.663389 s.
j = 8.053775e+05.
Runtime: 56.664764 s.
Runtime: 56.678617 s.
j = 8.053775e+05.
j = 8.053775e+05.
Runtime: 56.678724 s.
j = 8.053775e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.980e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.687e+01 (tol = 1.000e-10) r (rel) = 2.418e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.040e+00 (tol = 1.000e-10) r (rel) = 1.490e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.823e-03 (tol = 1.000e-10) r (rel) = 1.121e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.244e-07 (tol = 1.000e-10) r (rel) = 1.038e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.805e-12 (tol = 1.000e-10) r (rel) = 4.018e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 63.720001 s.
j = 8.011821e+05.
Runtime: 63.720008 s.
j = 8.011821e+05.
Runtime: 63.719433 s.
j = 8.011821e+05.
Runtime: 63.720215 s.
j = 8.011821e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.174e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.453e+00 (tol = 1.000e-10) r (rel) = 1.785e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.843e-01 (tol = 1.000e-10) r (rel) = 6.811e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.529e-04 (tol = 1.000e-10) r (rel) = 2.043e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.000e-08 (tol = 1.000e-10) r (rel) = 2.396e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 58.483678 s.
j = 7.975954e+05.
Runtime: 58.484251 s.
j = 7.975954e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 58.484872 s.
j = 7.975954e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 58.485657 s.
Start evaluation of j
j = 7.975954e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.483e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.078e+00 (tol = 1.000e-10) r (rel) = 1.239e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.186e-02 (tol = 1.000e-10) r (rel) = 2.491e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.287e-05 (tol = 1.000e-10) r (rel) = 1.726e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.999e-10 (tol = 1.000e-10) r (rel) = 1.208e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 62.072161 s.
j = 8.092003e+05.
Runtime: 62.071340 s.
End of time loop.
End of time loop.
j = 8.092003e+05.
Runtime: 62.072690 s.
j = 8.092003e+05.
Start evaluation of dj
Runtime: 62.070457 s.
j = 8.092003e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.6936089993 s
|dj| = 3159.98649744
Runtime: 15.6946051121 s
|dj| = 3159.98649744
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 15.7027480602 s
|dj| = 3159.98649744
Start evaluation of j
Updating the turbine cache
Runtime: 15.7070438862 s
|dj| = 3159.98649744
    2     6    -1.445865E+05     5.646207E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.904e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.220e+01 (tol = 1.000e-10) r (rel) = 2.493e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.700e+00 (tol = 1.000e-10) r (rel) = 1.910e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.420e-02 (tol = 1.000e-10) r (rel) = 1.595e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.768e-06 (tol = 1.000e-10) r (rel) = 1.985e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.041e-12 (tol = 1.000e-10) r (rel) = 7.908e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 72.218321 s.
j = 7.355600e+05.
Runtime: 72.207753 s.
j = 7.355600e+05.
End of time loop.
End of time loop.
Runtime: 72.203866 s.
j = 7.355600e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 72.219461 s.
j = 7.355600e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.714e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.180e+01 (tol = 1.000e-10) r (rel) = 2.244e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.632e+00 (tol = 1.000e-10) r (rel) = 1.680e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.429e-02 (tol = 1.000e-10) r (rel) = 1.471e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.458e-06 (tol = 1.000e-10) r (rel) = 1.500e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.070e-12 (tol = 1.000e-10) r (rel) = 5.219e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.339793 s.
j = 7.639165e+05.
Runtime: 75.339053 s.
j = 7.639165e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 75.340920 s.
j = 7.639165e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 75.341762 s.
Start evaluation of j
j = 7.639165e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.176e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.420e+01 (tol = 1.000e-10) r (rel) = 2.637e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.837e+00 (tol = 1.000e-10) r (rel) = 2.002e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.817e-02 (tol = 1.000e-10) r (rel) = 1.980e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.994e-06 (tol = 1.000e-10) r (rel) = 2.173e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.137e-12 (tol = 1.000e-10) r (rel) = 6.688e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 75.781209 s.
Runtime: 75.778801 s.
j = 7.994924e+05.
Runtime: 75.781227 s.
j = 7.994924e+05.
j = 7.994924e+05.
Runtime: 75.780496 s.
j = 7.994924e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.331e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.122e+01 (tol = 1.000e-10) r (rel) = 2.105e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.678e-01 (tol = 1.000e-10) r (rel) = 1.065e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.746e-03 (tol = 1.000e-10) r (rel) = 5.152e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.975e-08 (tol = 1.000e-10) r (rel) = 1.496e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.104e-12 (tol = 1.000e-10) r (rel) = 2.070e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 72.490546 s.
j = 7.993384e+05.
Runtime: 72.490730 s.
j = 7.993384e+05.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 72.490320 s.
Runtime: 72.491228 s.
j = 7.993384e+05.
j = 7.993384e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.599e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.343e+00 (tol = 1.000e-10) r (rel) = 1.286e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.132e-02 (tol = 1.000e-10) r (rel) = 2.359e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.129e-05 (tol = 1.000e-10) r (rel) = 1.204e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.744e-10 (tol = 1.000e-10) r (rel) = 6.710e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 63.924649 s.
Runtime: 63.923404 s.
j = 8.006437e+05.
j = 8.006437e+05.
End of time loop.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 63.925020 s.
Runtime: 63.924390 s.
j = 8.006437e+05.
j = 8.006437e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.027e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.596e-01 (tol = 1.000e-10) r (rel) = 5.449e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.698e-03 (tol = 1.000e-10) r (rel) = 1.653e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.243e-08 (tol = 1.000e-10) r (rel) = 2.184e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.107e-12 (tol = 1.000e-10) r (rel) = 1.077e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 57.848094 s.
Runtime: 57.848231 s.
j = 8.093701e+05.
j = 8.093701e+05.
Runtime: 57.849787 s.
j = 8.093701e+05.
Runtime: 57.849704 s.
j = 8.093701e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.566e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.340e-02 (tol = 1.000e-10) r (rel) = 8.555e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.097e-06 (tol = 1.000e-10) r (rel) = 7.005e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.219e-12 (tol = 1.000e-10) r (rel) = 3.333e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 45.600771 s.
j = 8.099345e+05.
End of time loop.
Runtime: 45.600885 s.
End of time loop.
j = 8.099345e+05.
Runtime: 45.601390 s.
Start evaluation of dj
j = 8.099345e+05.
found a tidal farm, computing gradient
Runtime: 45.600243 s.
j = 8.099345e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.3434970379 s
|dj| = 3643.97998814
Runtime: 15.3448278904 s
|dj| = 3643.97998814
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 15.359142065 s
|dj| = 3643.97998814
Runtime: 15.3612577915 s
|dj| = 3643.97998814
Start evaluation of j
Updating the turbine cache
    3    13    -1.447176E+05     6.510998E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.447e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.401e+01 (tol = 1.000e-10) r (rel) = 2.541e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.844e+00 (tol = 1.000e-10) r (rel) = 1.952e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.662e-02 (tol = 1.000e-10) r (rel) = 1.759e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.366e-06 (tol = 1.000e-10) r (rel) = 2.504e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 9.900e-12 (tol = 1.000e-10) r (rel) = 1.048e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.389842 s.
Runtime: 75.392322 s.
j = 7.506731e+05.
j = 7.506731e+05.
End of time loop.
End of time loop.
Runtime: 75.409206 s.
Runtime: 75.409120 s.
Start evaluation of j
j = 7.506731e+05.
j = 7.506731e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.952e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.346e+01 (tol = 1.000e-10) r (rel) = 2.357e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.735e+00 (tol = 1.000e-10) r (rel) = 1.744e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.645e-02 (tol = 1.000e-10) r (rel) = 1.652e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.298e-06 (tol = 1.000e-10) r (rel) = 2.309e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 9.636e-12 (tol = 1.000e-10) r (rel) = 9.682e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 73.584832 s.
j = 8.131014e+05.
End of time loop.
End of time loop.
Runtime: 73.584179 s.
j = 8.131014e+05.
Start evaluation of j
Runtime: 73.584511 s.
Runtime: 73.585037 s.
j = 8.131014e+05.
j = 8.131014e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.463e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.928e+01 (tol = 1.000e-10) r (rel) = 2.583e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.301e+00 (tol = 1.000e-10) r (rel) = 1.743e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.144e-02 (tol = 1.000e-10) r (rel) = 1.533e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.119e-06 (tol = 1.000e-10) r (rel) = 1.500e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.502e-12 (tol = 1.000e-10) r (rel) = 4.693e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 76.584594 s.
j = 8.223113e+05.
Runtime: 76.583472 s.
Runtime: 76.583466 s.
j = 8.223113e+05.
j = 8.223113e+05.
Runtime: 76.584265 s.
j = 8.223113e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.5411829948 s
|dj| = 5961.82641555
Start evaluation of j
Updating the turbine cache
Runtime: 17.5445361137 s
|dj| = 5961.82641555
    4    16    -1.469291E+05     1.065248E+03
Start evaluation of j
Updating the turbine cache
Runtime: 17.5578989983 s
Runtime: 17.5579760075 s
|dj| = 5961.82641555
|dj| = 5961.82641555
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.501e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.369e+01 (tol = 1.000e-10) r (rel) = 2.493e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.671e+00 (tol = 1.000e-10) r (rel) = 1.758e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.308e-02 (tol = 1.000e-10) r (rel) = 1.377e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.449e-06 (tol = 1.000e-10) r (rel) = 1.526e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.388e-12 (tol = 1.000e-10) r (rel) = 5.671e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 77.552954 s.
j = 7.984674e+05.
Runtime: 77.570397 s.
j = 7.984674e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 77.575142 s.
j = 7.984674e+05.
Start evaluation of j
End of time loop.
Runtime: 77.561524 s.
j = 7.984674e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.880e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.395e+01 (tol = 1.000e-10) r (rel) = 2.424e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.908e+00 (tol = 1.000e-10) r (rel) = 1.932e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.196e-02 (tol = 1.000e-10) r (rel) = 3.235e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.008e-05 (tol = 1.000e-10) r (rel) = 2.033e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.448e-11 (tol = 1.000e-10) r (rel) = 6.527e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 73.077584 s.
j = 8.062636e+05.
Runtime: 73.085191 s.
End of time loop.
j = 8.062636e+05.
End of time loop.
Start evaluation of j
Runtime: 73.075638 s.
j = 8.062636e+05.
Updating the turbine cache
Runtime: 73.086293 s.
j = 8.062636e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.036e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.137e+01 (tol = 1.000e-10) r (rel) = 2.660e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.488e+00 (tol = 1.000e-10) r (rel) = 1.852e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.253e-02 (tol = 1.000e-10) r (rel) = 1.560e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.211e-06 (tol = 1.000e-10) r (rel) = 1.507e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.238e-12 (tol = 1.000e-10) r (rel) = 5.273e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 72.141119 s.
j = 8.261169e+05.
End of time loop.
End of time loop.
Runtime: 72.142367 s.
j = 8.261169e+05.
Start evaluation of j
Runtime: 72.142054 s.
Runtime: 72.141561 s.
j = 8.261169e+05.
j = 8.261169e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.131e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.051e+01 (tol = 1.000e-10) r (rel) = 2.048e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.882e-01 (tol = 1.000e-10) r (rel) = 9.516e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.835e-03 (tol = 1.000e-10) r (rel) = 3.576e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.695e-08 (tol = 1.000e-10) r (rel) = 7.202e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 62.165727 s.
Runtime: 62.166970 s.
j = 8.327325e+05.
End of time loop.
j = 8.327325e+05.
End of time loop.
Runtime: 62.166572 s.
Runtime: 62.166204 s.
j = 8.327325e+05.
Start evaluation of dj
j = 8.327325e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.4942128658 s
|dj| = 6883.48784195
Runtime: 15.4960570335 s
|dj| = 6883.48784195
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 15.5098631382 s
|dj| = 6883.48784195
Runtime: 15.5124630928 s
Start evaluation of j
|dj| = 6883.48784195
Updating the turbine cache
    5    20    -1.487911E+05     1.229929E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.024e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.162e+01 (tol = 1.000e-10) r (rel) = 2.395e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.625e+00 (tol = 1.000e-10) r (rel) = 1.801e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.643e-02 (tol = 1.000e-10) r (rel) = 1.821e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.418e-06 (tol = 1.000e-10) r (rel) = 3.788e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.012e-11 (tol = 1.000e-10) r (rel) = 1.122e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 74.345055 s.
j = 8.132836e+05.
Runtime: 74.363610 s.
j = 8.132836e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Runtime: 74.348404 s.
j = 8.132836e+05.
Updating the turbine cache
End of time loop.
Runtime: 74.366001 s.
j = 8.132836e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.232e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.215e+01 (tol = 1.000e-10) r (rel) = 2.399e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.828e+00 (tol = 1.000e-10) r (rel) = 1.980e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.433e-02 (tol = 1.000e-10) r (rel) = 2.636e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.845e-06 (tol = 1.000e-10) r (rel) = 1.066e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.749e-11 (tol = 1.000e-10) r (rel) = 2.977e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 71.292294 s.
Runtime: 71.290848 s.
j = 8.054955e+05.
End of time loop.
j = 8.054955e+05.
Start evaluation of j
Runtime: 71.292852 s.
j = 8.054955e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 71.291441 s.
Start evaluation of j
j = 8.054955e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.062e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.064e+01 (tol = 1.000e-10) r (rel) = 2.560e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.476e+00 (tol = 1.000e-10) r (rel) = 1.831e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.322e-02 (tol = 1.000e-10) r (rel) = 1.640e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.571e-06 (tol = 1.000e-10) r (rel) = 1.949e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.919e-12 (tol = 1.000e-10) r (rel) = 6.102e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 63.030095 s.
j = 8.182222e+05.
End of time loop.
Runtime: 63.028911 s.
j = 8.182222e+05.
Start evaluation of j
Runtime: 63.031523 s.
j = 8.182222e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 63.032593 s.
j = 8.182222e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.467e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.532e+01 (tol = 1.000e-10) r (rel) = 2.370e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.565e-01 (tol = 1.000e-10) r (rel) = 1.479e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.287e-03 (tol = 1.000e-10) r (rel) = 1.127e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.513e-07 (tol = 1.000e-10) r (rel) = 1.162e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.802e-12 (tol = 1.000e-10) r (rel) = 5.879e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 69.252576 s.
j = 8.323534e+05.
Runtime: 69.255080 s.
j = 8.323534e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
End of time loop.
Updating the turbine cache
Runtime: 69.255727 s.
j = 8.323534e+05.
Runtime: 69.255278 s.
j = 8.323534e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.171e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.019e+00 (tol = 1.000e-10) r (rel) = 1.582e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.334e-01 (tol = 1.000e-10) r (rel) = 4.205e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.507e-04 (tol = 1.000e-10) r (rel) = 4.753e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.836e-10 (tol = 1.000e-10) r (rel) = 2.471e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 58.270826 s.
j = 8.315046e+05.
Runtime: 58.270844 s.
j = 8.315046e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 58.270283 s.
j = 8.315046e+05.
End of time loop.
Runtime: 58.270028 s.
j = 8.315046e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.567e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.463e+00 (tol = 1.000e-10) r (rel) = 9.334e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.404e-02 (tol = 1.000e-10) r (rel) = 8.960e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.042e-06 (tol = 1.000e-10) r (rel) = 1.303e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.774e-12 (tol = 1.000e-10) r (rel) = 5.599e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 62.895785 s.
j = 8.264659e+05.
Runtime: 62.894729 s.
j = 8.264659e+05.
End of time loop.
Start evaluation of j
Runtime: 62.893749 s.
j = 8.264659e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 62.897156 s.
j = 8.264659e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.014e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.176e-01 (tol = 1.000e-10) r (rel) = 6.088e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.369e-03 (tol = 1.000e-10) r (rel) = 2.335e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.966e-08 (tol = 1.000e-10) r (rel) = 4.895e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.134e-12 (tol = 1.000e-10) r (rel) = 1.118e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 58.885991 s.
j = 8.333231e+05.
Start evaluation of dj
End of time loop.
found a tidal farm, computing gradient
End of time loop.
Runtime: 58.889390 s.
j = 8.333231e+05.
Runtime: 58.888699 s.
j = 8.333231e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 58.898807 s.
j = 8.333231e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.3339459896 s
|dj| = 6823.92971727
Start evaluation of j
Updating the turbine cache
Runtime: 14.3468279839 s
|dj| = 6823.92971727
Runtime: 14.3453421593 s
|dj| = 6823.92971727
    6    27    -1.488967E+05     1.219288E+03
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 14.3626270294 s
|dj| = 6823.92971727
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.715e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.264e+01 (tol = 1.000e-10) r (rel) = 2.597e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.741e+00 (tol = 1.000e-10) r (rel) = 1.998e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.872e-02 (tol = 1.000e-10) r (rel) = 2.148e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.391e-06 (tol = 1.000e-10) r (rel) = 6.186e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.965e-11 (tol = 1.000e-10) r (rel) = 2.255e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.100529 s.
j = 7.942068e+05.
End of time loop.
Runtime: 75.098255 s.
End of time loop.
j = 7.942068e+05.
Runtime: 75.098410 s.
Start evaluation of j
j = 7.942068e+05.
Runtime: 75.081454 s.
Updating the turbine cache
j = 7.942068e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.281e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.281e+01 (tol = 1.000e-10) r (rel) = 2.458e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.776e+00 (tol = 1.000e-10) r (rel) = 1.913e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.668e-02 (tol = 1.000e-10) r (rel) = 1.797e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.107e-06 (tol = 1.000e-10) r (rel) = 2.271e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.247e-12 (tol = 1.000e-10) r (rel) = 4.575e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 73.883074 s.
j = 8.384945e+05.
End of time loop.
Runtime: 73.883252 s.
j = 8.384945e+05.
Runtime: 73.884705 s.
Runtime: 73.883421 s.
j = 8.384945e+05.
j = 8.384945e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.044e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.100e+01 (tol = 1.000e-10) r (rel) = 2.611e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.505e+00 (tol = 1.000e-10) r (rel) = 1.871e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.352e-02 (tol = 1.000e-10) r (rel) = 1.680e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.355e-06 (tol = 1.000e-10) r (rel) = 1.684e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.793e-12 (tol = 1.000e-10) r (rel) = 5.958e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.350581 s.
End of time loop.
j = 8.404385e+05.
Runtime: 75.350815 s.
j = 8.404385e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 75.355232 s.
j = 8.404385e+05.
End of time loop.
Runtime: 75.355222 s.
j = 8.404385e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.342e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.481e+01 (tol = 1.000e-10) r (rel) = 2.335e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.166e-01 (tol = 1.000e-10) r (rel) = 1.445e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.251e-03 (tol = 1.000e-10) r (rel) = 1.143e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.575e-07 (tol = 1.000e-10) r (rel) = 1.037e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.343e-12 (tol = 1.000e-10) r (rel) = 3.695e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 71.654335 s.
Runtime: 71.658172 s.
j = 8.419817e+05.
j = 8.419817e+05.
Runtime: 71.654269 s.
j = 8.419817e+05.
Runtime: 71.658911 s.
j = 8.419817e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.069e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.979e+00 (tol = 1.000e-10) r (rel) = 1.961e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.200e-01 (tol = 1.000e-10) r (rel) = 1.032e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.991e-03 (tol = 1.000e-10) r (rel) = 7.352e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.014e-07 (tol = 1.000e-10) r (rel) = 4.950e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.374e-12 (tol = 1.000e-10) r (rel) = 3.377e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 77.786114 s.
j = 8.393978e+05.
End of time loop.
Runtime: 77.786308 s.
End of time loop.
j = 8.393978e+05.
Start evaluation of dj
Runtime: 77.786716 s.
found a tidal farm, computing gradient
j = 8.393978e+05.
Runtime: 77.786095 s.
j = 8.393978e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.5687699318 s
|dj| = 7901.50835621
Runtime: 15.5695619583 s
|dj| = 7901.50835621
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 15.5844929218 s
|dj| = 7901.50835621
Runtime: 15.5849759579 s
|dj| = 7901.50835621
Start evaluation of j
Updating the turbine cache
    7    32    -1.499821E+05     1.411827E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.237e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.237e+01 (tol = 1.000e-10) r (rel) = 2.422e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.653e+00 (tol = 1.000e-10) r (rel) = 1.789e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.309e-02 (tol = 1.000e-10) r (rel) = 1.417e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.387e-05 (tol = 1.000e-10) r (rel) = 1.501e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.186e-12 (tol = 1.000e-10) r (rel) = 7.780e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 76.720505 s.
j = 8.156539e+05.
Runtime: 76.705266 s.
j = 8.156539e+05.
End of time loop.
Runtime: 76.704633 s.
j = 8.156539e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 76.723228 s.
Start evaluation of j
j = 8.156539e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.004e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.300e+01 (tol = 1.000e-10) r (rel) = 2.290e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.804e+00 (tol = 1.000e-10) r (rel) = 1.797e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.323e-02 (tol = 1.000e-10) r (rel) = 2.313e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.093e-05 (tol = 1.000e-10) r (rel) = 1.089e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.294e-11 (tol = 1.000e-10) r (rel) = 3.280e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.437912 s.
j = 8.127233e+05.
Start evaluation of j
Updating the turbine cache
Runtime: 75.444873 s.
j = 8.127233e+05.
End of time loop.
Runtime: 75.446539 s.
j = 8.127233e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 75.448126 s.
j = 8.127233e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.728e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.465e+01 (tol = 1.000e-10) r (rel) = 2.534e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.862e+00 (tol = 1.000e-10) r (rel) = 1.914e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.861e-02 (tol = 1.000e-10) r (rel) = 1.913e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.133e-06 (tol = 1.000e-10) r (rel) = 2.192e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.004e-12 (tol = 1.000e-10) r (rel) = 7.200e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.114593 s.
j = 8.438894e+05.
Runtime: 75.114636 s.
j = 8.438894e+05.
End of time loop.
Runtime: 75.121466 s.
j = 8.438894e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 75.113900 s.
Start evaluation of j
j = 8.438894e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.089e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.929e+01 (tol = 1.000e-10) r (rel) = 2.384e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.224e+00 (tol = 1.000e-10) r (rel) = 1.513e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.146e-03 (tol = 1.000e-10) r (rel) = 1.131e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.227e-07 (tol = 1.000e-10) r (rel) = 1.017e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.895e-12 (tol = 1.000e-10) r (rel) = 3.580e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 74.666773 s.
Runtime: 74.664614 s.
j = 8.328213e+05.
j = 8.328213e+05.
Runtime: 74.666939 s.
j = 8.328213e+05.
Runtime: 74.666237 s.
j = 8.328213e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.199e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.872e+00 (tol = 1.000e-10) r (rel) = 1.899e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.346e-01 (tol = 1.000e-10) r (rel) = 8.359e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.932e-03 (tol = 1.000e-10) r (rel) = 3.715e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.039e-08 (tol = 1.000e-10) r (rel) = 1.354e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.108e-12 (tol = 1.000e-10) r (rel) = 2.130e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 67.657694 s.
j = 8.343294e+05.
Runtime: 67.657031 s.
j = 8.343294e+05.
End of time loop.
Runtime: 67.658229 s.
Start evaluation of j
Start evaluation of j
j = 8.343294e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 67.658971 s.
Start evaluation of j
j = 8.343294e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.728e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.475e+00 (tol = 1.000e-10) r (rel) = 1.274e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.350e-02 (tol = 1.000e-10) r (rel) = 3.427e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.540e-04 (tol = 1.000e-10) r (rel) = 5.646e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.337e-10 (tol = 1.000e-10) r (rel) = 2.690e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 50.564834 s.
j = 8.374932e+05.
Runtime: 50.564811 s.
j = 8.374932e+05.
Runtime: 50.562828 s.
j = 8.374932e+05.
Runtime: 50.564298 s.
j = 8.374932e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.352e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.363e-01 (tol = 1.000e-10) r (rel) = 6.927e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.568e-03 (tol = 1.000e-10) r (rel) = 5.599e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.709e-07 (tol = 1.000e-10) r (rel) = 7.183e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.369e-12 (tol = 1.000e-10) r (rel) = 4.712e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 57.659583 s.
j = 8.395827e+05.
Runtime: 57.658754 s.
j = 8.395827e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 57.660124 s.
j = 8.395827e+05.
End of time loop.
Runtime: 57.660908 s.
j = 8.395827e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.526e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.148e-01 (tol = 1.000e-10) r (rel) = 3.292e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.854e-04 (tol = 1.000e-10) r (rel) = 5.906e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.940e-09 (tol = 1.000e-10) r (rel) = 4.505e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 37.080872 s.
j = 8.444395e+05.
Runtime: 37.078436 s.
j = 8.444395e+05.
Runtime: 37.081169 s.
j = 8.444395e+05.
Runtime: 37.080173 s.
j = 8.444395e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.926817894 s
|dj| = 4814.12395787
Runtime: 11.927809 s
|dj| = 4814.12395787
Runtime: 11.9283800125 s
Start evaluation of j
|dj| = 4814.12395787
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 11.9286961555 s
|dj| = 4814.12395787
Start evaluation of j
Updating the turbine cache
    8    40    -1.508829E+05     8.601790E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.007e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.437e+01 (tol = 1.000e-10) r (rel) = 2.421e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.900e+00 (tol = 1.000e-10) r (rel) = 1.887e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.954e-02 (tol = 1.000e-10) r (rel) = 1.941e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.367e-06 (tol = 1.000e-10) r (rel) = 5.331e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.569e-11 (tol = 1.000e-10) r (rel) = 1.559e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 73.529886 s.
j = 8.256340e+05.
Runtime: 73.531590 s.
j = 8.256340e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 73.531099 s.
j = 8.256340e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 73.533883 s.
Start evaluation of j
j = 8.256340e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.954e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.378e+01 (tol = 1.000e-10) r (rel) = 2.389e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.787e+00 (tol = 1.000e-10) r (rel) = 1.795e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.665e-02 (tol = 1.000e-10) r (rel) = 1.673e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.319e-06 (tol = 1.000e-10) r (rel) = 2.329e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.010e-12 (tol = 1.000e-10) r (rel) = 7.042e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.043721 s.
j = 8.395792e+05.
End of time loop.
End of time loop.
Runtime: 78.043274 s.
j = 8.395792e+05.
Start evaluation of j
Runtime: 78.044368 s.
Runtime: 78.042084 s.
j = 8.395792e+05.
j = 8.395792e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.616e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.920e+01 (tol = 1.000e-10) r (rel) = 2.228e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.273e+00 (tol = 1.000e-10) r (rel) = 1.477e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.343e-03 (tol = 1.000e-10) r (rel) = 1.084e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.767e-07 (tol = 1.000e-10) r (rel) = 7.854e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.952e-12 (tol = 1.000e-10) r (rel) = 3.427e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 77.319634 s.
j = 8.465541e+05.
Runtime: 77.318829 s.
End of time loop.
j = 8.465541e+05.
End of time loop.
Start evaluation of j
Runtime: 77.319212 s.
Updating the turbine cache
j = 8.465541e+05.
Runtime: 77.319745 s.
j = 8.465541e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.968e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.147e+01 (tol = 1.000e-10) r (rel) = 1.922e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.467e-01 (tol = 1.000e-10) r (rel) = 1.084e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.815e-03 (tol = 1.000e-10) r (rel) = 8.067e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.617e-07 (tol = 1.000e-10) r (rel) = 7.737e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.097e-12 (tol = 1.000e-10) r (rel) = 3.514e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 76.165945 s.
j = 8.454244e+05.
End of time loop.
Runtime: 76.165621 s.
End of time loop.
j = 8.454244e+05.
Start evaluation of j
Runtime: 76.166129 s.
j = 8.454244e+05.
Runtime: 76.167515 s.
j = 8.454244e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.446e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.501e+00 (tol = 1.000e-10) r (rel) = 1.306e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.222e-01 (tol = 1.000e-10) r (rel) = 3.547e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.732e-04 (tol = 1.000e-10) r (rel) = 5.026e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.477e-10 (tol = 1.000e-10) r (rel) = 1.879e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 59.499981 s.
Runtime: 59.499008 s.
j = 8.411316e+05.
Runtime: 59.499372 s.
j = 8.411316e+05.
j = 8.411316e+05.
Runtime: 59.499117 s.
j = 8.411316e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.898e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.570e+00 (tol = 1.000e-10) r (rel) = 8.275e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.729e-02 (tol = 1.000e-10) r (rel) = 9.112e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.493e-06 (tol = 1.000e-10) r (rel) = 1.840e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.425e-11 (tol = 1.000e-10) r (rel) = 7.508e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 54.121371 s.
j = 8.364283e+05.
Runtime: 54.121515 s.
j = 8.364283e+05.
Runtime: 54.121636 s.
j = 8.364283e+05.
Runtime: 54.121200 s.
j = 8.364283e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.146e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.194e-01 (tol = 1.000e-10) r (rel) = 5.405e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.806e-03 (tol = 1.000e-10) r (rel) = 2.448e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.147e-08 (tol = 1.000e-10) r (rel) = 7.981e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.092e-12 (tol = 1.000e-10) r (rel) = 9.525e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 57.836860 s.
j = 8.482706e+05.
End of time loop.
Runtime: 57.837764 s.
j = 8.482706e+05.
Start evaluation of dj
Runtime: 57.838118 s.
j = 8.482706e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 57.839277 s.
Start evaluation of dj
j = 8.482706e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.8007879257 s
|dj| = 6091.12257313
Runtime: 16.7988159657 s
|dj| = 6091.12257313
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 16.8153660297 s
|dj| = 6091.12257313
Runtime: 16.8180658817 s
|dj| = 6091.12257313
Start evaluation of j
Updating the turbine cache
    9    47    -1.515675E+05     1.088351E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.023e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.381e+01 (tol = 1.000e-10) r (rel) = 2.327e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.840e+00 (tol = 1.000e-10) r (rel) = 1.798e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.656e-02 (tol = 1.000e-10) r (rel) = 1.619e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.007e-06 (tol = 1.000e-10) r (rel) = 2.939e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.048e-11 (tol = 1.000e-10) r (rel) = 1.024e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 73.875293 s.
j = 8.192494e+05.
Runtime: 73.876750 s.
j = 8.192494e+05.
Runtime: 73.893751 s.
j = 8.192494e+05.
Runtime: 73.893932 s.
j = 8.192494e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.507e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.274e+01 (tol = 1.000e-10) r (rel) = 2.391e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.668e+00 (tol = 1.000e-10) r (rel) = 1.754e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.628e-02 (tol = 1.000e-10) r (rel) = 1.713e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.190e-06 (tol = 1.000e-10) r (rel) = 4.408e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.556e-11 (tol = 1.000e-10) r (rel) = 1.637e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 69.154631 s.
j = 8.133351e+05.
Runtime: 69.153966 s.
j = 8.133351e+05.
Runtime: 69.154615 s.
j = 8.133351e+05.
Runtime: 69.154995 s.
j = 8.133351e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.487e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.375e+01 (tol = 1.000e-10) r (rel) = 2.503e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.691e+00 (tol = 1.000e-10) r (rel) = 1.782e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.400e-02 (tol = 1.000e-10) r (rel) = 1.475e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.148e-06 (tol = 1.000e-10) r (rel) = 1.210e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.321e-12 (tol = 1.000e-10) r (rel) = 3.500e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 73.559308 s.
j = 8.660624e+05.
End of time loop.
Runtime: 73.560407 s.
End of time loop.
j = 8.660624e+05.
Runtime: 73.560737 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 8.660624e+05.
Runtime: 73.560924 s.
j = 8.660624e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.7327570915 s
|dj| = 8183.62520022
Runtime: 15.7326660156 s
|dj| = 8183.62520022
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 15.7510149479 s
|dj| = 8183.62520022
Runtime: 15.7518239021 s
|dj| = 8183.62520022
Start evaluation of j
Updating the turbine cache
   10    50    -1.547465E+05     1.462235E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.003e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.294e+01 (tol = 1.000e-10) r (rel) = 2.286e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.868e+00 (tol = 1.000e-10) r (rel) = 1.862e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.820e-02 (tol = 1.000e-10) r (rel) = 2.811e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.531e-05 (tol = 1.000e-10) r (rel) = 1.526e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.981e-11 (tol = 1.000e-10) r (rel) = 4.964e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 69.506545 s.
Runtime: 69.525773 s.
j = 8.207760e+05.
Runtime: 69.505828 s.
j = 8.207760e+05.
j = 8.207760e+05.
Runtime: 69.527344 s.
j = 8.207760e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.538e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.274e+01 (tol = 1.000e-10) r (rel) = 2.384e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.740e+00 (tol = 1.000e-10) r (rel) = 1.824e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.480e-02 (tol = 1.000e-10) r (rel) = 1.552e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.494e-06 (tol = 1.000e-10) r (rel) = 1.566e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.990e-12 (tol = 1.000e-10) r (rel) = 4.183e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 82.003495 s.
j = 8.389828e+05.
Runtime: 82.003651 s.
j = 8.389828e+05.
End of time loop.
Runtime: 82.004087 s.
Start evaluation of j
j = 8.389828e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 82.004291 s.
Start evaluation of j
j = 8.389828e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.972e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.088e+01 (tol = 1.000e-10) r (rel) = 2.327e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.512e+00 (tol = 1.000e-10) r (rel) = 1.685e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.325e-02 (tol = 1.000e-10) r (rel) = 1.477e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.703e-06 (tol = 1.000e-10) r (rel) = 1.899e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.575e-12 (tol = 1.000e-10) r (rel) = 8.442e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 78.771776 s.
Runtime: 78.771859 s.
j = 8.472618e+05.
j = 8.472618e+05.
Runtime: 78.769733 s.
j = 8.472618e+05.
Runtime: 78.771521 s.
j = 8.472618e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.345e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.583e+01 (tol = 1.000e-10) r (rel) = 2.155e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.888e-01 (tol = 1.000e-10) r (rel) = 1.346e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.321e-03 (tol = 1.000e-10) r (rel) = 9.967e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.284e-07 (tol = 1.000e-10) r (rel) = 9.916e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.160e-12 (tol = 1.000e-10) r (rel) = 4.303e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 76.318006 s.
j = 8.604095e+05.
Runtime: 76.317983 s.
j = 8.604095e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 76.317535 s.
j = 8.604095e+05.
End of time loop.
Runtime: 76.319086 s.
j = 8.604095e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.665e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.829e+00 (tol = 1.000e-10) r (rel) = 1.318e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.231e-01 (tol = 1.000e-10) r (rel) = 3.360e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.398e-04 (tol = 1.000e-10) r (rel) = 3.815e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.334e-10 (tol = 1.000e-10) r (rel) = 1.455e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 60.069775 s.
j = 8.615786e+05.
Runtime: 60.067508 s.
j = 8.615786e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 60.069178 s.
j = 8.615786e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 60.071281 s.
Start evaluation of j
j = 8.615786e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.820e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.322e+00 (tol = 1.000e-10) r (rel) = 7.263e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.104e-02 (tol = 1.000e-10) r (rel) = 6.068e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.265e-06 (tol = 1.000e-10) r (rel) = 6.950e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.182e-12 (tol = 1.000e-10) r (rel) = 2.848e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 61.094270 s.
j = 8.656450e+05.
End of time loop.
Runtime: 61.094442 s.
j = 8.656450e+05.
Start evaluation of j
Runtime: 61.093932 s.
j = 8.656450e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 61.093762 s.
Updating the turbine cache
j = 8.656450e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.289e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.738e-01 (tol = 1.000e-10) r (rel) = 2.764e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.581e-04 (tol = 1.000e-10) r (rel) = 2.513e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.030e-10 (tol = 1.000e-10) r (rel) = 1.436e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 45.408015 s.
j = 8.673611e+05.
End of time loop.
Runtime: 45.405827 s.
j = 8.673611e+05.
Start evaluation of dj
Runtime: 45.408451 s.
j = 8.673611e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 45.408554 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 8.673611e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.299945116 s
|dj| = 6377.49536737
Runtime: 15.298623085 s
|dj| = 6377.49536737
Runtime: 15.3002998829 s
|dj| = 6377.49536737
Start evaluation of j
Updating the turbine cache
Runtime: 15.3018159866 s
|dj| = 6377.49536737
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
   11    57    -1.549785E+05     1.139519E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.008e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.487e+01 (tol = 1.000e-10) r (rel) = 2.468e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.156e+00 (tol = 1.000e-10) r (rel) = 2.140e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.140e-02 (tol = 1.000e-10) r (rel) = 4.109e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.302e-05 (tol = 1.000e-10) r (rel) = 3.277e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 9.996e-11 (tol = 1.000e-10) r (rel) = 9.921e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 57.130041 s.
Runtime: 57.129454 s.
j = 7.992212e+05.
j = 7.992212e+05.
Runtime: 57.131702 s.
j = 7.992212e+05.
Runtime: 57.130567 s.
j = 7.992212e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.457e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.338e+01 (tol = 1.000e-10) r (rel) = 2.472e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.920e+00 (tol = 1.000e-10) r (rel) = 2.030e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.584e-02 (tol = 1.000e-10) r (rel) = 2.733e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.408e-06 (tol = 1.000e-10) r (rel) = 6.776e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.189e-11 (tol = 1.000e-10) r (rel) = 1.257e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 72.805575 s.
j = 8.285287e+05.
End of time loop.
Runtime: 72.805752 s.
j = 8.285287e+05.
Start evaluation of j
Runtime: 72.805497 s.
j = 8.285287e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 72.807192 s.
Updating the turbine cache
j = 8.285287e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.787e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.067e+01 (tol = 1.000e-10) r (rel) = 2.352e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.531e+00 (tol = 1.000e-10) r (rel) = 1.742e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.407e-02 (tol = 1.000e-10) r (rel) = 1.602e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.689e-06 (tol = 1.000e-10) r (rel) = 1.923e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.618e-12 (tol = 1.000e-10) r (rel) = 7.532e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 68.284257 s.
j = 8.651880e+05.
End of time loop.
End of time loop.
Runtime: 68.284547 s.
j = 8.651880e+05.
Start evaluation of j
Runtime: 68.283905 s.
Runtime: 68.282472 s.
j = 8.651880e+05.
Updating the turbine cache
j = 8.651880e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.004e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.094e+01 (tol = 1.000e-10) r (rel) = 1.822e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.246e-01 (tol = 1.000e-10) r (rel) = 1.040e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.416e-03 (tol = 1.000e-10) r (rel) = 7.356e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.748e-07 (tol = 1.000e-10) r (rel) = 6.243e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.441e-12 (tol = 1.000e-10) r (rel) = 2.401e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 67.692339 s.
Runtime: 67.691548 s.
j = 8.712934e+05.
j = 8.712934e+05.
Runtime: 67.691402 s.
j = 8.712934e+05.
Runtime: 67.691655 s.
j = 8.712934e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.865e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.215e+00 (tol = 1.000e-10) r (rel) = 1.122e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.389e-02 (tol = 1.000e-10) r (rel) = 2.579e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.659e-05 (tol = 1.000e-10) r (rel) = 2.324e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.941e-10 (tol = 1.000e-10) r (rel) = 6.775e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 58.806231 s.
j = 8.646932e+05.
Runtime: 58.806604 s.
End of time loop.
j = 8.646932e+05.
End of time loop.
Start evaluation of j
Runtime: 58.806208 s.
j = 8.646932e+05.
Runtime: 58.807104 s.
Updating the turbine cache
j = 8.646932e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.962e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.596e+00 (tol = 1.000e-10) r (rel) = 8.134e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.832e-02 (tol = 1.000e-10) r (rel) = 9.334e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.973e-06 (tol = 1.000e-10) r (rel) = 2.025e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.156e-12 (tol = 1.000e-10) r (rel) = 4.156e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 63.689990 s.
j = 8.751910e+05.
End of time loop.
Runtime: 63.690949 s.
j = 8.751910e+05.
Runtime: 63.690136 s.
j = 8.751910e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 63.690864 s.
j = 8.751910e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.4965620041 s
|dj| = 6689.99390798
Runtime: 14.4993350506 s
|dj| = 6689.99390798
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 14.5136518478 s
|dj| = 6689.99390798
Start evaluation of j
Updating the turbine cache
Runtime: 14.5187871456 s
|dj| = 6689.99390798
   12    63    -1.563776E+05     1.195356E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.718e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.316e+01 (tol = 1.000e-10) r (rel) = 2.383e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.816e+00 (tol = 1.000e-10) r (rel) = 1.869e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.843e-02 (tol = 1.000e-10) r (rel) = 1.897e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.858e-06 (tol = 1.000e-10) r (rel) = 2.940e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.734e-12 (tol = 1.000e-10) r (rel) = 6.929e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 70.999341 s.
j = 8.231191e+05.
End of time loop.
End of time loop.
Runtime: 71.020933 s.
j = 8.231191e+05.
Runtime: 71.020918 s.
Runtime: 71.003752 s.
Start evaluation of j
j = 8.231191e+05.
j = 8.231191e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.007e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.421e+01 (tol = 1.000e-10) r (rel) = 2.405e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.920e+00 (tol = 1.000e-10) r (rel) = 1.907e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.934e-02 (tol = 1.000e-10) r (rel) = 1.921e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.639e-06 (tol = 1.000e-10) r (rel) = 3.615e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.403e-11 (tol = 1.000e-10) r (rel) = 1.393e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 66.771896 s.
j = 7.932384e+05.
Runtime: 66.772565 s.
j = 7.932384e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 66.772279 s.
j = 7.932384e+05.
End of time loop.
Runtime: 66.772941 s.
j = 7.932384e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.455e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.376e+01 (tol = 1.000e-10) r (rel) = 2.513e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.733e+00 (tol = 1.000e-10) r (rel) = 1.833e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.495e-02 (tol = 1.000e-10) r (rel) = 1.582e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.314e-06 (tol = 1.000e-10) r (rel) = 1.390e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.310e-12 (tol = 1.000e-10) r (rel) = 3.501e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 67.603555 s.
j = 8.195780e+05.
Runtime: 67.601091 s.
j = 8.195780e+05.
Runtime: 67.603580 s.
j = 8.195780e+05.
Runtime: 67.602871 s.
j = 8.195780e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.224e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.041e+01 (tol = 1.000e-10) r (rel) = 2.482e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.429e+00 (tol = 1.000e-10) r (rel) = 1.738e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.297e-02 (tol = 1.000e-10) r (rel) = 1.577e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.639e-06 (tol = 1.000e-10) r (rel) = 1.993e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.512e-12 (tol = 1.000e-10) r (rel) = 9.134e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 64.424808 s.
j = 8.601428e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 64.424120 s.
j = 8.601428e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 64.431172 s.
j = 8.601428e+05.
End of time loop.
Start evaluation of j
Runtime: 64.431946 s.
j = 8.601428e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.610e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.683e+00 (tol = 1.000e-10) r (rel) = 1.574e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.959e-01 (tol = 1.000e-10) r (rel) = 5.426e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.743e-04 (tol = 1.000e-10) r (rel) = 1.314e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.025e-09 (tol = 1.000e-10) r (rel) = 1.115e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.155254 s.
j = 8.657235e+05.
Runtime: 48.137103 s.
j = 8.657235e+05.
End of time loop.
Runtime: 48.147277 s.
Start evaluation of j
Start evaluation of j
j = 8.657235e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 48.156725 s.
Start evaluation of j
j = 8.657235e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.432e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.078e+00 (tol = 1.000e-10) r (rel) = 7.523e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.457e-03 (tol = 1.000e-10) r (rel) = 5.206e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.483e-07 (tol = 1.000e-10) r (rel) = 3.827e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.284e-12 (tol = 1.000e-10) r (rel) = 1.594e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 60.409164 s.
j = 8.773879e+05.
End of time loop.
Runtime: 60.408476 s.
End of time loop.
j = 8.773879e+05.
Start evaluation of dj
Runtime: 60.409835 s.
found a tidal farm, computing gradient
j = 8.773879e+05.
Runtime: 60.407615 s.
j = 8.773879e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.8087759018 s
|dj| = 7349.73637033
Start evaluation of j
Runtime: 15.8090980053 s
|dj| = 7349.73637033
Updating the turbine cache
Runtime: 15.8103249073 s
|dj| = 7349.73637033
   13    69    -1.567701E+05     1.313238E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 15.8340978622 s
|dj| = 7349.73637033
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.697e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.318e+01 (tol = 1.000e-10) r (rel) = 2.390e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.674e+00 (tol = 1.000e-10) r (rel) = 1.726e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.394e-02 (tol = 1.000e-10) r (rel) = 1.437e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.101e-06 (tol = 1.000e-10) r (rel) = 2.166e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 8.110e-12 (tol = 1.000e-10) r (rel) = 8.363e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.210944 s.
j = 8.001634e+05.
Runtime: 78.234382 s.
j = 8.001634e+05.
End of time loop.
Start evaluation of j
Runtime: 78.236795 s.
j = 8.001634e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 78.239952 s.
Start evaluation of j
j = 8.001634e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.231e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.132e+01 (tol = 1.000e-10) r (rel) = 2.310e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.460e+00 (tol = 1.000e-10) r (rel) = 1.581e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.954e-03 (tol = 1.000e-10) r (rel) = 1.078e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.025e-07 (tol = 1.000e-10) r (rel) = 6.527e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.390e-12 (tol = 1.000e-10) r (rel) = 2.589e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 74.674117 s.
j = 8.214648e+05.
End of time loop.
Runtime: 74.673440 s.
j = 8.214648e+05.
Start evaluation of j
Runtime: 74.674924 s.
j = 8.214648e+05.
End of time loop.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 74.692671 s.
j = 8.214648e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.402e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.019e+01 (tol = 1.000e-10) r (rel) = 2.403e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.371e+00 (tol = 1.000e-10) r (rel) = 1.632e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.043e-02 (tol = 1.000e-10) r (rel) = 1.242e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.417e-07 (tol = 1.000e-10) r (rel) = 1.121e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.695e-12 (tol = 1.000e-10) r (rel) = 4.398e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 63.325945 s.
j = 8.567969e+05.
Runtime: 63.346061 s.
j = 8.567969e+05.
Runtime: 63.346530 s.
j = 8.567969e+05.
Runtime: 63.347508 s.
j = 8.567969e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.418e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.514e+01 (tol = 1.000e-10) r (rel) = 2.359e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.009e+00 (tol = 1.000e-10) r (rel) = 1.572e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.479e-03 (tol = 1.000e-10) r (rel) = 1.477e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.348e-06 (tol = 1.000e-10) r (rel) = 2.100e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.658e-12 (tol = 1.000e-10) r (rel) = 8.817e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 60.112564 s.
j = 8.663409e+05.
Runtime: 60.113383 s.
j = 8.663409e+05.
Runtime: 60.113519 s.
j = 8.663409e+05.
Runtime: 60.113635 s.
j = 8.663409e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.544e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.711e+00 (tol = 1.000e-10) r (rel) = 1.611e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.141e-01 (tol = 1.000e-10) r (rel) = 6.042e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.524e-04 (tol = 1.000e-10) r (rel) = 1.558e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.055e-09 (tol = 1.000e-10) r (rel) = 1.426e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.852952 s.
j = 8.675970e+05.
Runtime: 46.853658 s.
j = 8.675970e+05.
Runtime: 46.853802 s.
j = 8.675970e+05.
Runtime: 46.854199 s.
j = 8.675970e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.496e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.117e+00 (tol = 1.000e-10) r (rel) = 7.465e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.402e-03 (tol = 1.000e-10) r (rel) = 5.615e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.304e-07 (tol = 1.000e-10) r (rel) = 4.881e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.586e-12 (tol = 1.000e-10) r (rel) = 1.728e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 51.036560 s.
j = 8.709299e+05.
Runtime: 51.036538 s.
j = 8.709299e+05.
Runtime: 51.036014 s.
j = 8.709299e+05.
Runtime: 51.036958 s.
j = 8.709299e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.100e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.910e-01 (tol = 1.000e-10) r (rel) = 3.132e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.826e-04 (tol = 1.000e-10) r (rel) = 4.633e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.520e-09 (tol = 1.000e-10) r (rel) = 2.491e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 34.694636 s.
j = 8.778690e+05.
Runtime: 34.695279 s.
j = 8.778690e+05.
Runtime: 34.695556 s.
j = 8.778690e+05.
Runtime: 34.695838 s.
j = 8.778690e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.9872789383 s
|dj| = 6940.78162025
Runtime: 11.9879081249 s
|dj| = 6940.78162025
Runtime: 11.9881558418 s
|dj| = 6940.78162025
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 11.9891421795 s
|dj| = 6940.78162025
   14    76    -1.568561E+05     1.240166E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.054e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.346e+01 (tol = 1.000e-10) r (rel) = 2.226e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.820e+00 (tol = 1.000e-10) r (rel) = 1.727e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.634e-02 (tol = 1.000e-10) r (rel) = 1.550e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.102e-06 (tol = 1.000e-10) r (rel) = 1.994e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.926e-12 (tol = 1.000e-10) r (rel) = 7.522e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.934839 s.
j = 8.444092e+05.
Runtime: 75.935634 s.
j = 8.444092e+05.
End of time loop.
Start evaluation of j
Runtime: 75.935516 s.
j = 8.444092e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 75.934256 s.
Start evaluation of j
j = 8.444092e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.903e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.309e+01 (tol = 1.000e-10) r (rel) = 2.593e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.675e+00 (tol = 1.000e-10) r (rel) = 1.882e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.451e-02 (tol = 1.000e-10) r (rel) = 1.630e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.601e-06 (tol = 1.000e-10) r (rel) = 1.798e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.142e-12 (tol = 1.000e-10) r (rel) = 4.653e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.903815 s.
j = 8.388460e+05.
Runtime: 75.904824 s.
j = 8.388460e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 75.905343 s.
j = 8.388460e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 75.904426 s.
Updating the turbine cache
j = 8.388460e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.349e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.118e+01 (tol = 1.000e-10) r (rel) = 2.537e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.385e+00 (tol = 1.000e-10) r (rel) = 1.658e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.125e-02 (tol = 1.000e-10) r (rel) = 1.348e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.072e-06 (tol = 1.000e-10) r (rel) = 1.284e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.710e-12 (tol = 1.000e-10) r (rel) = 4.443e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 59.837670 s.
j = 8.634720e+05.
Runtime: 59.838653 s.
j = 8.634720e+05.
Runtime: 59.836271 s.
j = 8.634720e+05.
Runtime: 59.839014 s.
j = 8.634720e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.810e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.144e+01 (tol = 1.000e-10) r (rel) = 1.969e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.164e-01 (tol = 1.000e-10) r (rel) = 1.061e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.582e-03 (tol = 1.000e-10) r (rel) = 7.887e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.276e-07 (tol = 1.000e-10) r (rel) = 7.360e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.025e-12 (tol = 1.000e-10) r (rel) = 3.485e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 56.753279 s.
j = 8.577166e+05.
Runtime: 56.752680 s.
j = 8.577166e+05.
Runtime: 56.753581 s.
j = 8.577166e+05.
Runtime: 56.753924 s.
Start evaluation of j
j = 8.577166e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.116e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.676e+00 (tol = 1.000e-10) r (rel) = 1.179e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.762e-02 (tol = 1.000e-10) r (rel) = 2.812e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.063e-04 (tol = 1.000e-10) r (rel) = 3.411e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.812e-10 (tol = 1.000e-10) r (rel) = 1.223e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 45.609752 s.
Runtime: 45.609615 s.
j = 8.697682e+05.
j = 8.697682e+05.
Runtime: 45.609077 s.
j = 8.697682e+05.
Runtime: 45.610161 s.
j = 8.697682e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.878e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.154e-01 (tol = 1.000e-10) r (rel) = 3.553e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.171e-04 (tol = 1.000e-10) r (rel) = 9.204e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.032e-08 (tol = 1.000e-10) r (rel) = 1.162e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.071e-12 (tol = 1.000e-10) r (rel) = 1.206e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.399207 s.
j = 8.780581e+05.
Runtime: 46.399295 s.
j = 8.780581e+05.
Runtime: 46.399446 s.
j = 8.780581e+05.
Runtime: 46.398726 s.
j = 8.780581e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.6204259396 s
|dj| = 7114.70063253
Runtime: 11.6204121113 s
|dj| = 7114.70063253
Runtime: 11.6215410233 s
|dj| = 7114.70063253
Runtime: 11.6221110821 s
|dj| = 7114.70063253
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   15    82    -1.568898E+05     1.271242E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.930e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.326e+01 (tol = 1.000e-10) r (rel) = 2.604e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.725e+00 (tol = 1.000e-10) r (rel) = 1.932e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.468e-02 (tol = 1.000e-10) r (rel) = 1.644e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.220e-06 (tol = 1.000e-10) r (rel) = 2.486e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.802e-12 (tol = 1.000e-10) r (rel) = 7.617e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 58.293758 s.
Runtime: 58.292592 s.
j = 7.621407e+05.
j = 7.621407e+05.
Runtime: 58.293543 s.
j = 7.621407e+05.
Runtime: 58.294190 s.
j = 7.621407e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.472e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.169e+01 (tol = 1.000e-10) r (rel) = 2.290e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.568e+00 (tol = 1.000e-10) r (rel) = 1.656e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.355e-02 (tol = 1.000e-10) r (rel) = 1.431e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.458e-06 (tol = 1.000e-10) r (rel) = 1.539e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.655e-12 (tol = 1.000e-10) r (rel) = 7.026e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 76.836148 s.
j = 8.349754e+05.
Runtime: 76.835708 s.
End of time loop.
j = 8.349754e+05.
End of time loop.
Runtime: 76.836818 s.
Start evaluation of j
j = 8.349754e+05.
Updating the turbine cache
Runtime: 76.837067 s.
j = 8.349754e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.439e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.495e+01 (tol = 1.000e-10) r (rel) = 2.322e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.125e-01 (tol = 1.000e-10) r (rel) = 1.417e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.726e-03 (tol = 1.000e-10) r (rel) = 1.200e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.309e-07 (tol = 1.000e-10) r (rel) = 1.446e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.117e-12 (tol = 1.000e-10) r (rel) = 6.393e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 74.885650 s.
j = 8.642989e+05.
End of time loop.
Runtime: 74.886508 s.
j = 8.642989e+05.
Start evaluation of j
Runtime: 74.885487 s.
j = 8.642989e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 74.886728 s.
Start evaluation of j
j = 8.642989e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.510e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.129e+00 (tol = 1.000e-10) r (rel) = 7.477e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.814e-03 (tol = 1.000e-10) r (rel) = 5.174e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.507e-07 (tol = 1.000e-10) r (rel) = 4.309e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.125e-12 (tol = 1.000e-10) r (rel) = 2.070e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 63.718182 s.
j = 8.777127e+05.
End of time loop.
Runtime: 63.719321 s.
End of time loop.
j = 8.777127e+05.
Runtime: 63.717318 s.
Start evaluation of j
j = 8.777127e+05.
Runtime: 63.719940 s.
Updating the turbine cache
j = 8.777127e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.625e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.194e-02 (tol = 1.000e-10) r (rel) = 7.346e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.920e-07 (tol = 1.000e-10) r (rel) = 6.104e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.687e-12 (tol = 1.000e-10) r (rel) = 2.884e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 47.463071 s.
j = 8.781170e+05.
Runtime: 47.464822 s.
j = 8.781170e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 47.466243 s.
j = 8.781170e+05.
Runtime: 47.466651 s.
j = 8.781170e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.6095199585 s
|dj| = 7185.06433235
Runtime: 16.6102669239 s
|dj| = 7185.06433235
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 16.6301310062 s
|dj| = 7185.06433235
Runtime: 16.6293900013 s
|dj| = 7185.06433235
   16    87    -1.569004E+05     1.283814E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.613e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.601e+01 (tol = 1.000e-10) r (rel) = 2.103e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.023e+00 (tol = 1.000e-10) r (rel) = 1.344e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.692e-03 (tol = 1.000e-10) r (rel) = 8.790e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.541e-07 (tol = 1.000e-10) r (rel) = 4.652e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.559e-12 (tol = 1.000e-10) r (rel) = 2.048e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 72.639252 s.
j = 8.503028e+05.
Runtime: 72.619646 s.
j = 8.503028e+05.
Runtime: 72.619120 s.
j = 8.503028e+05.
Runtime: 72.639129 s.
j = 8.503028e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.595e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.189e+01 (tol = 1.000e-10) r (rel) = 2.124e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.993e-01 (tol = 1.000e-10) r (rel) = 1.071e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.304e-03 (tol = 1.000e-10) r (rel) = 4.118e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.047e-08 (tol = 1.000e-10) r (rel) = 9.022e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.702389 s.
j = 8.708799e+05.
Runtime: 46.701660 s.
j = 8.708799e+05.
Runtime: 46.692801 s.
j = 8.708799e+05.
Runtime: 46.702688 s.
j = 8.708799e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.659e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.275e+00 (tol = 1.000e-10) r (rel) = 1.988e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.139e-01 (tol = 1.000e-10) r (rel) = 5.844e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.193e-04 (tol = 1.000e-10) r (rel) = 5.992e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.974e-10 (tol = 1.000e-10) r (rel) = 2.179e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 51.008370 s.
Runtime: 51.007605 s.
j = 8.654129e+05.
j = 8.654129e+05.
Runtime: 51.008446 s.
j = 8.654129e+05.
Runtime: 51.008678 s.
j = 8.654129e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.621e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.904e+00 (tol = 1.000e-10) r (rel) = 1.490e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.369e-02 (tol = 1.000e-10) r (rel) = 2.430e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.449e-05 (tol = 1.000e-10) r (rel) = 9.344e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.928e-11 (tol = 1.000e-10) r (rel) = 3.788e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 53.249239 s.
j = 8.767837e+05.
Runtime: 53.249191 s.
j = 8.767837e+05.
Runtime: 53.249487 s.
j = 8.767837e+05.
Runtime: 53.249069 s.
j = 8.767837e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.005e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.092e-01 (tol = 1.000e-10) r (rel) = 4.072e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.122e-03 (tol = 1.000e-10) r (rel) = 1.116e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.437e-08 (tol = 1.000e-10) r (rel) = 1.430e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.075e-12 (tol = 1.000e-10) r (rel) = 1.070e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 46.700078 s.
Runtime: 46.701055 s.
End of time loop.
End of time loop.
j = 8.795784e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 46.701731 s.
j = 8.795784e+05.
Start evaluation of dj
found a tidal farm, computing gradient
j = 8.795784e+05.
Runtime: 46.701612 s.
j = 8.795784e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.5009829998 s
|dj| = 7649.7956325
Runtime: 14.4924650192 s
|dj| = 7649.7956325
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 14.5167160034 s
|dj| = 7649.7956325
Runtime: 14.5200998783 s
Start evaluation of j
|dj| = 7649.7956325
Updating the turbine cache
   17    92    -1.571615E+05     1.366852E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.008e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.243e+01 (tol = 1.000e-10) r (rel) = 2.226e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.622e+00 (tol = 1.000e-10) r (rel) = 1.610e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.232e-02 (tol = 1.000e-10) r (rel) = 1.223e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.493e-07 (tol = 1.000e-10) r (rel) = 8.429e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.126e-12 (tol = 1.000e-10) r (rel) = 3.103e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 73.159829 s.
Runtime: 73.179729 s.
j = 8.357551e+05.
j = 8.357551e+05.
Runtime: 73.179403 s.
j = 8.357551e+05.
Runtime: 73.163452 s.
j = 8.357551e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.407e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.984e+01 (tol = 1.000e-10) r (rel) = 2.678e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.235e+00 (tol = 1.000e-10) r (rel) = 1.667e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.291e-03 (tol = 1.000e-10) r (rel) = 1.254e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.138e-07 (tol = 1.000e-10) r (rel) = 1.099e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.932e-12 (tol = 1.000e-10) r (rel) = 3.958e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 72.152258 s.
j = 8.632875e+05.
Runtime: 72.153052 s.
j = 8.632875e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 72.153957 s.
j = 8.632875e+05.
End of time loop.
Runtime: 72.154705 s.
j = 8.632875e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.633e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.053e+01 (tol = 1.000e-10) r (rel) = 2.273e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.332e-01 (tol = 1.000e-10) r (rel) = 9.350e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.683e-03 (tol = 1.000e-10) r (rel) = 3.631e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.256e-08 (tol = 1.000e-10) r (rel) = 9.186e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 60.440410 s.
j = 8.630067e+05.
End of time loop.
Runtime: 60.441815 s.
j = 8.630067e+05.
End of time loop.
Start evaluation of j
Runtime: 60.439699 s.
Updating the turbine cache
j = 8.630067e+05.
Runtime: 60.442434 s.
j = 8.630067e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.563e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.262e+00 (tol = 1.000e-10) r (rel) = 1.273e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.584e-02 (tol = 1.000e-10) r (rel) = 1.788e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.616e-05 (tol = 1.000e-10) r (rel) = 6.303e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.677e-11 (tol = 1.000e-10) r (rel) = 2.605e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 66.335197 s.
j = 8.782981e+05.
Runtime: 66.335493 s.
j = 8.782981e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 66.335769 s.
Updating the turbine cache
Updating the turbine cache
j = 8.782981e+05.
End of time loop.
Runtime: 66.337811 s.
j = 8.782981e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.809e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.142e-01 (tol = 1.000e-10) r (rel) = 1.965e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.598e-05 (tol = 1.000e-10) r (rel) = 1.480e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.899e-10 (tol = 1.000e-10) r (rel) = 4.990e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 44.067039 s.
j = 8.797666e+05.
Runtime: 44.065889 s.
End of time loop.
j = 8.797666e+05.
Runtime: 44.067424 s.
Runtime: 44.064987 s.
j = 8.797666e+05.
j = 8.797666e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.3622441292 s
|dj| = 7353.124597
Runtime: 16.3634269238 s
|dj| = 7353.124597
Start evaluation of j
Updating the turbine cache
   18    97    -1.571951E+05     1.313843E+03
Start evaluation of j
Updating the turbine cache
Runtime: 16.3764960766 s
|dj| = 7353.124597
Runtime: 16.3768179417 s
|dj| = 7353.124597
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.168e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.783e+01 (tol = 1.000e-10) r (rel) = 2.182e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.253e+00 (tol = 1.000e-10) r (rel) = 1.534e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.040e-02 (tol = 1.000e-10) r (rel) = 1.273e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.046e-06 (tol = 1.000e-10) r (rel) = 1.281e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.276e-12 (tol = 1.000e-10) r (rel) = 4.010e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 80.717801 s.
j = 8.581532e+05.
Runtime: 80.701567 s.
j = 8.581532e+05.
Runtime: 80.716841 s.
j = 8.581532e+05.
Runtime: 80.702269 s.
j = 8.581532e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.453e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.411e+01 (tol = 1.000e-10) r (rel) = 2.587e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.326e-01 (tol = 1.000e-10) r (rel) = 1.527e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.415e-03 (tol = 1.000e-10) r (rel) = 1.176e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.461e-07 (tol = 1.000e-10) r (rel) = 1.368e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.194e-12 (tol = 1.000e-10) r (rel) = 5.856e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 79.796024 s.
j = 8.657518e+05.
Runtime: 79.796146 s.
j = 8.657518e+05.
End of time loop.
Runtime: 79.795555 s.
Start evaluation of j
j = 8.657518e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 79.797581 s.
Start evaluation of j
j = 8.657518e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.039e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.566e+00 (tol = 1.000e-10) r (rel) = 1.832e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.427e-01 (tol = 1.000e-10) r (rel) = 4.697e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.366e-04 (tol = 1.000e-10) r (rel) = 4.495e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.244e-10 (tol = 1.000e-10) r (rel) = 2.713e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 58.574088 s.
Runtime: 58.575173 s.
j = 8.680325e+05.
Runtime: 58.575213 s.
j = 8.680325e+05.
j = 8.680325e+05.
Runtime: 58.573068 s.
j = 8.680325e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.512e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.286e+00 (tol = 1.000e-10) r (rel) = 8.505e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.038e-02 (tol = 1.000e-10) r (rel) = 6.862e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.327e-06 (tol = 1.000e-10) r (rel) = 8.776e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.400e-12 (tol = 1.000e-10) r (rel) = 2.248e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 56.982274 s.
j = 8.794028e+05.
Start evaluation of j
End of time loop.
Runtime: 56.982988 s.
j = 8.794028e+05.
Start evaluation of j
Updating the turbine cache
Runtime: 56.982384 s.
j = 8.794028e+05.
Updating the turbine cache
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 56.990984 s.
j = 8.794028e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.355e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.994e-02 (tol = 1.000e-10) r (rel) = 8.467e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.434e-06 (tol = 1.000e-10) r (rel) = 1.034e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.696e-12 (tol = 1.000e-10) r (rel) = 2.843e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 47.315109 s.
j = 8.800010e+05.
End of time loop.
Runtime: 47.316118 s.
End of time loop.
j = 8.800010e+05.
Runtime: 47.313976 s.
Start evaluation of dj
j = 8.800010e+05.
found a tidal farm, computing gradient
Runtime: 47.321844 s.
j = 8.800010e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.5713498592 s
|dj| = 7321.99932603
Start evaluation of j
Updating the turbine cache
Runtime: 16.5828328133 s
|dj| = 7321.99932603
Start evaluation of j
Updating the turbine cache
Runtime: 16.5854341984 s
|dj| = 7321.99932603
Runtime: 16.5857019424 s
|dj| = 7321.99932603
   19   102    -1.572370E+05     1.308282E+03
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.585e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.488e+01 (tol = 1.000e-10) r (rel) = 1.961e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.921e-01 (tol = 1.000e-10) r (rel) = 1.176e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.159e-03 (tol = 1.000e-10) r (rel) = 6.801e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.397e-07 (tol = 1.000e-10) r (rel) = 3.160e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.287e-12 (tol = 1.000e-10) r (rel) = 1.697e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 68.678147 s.
j = 8.653269e+05.
Runtime: 68.693569 s.
j = 8.653269e+05.
Runtime: 68.683435 s.
j = 8.653269e+05.
Runtime: 68.678689 s.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
j = 8.653269e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.838e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.208e+01 (tol = 1.000e-10) r (rel) = 2.068e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.137e-01 (tol = 1.000e-10) r (rel) = 1.051e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.411e-03 (tol = 1.000e-10) r (rel) = 5.843e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.580e-07 (tol = 1.000e-10) r (rel) = 2.706e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.233e-12 (tol = 1.000e-10) r (rel) = 2.112e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 71.801633 s.
j = 8.678300e+05.
End of time loop.
End of time loop.
Runtime: 71.802090 s.
j = 8.678300e+05.
Start evaluation of j
Runtime: 71.800593 s.
Runtime: 71.802297 s.
j = 8.678300e+05.
j = 8.678300e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.361e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.761e+00 (tol = 1.000e-10) r (rel) = 1.550e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.634e-01 (tol = 1.000e-10) r (rel) = 6.041e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.869e-04 (tol = 1.000e-10) r (rel) = 2.034e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.104e-08 (tol = 1.000e-10) r (rel) = 2.532e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 57.847837 s.
j = 8.783033e+05.
End of time loop.
End of time loop.
Runtime: 57.847241 s.
j = 8.783033e+05.
Runtime: 57.847441 s.
Start evaluation of j
Runtime: 57.847765 s.
j = 8.783033e+05.
j = 8.783033e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.415e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.548e-01 (tol = 1.000e-10) r (rel) = 3.921e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.002e-03 (tol = 1.000e-10) r (rel) = 1.415e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.184e-08 (tol = 1.000e-10) r (rel) = 2.957e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.086e-12 (tol = 1.000e-10) r (rel) = 7.672e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 50.300898 s.
j = 8.798121e+05.
Runtime: 50.301531 s.
j = 8.798121e+05.
Runtime: 50.300508 s.
j = 8.798121e+05.
Runtime: 50.300785 s.
j = 8.798121e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.929e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.330e-02 (tol = 1.000e-10) r (rel) = 7.954e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.734e-06 (tol = 1.000e-10) r (rel) = 1.275e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.500e-11 (tol = 1.000e-10) r (rel) = 5.121e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 44.394052 s.
j = 8.800464e+05.
Runtime: 44.394938 s.
j = 8.800464e+05.
End of time loop.
Runtime: 44.395290 s.
j = 8.800464e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 44.398466 s.
j = 8.800464e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.9908080101 s
|dj| = 7071.19980747
Start evaluation of j
Updating the turbine cache
Runtime: 15.9927940369 s
|dj| = 7071.19980747
Start evaluation of j
Updating the turbine cache
Runtime: 16.0092551708 s
|dj| = 7071.19980747
Runtime: 16.006280899 s
|dj| = 7071.19980747
Start evaluation of j
Updating the turbine cache
   20   107    -1.572451E+05     1.263469E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.390e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.715e+01 (tol = 1.000e-10) r (rel) = 2.320e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.001e+00 (tol = 1.000e-10) r (rel) = 1.354e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.522e-03 (tol = 1.000e-10) r (rel) = 7.472e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.309e-07 (tol = 1.000e-10) r (rel) = 3.125e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.437e-12 (tol = 1.000e-10) r (rel) = 1.944e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 70.020523 s.
j = 8.463003e+05.
Runtime: 70.001357 s.
j = 8.463003e+05.
End of time loop.
Runtime: 70.002341 s.
Runtime: 70.022853 s.
j = 8.463003e+05.
j = 8.463003e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.172e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.301e+01 (tol = 1.000e-10) r (rel) = 1.814e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.208e-01 (tol = 1.000e-10) r (rel) = 1.005e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.390e-03 (tol = 1.000e-10) r (rel) = 6.122e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.497e-07 (tol = 1.000e-10) r (rel) = 3.482e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.312e-12 (tol = 1.000e-10) r (rel) = 1.830e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 65.108877 s.
j = 8.646142e+05.
End of time loop.
End of time loop.
Runtime: 65.109016 s.
j = 8.646142e+05.
Runtime: 65.108604 s.
Start evaluation of j
j = 8.646142e+05.
Runtime: 65.109470 s.
j = 8.646142e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.670e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.451e+00 (tol = 1.000e-10) r (rel) = 1.381e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.923e-01 (tol = 1.000e-10) r (rel) = 6.258e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.427e-03 (tol = 1.000e-10) r (rel) = 3.055e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.782e-08 (tol = 1.000e-10) r (rel) = 8.098e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 48.921367 s.
j = 8.686222e+05.
Runtime: 48.921546 s.
j = 8.686222e+05.
Runtime: 48.921285 s.
j = 8.686222e+05.
Runtime: 48.922554 s.
j = 8.686222e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.744e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.471e+00 (tol = 1.000e-10) r (rel) = 9.004e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.571e-02 (tol = 1.000e-10) r (rel) = 2.394e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.098e-05 (tol = 1.000e-10) r (rel) = 2.951e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.044e-10 (tol = 1.000e-10) r (rel) = 1.109e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.370337 s.
j = 8.810607e+05.
Runtime: 46.369635 s.
j = 8.810607e+05.
Runtime: 46.370325 s.
j = 8.810607e+05.
Runtime: 46.370652 s.
j = 8.810607e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.9551639557 s
|dj| = 7088.49270058
Runtime: 11.9561111927 s
|dj| = 7088.49270058
Start evaluation of j
Updating the turbine cache
Runtime: 11.9565057755 s
|dj| = 7088.49270058
Start evaluation of j
Updating the turbine cache
Runtime: 11.9578900337 s
|dj| = 7088.49270058
Start evaluation of j
Updating the turbine cache
   21   111    -1.574263E+05     1.266559E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.376e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.972e+01 (tol = 1.000e-10) r (rel) = 2.354e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.369e+00 (tol = 1.000e-10) r (rel) = 1.634e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.184e-02 (tol = 1.000e-10) r (rel) = 1.414e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.320e-06 (tol = 1.000e-10) r (rel) = 1.575e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.854e-12 (tol = 1.000e-10) r (rel) = 5.795e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 58.752666 s.
j = 8.422290e+05.
Runtime: 58.751929 s.
j = 8.422290e+05.
Runtime: 58.750067 s.
j = 8.422290e+05.
Runtime: 58.750631 s.
j = 8.422290e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.440e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.689e+01 (tol = 1.000e-10) r (rel) = 2.271e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.084e+00 (tol = 1.000e-10) r (rel) = 1.456e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.940e-03 (tol = 1.000e-10) r (rel) = 1.202e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.006e-06 (tol = 1.000e-10) r (rel) = 1.351e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.815e-12 (tol = 1.000e-10) r (rel) = 5.128e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 65.986053 s.
Runtime: 65.985392 s.
j = 8.559421e+05.
j = 8.559421e+05.
Runtime: 65.986230 s.
j = 8.559421e+05.
Runtime: 65.986592 s.
j = 8.559421e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.319e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.906e+00 (tol = 1.000e-10) r (rel) = 1.674e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.588e-01 (tol = 1.000e-10) r (rel) = 6.744e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.203e-03 (tol = 1.000e-10) r (rel) = 2.262e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.103e-08 (tol = 1.000e-10) r (rel) = 3.953e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 61.919846 s.
j = 8.616023e+05.
Runtime: 61.920823 s.
j = 8.616023e+05.
Runtime: 61.921039 s.
j = 8.616023e+05.
Runtime: 61.921274 s.
j = 8.616023e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.200e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.176e+00 (tol = 1.000e-10) r (rel) = 9.927e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.930e-02 (tol = 1.000e-10) r (rel) = 1.853e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.937e-05 (tol = 1.000e-10) r (rel) = 1.543e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.844e-10 (tol = 1.000e-10) r (rel) = 5.762e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 52.364539 s.
j = 8.768716e+05.
End of time loop.
End of time loop.
Runtime: 52.364690 s.
j = 8.768716e+05.
Runtime: 52.364493 s.
Start evaluation of j
j = 8.768716e+05.
Updating the turbine cache
Runtime: 52.365457 s.
j = 8.768716e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.115e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.633e-01 (tol = 1.000e-10) r (rel) = 3.260e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.636e-04 (tol = 1.000e-10) r (rel) = 7.748e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.446e-09 (tol = 1.000e-10) r (rel) = 7.577e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 46.252481 s.
j = 8.821579e+05.
End of time loop.
Runtime: 46.253121 s.
j = 8.821579e+05.
Runtime: 46.254209 s.
Start evaluation of dj
j = 8.821579e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 46.254133 s.
Start evaluation of dj
j = 8.821579e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.0295021534 s
|dj| = 6556.80900173
Start evaluation of j
Updating the turbine cache
Runtime: 15.0464880466 s
|dj| = 6556.80900173
Runtime: 15.048771143 s
|dj| = 6556.80900173
Runtime: 15.0496609211 s
|dj| = 6556.80900173
   22   116    -1.576224E+05     1.171559E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.501e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.918e+01 (tol = 1.000e-10) r (rel) = 2.256e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.253e+00 (tol = 1.000e-10) r (rel) = 1.474e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.753e-03 (tol = 1.000e-10) r (rel) = 1.147e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.272e-07 (tol = 1.000e-10) r (rel) = 1.091e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.420e-12 (tol = 1.000e-10) r (rel) = 4.023e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.111636 s.
j = 8.533571e+05.
End of time loop.
End of time loop.
Runtime: 78.092733 s.
j = 8.533571e+05.
Runtime: 78.092658 s.
Start evaluation of j
j = 8.533571e+05.
Runtime: 78.091537 s.
j = 8.533571e+05.
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.016e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.406e+01 (tol = 1.000e-10) r (rel) = 2.003e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.215e-01 (tol = 1.000e-10) r (rel) = 1.028e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.347e-03 (tol = 1.000e-10) r (rel) = 4.770e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.108e-07 (tol = 1.000e-10) r (rel) = 1.580e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.146e-12 (tol = 1.000e-10) r (rel) = 1.633e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 59.585432 s.
j = 8.597204e+05.
Runtime: 59.586552 s.
j = 8.597204e+05.
Runtime: 59.586017 s.
j = 8.597204e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 59.589198 s.
j = 8.597204e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.064e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.412e+00 (tol = 1.000e-10) r (rel) = 1.464e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.508e-01 (tol = 1.000e-10) r (rel) = 4.953e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.828e-04 (tol = 1.000e-10) r (rel) = 1.348e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.990e-09 (tol = 1.000e-10) r (rel) = 1.380e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 45.740093 s.
j = 8.683532e+05.
Runtime: 45.746661 s.
j = 8.683532e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 45.750090 s.
j = 8.683532e+05.
Runtime: 45.756648 s.
j = 8.683532e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.686e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.981e+00 (tol = 1.000e-10) r (rel) = 7.376e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.162e-02 (tol = 1.000e-10) r (rel) = 8.051e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.020e-06 (tol = 1.000e-10) r (rel) = 1.869e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.787e-11 (tol = 1.000e-10) r (rel) = 6.655e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 55.732448 s.
j = 8.810751e+05.
Runtime: 55.725916 s.
j = 8.810751e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 55.726299 s.
j = 8.810751e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 55.734567 s.
j = 8.810751e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.634e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.484e-01 (tol = 1.000e-10) r (rel) = 1.943e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.390e-04 (tol = 1.000e-10) r (rel) = 1.821e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.414e-10 (tol = 1.000e-10) r (rel) = 5.782e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 39.992330 s.
j = 8.828330e+05.
Runtime: 39.991343 s.
j = 8.828330e+05.
Runtime: 39.989831 s.
j = 8.828330e+05.
Runtime: 39.992720 s.
j = 8.828330e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.8250918388 s
|dj| = 6160.94134911
Runtime: 11.8255541325 s
Runtime: 11.8248639107 s
|dj| = 6160.94134911
|dj| = 6160.94134911
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 11.8284051418 s
|dj| = 6160.94134911
   23   121    -1.577430E+05     1.100826E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.325e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.004e+01 (tol = 1.000e-10) r (rel) = 2.322e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.221e-01 (tol = 1.000e-10) r (rel) = 1.207e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.994e-03 (tol = 1.000e-10) r (rel) = 4.611e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.524e-08 (tol = 1.000e-10) r (rel) = 8.149e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 49.908306 s.
Runtime: 49.911576 s.
j = 8.650937e+05.
j = 8.650937e+05.
Runtime: 49.912077 s.
j = 8.650937e+05.
Runtime: 49.911901 s.
j = 8.650937e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.572e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.669e+00 (tol = 1.000e-10) r (rel) = 1.556e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.320e-01 (tol = 1.000e-10) r (rel) = 9.549e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.338e-03 (tol = 1.000e-10) r (rel) = 5.991e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.564e-07 (tol = 1.000e-10) r (rel) = 2.807e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.166e-12 (tol = 1.000e-10) r (rel) = 2.092e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 61.853935 s.
Runtime: 61.853910 s.
j = 8.734243e+05.
Runtime: 61.853309 s.
j = 8.734243e+05.
j = 8.734243e+05.
Runtime: 61.854292 s.
j = 8.734243e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.221e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.407e+00 (tol = 1.000e-10) r (rel) = 1.281e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.690e-01 (tol = 1.000e-10) r (rel) = 6.371e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.231e-03 (tol = 1.000e-10) r (rel) = 2.917e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.828e-08 (tol = 1.000e-10) r (rel) = 6.699e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.856444 s.
Runtime: 48.857157 s.
j = 8.804984e+05.
j = 8.804984e+05.
End of time loop.
Runtime: 48.857857 s.
Start evaluation of j
j = 8.804984e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 48.858912 s.
j = 8.804984e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.127e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.580e+00 (tol = 1.000e-10) r (rel) = 7.428e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.179e-02 (tol = 1.000e-10) r (rel) = 1.494e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.904e-05 (tol = 1.000e-10) r (rel) = 8.950e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.289e-11 (tol = 1.000e-10) r (rel) = 2.957e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 58.586225 s.
j = 8.832308e+05.
Runtime: 58.583831 s.
j = 8.832308e+05.
Runtime: 58.585311 s.
j = 8.832308e+05.
Runtime: 58.586509 s.
j = 8.832308e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.7546699047 s
Runtime: 12.7546610832 s
|dj| = 6072.13436509
|dj| = 6072.13436509
Runtime: 12.7547371387 s
|dj| = 6072.13436509
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 12.7555961609 s
|dj| = 6072.13436509
   24   125    -1.578141E+05     1.084958E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.597e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.737e-01 (tol = 1.000e-10) r (rel) = 4.844e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.480e-03 (tol = 1.000e-10) r (rel) = 2.805e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.732e-07 (tol = 1.000e-10) r (rel) = 1.711e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.563e-12 (tol = 1.000e-10) r (rel) = 9.783e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 53.920062 s.
j = 8.797645e+05.
End of time loop.
Runtime: 53.918302 s.
j = 8.797645e+05.
Start evaluation of j
Runtime: 53.920803 s.
j = 8.797645e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 53.921961 s.
Start evaluation of j
j = 8.797645e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.026e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.110e-01 (tol = 1.000e-10) r (rel) = 3.032e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.884e-04 (tol = 1.000e-10) r (rel) = 6.712e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.777e-09 (tol = 1.000e-10) r (rel) = 5.632e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 44.192794 s.
j = 8.847523e+05.
End of time loop.
End of time loop.
Runtime: 44.192203 s.
j = 8.847523e+05.
Start evaluation of dj
Runtime: 44.191218 s.
Runtime: 44.193570 s.
j = 8.847523e+05.
j = 8.847523e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.0539119244 s
|dj| = 4522.61547766
Runtime: 16.0550248623 s
|dj| = 4522.61547766
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 16.0705108643 s
|dj| = 4522.61547766
   25   127    -1.580859E+05     8.080928E+02
Start evaluation of j
Updating the turbine cache
Runtime: 16.0822482109 s
|dj| = 4522.61547766
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.748e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.076e+00 (tol = 1.000e-10) r (rel) = 1.354e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.624e-01 (tol = 1.000e-10) r (rel) = 7.000e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.340e-03 (tol = 1.000e-10) r (rel) = 3.576e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.531e-08 (tol = 1.000e-10) r (rel) = 9.420e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 60.621182 s.
j = 8.640487e+05.
Runtime: 60.637073 s.
j = 8.640487e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 60.638605 s.
j = 8.640487e+05.
End of time loop.
Runtime: 60.610785 s.
j = 8.640487e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.785e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.014e+00 (tol = 1.000e-10) r (rel) = 1.441e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.827e-02 (tol = 1.000e-10) r (rel) = 3.528e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.624e-05 (tol = 1.000e-10) r (rel) = 2.378e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.543e-11 (tol = 1.000e-10) r (rel) = 3.067e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 59.371903 s.
j = 8.829213e+05.
Runtime: 59.373285 s.
j = 8.829213e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 59.371259 s.
j = 8.829213e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 59.374833 s.
j = 8.829213e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.947e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.539e-01 (tol = 1.000e-10) r (rel) = 4.453e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.200e-03 (tol = 1.000e-10) r (rel) = 1.510e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.240e-08 (tol = 1.000e-10) r (rel) = 2.819e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.070e-12 (tol = 1.000e-10) r (rel) = 1.346e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 63.849207 s.
Runtime: 63.849204 s.
j = 8.847955e+05.
End of time loop.
End of time loop.
j = 8.847955e+05.
Runtime: 63.848662 s.
Runtime: 63.847336 s.
Start evaluation of j
j = 8.847955e+05.
j = 8.847955e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.707e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.402e-02 (tol = 1.000e-10) r (rel) = 8.218e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.964e-06 (tol = 1.000e-10) r (rel) = 1.151e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.413e-12 (tol = 1.000e-10) r (rel) = 2.586e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 47.379954 s.
Runtime: 47.380444 s.
j = 8.848712e+05.
j = 8.848712e+05.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 47.380597 s.
found a tidal farm, computing gradient
j = 8.848712e+05.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 47.388030 s.
j = 8.848712e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.5946741104 s
|dj| = 4389.7364928
Runtime: 17.5965168476 s
|dj| = 4389.7364928
Runtime: 17.5969219208 s
|dj| = 4389.7364928
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 17.5915491581 s
|dj| = 4389.7364928
   26   131    -1.581072E+05     7.843502E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.504e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.814e+00 (tol = 1.000e-10) r (rel) = 7.245e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.878e-02 (tol = 1.000e-10) r (rel) = 1.549e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.822e-05 (tol = 1.000e-10) r (rel) = 1.127e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.390e-11 (tol = 1.000e-10) r (rel) = 2.951e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 56.904940 s.
j = 8.808571e+05.
Runtime: 56.904446 s.
j = 8.808571e+05.
End of time loop.
Start evaluation of j
Runtime: 56.902282 s.
Start evaluation of j
j = 8.808571e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 56.906411 s.
Start evaluation of j
j = 8.808571e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.299e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.747e-01 (tol = 1.000e-10) r (rel) = 5.963e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.797e-03 (tol = 1.000e-10) r (rel) = 3.692e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.326e-07 (tol = 1.000e-10) r (rel) = 2.560e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.393e-12 (tol = 1.000e-10) r (rel) = 1.072e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 59.394117 s.
j = 8.856295e+05.
End of time loop.
Runtime: 59.393252 s.
j = 8.856295e+05.
Start evaluation of dj
Runtime: 59.392238 s.
j = 8.856295e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 59.395727 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 8.856295e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.4142138958 s
|dj| = 3827.58104388
Runtime: 17.4160399437 s
|dj| = 3827.58104388
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 17.434461832 s
|dj| = 3827.58104388
Runtime: 17.435395956 s
|dj| = 3827.58104388
Start evaluation of j
Updating the turbine cache
   27   133    -1.582427E+05     6.839053E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.897e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.100e+01 (tol = 1.000e-10) r (rel) = 1.866e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.310e-01 (tol = 1.000e-10) r (rel) = 9.005e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.780e-03 (tol = 1.000e-10) r (rel) = 4.714e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.046e-07 (tol = 1.000e-10) r (rel) = 1.774e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.123e-12 (tol = 1.000e-10) r (rel) = 1.905e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 73.453200 s.
Runtime: 73.433580 s.
j = 8.617045e+05.
Runtime: 73.453521 s.
j = 8.617045e+05.
j = 8.617045e+05.
Runtime: 73.434283 s.
j = 8.617045e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.436e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.033e+00 (tol = 1.000e-10) r (rel) = 1.662e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.772e-01 (tol = 1.000e-10) r (rel) = 6.939e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.169e-03 (tol = 1.000e-10) r (rel) = 2.150e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.701e-08 (tol = 1.000e-10) r (rel) = 3.130e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 57.591331 s.
j = 8.684225e+05.
Runtime: 57.590516 s.
j = 8.684225e+05.
End of time loop.
Runtime: 57.591880 s.
Start evaluation of j
Start evaluation of j
j = 8.684225e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 57.592684 s.
Start evaluation of j
j = 8.684225e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.907e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.363e+00 (tol = 1.000e-10) r (rel) = 1.157e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.906e-02 (tol = 1.000e-10) r (rel) = 2.032e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.603e-05 (tol = 1.000e-10) r (rel) = 8.956e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.736e-11 (tol = 1.000e-10) r (rel) = 2.318e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 55.874329 s.
j = 8.857805e+05.
Runtime: 55.873158 s.
j = 8.857805e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 55.876648 s.
Runtime: 55.877191 s.
j = 8.857805e+05.
j = 8.857805e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.544e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.284e-02 (tol = 1.000e-10) r (rel) = 1.603e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.713e-05 (tol = 1.000e-10) r (rel) = 1.257e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.601e-10 (tol = 1.000e-10) r (rel) = 3.523e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 41.186394 s.
j = 8.862570e+05.
Runtime: 41.186469 s.
j = 8.862570e+05.
Runtime: 41.182449 s.
j = 8.862570e+05.
Runtime: 41.183408 s.
j = 8.862570e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.0491168499 s
|dj| = 3425.95478574
Runtime: 14.0503149033 s
|dj| = 3425.95478574
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 14.0638699532 s
|dj| = 3425.95478574
Start evaluation of j
Updating the turbine cache
Runtime: 14.0677509308 s
|dj| = 3425.95478574
   28   137    -1.583548E+05     6.121435E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.953e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.115e+01 (tol = 1.000e-10) r (rel) = 1.873e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.465e-01 (tol = 1.000e-10) r (rel) = 9.181e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.921e-03 (tol = 1.000e-10) r (rel) = 4.907e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.133e-07 (tol = 1.000e-10) r (rel) = 1.904e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.155e-12 (tol = 1.000e-10) r (rel) = 1.941e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 68.323322 s.
Runtime: 68.337980 s.
j = 8.595992e+05.
j = 8.595992e+05.
Runtime: 68.337943 s.
j = 8.595992e+05.
Runtime: 68.319799 s.
j = 8.595992e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.464e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.208e+00 (tol = 1.000e-10) r (rel) = 1.685e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.880e-01 (tol = 1.000e-10) r (rel) = 7.101e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.208e-03 (tol = 1.000e-10) r (rel) = 2.211e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.768e-08 (tol = 1.000e-10) r (rel) = 3.236e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 49.999476 s.
Runtime: 49.998771 s.
j = 8.680861e+05.
Runtime: 49.999530 s.
j = 8.680861e+05.
j = 8.680861e+05.
Runtime: 49.999752 s.
j = 8.680861e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.892e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.412e+00 (tol = 1.000e-10) r (rel) = 1.180e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.122e-02 (tol = 1.000e-10) r (rel) = 2.117e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.772e-05 (tol = 1.000e-10) r (rel) = 9.586e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.607e-11 (tol = 1.000e-10) r (rel) = 2.285e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 55.455694 s.
Runtime: 55.456263 s.
j = 8.845346e+05.
Start evaluation of j
Updating the turbine cache
j = 8.845346e+05.
Runtime: 55.465490 s.
j = 8.845346e+05.
End of time loop.
Runtime: 55.466322 s.
j = 8.845346e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.575e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.585e-01 (tol = 1.000e-10) r (rel) = 2.410e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.107e-04 (tol = 1.000e-10) r (rel) = 3.204e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.416e-10 (tol = 1.000e-10) r (rel) = 1.280e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 43.991538 s.
Runtime: 44.004091 s.
j = 8.862487e+05.
j = 8.862487e+05.
Runtime: 43.994201 s.
j = 8.862487e+05.
Runtime: 43.988542 s.
j = 8.862487e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.246e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.948e-03 (tol = 1.000e-10) r (rel) = 3.972e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.540e-07 (tol = 1.000e-10) r (rel) = 2.039e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.280e-12 (tol = 1.000e-10) r (rel) = 1.027e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 37.739100 s.
j = 8.863531e+05.
Runtime: 37.739237 s.
j = 8.863531e+05.
Runtime: 37.739356 s.
j = 8.863531e+05.
Runtime: 37.738654 s.
j = 8.863531e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.571559906 s
Runtime: 12.5717658997 s
|dj| = 3456.04334673
|dj| = 3456.04334673
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 12.5731329918 s
|dj| = 3456.04334673
Runtime: 12.5753769875 s
|dj| = 3456.04334673
   29   142    -1.583720E+05     6.175196E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.737e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.413e-01 (tol = 1.000e-10) r (rel) = 5.420e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.924e-03 (tol = 1.000e-10) r (rel) = 3.411e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.913e-07 (tol = 1.000e-10) r (rel) = 2.253e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.724e-12 (tol = 1.000e-10) r (rel) = 9.926e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 60.628985 s.
j = 8.753318e+05.
End of time loop.
Runtime: 60.626209 s.
j = 8.753318e+05.
Start evaluation of j
Runtime: 60.625777 s.
j = 8.753318e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 60.630680 s.
Start evaluation of j
j = 8.753318e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.210e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.372e-01 (tol = 1.000e-10) r (rel) = 4.438e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.774e-03 (tol = 1.000e-10) r (rel) = 1.465e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.548e-08 (tol = 1.000e-10) r (rel) = 2.931e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.085e-12 (tol = 1.000e-10) r (rel) = 8.962e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 59.240738 s.
j = 8.865278e+05.
Runtime: 59.238395 s.
j = 8.865278e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 59.240649 s.
j = 8.865278e+05.
End of time loop.
Runtime: 59.242277 s.
j = 8.865278e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.076e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.250e-02 (tol = 1.000e-10) r (rel) = 6.020e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.155e-06 (tol = 1.000e-10) r (rel) = 5.562e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.214e-12 (tol = 1.000e-10) r (rel) = 1.548e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.581834 s.
j = 8.869661e+05.
Runtime: 48.584353 s.
j = 8.869661e+05.
End of time loop.
Start evaluation of dj
Start evaluation of dj
Runtime: 48.585068 s.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
j = 8.869661e+05.
End of time loop.
Runtime: 48.584285 s.
j = 8.869661e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.6980321407 s
Runtime: 15.6968791485 s
|dj| = 2172.83589016
|dj| = 2172.83589016
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 15.7146289349 s
|dj| = 2172.83589016
Start evaluation of j
Updating the turbine cache
Runtime: 15.7179961205 s
|dj| = 2172.83589016
   30   145    -1.584815E+05     3.882384E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.500e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.602e-02 (tol = 1.000e-10) r (rel) = 1.382e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.614e-05 (tol = 1.000e-10) r (rel) = 8.390e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.278e-10 (tol = 1.000e-10) r (rel) = 2.323e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 50.803220 s.
Runtime: 50.819786 s.
j = 8.867898e+05.
j = 8.867898e+05.
Runtime: 50.800419 s.
j = 8.867898e+05.
Runtime: 50.820372 s.
j = 8.867898e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.154e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.695e-02 (tol = 1.000e-10) r (rel) = 8.547e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.344e-06 (tol = 1.000e-10) r (rel) = 1.694e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.291e-11 (tol = 1.000e-10) r (rel) = 4.093e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 45.330980 s.
Runtime: 45.329874 s.
j = 8.870551e+05.
j = 8.870551e+05.
Runtime: 45.330842 s.
j = 8.870551e+05.
Runtime: 45.331381 s.
j = 8.870551e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 13.3225331306 s
|dj| = 1690.72613144
Runtime: 13.3219809532 s
|dj| = 1690.72613144
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 13.3418960571 s
Runtime: 13.3414170742 s
|dj| = 1690.72613144
|dj| = 1690.72613144
   31   147    -1.584974E+05     3.020959E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.371e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.933e-02 (tol = 1.000e-10) r (rel) = 8.699e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.938e-06 (tol = 1.000e-10) r (rel) = 1.761e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.992e-11 (tol = 1.000e-10) r (rel) = 5.909e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 46.974482 s.
j = 8.870645e+05.
Runtime: 46.995378 s.
End of time loop.
j = 8.870645e+05.
End of time loop.
Runtime: 46.995235 s.
Start evaluation of j
j = 8.870645e+05.
Updating the turbine cache
Runtime: 46.974964 s.
j = 8.870645e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.653e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.969e-03 (tol = 1.000e-10) r (rel) = 4.215e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.073e-07 (tol = 1.000e-10) r (rel) = 1.858e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.334e-12 (tol = 1.000e-10) r (rel) = 8.067e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 44.863524 s.
j = 8.873021e+05.
End of time loop.
End of time loop.
Runtime: 44.862728 s.
j = 8.873021e+05.
Start evaluation of dj
Runtime: 44.863159 s.
j = 8.873021e+05.
Runtime: 44.863563 s.
j = 8.873021e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 13.4995748997 s
|dj| = 1293.84453585
Runtime: 13.5008881092 s
|dj| = 1293.84453585
Runtime: 13.5009069443 s
Start evaluation of j
|dj| = 1293.84453585
Updating the turbine cache
Runtime: 13.5024302006 s
|dj| = 1293.84453585
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   32   149    -1.585415E+05     2.311818E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.094e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.276e-03 (tol = 1.000e-10) r (rel) = 3.910e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.917e-07 (tol = 1.000e-10) r (rel) = 1.753e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.148e-12 (tol = 1.000e-10) r (rel) = 1.050e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 44.766166 s.
j = 8.873833e+05.
End of time loop.
End of time loop.
Runtime: 44.766725 s.
j = 8.873833e+05.
Runtime: 44.768871 s.
Runtime: 44.768119 s.
Start evaluation of dj
j = 8.873833e+05.
j = 8.873833e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 13.3773989677 s
|dj| = 1075.07990253
Runtime: 13.3779947758 s
|dj| = 1075.07990253
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Runtime: 13.3804769516 s
|dj| = 1075.07990253
Updating the turbine cache
Runtime: 13.3805229664 s
|dj| = 1075.07990253
   33   150    -1.585561E+05     1.920933E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.746e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.773e-01 (tol = 1.000e-10) r (rel) = 5.024e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.767e-03 (tol = 1.000e-10) r (rel) = 5.020e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.399e-06 (tol = 1.000e-10) r (rel) = 8.013e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.554e-12 (tol = 1.000e-10) r (rel) = 3.180e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 56.613644 s.
j = 8.829005e+05.
Runtime: 56.610707 s.
j = 8.829005e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 56.613815 s.
j = 8.829005e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 56.613509 s.
Updating the turbine cache
j = 8.829005e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.210e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.168e-01 (tol = 1.000e-10) r (rel) = 5.098e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.906e-03 (tol = 1.000e-10) r (rel) = 2.401e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.274e-07 (tol = 1.000e-10) r (rel) = 1.053e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.152e-12 (tol = 1.000e-10) r (rel) = 9.523e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 63.124221 s.
j = 8.872519e+05.
Runtime: 63.126808 s.
j = 8.872519e+05.
Runtime: 63.127157 s.
j = 8.872519e+05.
Runtime: 63.126328 s.
j = 8.872519e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.560e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.721e-03 (tol = 1.000e-10) r (rel) = 4.308e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.985e-07 (tol = 1.000e-10) r (rel) = 2.555e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.591e-12 (tol = 1.000e-10) r (rel) = 1.020e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.500440 s.
Runtime: 48.500415 s.
j = 8.874068e+05.
j = 8.874068e+05.
End of time loop.
End of time loop.
Start evaluation of dj
Runtime: 48.500169 s.
Runtime: 48.501075 s.
j = 8.874068e+05.
j = 8.874068e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.3084390163 s
Runtime: 14.3079941273 s
|dj| = 1024.41499987
|dj| = 1024.41499987
Runtime: 14.3080499172 s
|dj| = 1024.41499987
Start evaluation of j
Runtime: 14.3089790344 s
Updating the turbine cache
|dj| = 1024.41499987
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
   34   153    -1.585603E+05     1.830406E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.686e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.284e-03 (tol = 1.000e-10) r (rel) = 3.780e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.362e-07 (tol = 1.000e-10) r (rel) = 1.568e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.154e-12 (tol = 1.000e-10) r (rel) = 1.328e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 35.593486 s.
j = 8.874807e+05.
Runtime: 35.592086 s.
j = 8.874807e+05.
Runtime: 35.593332 s.
j = 8.874807e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 35.608011 s.
j = 8.874807e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.1461660862 s
|dj| = 1028.85393548
Runtime: 12.1651101112 s
|dj| = 1028.85393548
Runtime: 12.1650950909 s
|dj| = 1028.85393548
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Runtime: 12.1670119762 s
Start evaluation of j
|dj| = 1028.85393548
Updating the turbine cache
Updating the turbine cache
   35   154    -1.585735E+05     1.838338E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.315e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.240e-03 (tol = 1.000e-10) r (rel) = 1.963e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.358e-08 (tol = 1.000e-10) r (rel) = 2.150e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.073e-12 (tol = 1.000e-10) r (rel) = 1.698e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 40.327376 s.
j = 8.875054e+05.
Runtime: 40.326276 s.
j = 8.875054e+05.
Start evaluation of dj
End of time loop.
found a tidal farm, computing gradient
End of time loop.
Runtime: 40.329456 s.
j = 8.875054e+05.
Runtime: 40.328789 s.
j = 8.875054e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.3418679237 s
|dj| = 961.673269391
Start evaluation of j
Updating the turbine cache
Runtime: 15.3494691849 s
|dj| = 961.673269391
Start evaluation of j
Updating the turbine cache
Runtime: 15.3516180515 s
|dj| = 961.673269391
Start evaluation of j
Updating the turbine cache
Runtime: 15.3608460426 s
|dj| = 961.673269391
   36   155    -1.585779E+05     1.718301E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.730e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.126e-03 (tol = 1.000e-10) r (rel) = 1.965e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.390e-08 (tol = 1.000e-10) r (rel) = 2.427e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.076e-12 (tol = 1.000e-10) r (rel) = 1.878e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 45.221219 s.
Runtime: 45.211352 s.
j = 8.875119e+05.
End of time loop.
End of time loop.
j = 8.875119e+05.
Runtime: 45.202381 s.
Runtime: 45.214521 s.
j = 8.875119e+05.
j = 8.875119e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.2615799904 s
|dj| = 919.037565569
Runtime: 17.2621459961 s
|dj| = 919.037565569
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 17.2785639763 s
|dj| = 919.037565569
Runtime: 17.279487133 s
|dj| = 919.037565569
Start evaluation of j
Updating the turbine cache
   37   156    -1.585790E+05     1.642120E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.139e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.746e-04 (tol = 1.000e-10) r (rel) = 1.147e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.649e-09 (tol = 1.000e-10) r (rel) = 6.400e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.077e-12 (tol = 1.000e-10) r (rel) = 2.602e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 54.695050 s.
j = 8.875276e+05.
End of time loop.
End of time loop.
Runtime: 54.697938 s.
Runtime: 54.714623 s.
j = 8.875276e+05.
Runtime: 54.715619 s.
j = 8.875276e+05.
j = 8.875276e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 19.258769989 s
|dj| = 871.715505165
Runtime: 19.2599351406 s
|dj| = 871.715505165
Start evaluation of j
Runtime: 19.2611980438 s
|dj| = 871.715505165
Updating the turbine cache
Runtime: 19.2632749081 s
|dj| = 871.715505165
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
   38   157    -1.585818E+05     1.557566E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.610e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.069e-04 (tol = 1.000e-10) r (rel) = 7.926e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.384e-10 (tol = 1.000e-10) r (rel) = 2.446e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.067e-12 (tol = 1.000e-10) r (rel) = 4.087e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.794212 s.
j = 8.875341e+05.
Runtime: 48.795555 s.
j = 8.875341e+05.
End of time loop.
Start evaluation of dj
Start evaluation of dj
Runtime: 48.796104 s.
j = 8.875341e+05.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 48.799841 s.
Start evaluation of dj
j = 8.875341e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.8199679852 s
|dj| = 874.431886114
Start evaluation of j
Updating the turbine cache
Runtime: 15.8241930008 s
|dj| = 874.431886114
   39   158    -1.585830E+05     1.562419E+02
Start evaluation of j
Updating the turbine cache
Runtime: 15.8400039673 s
|dj| = 874.431886114
Runtime: 15.8405020237 s
|dj| = 874.431886114
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.527e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.889e-05 (tol = 1.000e-10) r (rel) = 3.033e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.130e-10 (tol = 1.000e-10) r (rel) = 1.186e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.038e-12 (tol = 1.000e-10) r (rel) = 1.090e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 44.986259 s.
j = 8.875445e+05.
Runtime: 44.969497 s.
j = 8.875445e+05.
End of time loop.
Start evaluation of dj
Start evaluation of dj
Runtime: 44.967905 s.
j = 8.875445e+05.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 44.989547 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 8.875445e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 13.2839970589 s
|dj| = 871.190690238
Runtime: 13.2853899002 s
|dj| = 871.190690238
Runtime: 13.287940979 s
Start evaluation of j
Start evaluation of j
Runtime: 13.2880058289 s
|dj| = 871.190690238
Updating the turbine cache
Updating the turbine cache
|dj| = 871.190690238
   40   159    -1.585849E+05     1.556628E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.055e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.507e-04 (tol = 1.000e-10) r (rel) = 1.405e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.769e-09 (tol = 1.000e-10) r (rel) = 7.876e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.072e-12 (tol = 1.000e-10) r (rel) = 1.770e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 42.825950 s.
Runtime: 42.827692 s.
j = 8.875876e+05.
j = 8.875876e+05.
End of time loop.
End of time loop.
Runtime: 42.828354 s.
Runtime: 42.826961 s.
j = 8.875876e+05.
j = 8.875876e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.6907401085 s
Runtime: 16.6897690296 s
|dj| = 888.907421333
|dj| = 888.907421333
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 16.7047889233 s
|dj| = 888.907421333
Start evaluation of j
Updating the turbine cache
Runtime: 16.7194240093 s
|dj| = 888.907421333
   41   160    -1.585926E+05     1.588284E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.058e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.264e-04 (tol = 1.000e-10) r (rel) = 1.051e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.802e-09 (tol = 1.000e-10) r (rel) = 4.442e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.073e-12 (tol = 1.000e-10) r (rel) = 2.643e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 49.410301 s.
Runtime: 49.443192 s.
j = 8.876072e+05.
j = 8.876072e+05.
Runtime: 49.428082 s.
j = 8.876072e+05.
Runtime: 49.443777 s.
j = 8.876072e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.1145641804 s
|dj| = 813.916569742
Start evaluation of j
Updating the turbine cache
Runtime: 16.1167190075 s
|dj| = 813.916569742
   42   161    -1.585961E+05     1.454292E+02
Start evaluation of j
Updating the turbine cache
Runtime: 16.1300051212 s
|dj| = 813.916569742
Runtime: 16.1300439835 s
|dj| = 813.916569742
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.710e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.354e-04 (tol = 1.000e-10) r (rel) = 8.685e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.057e-10 (tol = 1.000e-10) r (rel) = 3.342e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.065e-12 (tol = 1.000e-10) r (rel) = 3.932e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 50.092677 s.
Runtime: 50.094806 s.
j = 8.876266e+05.
Runtime: 50.076749 s.
j = 8.876266e+05.
j = 8.876266e+05.
Runtime: 50.078930 s.
j = 8.876266e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.5501580238 s
|dj| = 704.380900351
Runtime: 17.5513131618 s
|dj| = 704.380900351
Start evaluation of j
Updating the turbine cache
   43   162    -1.585995E+05     1.258575E+02
Start evaluation of j
Updating the turbine cache
Runtime: 17.5660939217 s
Runtime: 17.5671482086 s
|dj| = 704.380900351
|dj| = 704.380900351
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.035e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.033e-04 (tol = 1.000e-10) r (rel) = 9.991e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.209e-09 (tol = 1.000e-10) r (rel) = 5.942e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.060e-12 (tol = 1.000e-10) r (rel) = 5.210e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.997071 s.
Runtime: 47.014504 s.
j = 8.876390e+05.
j = 8.876390e+05.
Runtime: 46.997734 s.
Runtime: 47.015891 s.
j = 8.876390e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
j = 8.876390e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.4982619286 s
|dj| = 620.022465143
Runtime: 12.5087220669 s
|dj| = 620.022465143
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 12.5176959038 s
|dj| = 620.022465143
Runtime: 12.5190081596 s
|dj| = 620.022465143
Start evaluation of j
Updating the turbine cache
   44   163    -1.586018E+05     1.107845E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.023e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.054e-05 (tol = 1.000e-10) r (rel) = 2.987e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.458e-10 (tol = 1.000e-10) r (rel) = 1.426e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.048e-12 (tol = 1.000e-10) r (rel) = 1.025e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 40.969949 s.
j = 8.876437e+05.
Runtime: 40.969615 s.
j = 8.876437e+05.
Runtime: 40.959391 s.
j = 8.876437e+05.
Runtime: 40.960644 s.
j = 8.876437e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 13.9519751072 s
|dj| = 595.020439704
Runtime: 13.9532980919 s
|dj| = 595.020439704
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 13.9674530029 s
|dj| = 595.020439704
Runtime: 13.9694859982 s
|dj| = 595.020439704
Start evaluation of j
Updating the turbine cache
   45   164    -1.586026E+05     1.063172E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.407e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.952e-05 (tol = 1.000e-10) r (rel) = 4.230e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.629e-10 (tol = 1.000e-10) r (rel) = 1.158e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.053e-12 (tol = 1.000e-10) r (rel) = 7.483e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 51.025301 s.
j = 8.876473e+05.
Runtime: 51.040931 s.
j = 8.876473e+05.
Runtime: 51.040484 s.
j = 8.876473e+05.
Runtime: 51.023822 s.
j = 8.876473e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.5581560135 s
|dj| = 574.88457548
Runtime: 17.5580768585 s
|dj| = 574.88457548
Start evaluation of j
Updating the turbine cache
   46   165    -1.586032E+05     1.027193E+02
Start evaluation of j
Updating the turbine cache
Runtime: 17.5717411041 s
|dj| = 574.88457548
Runtime: 17.5736429691 s
|dj| = 574.88457548
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.582e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.285e-06 (tol = 1.000e-10) r (rel) = 1.663e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.534e-11 (tol = 1.000e-10) r (rel) = 4.540e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 31.055834 s.
j = 8.876479e+05.
End of time loop.
End of time loop.
Runtime: 31.053753 s.
j = 8.876479e+05.
Start evaluation of dj
Runtime: 31.070771 s.
Runtime: 31.069938 s.
j = 8.876479e+05.
found a tidal farm, computing gradient
j = 8.876479e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.8293840885 s
|dj| = 569.734704978
Runtime: 15.8294548988 s
|dj| = 569.734704978
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 15.8479249477 s
|dj| = 569.734704978
Runtime: 15.8493840694 s
|dj| = 569.734704978
   47   166    -1.586033E+05     1.017992E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.159e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.105e-06 (tol = 1.000e-10) r (rel) = 9.751e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.242e-11 (tol = 1.000e-10) r (rel) = 5.753e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 25.537148 s.
Runtime: 25.535910 s.
j = 8.876481e+05.
j = 8.876481e+05.
Runtime: 25.516513 s.
j = 8.876481e+05.
Runtime: 25.515104 s.
j = 8.876481e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.2797319889 s
Runtime: 12.279720068 s
|dj| = 568.397887423
|dj| = 568.397887423
Runtime: 12.2798879147 s
|dj| = 568.397887423
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 12.2815229893 s
|dj| = 568.397887423
Start evaluation of j
Updating the turbine cache
   48   167    -1.586034E+05     1.015603E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.204e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.762e-07 (tol = 1.000e-10) r (rel) = 3.956e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.158e-12 (tol = 1.000e-10) r (rel) = 2.623e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 29.622470 s.
j = 8.876482e+05.
Runtime: 29.621424 s.
j = 8.876482e+05.
End of time loop.
Start evaluation of dj
Start evaluation of dj
Runtime: 29.623102 s.
j = 8.876482e+05.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 29.621650 s.
j = 8.876482e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.4869949818 s
|dj| = 568.189613607
Runtime: 12.4872992039 s
|dj| = 568.189613607
Runtime: 12.4866650105 s
|dj| = 568.189613607
Runtime: 12.4860229492 s
|dj| = 568.189613607
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   49   168    -1.586034E+05     1.015231E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.037e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.578e-07 (tol = 1.000e-10) r (rel) = 3.452e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.587e-12 (tol = 1.000e-10) r (rel) = 1.531e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 31.038280 s.
j = 8.876482e+05.
Runtime: 31.038054 s.
j = 8.876482e+05.
End of time loop.
End of time loop.
Start evaluation of dj
Runtime: 31.037829 s.
found a tidal farm, computing gradient
j = 8.876482e+05.
Runtime: 31.038427 s.
j = 8.876482e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 18.2151260376 s
|dj| = 568.123277206
Start evaluation of j
Runtime: 18.2155730724 s
|dj| = 568.123277206
Updating the turbine cache
   50   169    -1.586034E+05     1.015112E+02
Start evaluation of j
Updating the turbine cache
Runtime: 18.2309639454 s
Runtime: 18.2316820621 s
|dj| = 568.123277206
|dj| = 568.123277206
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.525e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.656e-08 (tol = 1.000e-10) r (rel) = 1.471e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.123e-12 (tol = 1.000e-10) r (rel) = 2.482e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 29.926961 s.
j = 8.876482e+05.
Runtime: 29.927438 s.
j = 8.876482e+05.
Runtime: 29.946080 s.
j = 8.876482e+05.
Runtime: 29.944904 s.
j = 8.876482e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.2103710175 s
|dj| = 568.091991679
Runtime: 12.2108838558 s
|dj| = 568.091991679
Start evaluation of j
Runtime: 12.2120811939 s
Updating the turbine cache
|dj| = 568.091991679
Start evaluation of j
Runtime: 12.2118430138 s
Updating the turbine cache
|dj| = 568.091991679
Start evaluation of j
   51   170    -1.586034E+05     1.015057E+02
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.495e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.225e-08 (tol = 1.000e-10) r (rel) = 8.192e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.082e-12 (tol = 1.000e-10) r (rel) = 7.237e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 31.381710 s.
j = 8.876482e+05.
Runtime: 31.379659 s.
End of time loop.
End of time loop.
j = 8.876482e+05.
Start evaluation of dj
Runtime: 31.380426 s.
found a tidal farm, computing gradient
Runtime: 31.381998 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 8.876482e+05.
Start evaluation of dj
found a tidal farm, computing gradient
j = 8.876482e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.138502121 s
|dj| = 568.083563258
Runtime: 16.1375291348 s
Start evaluation of j
Updating the turbine cache
|dj| = 568.083563258
Start evaluation of j
Updating the turbine cache
Runtime: 16.1600580215 s
|dj| = 568.083563258
Start evaluation of j
Runtime: 16.1619670391 s
Updating the turbine cache
|dj| = 568.083563258
   52   171    -1.586034E+05     1.015042E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.389e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.696e-09 (tol = 1.000e-10) r (rel) = 4.220e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.069e-12 (tol = 1.000e-10) r (rel) = 1.674e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 27.088581 s.
j = 8.876482e+05.
Runtime: 27.074352 s.
j = 8.876482e+05.
Runtime: 27.071934 s.
j = 8.876482e+05.
Runtime: 27.090458 s.
j = 8.876482e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.1777729988 s
|dj| = 568.082914359
Runtime: 12.1776731014 s
|dj| = 568.082914359
Runtime: 12.1789009571 s
|dj| = 568.082914359
Start evaluation of j
Updating the turbine cache
Runtime: 12.1794440746 s
|dj| = 568.082914359
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
   53   172    -1.586034E+05     1.015040E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.101e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.800e-10 (tol = 1.000e-10) r (rel) = 2.760e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.062e-12 (tol = 1.000e-10) r (rel) = 5.053e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 23.978858 s.
Runtime: 23.978409 s.
j = 8.876482e+05.
j = 8.876482e+05.
Runtime: 23.979330 s.
j = 8.876482e+05.
Runtime: 23.980921 s.
j = 8.876482e+05.
Optimization terminated successfully.    (Exit mode 0)
            Current function value: -158603.384165
            Iterations: 53
            Function evaluations: 173
            Gradient evaluations: 53
