Number of global vertices: 90601
Number of global cells: 180000
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (386.67, 160.00).
Turbine added at (386.67, 386.67).
Turbine added at (386.67, 613.33).
Turbine added at (386.67, 840.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (386.67, 160.00).
Turbine added at (386.67, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 840.00).
Turbine added at (386.67, 613.33).
Turbine added at (386.67, 840.00).
Turbine added at (840.00, 160.00).
Turbine added at (840.00, 386.67).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (840.00, 613.33).
Turbine added at (840.00, 840.00).
Turbine added at (613.33, 613.33).
Added 16 turbines to the site in an 4x4 rectangular array.
Turbine added at (613.33, 840.00).
Turbine added at (840.00, 160.00).
Turbine added at (840.00, 386.67).
Turbine added at (840.00, 613.33).
Turbine added at (840.00, 840.00).
Added 16 turbines to the site in an 4x4 rectangular array.
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (386.67, 160.00).
Turbine added at (386.67, 386.67).
Turbine added at (386.67, 613.33).
Turbine added at (386.67, 840.00).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 840.00).
Turbine added at (840.00, 160.00).
Turbine added at (840.00, 386.67).
Turbine added at (840.00, 613.33).
Turbine added at (840.00, 840.00).
Added 16 turbines to the site in an 4x4 rectangular array.
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (386.67, 160.00).
Turbine added at (386.67, 386.67).
Turbine added at (386.67, 613.33).
Turbine added at (386.67, 840.00).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 840.00).
Turbine added at (840.00, 160.00).
Turbine added at (840.00, 386.67).
Turbine added at (840.00, 613.33).
Turbine added at (840.00, 840.00).
Added 16 turbines to the site in an 4x4 rectangular array.
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

  NIT    FC           OBJFUN            GNORM
Start evaluation of j
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Start evaluation of j
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Start evaluation of j
Start evaluation of j
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.903e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.419e+01 (tol = 1.000e-10) r (rel) = 1.513e+00 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.422e+01 (tol = 1.000e-10) r (rel) = 2.900e-01 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.460e+00 (tol = 1.000e-10) r (rel) = 2.978e-02 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.498e-02 (tol = 1.000e-10) r (rel) = 5.095e-04 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 8.794e-06 (tol = 1.000e-10) r (rel) = 1.794e-07 (tol = 1.000e-09)
  Newton iteration 6: r (abs) = 4.329e-12 (tol = 1.000e-10) r (rel) = 8.830e-14 (tol = 1.000e-09)
  Newton solver finished in 6 iterations and 6 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 197.431479 s.
j = 6.005799e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
Runtime: 197.448675 s.
j = 6.005799e+05.
Computing derivative to determine the automatic scaling factor
found a tidal farm, computing gradient
Start evaluation of dj
End of time loop.
found a tidal farm, computing gradient
Runtime: 197.424339 s.
j = 6.005799e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 197.425479 s.
j = 6.005799e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 38.0275130272 s
Runtime: 38.0295510292 s
Runtime: 38.0290219784 s
Runtime: 38.0296709538 s
|dj| = 342.173055109
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 8.860206e-01.
|dj| = 342.173055109
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 8.860206e-01.
|dj| = 342.173055109
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 8.860206e-01.
|dj| = 342.173055109
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing _set_automatic_scaling_factor
Use checkpoint value.
Use checkpoint value.
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Set automatic scaling factor to 8.860206e-01.
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Runtime: 0.0537688732147 s
|dj| = 342.173055109
Runtime: 0.0540788173676 s
|dj| = 342.173055109
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 0.0831599235535 s
|dj| = 342.173055109
    1     1    -5.321262E+05     3.031724E+02
Start evaluation of j
Updating the turbine cache
Runtime: 0.0859129428864 s
|dj| = 342.173055109
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.643e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.443e+01 (tol = 1.000e-10) r (rel) = 2.172e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.051e+00 (tol = 1.000e-10) r (rel) = 1.582e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.745e-03 (tol = 1.000e-10) r (rel) = 1.316e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.562e-07 (tol = 1.000e-10) r (rel) = 1.138e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.579e-12 (tol = 1.000e-10) r (rel) = 2.377e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 187.934906 s.
j = 8.746565e+05.
End of time loop.
End of time loop.
Runtime: 187.898720 s.
Runtime: 187.935353 s.
j = 8.746565e+05.
j = 8.746565e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 187.904039 s.
j = 8.746565e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 31.5340669155 s
|dj| = 3357.53691449
Start evaluation of j
Updating the turbine cache
Runtime: 31.547440052 s
|dj| = 3357.53691449
Start evaluation of j
Updating the turbine cache
Runtime: 31.5573241711 s
|dj| = 3357.53691449
Start evaluation of j
Updating the turbine cache
Runtime: 31.5701069832 s
|dj| = 3357.53691449
    2     2    -7.749637E+05     2.974847E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.442e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.819e+01 (tol = 1.000e-10) r (rel) = 2.444e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.542e+00 (tol = 1.000e-10) r (rel) = 2.073e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.719e-02 (tol = 1.000e-10) r (rel) = 2.310e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.281e-06 (tol = 1.000e-10) r (rel) = 5.752e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.806e-12 (tol = 1.000e-10) r (rel) = 3.771e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 188.516891 s.
j = 9.098642e+05.
Runtime: 188.484791 s.
End of time loop.
j = 9.098642e+05.
End of time loop.
Runtime: 188.511320 s.
j = 9.098642e+05.
Runtime: 188.534415 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 9.098642e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 39.5390880108 s
|dj| = 3658.97015459
Runtime: 39.5379700661 s
|dj| = 3658.97015459
Runtime: 39.5403599739 s
Runtime: 39.5398631096 s
|dj| = 3658.97015459
Start evaluation of j
Updating the turbine cache
|dj| = 3658.97015459
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
    3     3    -8.061584E+05     3.241923E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.587e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.812e+01 (tol = 1.000e-10) r (rel) = 2.388e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.667e+00 (tol = 1.000e-10) r (rel) = 2.197e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.551e-02 (tol = 1.000e-10) r (rel) = 3.362e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.207e-05 (tol = 1.000e-10) r (rel) = 1.590e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.720e-12 (tol = 1.000e-10) r (rel) = 8.858e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 174.338879 s.
j = 8.645240e+05.
Runtime: 174.340074 s.
j = 8.645240e+05.
End of time loop.
Runtime: 174.342513 s.
j = 8.645240e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 174.343084 s.
Start evaluation of j
j = 8.645240e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.904e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.841e+01 (tol = 1.000e-10) r (rel) = 2.667e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.453e+00 (tol = 1.000e-10) r (rel) = 2.104e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.963e-02 (tol = 1.000e-10) r (rel) = 2.844e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.978e-06 (tol = 1.000e-10) r (rel) = 1.156e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.467e-12 (tol = 1.000e-10) r (rel) = 6.471e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 217.344025 s.
j = 9.453241e+05.
End of time loop.
End of time loop.
Runtime: 217.345108 s.
j = 9.453241e+05.
Runtime: 217.343045 s.
j = 9.453241e+05.
Start evaluation of dj
Runtime: 217.345997 s.
j = 9.453241e+05.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 39.6313488483 s
|dj| = 2170.28565747
Runtime: 39.6317689419 s
|dj| = 2170.28565747
Runtime: 39.6326260567 s
|dj| = 2170.28565747
Start evaluation of j
Updating the turbine cache
    4     5    -8.375766E+05     1.922918E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 39.6359739304 s
|dj| = 2170.28565747
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.742e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.716e+01 (tol = 1.000e-10) r (rel) = 2.545e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.540e+00 (tol = 1.000e-10) r (rel) = 2.284e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.038e-02 (tol = 1.000e-10) r (rel) = 3.022e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.702e-05 (tol = 1.000e-10) r (rel) = 2.524e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.287e-11 (tol = 1.000e-10) r (rel) = 4.876e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 193.819376 s.
j = 8.056648e+05.
Runtime: 193.814984 s.
j = 8.056648e+05.
Runtime: 193.818617 s.
j = 8.056648e+05.
Runtime: 193.818125 s.
j = 8.056648e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.460e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.683e+01 (tol = 1.000e-10) r (rel) = 2.256e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.390e+00 (tol = 1.000e-10) r (rel) = 1.863e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.807e-02 (tol = 1.000e-10) r (rel) = 2.422e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.407e-06 (tol = 1.000e-10) r (rel) = 1.261e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.211e-12 (tol = 1.000e-10) r (rel) = 6.986e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 208.962216 s.
j = 9.376098e+05.
Runtime: 208.963057 s.
j = 9.376098e+05.
Runtime: 208.963062 s.
j = 9.376098e+05.
Runtime: 208.963421 s.
j = 9.376098e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.503e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.613e+01 (tol = 1.000e-10) r (rel) = 2.480e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.151e+00 (tol = 1.000e-10) r (rel) = 1.770e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.048e-03 (tol = 1.000e-10) r (rel) = 1.391e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.464e-07 (tol = 1.000e-10) r (rel) = 1.148e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.554e-12 (tol = 1.000e-10) r (rel) = 2.390e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 213.067638 s.
j = 9.636555e+05.
Runtime: 213.067909 s.
End of time loop.
j = 9.636555e+05.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 213.068649 s.
Runtime: 213.067581 s.
j = 9.636555e+05.
j = 9.636555e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.376e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.719e+01 (tol = 1.000e-10) r (rel) = 2.696e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.182e+00 (tol = 1.000e-10) r (rel) = 1.854e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.079e-02 (tol = 1.000e-10) r (rel) = 1.693e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.342e-06 (tol = 1.000e-10) r (rel) = 2.104e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.657e-12 (tol = 1.000e-10) r (rel) = 2.599e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 200.387950 s.
j = 9.849786e+05.
Runtime: 200.386567 s.
j = 9.849786e+05.
Runtime: 200.386567 s.
j = 9.849786e+05.
Runtime: 200.387597 s.
j = 9.849786e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 39.5742559433 s
|dj| = 2819.28909612
Start evaluation of j
Runtime: 39.5763819218 s
Updating the turbine cache
|dj| = 2819.28909612
Start evaluation of j
Updating the turbine cache
Runtime: 39.610708952 s
|dj| = 2819.28909612
    5     9    -8.727113E+05     2.497948E+03
Start evaluation of j
Updating the turbine cache
Runtime: 39.6155290604 s
|dj| = 2819.28909612
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.467e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.528e+01 (tol = 1.000e-10) r (rel) = 2.364e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.091e+00 (tol = 1.000e-10) r (rel) = 1.687e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.696e-03 (tol = 1.000e-10) r (rel) = 1.499e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.710e-06 (tol = 1.000e-10) r (rel) = 2.644e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.673e-12 (tol = 1.000e-10) r (rel) = 2.587e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 209.631650 s.
j = 9.002244e+05.
Runtime: 209.675869 s.
j = 9.002244e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 209.674561 s.
j = 9.002244e+05.
End of time loop.
Runtime: 209.639362 s.
j = 9.002244e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.086e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.598e+01 (tol = 1.000e-10) r (rel) = 2.255e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.255e+00 (tol = 1.000e-10) r (rel) = 1.772e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.945e-02 (tol = 1.000e-10) r (rel) = 2.745e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.103e-05 (tol = 1.000e-10) r (rel) = 1.557e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.605e-12 (tol = 1.000e-10) r (rel) = 7.911e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 208.962660 s.
j = 9.794073e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 208.964932 s.
Runtime: 208.966282 s.
j = 9.794073e+05.
j = 9.794073e+05.
Runtime: 208.963992 s.
j = 9.794073e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.053e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.462e+01 (tol = 1.000e-10) r (rel) = 2.416e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.005e+00 (tol = 1.000e-10) r (rel) = 1.660e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.182e-03 (tol = 1.000e-10) r (rel) = 1.352e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.409e-07 (tol = 1.000e-10) r (rel) = 1.224e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.553e-12 (tol = 1.000e-10) r (rel) = 2.565e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 168.193613 s.
j = 9.635823e+05.
End of time loop.
End of time loop.
Runtime: 168.197888 s.
j = 9.635823e+05.
Start evaluation of j
Runtime: 168.186946 s.
j = 9.635823e+05.
Updating the turbine cache
Runtime: 168.194043 s.
j = 9.635823e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.311e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.310e+01 (tol = 1.000e-10) r (rel) = 2.467e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.741e-01 (tol = 1.000e-10) r (rel) = 1.646e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.531e-03 (tol = 1.000e-10) r (rel) = 1.418e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.137e-07 (tol = 1.000e-10) r (rel) = 1.721e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.585e-12 (tol = 1.000e-10) r (rel) = 2.985e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 188.799523 s.
Runtime: 188.801015 s.
j = 9.777185e+05.
j = 9.777185e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 188.809315 s.
j = 9.777185e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 188.820840 s.
j = 9.777185e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.973e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.591e+00 (tol = 1.000e-10) r (rel) = 1.881e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.322e-01 (tol = 1.000e-10) r (rel) = 7.811e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.830e-04 (tol = 1.000e-10) r (rel) = 2.634e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.553e-08 (tol = 1.000e-10) r (rel) = 5.224e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 161.950628 s.
j = 9.838828e+05.
Runtime: 161.930095 s.
j = 9.838828e+05.
Runtime: 161.942750 s.
j = 9.838828e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 161.952122 s.
j = 9.838828e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.120e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.011e+00 (tol = 1.000e-10) r (rel) = 9.030e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.056e-03 (tol = 1.000e-10) r (rel) = 8.088e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.215e-06 (tol = 1.000e-10) r (rel) = 1.085e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.740e-12 (tol = 1.000e-10) r (rel) = 1.554e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 148.034346 s.
j = 9.855051e+05.
Runtime: 148.033271 s.
j = 9.855051e+05.
Runtime: 148.034342 s.
j = 9.855051e+05.
Runtime: 148.032350 s.
j = 9.855051e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.388e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.641e-01 (tol = 1.000e-10) r (rel) = 3.739e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.543e-04 (tol = 1.000e-10) r (rel) = 5.796e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.333e-10 (tol = 1.000e-10) r (rel) = 2.127e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 123.283166 s.
j = 9.856847e+05.
Runtime: 123.282434 s.
j = 9.856847e+05.
Runtime: 123.283194 s.
j = 9.856847e+05.
Runtime: 123.283585 s.
j = 9.856847e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.7314381599 s
|dj| = 2055.68861126
Start evaluation of j
Runtime: 45.7337231636 s
Updating the turbine cache
|dj| = 2055.68861126
Start evaluation of j
Updating the turbine cache
Runtime: 45.7685000896 s
|dj| = 2055.68861126
Runtime: 45.770742178 s
|dj| = 2055.68861126
    6    16    -8.733369E+05     1.821382E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.507e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.659e+01 (tol = 1.000e-10) r (rel) = 2.550e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.133e+00 (tol = 1.000e-10) r (rel) = 1.741e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.494e-03 (tol = 1.000e-10) r (rel) = 1.152e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.095e-07 (tol = 1.000e-10) r (rel) = 9.368e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.558e-12 (tol = 1.000e-10) r (rel) = 2.394e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 214.272531 s.
j = 9.246731e+05.
Runtime: 214.310259 s.
End of time loop.
j = 9.246731e+05.
Runtime: 214.313095 s.
Start evaluation of j
j = 9.246731e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 214.273434 s.
Start evaluation of j
j = 9.246731e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.125e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.702e+01 (tol = 1.000e-10) r (rel) = 2.095e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.349e+00 (tol = 1.000e-10) r (rel) = 1.660e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.308e-02 (tol = 1.000e-10) r (rel) = 1.610e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.746e-06 (tol = 1.000e-10) r (rel) = 2.149e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.758e-12 (tol = 1.000e-10) r (rel) = 2.164e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 221.675323 s.
j = 1.008786e+06.
Runtime: 221.674114 s.
j = 1.008786e+06.
End of time loop.
Start evaluation of dj
Runtime: 221.676061 s.
j = 1.008786e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 221.674511 s.
j = 1.008786e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.5126969814 s
|dj| = 2805.32500364
Runtime: 43.5107350349 s
|dj| = 2805.32500364
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 43.5671339035 s
|dj| = 2805.32500364
Start evaluation of j
Updating the turbine cache
Runtime: 43.5777568817 s
|dj| = 2805.32500364
    7    18    -8.938050E+05     2.485576E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.865e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.730e+01 (tol = 1.000e-10) r (rel) = 2.520e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.446e+00 (tol = 1.000e-10) r (rel) = 2.107e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.426e-02 (tol = 1.000e-10) r (rel) = 3.535e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.207e-05 (tol = 1.000e-10) r (rel) = 3.215e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.251e-11 (tol = 1.000e-10) r (rel) = 3.279e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 207.553990 s.
j = 7.618538e+05.
Runtime: 207.608676 s.
j = 7.618538e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 207.544056 s.
j = 7.618538e+05.
Runtime: 207.610594 s.
j = 7.618538e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.821e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.859e+01 (tol = 1.000e-10) r (rel) = 2.377e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.699e+00 (tol = 1.000e-10) r (rel) = 2.173e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.182e-02 (tol = 1.000e-10) r (rel) = 4.069e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.969e-05 (tol = 1.000e-10) r (rel) = 2.517e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.648e-12 (tol = 1.000e-10) r (rel) = 9.779e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 217.266457 s.
j = 9.523457e+05.
Runtime: 217.263416 s.
j = 9.523457e+05.
Runtime: 217.264271 s.
j = 9.523457e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 217.268086 s.
j = 9.523457e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.640e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.783e+01 (tol = 1.000e-10) r (rel) = 2.333e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.359e+00 (tol = 1.000e-10) r (rel) = 1.779e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.406e-02 (tol = 1.000e-10) r (rel) = 1.841e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.310e-06 (tol = 1.000e-10) r (rel) = 3.023e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.912e-12 (tol = 1.000e-10) r (rel) = 2.502e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 192.175060 s.
j = 9.766934e+05.
Start evaluation of j
End of time loop.
Updating the turbine cache
Runtime: 192.175292 s.
j = 9.766934e+05.
Start evaluation of j
End of time loop.
Runtime: 192.177962 s.
j = 9.766934e+05.
Updating the turbine cache
Runtime: 192.175863 s.
j = 9.766934e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.837e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.503e+01 (tol = 1.000e-10) r (rel) = 2.575e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.079e+00 (tol = 1.000e-10) r (rel) = 1.849e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.366e-02 (tol = 1.000e-10) r (rel) = 2.341e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.682e-06 (tol = 1.000e-10) r (rel) = 6.309e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.133e-12 (tol = 1.000e-10) r (rel) = 3.655e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 204.781288 s.
j = 1.002777e+06.
End of time loop.
End of time loop.
Runtime: 204.788995 s.
j = 1.002777e+06.
Runtime: 204.793168 s.
Runtime: 204.791230 s.
j = 1.002777e+06.
j = 1.002777e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.121e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.915e+00 (tol = 1.000e-10) r (rel) = 1.375e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.171e-02 (tol = 1.000e-10) r (rel) = 2.910e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.560e-05 (tol = 1.000e-10) r (rel) = 2.621e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.769e-11 (tol = 1.000e-10) r (rel) = 3.663e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 181.472426 s.
j = 1.007357e+06.
Runtime: 181.473011 s.
End of time loop.
j = 1.007357e+06.
End of time loop.
Runtime: 181.473048 s.
j = 1.007357e+06.
Runtime: 181.474376 s.
Start evaluation of j
j = 1.007357e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.602e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.057e-01 (tol = 1.000e-10) r (rel) = 5.337e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.340e-03 (tol = 1.000e-10) r (rel) = 1.763e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.519e-08 (tol = 1.000e-10) r (rel) = 3.314e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.502e-12 (tol = 1.000e-10) r (rel) = 1.975e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 157.470034 s.
j = 1.009259e+06.
Runtime: 157.467540 s.
j = 1.009259e+06.
End of time loop.
Start evaluation of dj
End of time loop.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 157.471494 s.
j = 1.009259e+06.
Runtime: 157.468194 s.
j = 1.009259e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.3004009724 s
|dj| = 3006.03951927
Runtime: 43.3035349846 s
|dj| = 3006.03951927
Start evaluation of j
Updating the turbine cache
    8    24    -8.942241E+05     2.663413E+03
Start evaluation of j
Updating the turbine cache
Runtime: 43.3377511501 s
|dj| = 3006.03951927
Runtime: 43.3373830318 s
|dj| = 3006.03951927
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.558e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.818e+01 (tol = 1.000e-10) r (rel) = 2.405e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.326e+00 (tol = 1.000e-10) r (rel) = 1.755e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.042e-02 (tol = 1.000e-10) r (rel) = 1.379e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.664e-06 (tol = 1.000e-10) r (rel) = 2.202e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.693e-12 (tol = 1.000e-10) r (rel) = 2.241e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 197.809529 s.
j = 9.317884e+05.
Runtime: 197.810412 s.
j = 9.317884e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 197.773752 s.
j = 9.317884e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 197.775711 s.
j = 9.317884e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.866e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.872e+01 (tol = 1.000e-10) r (rel) = 2.380e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.439e+00 (tol = 1.000e-10) r (rel) = 1.829e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.657e-02 (tol = 1.000e-10) r (rel) = 2.106e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.488e-06 (tol = 1.000e-10) r (rel) = 5.705e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.061e-12 (tol = 1.000e-10) r (rel) = 3.891e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 206.991445 s.
j = 9.407042e+05.
Runtime: 206.990237 s.
j = 9.407042e+05.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 206.993709 s.
j = 9.407042e+05.
Updating the turbine cache
Updating the turbine cache
Runtime: 206.994313 s.
j = 9.407042e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.720e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.826e+01 (tol = 1.000e-10) r (rel) = 2.365e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.349e+00 (tol = 1.000e-10) r (rel) = 1.747e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.178e-02 (tol = 1.000e-10) r (rel) = 1.526e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.147e-06 (tol = 1.000e-10) r (rel) = 1.486e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.649e-12 (tol = 1.000e-10) r (rel) = 2.135e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 218.304152 s.
j = 9.582376e+05.
Runtime: 218.305420 s.
j = 9.582376e+05.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 218.307472 s.
j = 9.582376e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 218.308428 s.
j = 9.582376e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.507e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.616e+01 (tol = 1.000e-10) r (rel) = 2.484e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.144e+00 (tol = 1.000e-10) r (rel) = 1.758e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.108e-02 (tol = 1.000e-10) r (rel) = 1.703e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.582e-06 (tol = 1.000e-10) r (rel) = 2.431e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.708e-12 (tol = 1.000e-10) r (rel) = 2.625e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 189.146675 s.
j = 1.007932e+06.
Runtime: 189.148064 s.
j = 1.007932e+06.
Runtime: 189.145333 s.
j = 1.007932e+06.
Runtime: 189.148495 s.
j = 1.007932e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.061e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.796e+00 (tol = 1.000e-10) r (rel) = 1.357e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.223e-02 (tol = 1.000e-10) r (rel) = 3.505e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.124e-04 (tol = 1.000e-10) r (rel) = 5.454e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.825e-10 (tol = 1.000e-10) r (rel) = 1.856e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 170.068606 s.
j = 1.009073e+06.
Runtime: 170.068604 s.
j = 1.009073e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 170.069561 s.
Updating the turbine cache
Updating the turbine cache
j = 1.009073e+06.
End of time loop.
Runtime: 170.069428 s.
j = 1.009073e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.641e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.543e-01 (tol = 1.000e-10) r (rel) = 6.787e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.363e-03 (tol = 1.000e-10) r (rel) = 4.525e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.718e-07 (tol = 1.000e-10) r (rel) = 3.856e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.539e-12 (tol = 1.000e-10) r (rel) = 1.597e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 164.018943 s.
j = 1.009348e+06.
Runtime: 164.018952 s.
End of time loop.
j = 1.009348e+06.
Runtime: 164.017988 s.
j = 1.009348e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 164.017691 s.
j = 1.009348e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.682e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.610e-01 (tol = 1.000e-10) r (rel) = 3.439e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.852e-04 (tol = 1.000e-10) r (rel) = 6.091e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.421e-09 (tol = 1.000e-10) r (rel) = 3.035e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 117.057566 s.
j = 1.009678e+06.
End of time loop.
Runtime: 117.056495 s.
j = 1.009678e+06.
End of time loop.
Runtime: 117.055410 s.
j = 1.009678e+06.
Runtime: 117.058243 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 1.009678e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 41.2910368443 s
|dj| = 3483.64626589
Runtime: 41.292525053 s
|dj| = 3483.64626589
    9    31    -8.945952E+05     3.086582E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 41.3298659325 s
|dj| = 3483.64626589
Runtime: 41.3296499252 s
|dj| = 3483.64626589
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.093e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.736e+01 (tol = 1.000e-10) r (rel) = 2.448e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.374e+00 (tol = 1.000e-10) r (rel) = 1.938e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.250e-02 (tol = 1.000e-10) r (rel) = 1.762e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.839e-06 (tol = 1.000e-10) r (rel) = 4.003e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.867e-12 (tol = 1.000e-10) r (rel) = 2.632e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 204.778054 s.
j = 9.224781e+05.
Runtime: 204.737999 s.
j = 9.224781e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 204.777145 s.
Updating the turbine cache
Updating the turbine cache
j = 9.224781e+05.
End of time loop.
Runtime: 204.739790 s.
j = 9.224781e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.340e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.747e+01 (tol = 1.000e-10) r (rel) = 2.380e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.441e+00 (tol = 1.000e-10) r (rel) = 1.964e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.893e-02 (tol = 1.000e-10) r (rel) = 2.579e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.900e-06 (tol = 1.000e-10) r (rel) = 9.401e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.901e-12 (tol = 1.000e-10) r (rel) = 3.952e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 203.134238 s.
j = 9.159740e+05.
Runtime: 203.134216 s.
j = 9.159740e+05.
Runtime: 203.131360 s.
j = 9.159740e+05.
Runtime: 203.133302 s.
j = 9.159740e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.550e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.515e+01 (tol = 1.000e-10) r (rel) = 2.312e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.046e+00 (tol = 1.000e-10) r (rel) = 1.596e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.815e-03 (tol = 1.000e-10) r (rel) = 1.346e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.988e-07 (tol = 1.000e-10) r (rel) = 1.219e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.553e-12 (tol = 1.000e-10) r (rel) = 2.371e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 208.924422 s.
Runtime: 208.924466 s.
j = 1.011781e+06.
j = 1.011781e+06.
Runtime: 208.923799 s.
j = 1.011781e+06.
Runtime: 208.925435 s.
j = 1.011781e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.156e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.595e+00 (tol = 1.000e-10) r (rel) = 2.309e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.520e-01 (tol = 1.000e-10) r (rel) = 1.328e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.052e-03 (tol = 1.000e-10) r (rel) = 9.751e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.711e-07 (tol = 1.000e-10) r (rel) = 8.929e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.509e-12 (tol = 1.000e-10) r (rel) = 3.631e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 207.887353 s.
j = 1.020023e+06.
End of time loop.
End of time loop.
Runtime: 207.889262 s.
j = 1.020023e+06.
Runtime: 207.889420 s.
j = 1.020023e+06.
Start evaluation of dj
Runtime: 207.889501 s.
found a tidal farm, computing gradient
j = 1.020023e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.4376378059 s
|dj| = 2621.45717418
Runtime: 45.4375970364 s
|dj| = 2621.45717418
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 45.4791250229 s
|dj| = 2621.45717418
Runtime: 45.479801178 s
|dj| = 2621.45717418
   10    35    -9.037610E+05     2.322665E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.171e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.788e+01 (tol = 1.000e-10) r (rel) = 2.493e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.450e+00 (tol = 1.000e-10) r (rel) = 2.021e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.745e-02 (tol = 1.000e-10) r (rel) = 2.434e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.126e-06 (tol = 1.000e-10) r (rel) = 8.542e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.886e-12 (tol = 1.000e-10) r (rel) = 4.025e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 208.431744 s.
j = 8.821262e+05.
Runtime: 208.432583 s.
j = 8.821262e+05.
Runtime: 208.388588 s.
j = 8.821262e+05.
Runtime: 208.390803 s.
j = 8.821262e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.929e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.825e+01 (tol = 1.000e-10) r (rel) = 2.302e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.443e+00 (tol = 1.000e-10) r (rel) = 1.820e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.914e-02 (tol = 1.000e-10) r (rel) = 2.414e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.558e-06 (tol = 1.000e-10) r (rel) = 8.271e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.086e-12 (tol = 1.000e-10) r (rel) = 3.892e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 207.125158 s.
Runtime: 207.125185 s.
j = 9.503830e+05.
j = 9.503830e+05.
Runtime: 207.124820 s.
j = 9.503830e+05.
Runtime: 207.125807 s.
j = 9.503830e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.695e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.589e+01 (tol = 1.000e-10) r (rel) = 2.374e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.087e+00 (tol = 1.000e-10) r (rel) = 1.623e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.482e-03 (tol = 1.000e-10) r (rel) = 1.267e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.634e-07 (tol = 1.000e-10) r (rel) = 9.908e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.534e-12 (tol = 1.000e-10) r (rel) = 2.291e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 201.687999 s.
Runtime: 201.687828 s.
j = 9.660402e+05.
j = 9.660402e+05.
Runtime: 201.687056 s.
j = 9.660402e+05.
Runtime: 201.688515 s.
j = 9.660402e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.104e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.220e+01 (tol = 1.000e-10) r (rel) = 2.390e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.331e-01 (tol = 1.000e-10) r (rel) = 1.437e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.762e-03 (tol = 1.000e-10) r (rel) = 1.129e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.726e-07 (tol = 1.000e-10) r (rel) = 9.260e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.529e-12 (tol = 1.000e-10) r (rel) = 2.996e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 213.786713 s.
j = 1.015920e+06.
Runtime: 213.786729 s.
j = 1.015920e+06.
End of time loop.
Runtime: 213.786466 s.
Start evaluation of j
Start evaluation of j
j = 1.015920e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 213.788559 s.
j = 1.015920e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.777e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.263e+00 (tol = 1.000e-10) r (rel) = 1.273e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.472e-02 (tol = 1.000e-10) r (rel) = 3.079e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.504e-05 (tol = 1.000e-10) r (rel) = 3.659e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.225e-10 (tol = 1.000e-10) r (rel) = 6.893e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.489618 s.
j = 1.018925e+06.
End of time loop.
End of time loop.
Runtime: 169.488811 s.
j = 1.018925e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 169.497951 s.
j = 1.018925e+06.
Start evaluation of j
Runtime: 169.500880 s.
j = 1.018925e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.183e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.733e-01 (tol = 1.000e-10) r (rel) = 5.197e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.737e-03 (tol = 1.000e-10) r (rel) = 2.418e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.114e-08 (tol = 1.000e-10) r (rel) = 8.512e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.501e-12 (tol = 1.000e-10) r (rel) = 2.090e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 170.069869 s.
j = 1.020911e+06.
Runtime: 170.064784 s.
j = 1.020911e+06.
End of time loop.
Runtime: 170.060709 s.
j = 1.020911e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 170.062135 s.
j = 1.020911e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 40.0985798836 s
|dj| = 3138.12149678
Start evaluation of j
Updating the turbine cache
Runtime: 40.101801157 s
|dj| = 3138.12149678
Start evaluation of j
Updating the turbine cache
Runtime: 40.1392710209 s
|dj| = 3138.12149678
Runtime: 40.1394319534 s
|dj| = 3138.12149678
   11    41    -9.045482E+05     2.780440E+03
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.753e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.819e+01 (tol = 1.000e-10) r (rel) = 2.347e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.588e+00 (tol = 1.000e-10) r (rel) = 2.048e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.158e-02 (tol = 1.000e-10) r (rel) = 5.363e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.428e-05 (tol = 1.000e-10) r (rel) = 9.581e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.559e-10 (tol = 1.000e-10) r (rel) = 3.301e-12 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 200.729924 s.
j = 8.725327e+05.
Runtime: 200.734201 s.
Runtime: 200.693377 s.
j = 8.725327e+05.
j = 8.725327e+05.
Runtime: 200.693772 s.
j = 8.725327e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.788e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.740e+01 (tol = 1.000e-10) r (rel) = 2.563e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.495e+00 (tol = 1.000e-10) r (rel) = 2.202e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.044e-02 (tol = 1.000e-10) r (rel) = 3.011e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.256e-06 (tol = 1.000e-10) r (rel) = 9.216e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.854e-12 (tol = 1.000e-10) r (rel) = 2.731e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 196.788521 s.
Runtime: 196.788459 s.
j = 1.050115e+06.
j = 1.050115e+06.
Runtime: 196.788723 s.
j = 1.050115e+06.
Runtime: 196.787963 s.
j = 1.050115e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 32.0311090946 s
|dj| = 3048.42417027
Runtime: 32.0316100121 s
|dj| = 3048.42417027
Runtime: 32.0316700935 s
|dj| = 3048.42417027
Start evaluation of j
Runtime: 32.033654213 s
|dj| = 3048.42417027
   12    43    -9.304234E+05     2.700966E+03
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.210e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.957e+01 (tol = 1.000e-10) r (rel) = 2.714e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.691e+00 (tol = 1.000e-10) r (rel) = 2.345e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.890e-02 (tol = 1.000e-10) r (rel) = 4.009e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.764e-05 (tol = 1.000e-10) r (rel) = 2.447e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.803e-12 (tol = 1.000e-10) r (rel) = 9.435e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 183.409670 s.
j = 9.350697e+05.
Runtime: 183.411875 s.
Runtime: 183.411473 s.
j = 9.350697e+05.
j = 9.350697e+05.
Runtime: 183.411122 s.
j = 9.350697e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.016e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.825e+01 (tol = 1.000e-10) r (rel) = 2.277e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.441e+00 (tol = 1.000e-10) r (rel) = 1.798e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.923e-02 (tol = 1.000e-10) r (rel) = 2.399e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.532e-06 (tol = 1.000e-10) r (rel) = 9.395e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.914e-12 (tol = 1.000e-10) r (rel) = 4.882e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 194.699322 s.
j = 9.326348e+05.
Runtime: 194.699241 s.
j = 9.326348e+05.
Runtime: 194.698495 s.
j = 9.326348e+05.
Runtime: 194.699815 s.
j = 9.326348e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.431e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.784e+01 (tol = 1.000e-10) r (rel) = 2.400e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.293e+00 (tol = 1.000e-10) r (rel) = 1.740e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.275e-02 (tol = 1.000e-10) r (rel) = 1.716e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.769e-06 (tol = 1.000e-10) r (rel) = 2.381e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.835e-12 (tol = 1.000e-10) r (rel) = 2.469e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 212.841821 s.
j = 1.048415e+06.
End of time loop.
End of time loop.
Runtime: 212.842343 s.
Runtime: 212.842434 s.
Runtime: 212.841147 s.
j = 1.048415e+06.
j = 1.048415e+06.
Start evaluation of j
j = 1.048415e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.323e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.658e+00 (tol = 1.000e-10) r (rel) = 1.575e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.224e-01 (tol = 1.000e-10) r (rel) = 5.270e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.709e-04 (tol = 1.000e-10) r (rel) = 1.166e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.897e-09 (tol = 1.000e-10) r (rel) = 8.165e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 148.758242 s.
j = 1.051752e+06.
Runtime: 148.758946 s.
j = 1.051752e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 148.766553 s.
j = 1.051752e+06.
Runtime: 148.767802 s.
j = 1.051752e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 40.5974929333 s
|dj| = 2863.50895656
Runtime: 40.5904929638 s
|dj| = 2863.50895656
   13    47    -9.318739E+05     2.537128E+03
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 40.6244449615 s
|dj| = 2863.50895656
Runtime: 40.6274960041 s
|dj| = 2863.50895656
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.044e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.775e+01 (tol = 1.000e-10) r (rel) = 2.207e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.288e+00 (tol = 1.000e-10) r (rel) = 1.601e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.182e-02 (tol = 1.000e-10) r (rel) = 1.469e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.855e-06 (tol = 1.000e-10) r (rel) = 2.306e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.735e-12 (tol = 1.000e-10) r (rel) = 2.157e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 200.615304 s.
j = 1.002056e+06.
Runtime: 200.575499 s.
End of time loop.
j = 1.002056e+06.
Runtime: 200.615834 s.
j = 1.002056e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 200.579970 s.
j = 1.002056e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.008e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.631e+01 (tol = 1.000e-10) r (rel) = 2.327e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.171e+00 (tol = 1.000e-10) r (rel) = 1.671e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.334e-03 (tol = 1.000e-10) r (rel) = 1.332e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.298e-07 (tol = 1.000e-10) r (rel) = 1.041e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.554e-12 (tol = 1.000e-10) r (rel) = 2.218e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 211.687499 s.
j = 9.832211e+05.
Runtime: 211.686001 s.
j = 9.832211e+05.
Runtime: 211.689118 s.
Runtime: 211.689061 s.
j = 9.832211e+05.
j = 9.832211e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.329e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.513e+01 (tol = 1.000e-10) r (rel) = 2.391e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.098e+00 (tol = 1.000e-10) r (rel) = 1.736e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.133e-02 (tol = 1.000e-10) r (rel) = 1.790e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.455e-06 (tol = 1.000e-10) r (rel) = 2.300e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.624e-12 (tol = 1.000e-10) r (rel) = 2.566e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 209.907824 s.
End of time loop.
j = 1.051973e+06.
Runtime: 209.908690 s.
End of time loop.
j = 1.051973e+06.
Runtime: 209.908412 s.
Runtime: 209.909453 s.
j = 1.051973e+06.
j = 1.051973e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.370e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.192e+00 (tol = 1.000e-10) r (rel) = 1.347e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.546e-02 (tol = 1.000e-10) r (rel) = 3.184e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.439e-05 (tol = 1.000e-10) r (rel) = 2.717e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.266e-11 (tol = 1.000e-10) r (rel) = 3.066e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 171.084582 s.
End of time loop.
j = 1.054304e+06.
End of time loop.
Runtime: 171.085017 s.
Runtime: 171.086207 s.
Runtime: 171.085575 s.
j = 1.054304e+06.
j = 1.054304e+06.
j = 1.054304e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 35.3028018475 s
|dj| = 3157.594981
Start evaluation of j
Updating the turbine cache
Runtime: 35.305464983 s
|dj| = 3157.594981
Start evaluation of j
Updating the turbine cache
Runtime: 35.3422820568 s
|dj| = 3157.594981
   14    51    -9.341347E+05     2.797694E+03
Start evaluation of j
Updating the turbine cache
Runtime: 35.3473978043 s
|dj| = 3157.594981
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.352e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.734e+01 (tol = 1.000e-10) r (rel) = 2.358e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.230e+00 (tol = 1.000e-10) r (rel) = 1.673e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.962e-03 (tol = 1.000e-10) r (rel) = 1.355e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.131e-06 (tol = 1.000e-10) r (rel) = 5.619e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.657e-12 (tol = 1.000e-10) r (rel) = 2.253e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 197.420733 s.
j = 9.164125e+05.
Runtime: 197.373264 s.
j = 9.164125e+05.
End of time loop.
Runtime: 197.417460 s.
j = 9.164125e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 197.379946 s.
j = 9.164125e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.791e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.771e+01 (tol = 1.000e-10) r (rel) = 2.273e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.370e+00 (tol = 1.000e-10) r (rel) = 1.758e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.395e-02 (tol = 1.000e-10) r (rel) = 1.791e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.519e-06 (tol = 1.000e-10) r (rel) = 3.234e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.014e-12 (tol = 1.000e-10) r (rel) = 2.585e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 189.915923 s.
j = 9.120219e+05.
Runtime: 189.915873 s.
j = 9.120219e+05.
Runtime: 189.913747 s.
j = 9.120219e+05.
Runtime: 189.915531 s.
j = 9.120219e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.033e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.624e+01 (tol = 1.000e-10) r (rel) = 2.309e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.142e+00 (tol = 1.000e-10) r (rel) = 1.624e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.717e-03 (tol = 1.000e-10) r (rel) = 1.382e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.994e-07 (tol = 1.000e-10) r (rel) = 1.279e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.566e-12 (tol = 1.000e-10) r (rel) = 2.227e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 197.659633 s.
j = 1.041436e+06.
End of time loop.
Runtime: 197.659742 s.
j = 1.041436e+06.
Start evaluation of j
Runtime: 197.659267 s.
j = 1.041436e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 197.661403 s.
Start evaluation of j
Updating the turbine cache
j = 1.041436e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.654e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.020e+01 (tol = 1.000e-10) r (rel) = 2.192e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.044e-01 (tol = 1.000e-10) r (rel) = 1.299e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.333e-03 (tol = 1.000e-10) r (rel) = 9.309e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.322e-07 (tol = 1.000e-10) r (rel) = 7.138e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.516e-12 (tol = 1.000e-10) r (rel) = 3.257e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 198.921944 s.
j = 1.056777e+06.
Runtime: 198.923784 s.
j = 1.056777e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 198.925826 s.
j = 1.056777e+06.
Runtime: 198.926446 s.
j = 1.056777e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 42.8968229294 s
|dj| = 3256.90800401
Start evaluation of j
Updating the turbine cache
Runtime: 42.9001410007 s
|dj| = 3256.90800401
Runtime: 42.8999791145 s
|dj| = 3256.90800401
Start evaluation of j
Updating the turbine cache
Runtime: 42.9000740051 s
|dj| = 3256.90800401
Start evaluation of j
Updating the turbine cache
   15    55    -9.363265E+05     2.885687E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.427e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.792e+01 (tol = 1.000e-10) r (rel) = 2.413e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.467e+00 (tol = 1.000e-10) r (rel) = 1.975e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.520e-02 (tol = 1.000e-10) r (rel) = 3.393e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.512e-05 (tol = 1.000e-10) r (rel) = 3.382e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.873e-11 (tol = 1.000e-10) r (rel) = 3.868e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 207.215033 s.
j = 8.183540e+05.
End of time loop.
End of time loop.
Runtime: 207.216990 s.
j = 8.183540e+05.
Runtime: 207.222082 s.
Runtime: 207.218526 s.
j = 8.183540e+05.
j = 8.183540e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.835e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.812e+01 (tol = 1.000e-10) r (rel) = 2.313e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.545e+00 (tol = 1.000e-10) r (rel) = 1.971e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.005e-02 (tol = 1.000e-10) r (rel) = 2.558e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.993e-06 (tol = 1.000e-10) r (rel) = 8.925e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.800e-12 (tol = 1.000e-10) r (rel) = 4.850e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 220.158142 s.
Runtime: 220.158149 s.
j = 9.435255e+05.
j = 9.435255e+05.
End of time loop.
Runtime: 220.158929 s.
j = 9.435255e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 220.160804 s.
j = 9.435255e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.282e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.684e+01 (tol = 1.000e-10) r (rel) = 2.313e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.181e+00 (tol = 1.000e-10) r (rel) = 1.622e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.107e-02 (tol = 1.000e-10) r (rel) = 1.520e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.440e-06 (tol = 1.000e-10) r (rel) = 1.978e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.631e-12 (tol = 1.000e-10) r (rel) = 2.240e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 193.739271 s.
j = 1.041245e+06.
End of time loop.
End of time loop.
Runtime: 193.742381 s.
j = 1.041245e+06.
Start evaluation of j
Runtime: 193.741323 s.
j = 1.041245e+06.
Runtime: 193.742611 s.
Updating the turbine cache
j = 1.041245e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.235e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.844e+00 (tol = 1.000e-10) r (rel) = 2.088e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.437e-01 (tol = 1.000e-10) r (rel) = 1.284e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.111e-03 (tol = 1.000e-10) r (rel) = 1.207e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.055e-07 (tol = 1.000e-10) r (rel) = 1.666e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.536e-12 (tol = 1.000e-10) r (rel) = 3.626e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 188.587729 s.
Runtime: 188.587942 s.
j = 1.054936e+06.
j = 1.054936e+06.
Runtime: 188.588240 s.
j = 1.054936e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 188.598713 s.
j = 1.054936e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.491e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.350e+00 (tol = 1.000e-10) r (rel) = 9.049e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.025e-02 (tol = 1.000e-10) r (rel) = 1.358e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.841e-06 (tol = 1.000e-10) r (rel) = 5.257e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.211e-12 (tol = 1.000e-10) r (rel) = 3.494e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 154.074906 s.
j = 1.056705e+06.
Runtime: 154.084518 s.
j = 1.056705e+06.
Runtime: 154.084617 s.
j = 1.056705e+06.
Runtime: 154.084302 s.
j = 1.056705e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.933e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.323e-01 (tol = 1.000e-10) r (rel) = 3.915e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.647e-04 (tol = 1.000e-10) r (rel) = 1.120e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.770e-09 (tol = 1.000e-10) r (rel) = 1.310e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.487e-12 (tol = 1.000e-10) r (rel) = 2.507e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 158.110399 s.
j = 1.055966e+06.
Runtime: 158.110726 s.
j = 1.055966e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
End of time loop.
Runtime: 158.115322 s.
j = 1.055966e+06.
Runtime: 158.115021 s.
j = 1.055966e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.561e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.728e-02 (tol = 1.000e-10) r (rel) = 2.170e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.806e-05 (tol = 1.000e-10) r (rel) = 1.911e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.489e-11 (tol = 1.000e-10) r (rel) = 2.665e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 114.071454 s.
j = 1.057363e+06.
Runtime: 114.075392 s.
j = 1.057363e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 114.076807 s.
j = 1.057363e+06.
Runtime: 114.072042 s.
j = 1.057363e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.2401590347 s
|dj| = 3229.51528481
Runtime: 43.239331007 s
|dj| = 3229.51528481
Start evaluation of j
Updating the turbine cache
   16    62    -9.368454E+05     2.861417E+03
Start evaluation of j
Updating the turbine cache
Runtime: 43.2728300095 s
|dj| = 3229.51528481
Start evaluation of j
Updating the turbine cache
Runtime: 43.2782549858 s
|dj| = 3229.51528481
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.985e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.841e+01 (tol = 1.000e-10) r (rel) = 2.635e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.512e+00 (tol = 1.000e-10) r (rel) = 2.165e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.129e-02 (tol = 1.000e-10) r (rel) = 3.048e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.014e-05 (tol = 1.000e-10) r (rel) = 1.452e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.190e-12 (tol = 1.000e-10) r (rel) = 7.430e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 206.023956 s.
Runtime: 205.991008 s.
j = 8.059205e+05.
j = 8.059205e+05.
Runtime: 206.025388 s.
j = 8.059205e+05.
Runtime: 205.982883 s.
j = 8.059205e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.191e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.867e+01 (tol = 1.000e-10) r (rel) = 2.280e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.518e+00 (tol = 1.000e-10) r (rel) = 1.854e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.451e-02 (tol = 1.000e-10) r (rel) = 1.771e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.678e-06 (tol = 1.000e-10) r (rel) = 2.048e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.722e-12 (tol = 1.000e-10) r (rel) = 2.102e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 205.450254 s.
j = 1.003202e+06.
Runtime: 205.450615 s.
j = 1.003202e+06.
Runtime: 205.450314 s.
j = 1.003202e+06.
Runtime: 205.451671 s.
j = 1.003202e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.499e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.449e+01 (tol = 1.000e-10) r (rel) = 2.230e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.538e-01 (tol = 1.000e-10) r (rel) = 1.468e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.353e-03 (tol = 1.000e-10) r (rel) = 1.285e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.869e-07 (tol = 1.000e-10) r (rel) = 1.365e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.566e-12 (tol = 1.000e-10) r (rel) = 2.410e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 200.585937 s.
j = 1.053330e+06.
End of time loop.
End of time loop.
Runtime: 200.586045 s.
j = 1.053330e+06.
Runtime: 200.585383 s.
Runtime: 200.586392 s.
j = 1.053330e+06.
j = 1.053330e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.750e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.628e+00 (tol = 1.000e-10) r (rel) = 1.319e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.118e-01 (tol = 1.000e-10) r (rel) = 4.064e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.060e-04 (tol = 1.000e-10) r (rel) = 7.492e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.018e-09 (tol = 1.000e-10) r (rel) = 3.701e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 170.254987 s.
j = 1.057044e+06.
Runtime: 170.253913 s.
j = 1.057044e+06.
Runtime: 170.254788 s.
j = 1.057044e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 170.255617 s.
Start evaluation of j
j = 1.057044e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.154e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.004e-01 (tol = 1.000e-10) r (rel) = 6.071e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.500e-03 (tol = 1.000e-10) r (rel) = 3.901e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.926e-07 (tol = 1.000e-10) r (rel) = 2.536e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.518e-12 (tol = 1.000e-10) r (rel) = 1.316e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 180.493739 s.
Runtime: 180.496355 s.
j = 1.057365e+06.
j = 1.057365e+06.
Runtime: 180.495600 s.
j = 1.057365e+06.
Runtime: 180.496928 s.
j = 1.057365e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.486e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.590e-01 (tol = 1.000e-10) r (rel) = 2.897e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.382e-04 (tol = 1.000e-10) r (rel) = 4.342e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.242e-10 (tol = 1.000e-10) r (rel) = 1.502e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 124.429268 s.
j = 1.058590e+06.
Runtime: 124.428218 s.
Runtime: 124.429159 s.
j = 1.058590e+06.
j = 1.058590e+06.
Runtime: 124.429726 s.
j = 1.058590e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 36.4753520489 s
|dj| = 3046.48089414
Runtime: 36.4759669304 s
|dj| = 3046.48089414
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 36.5076208115 s
|dj| = 3046.48089414
Start evaluation of j
Updating the turbine cache
Runtime: 36.5114150047 s
|dj| = 3046.48089414
   17    68    -9.379324E+05     2.699245E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.154e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.788e+01 (tol = 1.000e-10) r (rel) = 2.500e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.349e+00 (tol = 1.000e-10) r (rel) = 1.886e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.189e-02 (tol = 1.000e-10) r (rel) = 1.662e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.434e-06 (tol = 1.000e-10) r (rel) = 2.004e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.625e-12 (tol = 1.000e-10) r (rel) = 2.272e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 214.423671 s.
j = 8.994060e+05.
End of time loop.
Runtime: 214.428244 s.
j = 8.994060e+05.
End of time loop.
Runtime: 214.462401 s.
j = 8.994060e+05.
Start evaluation of j
Updating the turbine cache
Runtime: 214.463031 s.
j = 8.994060e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.213e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.707e+01 (tol = 1.000e-10) r (rel) = 2.366e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.207e+00 (tol = 1.000e-10) r (rel) = 1.674e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.898e-03 (tol = 1.000e-10) r (rel) = 1.372e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.621e-07 (tol = 1.000e-10) r (rel) = 1.057e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.561e-12 (tol = 1.000e-10) r (rel) = 2.164e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 200.207675 s.
j = 1.004414e+06.
Runtime: 200.208553 s.
Runtime: 200.207153 s.
Runtime: 200.207630 s.
j = 1.004414e+06.
j = 1.004414e+06.
j = 1.004414e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.453e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.064e+01 (tol = 1.000e-10) r (rel) = 1.952e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.505e-01 (tol = 1.000e-10) r (rel) = 1.193e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.568e-03 (tol = 1.000e-10) r (rel) = 8.376e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.438e-07 (tol = 1.000e-10) r (rel) = 6.305e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.498e-12 (tol = 1.000e-10) r (rel) = 2.748e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 207.250245 s.
j = 1.057247e+06.
Runtime: 207.250821 s.
j = 1.057247e+06.
Runtime: 207.250302 s.
j = 1.057247e+06.
Runtime: 207.250391 s.
j = 1.057247e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.100e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.137e+00 (tol = 1.000e-10) r (rel) = 1.018e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.433e-02 (tol = 1.000e-10) r (rel) = 3.063e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.027e-04 (tol = 1.000e-10) r (rel) = 4.888e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.000e-10 (tol = 1.000e-10) r (rel) = 1.429e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 151.137854 s.
j = 1.057375e+06.
Runtime: 151.137843 s.
j = 1.057375e+06.
Runtime: 151.137207 s.
j = 1.057375e+06.
Runtime: 151.138073 s.
j = 1.057375e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.074e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.180e-01 (tol = 1.000e-10) r (rel) = 5.754e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.829e-03 (tol = 1.000e-10) r (rel) = 5.427e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.286e-07 (tol = 1.000e-10) r (rel) = 7.715e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.635e-12 (tol = 1.000e-10) r (rel) = 1.523e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 161.400123 s.
j = 1.057526e+06.
Runtime: 161.399446 s.
j = 1.057526e+06.
Runtime: 161.400258 s.
j = 1.057526e+06.
Runtime: 161.400464 s.
j = 1.057526e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.130e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.574e-01 (tol = 1.000e-10) r (rel) = 3.069e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.167e-04 (tol = 1.000e-10) r (rel) = 8.124e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.382e-09 (tol = 1.000e-10) r (rel) = 8.542e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 114.538695 s.
j = 1.058496e+06.
Runtime: 114.538715 s.
j = 1.058496e+06.
End of time loop.
Runtime: 114.538489 s.
j = 1.058496e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 114.540041 s.
j = 1.058496e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.643e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.621e-02 (tol = 1.000e-10) r (rel) = 9.865e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.279e-06 (tol = 1.000e-10) r (rel) = 2.604e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.512e-12 (tol = 1.000e-10) r (rel) = 2.137e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 123.753074 s.
j = 1.058880e+06.
Runtime: 123.754436 s.
End of time loop.
End of time loop.
j = 1.058880e+06.
Start evaluation of dj
Runtime: 123.754961 s.
found a tidal farm, computing gradient
j = 1.058880e+06.
Runtime: 123.752450 s.
j = 1.058880e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.3432579041 s
|dj| = 2747.53025546
Runtime: 43.3441791534 s
|dj| = 2747.53025546
Start evaluation of j
Runtime: 43.3463790417 s
Updating the turbine cache
|dj| = 2747.53025546
Runtime: 43.3474750519 s
|dj| = 2747.53025546
Start evaluation of j
Updating the turbine cache
   18    75    -9.381898E+05     2.434368E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.279e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.689e+01 (tol = 1.000e-10) r (rel) = 2.320e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.472e+00 (tol = 1.000e-10) r (rel) = 2.023e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.064e-02 (tol = 1.000e-10) r (rel) = 5.583e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.001e-05 (tol = 1.000e-10) r (rel) = 9.619e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.227e-10 (tol = 1.000e-10) r (rel) = 3.059e-12 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 184.608750 s.
j = 9.028743e+05.
Runtime: 184.607985 s.
j = 9.028743e+05.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 184.611118 s.
Updating the turbine cache
j = 9.028743e+05.
Updating the turbine cache
Runtime: 184.612555 s.
j = 9.028743e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.551e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.594e+01 (tol = 1.000e-10) r (rel) = 2.433e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.232e+00 (tol = 1.000e-10) r (rel) = 1.881e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.575e-02 (tol = 1.000e-10) r (rel) = 2.405e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.679e-06 (tol = 1.000e-10) r (rel) = 5.615e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.559e-12 (tol = 1.000e-10) r (rel) = 2.379e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 205.122323 s.
j = 1.055801e+06.
Runtime: 205.120018 s.
Runtime: 205.121047 s.
j = 1.055801e+06.
j = 1.055801e+06.
Runtime: 205.122623 s.
j = 1.055801e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.562e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.056e+00 (tol = 1.000e-10) r (rel) = 1.973e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.482e-01 (tol = 1.000e-10) r (rel) = 5.784e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.210e-04 (tol = 1.000e-10) r (rel) = 8.624e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.979e-10 (tol = 1.000e-10) r (rel) = 2.724e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 143.739304 s.
j = 1.058945e+06.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 143.740668 s.
Updating the turbine cache
End of time loop.
Runtime: 143.741229 s.
j = 1.058945e+06.
Runtime: 143.741502 s.
j = 1.058945e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
j = 1.058945e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.395e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.017e+00 (tol = 1.000e-10) r (rel) = 7.289e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.555e-03 (tol = 1.000e-10) r (rel) = 5.416e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.733e-07 (tol = 1.000e-10) r (rel) = 4.827e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.602e-12 (tol = 1.000e-10) r (rel) = 1.149e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 150.110681 s.
Runtime: 150.108258 s.
j = 1.058182e+06.
j = 1.058182e+06.
Runtime: 150.103372 s.
j = 1.058182e+06.
Runtime: 150.109220 s.
j = 1.058182e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.550e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.147e-01 (tol = 1.000e-10) r (rel) = 4.342e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.345e-03 (tol = 1.000e-10) r (rel) = 1.408e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.210e-08 (tol = 1.000e-10) r (rel) = 2.314e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.491e-12 (tol = 1.000e-10) r (rel) = 1.561e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 133.642244 s.
Runtime: 133.643009 s.
j = 1.058895e+06.
j = 1.058895e+06.
Runtime: 133.643201 s.
j = 1.058895e+06.
Runtime: 133.643658 s.
j = 1.058895e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.612e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.937e-02 (tol = 1.000e-10) r (rel) = 1.367e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.058e-05 (tol = 1.000e-10) r (rel) = 5.699e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.564e-11 (tol = 1.000e-10) r (rel) = 4.330e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 109.573088 s.
j = 1.058932e+06.
End of time loop.
End of time loop.
Runtime: 109.573533 s.
Runtime: 109.572816 s.
Start evaluation of j
j = 1.058932e+06.
j = 1.058932e+06.
Updating the turbine cache
Runtime: 109.573970 s.
j = 1.058932e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.671e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.638e-03 (tol = 1.000e-10) r (rel) = 5.768e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.525e-07 (tol = 1.000e-10) r (rel) = 4.504e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.597e-12 (tol = 1.000e-10) r (rel) = 9.557e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 125.534791 s.
j = 1.059023e+06.
End of time loop.
End of time loop.
Runtime: 125.535694 s.
j = 1.059023e+06.
Runtime: 125.535984 s.
j = 1.059023e+06.
Start evaluation of dj
Runtime: 125.537114 s.
found a tidal farm, computing gradient
j = 1.059023e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 40.0893700123 s
|dj| = 2829.90378634
Runtime: 40.0906171799 s
|dj| = 2829.90378634
Start evaluation of j
   19    82    -9.383160E+05     2.507353E+03
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 40.1283009052 s
|dj| = 2829.90378634
Runtime: 40.1281971931 s
|dj| = 2829.90378634
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.105e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.746e+01 (tol = 1.000e-10) r (rel) = 2.458e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.412e+00 (tol = 1.000e-10) r (rel) = 1.987e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.601e-02 (tol = 1.000e-10) r (rel) = 3.661e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.970e-05 (tol = 1.000e-10) r (rel) = 4.181e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.914e-11 (tol = 1.000e-10) r (rel) = 5.509e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 195.372998 s.
j = 9.063263e+05.
End of time loop.
Runtime: 195.373603 s.
j = 9.063263e+05.
Start evaluation of j
Runtime: 195.333315 s.
Updating the turbine cache
j = 9.063263e+05.
End of time loop.
Runtime: 195.334659 s.
j = 9.063263e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.245e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.700e+01 (tol = 1.000e-10) r (rel) = 2.346e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.287e+00 (tol = 1.000e-10) r (rel) = 1.777e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.393e-02 (tol = 1.000e-10) r (rel) = 1.923e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.640e-06 (tol = 1.000e-10) r (rel) = 3.644e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.638e-12 (tol = 1.000e-10) r (rel) = 2.261e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 192.185483 s.
Runtime: 192.182964 s.
j = 1.056110e+06.
Runtime: 192.183819 s.
j = 1.056110e+06.
j = 1.056110e+06.
Runtime: 192.184780 s.
j = 1.056110e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.720e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.446e+00 (tol = 1.000e-10) r (rel) = 1.267e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.254e-02 (tol = 1.000e-10) r (rel) = 3.402e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.501e-04 (tol = 1.000e-10) r (rel) = 5.517e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.411e-10 (tol = 1.000e-10) r (rel) = 2.357e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 168.242294 s.
j = 1.059205e+06.
End of time loop.
End of time loop.
Runtime: 168.242053 s.
j = 1.059205e+06.
Start evaluation of j
Runtime: 168.242971 s.
Runtime: 168.243088 s.
j = 1.059205e+06.
j = 1.059205e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.572e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.477e-01 (tol = 1.000e-10) r (rel) = 4.677e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.320e-03 (tol = 1.000e-10) r (rel) = 2.424e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.954e-08 (tol = 1.000e-10) r (rel) = 1.040e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.495e-12 (tol = 1.000e-10) r (rel) = 1.561e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 169.714417 s.
j = 1.057554e+06.
Runtime: 169.712948 s.
j = 1.057554e+06.
Runtime: 169.713274 s.
j = 1.057554e+06.
Runtime: 169.714058 s.
j = 1.057554e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.101e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.053e-01 (tol = 1.000e-10) r (rel) = 3.769e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.053e-03 (tol = 1.000e-10) r (rel) = 1.300e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.997e-08 (tol = 1.000e-10) r (rel) = 2.465e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 1.843e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 161.001138 s.
j = 1.058737e+06.
End of time loop.
End of time loop.
Runtime: 161.001424 s.
j = 1.058737e+06.
Runtime: 161.001467 s.
Runtime: 161.000616 s.
j = 1.058737e+06.
j = 1.058737e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.126e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.016e-02 (tol = 1.000e-10) r (rel) = 9.483e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.922e-06 (tol = 1.000e-10) r (rel) = 2.316e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.622e-12 (tol = 1.000e-10) r (rel) = 1.704e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 118.304502 s.
j = 1.059099e+06.
Runtime: 118.303513 s.
j = 1.059099e+06.
Runtime: 118.304041 s.
j = 1.059099e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 118.305442 s.
j = 1.059099e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 37.5426521301 s
|dj| = 2740.64616196
Start evaluation of j
Updating the turbine cache
Runtime: 37.5491690636 s
|dj| = 2740.64616196
Start evaluation of j
Updating the turbine cache
Runtime: 37.5827510357 s
|dj| = 2740.64616196
Runtime: 37.5803508759 s
|dj| = 2740.64616196
Start evaluation of j
   20    88    -9.383839E+05     2.428269E+03
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.910e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.574e+01 (tol = 1.000e-10) r (rel) = 2.277e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.095e+00 (tol = 1.000e-10) r (rel) = 1.585e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.857e-03 (tol = 1.000e-10) r (rel) = 1.282e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.361e-07 (tol = 1.000e-10) r (rel) = 1.065e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.549e-12 (tol = 1.000e-10) r (rel) = 2.241e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 215.223262 s.
j = 9.781068e+05.
Runtime: 215.182354 s.
j = 9.781068e+05.
Runtime: 215.182313 s.
j = 9.781068e+05.
Runtime: 215.218062 s.
j = 9.781068e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.591e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.494e+01 (tol = 1.000e-10) r (rel) = 2.266e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.758e-01 (tol = 1.000e-10) r (rel) = 1.480e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.359e-03 (tol = 1.000e-10) r (rel) = 1.117e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.204e-07 (tol = 1.000e-10) r (rel) = 9.413e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.525e-12 (tol = 1.000e-10) r (rel) = 2.314e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 212.027590 s.
j = 1.063330e+06.
End of time loop.
Runtime: 212.027655 s.
End of time loop.
j = 1.063330e+06.
Runtime: 212.027869 s.
j = 1.063330e+06.
Runtime: 212.026871 s.
j = 1.063330e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 44.1829349995 s
|dj| = 3554.66369539
Start evaluation of j
Updating the turbine cache
Runtime: 44.1875059605 s
|dj| = 3554.66369539
   21    90    -9.421325E+05     3.149505E+03
Start evaluation of j
Updating the turbine cache
Runtime: 44.2238008976 s
|dj| = 3554.66369539
Runtime: 44.2233679295 s
|dj| = 3554.66369539
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.089e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.691e+01 (tol = 1.000e-10) r (rel) = 2.386e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.206e+00 (tol = 1.000e-10) r (rel) = 1.701e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.112e-02 (tol = 1.000e-10) r (rel) = 1.568e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.455e-06 (tol = 1.000e-10) r (rel) = 2.053e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.653e-12 (tol = 1.000e-10) r (rel) = 2.331e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 214.385490 s.
Runtime: 214.427227 s.
j = 1.011314e+06.
j = 1.011314e+06.
Runtime: 214.422035 s.
j = 1.011314e+06.
Runtime: 214.385601 s.
j = 1.011314e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.552e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.524e+01 (tol = 1.000e-10) r (rel) = 2.326e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.025e+00 (tol = 1.000e-10) r (rel) = 1.564e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.096e-03 (tol = 1.000e-10) r (rel) = 1.388e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.310e-06 (tol = 1.000e-10) r (rel) = 1.999e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.707e-12 (tol = 1.000e-10) r (rel) = 2.605e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 215.729104 s.
j = 1.064552e+06.
Runtime: 215.728753 s.
j = 1.064552e+06.
Runtime: 215.727789 s.
j = 1.064552e+06.
Runtime: 215.729622 s.
j = 1.064552e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.099e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.417e+00 (tol = 1.000e-10) r (rel) = 1.425e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.548e-01 (tol = 1.000e-10) r (rel) = 4.997e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.626e-04 (tol = 1.000e-10) r (rel) = 1.493e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.914e-09 (tol = 1.000e-10) r (rel) = 1.908e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 175.322320 s.
j = 1.066205e+06.
Runtime: 175.322322 s.
j = 1.066205e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 175.322261 s.
j = 1.066205e+06.
End of time loop.
Runtime: 175.324127 s.
j = 1.066205e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 40.5606498718 s
|dj| = 3831.38716466
Start evaluation of j
Updating the turbine cache
Runtime: 40.5608210564 s
|dj| = 3831.38716466
Start evaluation of j
Updating the turbine cache
Runtime: 40.597826004 s
|dj| = 3831.38716466
Start evaluation of j
Updating the turbine cache
Runtime: 40.6304030418 s
|dj| = 3831.38716466
   22    93    -9.446798E+05     3.394688E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.209e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.794e+01 (tol = 1.000e-10) r (rel) = 2.488e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.323e+00 (tol = 1.000e-10) r (rel) = 1.836e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.236e-02 (tol = 1.000e-10) r (rel) = 1.714e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.578e-06 (tol = 1.000e-10) r (rel) = 2.189e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.652e-12 (tol = 1.000e-10) r (rel) = 2.291e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 184.563303 s.
Runtime: 184.495163 s.
j = 9.978700e+05.
j = 9.978700e+05.
Runtime: 184.526125 s.
j = 9.978700e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 184.584086 s.
j = 9.978700e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.411e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.714e+01 (tol = 1.000e-10) r (rel) = 2.313e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.232e+00 (tol = 1.000e-10) r (rel) = 1.663e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.204e-02 (tol = 1.000e-10) r (rel) = 1.625e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.488e-06 (tol = 1.000e-10) r (rel) = 3.357e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.705e-12 (tol = 1.000e-10) r (rel) = 2.300e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 195.236033 s.
j = 1.054887e+06.
Runtime: 195.236029 s.
End of time loop.
End of time loop.
j = 1.054887e+06.
Start evaluation of j
Runtime: 195.237261 s.
Runtime: 195.219141 s.
j = 1.054887e+06.
Updating the turbine cache
j = 1.054887e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.286e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.487e+00 (tol = 1.000e-10) r (rel) = 1.747e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.391e-01 (tol = 1.000e-10) r (rel) = 7.913e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.486e-03 (tol = 1.000e-10) r (rel) = 3.468e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.234e-08 (tol = 1.000e-10) r (rel) = 9.880e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 167.378467 s.
j = 1.066133e+06.
End of time loop.
End of time loop.
Runtime: 167.379703 s.
j = 1.066133e+06.
Runtime: 167.378451 s.
Start evaluation of j
j = 1.066133e+06.
Updating the turbine cache
Runtime: 167.378640 s.
j = 1.066133e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.871e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.559e+00 (tol = 1.000e-10) r (rel) = 8.332e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.688e-02 (tol = 1.000e-10) r (rel) = 1.437e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.708e-05 (tol = 1.000e-10) r (rel) = 9.132e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.242e-11 (tol = 1.000e-10) r (rel) = 6.637e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 163.916695 s.
j = 1.065295e+06.
Runtime: 163.917810 s.
j = 1.065295e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 163.919824 s.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 163.919484 s.
j = 1.065295e+06.
Start evaluation of j
j = 1.065295e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.116e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.588e-01 (tol = 1.000e-10) r (rel) = 5.008e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.550e-03 (tol = 1.000e-10) r (rel) = 3.181e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.948e-07 (tol = 1.000e-10) r (rel) = 2.642e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.501e-12 (tol = 1.000e-10) r (rel) = 1.346e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 161.114501 s.
j = 1.066291e+06.
End of time loop.
Runtime: 161.110521 s.
j = 1.066291e+06.
Runtime: 161.116221 s.
j = 1.066291e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 161.112457 s.
j = 1.066291e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.287e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.241e-02 (tol = 1.000e-10) r (rel) = 1.923e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.449e-05 (tol = 1.000e-10) r (rel) = 1.738e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.308e-10 (tol = 1.000e-10) r (rel) = 3.050e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 121.715346 s.
j = 1.066490e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
End of time loop.
End of time loop.
Runtime: 121.716860 s.
j = 1.066490e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 121.720509 s.
j = 1.066490e+06.
Runtime: 121.727877 s.
j = 1.066490e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 35.8650438786 s
|dj| = 2872.17233236
Start evaluation of j
Updating the turbine cache
Runtime: 35.8789579868 s
|dj| = 2872.17233236
Start evaluation of j
Updating the turbine cache
Runtime: 35.9133529663 s
|dj| = 2872.17233236
   23    99    -9.449319E+05     2.544804E+03
Start evaluation of j
Updating the turbine cache
Runtime: 35.9088189602 s
|dj| = 2872.17233236
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.219e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.750e+01 (tol = 1.000e-10) r (rel) = 2.423e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.352e+00 (tol = 1.000e-10) r (rel) = 1.873e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.167e-02 (tol = 1.000e-10) r (rel) = 1.616e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.986e-06 (tol = 1.000e-10) r (rel) = 2.752e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.658e-12 (tol = 1.000e-10) r (rel) = 2.296e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 207.454083 s.
j = 8.973768e+05.
Runtime: 207.490065 s.
j = 8.973768e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 207.449635 s.
j = 8.973768e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 207.495074 s.
j = 8.973768e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.508e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.728e+01 (tol = 1.000e-10) r (rel) = 2.302e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.413e+00 (tol = 1.000e-10) r (rel) = 1.882e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.854e-02 (tol = 1.000e-10) r (rel) = 2.469e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.284e-06 (tol = 1.000e-10) r (rel) = 9.701e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.224e-12 (tol = 1.000e-10) r (rel) = 2.962e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 204.567281 s.
j = 1.044891e+06.
End of time loop.
Runtime: 204.566245 s.
j = 1.044891e+06.
End of time loop.
Start evaluation of j
Runtime: 204.569411 s.
j = 1.044891e+06.
Updating the turbine cache
Runtime: 204.569599 s.
j = 1.044891e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.815e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.724e+00 (tol = 1.000e-10) r (rel) = 2.019e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.228e-01 (tol = 1.000e-10) r (rel) = 1.086e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.095e-03 (tol = 1.000e-10) r (rel) = 6.428e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.612e-07 (tol = 1.000e-10) r (rel) = 3.348e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.489e-12 (tol = 1.000e-10) r (rel) = 3.091e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 213.047805 s.
j = 1.064093e+06.
End of time loop.
Runtime: 213.046611 s.
j = 1.064093e+06.
End of time loop.
Start evaluation of j
Runtime: 213.047223 s.
j = 1.064093e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 213.048440 s.
j = 1.064093e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.019e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.007e+00 (tol = 1.000e-10) r (rel) = 9.940e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.238e-02 (tol = 1.000e-10) r (rel) = 1.604e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.058e-05 (tol = 1.000e-10) r (rel) = 1.019e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.599e-11 (tol = 1.000e-10) r (rel) = 7.918e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 159.305301 s.
j = 1.066559e+06.
Runtime: 159.302423 s.
j = 1.066559e+06.
Runtime: 159.305681 s.
j = 1.066559e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 159.305635 s.
Start evaluation of j
j = 1.066559e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.637e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.501e-01 (tol = 1.000e-10) r (rel) = 4.054e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.063e-03 (tol = 1.000e-10) r (rel) = 1.231e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.097e-08 (tol = 1.000e-10) r (rel) = 2.427e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.485e-12 (tol = 1.000e-10) r (rel) = 1.719e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 156.354386 s.
j = 1.067000e+06.
End of time loop.
End of time loop.
Runtime: 156.357968 s.
j = 1.067000e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 156.359918 s.
Runtime: 156.358747 s.
j = 1.067000e+06.
j = 1.067000e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 38.9895670414 s
|dj| = 3645.20540047
Runtime: 38.9950430393 s
Start evaluation of j
|dj| = 3645.20540047
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 39.0284309387 s
|dj| = 3645.20540047
Runtime: 39.0334300995 s
|dj| = 3645.20540047
Start evaluation of j
Updating the turbine cache
   24   104    -9.453841E+05     3.229727E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.505e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.830e+01 (tol = 1.000e-10) r (rel) = 2.438e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.451e+00 (tol = 1.000e-10) r (rel) = 1.933e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.577e-02 (tol = 1.000e-10) r (rel) = 2.101e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.102e-06 (tol = 1.000e-10) r (rel) = 4.134e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.018e-12 (tol = 1.000e-10) r (rel) = 2.689e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 196.309088 s.
j = 9.090050e+05.
End of time loop.
End of time loop.
Runtime: 196.273041 s.
j = 9.090050e+05.
Runtime: 196.313704 s.
Runtime: 196.269989 s.
j = 9.090050e+05.
j = 9.090050e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.528e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.696e+01 (tol = 1.000e-10) r (rel) = 2.253e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.248e+00 (tol = 1.000e-10) r (rel) = 1.657e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.211e-02 (tol = 1.000e-10) r (rel) = 1.608e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.774e-06 (tol = 1.000e-10) r (rel) = 2.357e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.976e-12 (tol = 1.000e-10) r (rel) = 2.625e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 214.635688 s.
j = 1.040212e+06.
Runtime: 214.635894 s.
j = 1.040212e+06.
Runtime: 214.637152 s.
j = 1.040212e+06.
Runtime: 214.636697 s.
j = 1.040212e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.375e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.126e+01 (tol = 1.000e-10) r (rel) = 2.094e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.101e-01 (tol = 1.000e-10) r (rel) = 1.321e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.729e-03 (tol = 1.000e-10) r (rel) = 1.066e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.254e-07 (tol = 1.000e-10) r (rel) = 9.775e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.510e-12 (tol = 1.000e-10) r (rel) = 2.809e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 206.241840 s.
j = 1.063297e+06.
Runtime: 206.240616 s.
Runtime: 206.242166 s.
j = 1.063297e+06.
j = 1.063297e+06.
Runtime: 206.242334 s.
j = 1.063297e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.458e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.712e+00 (tol = 1.000e-10) r (rel) = 1.103e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.799e-02 (tol = 1.000e-10) r (rel) = 2.359e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.227e-05 (tol = 1.000e-10) r (rel) = 2.126e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.777e-11 (tol = 1.000e-10) r (rel) = 2.350e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 153.116297 s.
j = 1.066345e+06.
End of time loop.
Runtime: 153.115732 s.
End of time loop.
j = 1.066345e+06.
Start evaluation of j
Runtime: 153.117137 s.
Runtime: 153.117091 s.
Updating the turbine cache
j = 1.066345e+06.
j = 1.066345e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.049e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.821e-01 (tol = 1.000e-10) r (rel) = 4.596e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.878e-03 (tol = 1.000e-10) r (rel) = 1.791e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.724e-08 (tol = 1.000e-10) r (rel) = 4.504e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.488e-12 (tol = 1.000e-10) r (rel) = 1.419e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 168.203321 s.
j = 1.066398e+06.
Runtime: 168.202674 s.
j = 1.066398e+06.
Runtime: 168.203031 s.
j = 1.066398e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 168.212738 s.
j = 1.066398e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.270e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.161e-01 (tol = 1.000e-10) r (rel) = 2.203e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.117e-04 (tol = 1.000e-10) r (rel) = 2.120e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.746e-10 (tol = 1.000e-10) r (rel) = 3.314e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 113.520874 s.
j = 1.067455e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
End of time loop.
End of time loop.
Runtime: 113.519512 s.
j = 1.067455e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 113.521018 s.
j = 1.067455e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 113.533507 s.
j = 1.067455e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 44.7549228668 s
|dj| = 3199.03467574
Runtime: 44.7373688221 s
|dj| = 3199.03467574
   25   110    -9.457870E+05     2.834410E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 44.7892518044 s
|dj| = 3199.03467574
Start evaluation of j
Runtime: 44.7834341526 s
Updating the turbine cache
|dj| = 3199.03467574
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.891e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.757e+01 (tol = 1.000e-10) r (rel) = 2.550e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.493e+00 (tol = 1.000e-10) r (rel) = 2.166e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.647e-02 (tol = 1.000e-10) r (rel) = 3.841e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.521e-05 (tol = 1.000e-10) r (rel) = 3.658e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.777e-11 (tol = 1.000e-10) r (rel) = 4.029e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 208.636800 s.
Runtime: 208.673349 s.
j = 8.450129e+05.
j = 8.450129e+05.
Runtime: 208.640479 s.
j = 8.450129e+05.
Runtime: 208.675621 s.
j = 8.450129e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.570e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.617e+01 (tol = 1.000e-10) r (rel) = 2.135e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.270e+00 (tol = 1.000e-10) r (rel) = 1.677e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.289e-02 (tol = 1.000e-10) r (rel) = 1.702e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.230e-06 (tol = 1.000e-10) r (rel) = 2.946e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.567e-12 (tol = 1.000e-10) r (rel) = 2.070e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 178.323129 s.
Runtime: 178.323909 s.
j = 1.062275e+06.
j = 1.062275e+06.
Runtime: 178.324197 s.
j = 1.062275e+06.
Runtime: 178.324546 s.
j = 1.062275e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.488e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.921e+00 (tol = 1.000e-10) r (rel) = 1.411e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.711e-01 (tol = 1.000e-10) r (rel) = 4.906e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.734e-04 (tol = 1.000e-10) r (rel) = 1.071e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.466e-09 (tol = 1.000e-10) r (rel) = 7.070e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 158.264653 s.
j = 1.067936e+06.
Runtime: 158.263989 s.
j = 1.067936e+06.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 158.265372 s.
Updating the turbine cache
Updating the turbine cache
j = 1.067936e+06.
Runtime: 158.266006 s.
j = 1.067936e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.275e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.252e-01 (tol = 1.000e-10) r (rel) = 5.688e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.345e-03 (tol = 1.000e-10) r (rel) = 3.408e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.485e-07 (tol = 1.000e-10) r (rel) = 1.949e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 1.171e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 180.485531 s.
Runtime: 180.487994 s.
j = 1.067526e+06.
j = 1.067526e+06.
End of time loop.
Runtime: 180.488425 s.
j = 1.067526e+06.
Runtime: 180.487343 s.
Start evaluation of j
Start evaluation of j
j = 1.067526e+06.
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.354e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.463e-01 (tol = 1.000e-10) r (rel) = 3.348e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.295e-04 (tol = 1.000e-10) r (rel) = 7.200e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.337e-09 (tol = 1.000e-10) r (rel) = 5.897e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 104.684920 s.
Runtime: 104.685378 s.
j = 1.067259e+06.
j = 1.067259e+06.
Runtime: 104.685529 s.
j = 1.067259e+06.
Runtime: 104.684828 s.
j = 1.067259e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.312e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.354e-02 (tol = 1.000e-10) r (rel) = 1.937e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.570e-05 (tol = 1.000e-10) r (rel) = 1.524e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.147e-11 (tol = 1.000e-10) r (rel) = 1.889e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 114.530963 s.
j = 1.067537e+06.
Runtime: 114.532191 s.
Runtime: 114.532067 s.
j = 1.067537e+06.
j = 1.067537e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 114.541312 s.
j = 1.067537e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.617e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.092e-02 (tol = 1.000e-10) r (rel) = 6.754e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.027e-06 (tol = 1.000e-10) r (rel) = 6.352e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.667e-12 (tol = 1.000e-10) r (rel) = 1.031e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 134.443222 s.
j = 1.067693e+06.
Runtime: 134.452005 s.
j = 1.067693e+06.
End of time loop.
End of time loop.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 134.448459 s.
j = 1.067693e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 134.453019 s.
j = 1.067693e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.4151930809 s
|dj| = 3295.65792734
Runtime: 45.4007461071 s
|dj| = 3295.65792734
Start evaluation of j
Updating the turbine cache
   26   117    -9.459977E+05     2.920021E+03
Start evaluation of j
Updating the turbine cache
Runtime: 45.4427239895 s
|dj| = 3295.65792734
Runtime: 45.4545781612 s
|dj| = 3295.65792734
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.463e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.770e+01 (tol = 1.000e-10) r (rel) = 2.372e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.367e+00 (tol = 1.000e-10) r (rel) = 1.832e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.424e-02 (tol = 1.000e-10) r (rel) = 1.908e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.279e-06 (tol = 1.000e-10) r (rel) = 3.053e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.812e-12 (tol = 1.000e-10) r (rel) = 2.428e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 192.473317 s.
j = 9.530090e+05.
Runtime: 192.433739 s.
j = 9.530090e+05.
End of time loop.
Start evaluation of j
Runtime: 192.431974 s.
j = 9.530090e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 192.476495 s.
j = 9.530090e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.056e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.637e+01 (tol = 1.000e-10) r (rel) = 2.319e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.148e+00 (tol = 1.000e-10) r (rel) = 1.627e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.736e-03 (tol = 1.000e-10) r (rel) = 1.380e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.982e-07 (tol = 1.000e-10) r (rel) = 1.273e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.541e-12 (tol = 1.000e-10) r (rel) = 2.184e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 167.649483 s.
Runtime: 167.649402 s.
j = 1.056311e+06.
j = 1.056311e+06.
Runtime: 167.648562 s.
j = 1.056311e+06.
End of time loop.
Runtime: 167.647669 s.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
j = 1.056311e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.538e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.882e+00 (tol = 1.000e-10) r (rel) = 1.516e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.064e-01 (tol = 1.000e-10) r (rel) = 6.752e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.036e-03 (tol = 1.000e-10) r (rel) = 2.284e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.538e-08 (tol = 1.000e-10) r (rel) = 3.390e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 158.727657 s.
j = 1.067618e+06.
Runtime: 158.727885 s.
j = 1.067618e+06.
Runtime: 158.726728 s.
j = 1.067618e+06.
Runtime: 158.728173 s.
j = 1.067618e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.361e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.778e-01 (tol = 1.000e-10) r (rel) = 4.980e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.864e-03 (tol = 1.000e-10) r (rel) = 2.839e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.344e-07 (tol = 1.000e-10) r (rel) = 1.722e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.490e-12 (tol = 1.000e-10) r (rel) = 1.095e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 153.166463 s.
j = 1.067187e+06.
End of time loop.
Runtime: 153.166772 s.
j = 1.067187e+06.
Runtime: 153.167067 s.
Start evaluation of j
j = 1.067187e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 153.167389 s.
Start evaluation of j
j = 1.067187e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.639e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.239e-01 (tol = 1.000e-10) r (rel) = 2.931e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.372e-04 (tol = 1.000e-10) r (rel) = 5.724e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.165e-09 (tol = 1.000e-10) r (rel) = 4.144e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 128.350863 s.
j = 1.067619e+06.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 128.354203 s.
j = 1.067619e+06.
Updating the turbine cache
Runtime: 128.355036 s.
j = 1.067619e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 128.360626 s.
j = 1.067619e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.942e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.384e-02 (tol = 1.000e-10) r (rel) = 1.150e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.193e-06 (tol = 1.000e-10) r (rel) = 3.125e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.313e-12 (tol = 1.000e-10) r (rel) = 2.826e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 127.683177 s.
j = 1.068026e+06.
Runtime: 127.691287 s.
j = 1.068026e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 127.689767 s.
j = 1.068026e+06.
Runtime: 127.691426 s.
j = 1.068026e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.0011320114 s
|dj| = 3374.85363502
Runtime: 43.0017280579 s
|dj| = 3374.85363502
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 43.00345397 s
|dj| = 3374.85363502
Runtime: 43.003166914 s
|dj| = 3374.85363502
Start evaluation of j
Updating the turbine cache
   27   123    -9.462926E+05     2.990190E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.675e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.509e+01 (tol = 1.000e-10) r (rel) = 2.261e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.020e+00 (tol = 1.000e-10) r (rel) = 1.528e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.115e-03 (tol = 1.000e-10) r (rel) = 1.216e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.228e-07 (tol = 1.000e-10) r (rel) = 1.382e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.535e-12 (tol = 1.000e-10) r (rel) = 2.300e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 182.864619 s.
j = 1.038373e+06.
End of time loop.
Runtime: 182.864047 s.
j = 1.038373e+06.
Runtime: 182.860853 s.
j = 1.038373e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 182.861273 s.
j = 1.038373e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.901e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.255e+01 (tol = 1.000e-10) r (rel) = 2.126e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.731e-01 (tol = 1.000e-10) r (rel) = 1.310e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.902e-03 (tol = 1.000e-10) r (rel) = 1.000e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.031e-07 (tol = 1.000e-10) r (rel) = 1.022e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.521e-12 (tol = 1.000e-10) r (rel) = 2.578e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 188.142217 s.
j = 1.067408e+06.
Runtime: 188.139410 s.
j = 1.067408e+06.
Runtime: 188.140905 s.
j = 1.067408e+06.
Runtime: 188.142820 s.
j = 1.067408e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.790e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.259e+00 (tol = 1.000e-10) r (rel) = 1.168e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.077e-01 (tol = 1.000e-10) r (rel) = 3.858e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.890e-04 (tol = 1.000e-10) r (rel) = 1.036e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.325e-09 (tol = 1.000e-10) r (rel) = 8.332e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 174.228847 s.
j = 1.069037e+06.
Runtime: 174.227651 s.
j = 1.069037e+06.
End of time loop.
Start evaluation of dj
Runtime: 174.229639 s.
j = 1.069037e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 174.230519 s.
j = 1.069037e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 42.6692020893 s
|dj| = 3141.72616926
Start evaluation of j
Runtime: 42.6716160774 s
|dj| = 3141.72616926
Updating the turbine cache
Runtime: 42.6738498211 s
Runtime: 42.675276041 s
|dj| = 3141.72616926
|dj| = 3141.72616926
   28   126    -9.471888E+05     2.783634E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.365e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.825e+01 (tol = 1.000e-10) r (rel) = 2.477e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.324e+00 (tol = 1.000e-10) r (rel) = 1.798e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.222e-02 (tol = 1.000e-10) r (rel) = 1.659e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.673e-06 (tol = 1.000e-10) r (rel) = 2.271e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.732e-12 (tol = 1.000e-10) r (rel) = 2.352e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 199.388008 s.
j = 1.003019e+06.
Runtime: 199.387226 s.
j = 1.003019e+06.
End of time loop.
End of time loop.
Runtime: 199.392212 s.
j = 1.003019e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 199.388654 s.
j = 1.003019e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.895e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.583e+01 (tol = 1.000e-10) r (rel) = 2.296e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.054e+00 (tol = 1.000e-10) r (rel) = 1.528e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.548e-03 (tol = 1.000e-10) r (rel) = 1.240e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.964e-07 (tol = 1.000e-10) r (rel) = 1.300e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.546e-12 (tol = 1.000e-10) r (rel) = 2.242e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 181.504361 s.
Runtime: 181.503162 s.
j = 1.060401e+06.
j = 1.060401e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 181.505155 s.
j = 1.060401e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 181.503562 s.
j = 1.060401e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.018e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.090e+00 (tol = 1.000e-10) r (rel) = 1.516e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.310e-01 (tol = 1.000e-10) r (rel) = 5.749e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.038e-04 (tol = 1.000e-10) r (rel) = 1.751e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.696e-09 (tol = 1.000e-10) r (rel) = 2.164e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 164.840192 s.
j = 1.068557e+06.
Runtime: 164.839049 s.
j = 1.068557e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 164.838347 s.
j = 1.068557e+06.
Updating the turbine cache
End of time loop.
Updating the turbine cache
Runtime: 164.841687 s.
j = 1.068557e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.871e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.250e+00 (tol = 1.000e-10) r (rel) = 6.679e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.324e-02 (tol = 1.000e-10) r (rel) = 7.078e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.253e-06 (tol = 1.000e-10) r (rel) = 1.738e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.011e-12 (tol = 1.000e-10) r (rel) = 1.075e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 162.008531 s.
j = 1.069555e+06.
End of time loop.
End of time loop.
Runtime: 162.011388 s.
j = 1.069555e+06.
Runtime: 162.010767 s.
Start evaluation of j
Runtime: 162.011992 s.
j = 1.069555e+06.
j = 1.069555e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.203e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.303e-01 (tol = 1.000e-10) r (rel) = 2.808e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.387e-04 (tol = 1.000e-10) r (rel) = 5.347e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.586e-09 (tol = 1.000e-10) r (rel) = 4.372e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 123.507269 s.
j = 1.069117e+06.
Runtime: 123.507980 s.
j = 1.069117e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Runtime: 123.508115 s.
j = 1.069117e+06.
Updating the turbine cache
End of time loop.
Runtime: 123.510257 s.
j = 1.069117e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.997e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.600e-02 (tol = 1.000e-10) r (rel) = 1.721e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.700e-05 (tol = 1.000e-10) r (rel) = 1.141e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.689e-11 (tol = 1.000e-10) r (rel) = 1.138e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 127.572231 s.
Runtime: 127.570742 s.
j = 1.069722e+06.
j = 1.069722e+06.
Runtime: 127.572365 s.
j = 1.069722e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 127.571177 s.
j = 1.069722e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 34.7467348576 s
|dj| = 3102.12482372
Runtime: 34.748883009 s
|dj| = 3102.12482372
Runtime: 34.7494261265 s
|dj| = 3102.12482372
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   29   132    -9.477955E+05     2.748546E+03
Start evaluation of j
Updating the turbine cache
Runtime: 34.752737999 s
|dj| = 3102.12482372
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.041e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.620e+01 (tol = 1.000e-10) r (rel) = 2.300e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.105e+00 (tol = 1.000e-10) r (rel) = 1.570e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.036e-02 (tol = 1.000e-10) r (rel) = 1.471e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.066e-06 (tol = 1.000e-10) r (rel) = 2.935e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.903e-12 (tol = 1.000e-10) r (rel) = 2.702e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 176.287430 s.
j = 1.044721e+06.
End of time loop.
End of time loop.
Runtime: 176.284005 s.
j = 1.044721e+06.
Runtime: 176.288578 s.
Runtime: 176.289502 s.
j = 1.044721e+06.
j = 1.044721e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.213e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.259e+01 (tol = 1.000e-10) r (rel) = 2.026e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.482e-01 (tol = 1.000e-10) r (rel) = 1.204e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.960e-03 (tol = 1.000e-10) r (rel) = 7.983e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.926e-07 (tol = 1.000e-10) r (rel) = 4.709e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.495e-12 (tol = 1.000e-10) r (rel) = 2.406e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 201.476773 s.
Runtime: 201.476567 s.
j = 1.068580e+06.
j = 1.068580e+06.
Runtime: 201.477958 s.
j = 1.068580e+06.
Runtime: 201.477309 s.
j = 1.068580e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.353e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.171e+00 (tol = 1.000e-10) r (rel) = 1.244e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.478e-01 (tol = 1.000e-10) r (rel) = 4.408e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.133e-04 (tol = 1.000e-10) r (rel) = 1.233e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.709e-09 (tol = 1.000e-10) r (rel) = 1.106e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 160.414831 s.
Runtime: 160.415777 s.
j = 1.067195e+06.
j = 1.067195e+06.
Runtime: 160.415125 s.
j = 1.067195e+06.
Runtime: 160.417089 s.
j = 1.067195e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.263e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.923e+00 (tol = 1.000e-10) r (rel) = 8.500e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.561e-02 (tol = 1.000e-10) r (rel) = 1.574e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.521e-05 (tol = 1.000e-10) r (rel) = 1.114e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.966e-11 (tol = 1.000e-10) r (rel) = 8.690e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 163.445101 s.
j = 1.069990e+06.
Runtime: 163.445222 s.
j = 1.069990e+06.
End of time loop.
Runtime: 163.445777 s.
j = 1.069990e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 163.446143 s.
j = 1.069990e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.939e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.788e-01 (tol = 1.000e-10) r (rel) = 2.576e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.068e-04 (tol = 1.000e-10) r (rel) = 4.421e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.757e-09 (tol = 1.000e-10) r (rel) = 2.531e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 134.834001 s.
j = 1.069595e+06.
End of time loop.
Runtime: 134.832427 s.
j = 1.069595e+06.
Runtime: 134.834492 s.
j = 1.069595e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 134.832877 s.
j = 1.069595e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.643e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.035e-02 (tol = 1.000e-10) r (rel) = 1.731e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.866e-05 (tol = 1.000e-10) r (rel) = 1.263e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.150e-11 (tol = 1.000e-10) r (rel) = 1.325e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 120.933764 s.
j = 1.069995e+06.
Runtime: 120.934247 s.
j = 1.069995e+06.
Runtime: 120.933235 s.
j = 1.069995e+06.
End of time loop.
Runtime: 120.932560 s.
j = 1.069995e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 47.6775348186 s
|dj| = 3138.99589101
Runtime: 47.6664829254 s
|dj| = 3138.99589101
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Runtime: 47.6801819801 s
Updating the turbine cache
|dj| = 3138.99589101
Runtime: 47.681926012 s
|dj| = 3138.99589101
Start evaluation of j
Updating the turbine cache
   30   138    -9.480378E+05     2.781215E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.746e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.708e+01 (tol = 1.000e-10) r (rel) = 2.204e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.275e+00 (tol = 1.000e-10) r (rel) = 1.647e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.419e-02 (tol = 1.000e-10) r (rel) = 1.832e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.706e-06 (tol = 1.000e-10) r (rel) = 3.494e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.982e-12 (tol = 1.000e-10) r (rel) = 2.559e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 179.913217 s.
j = 1.027265e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 179.921980 s.
Runtime: 179.928418 s.
End of time loop.
Runtime: 179.924699 s.
j = 1.027265e+06.
Start evaluation of j
Updating the turbine cache
j = 1.027265e+06.
Start evaluation of j
Updating the turbine cache
j = 1.027265e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.688e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.373e+01 (tol = 1.000e-10) r (rel) = 2.414e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.878e-01 (tol = 1.000e-10) r (rel) = 1.561e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.652e-03 (tol = 1.000e-10) r (rel) = 1.345e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.360e-07 (tol = 1.000e-10) r (rel) = 1.470e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.622e-12 (tol = 1.000e-10) r (rel) = 2.851e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 225.627192 s.
j = 1.068369e+06.
Runtime: 225.613420 s.
j = 1.068369e+06.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 225.622627 s.
j = 1.068369e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
End of time loop.
Updating the turbine cache
Runtime: 225.640683 s.
j = 1.068369e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.794e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.431e+00 (tol = 1.000e-10) r (rel) = 1.228e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.633e-02 (tol = 1.000e-10) r (rel) = 3.090e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.078e-04 (tol = 1.000e-10) r (rel) = 3.857e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.460e-10 (tol = 1.000e-10) r (rel) = 8.807e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 164.546368 s.
j = 1.069368e+06.
Runtime: 164.547861 s.
j = 1.069368e+06.
Runtime: 164.544560 s.
j = 1.069368e+06.
Runtime: 164.547979 s.
j = 1.069368e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.476e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.023e-01 (tol = 1.000e-10) r (rel) = 6.114e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.539e-03 (tol = 1.000e-10) r (rel) = 4.431e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.962e-07 (tol = 1.000e-10) r (rel) = 4.039e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.571e-12 (tol = 1.000e-10) r (rel) = 1.064e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 159.973300 s.
j = 1.069606e+06.
End of time loop.
End of time loop.
Runtime: 159.973791 s.
j = 1.069606e+06.
Start evaluation of j
Runtime: 159.973093 s.
Runtime: 159.973951 s.
j = 1.069606e+06.
j = 1.069606e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.670e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.325e-01 (tol = 1.000e-10) r (rel) = 3.031e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.631e-04 (tol = 1.000e-10) r (rel) = 6.039e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.906e-09 (tol = 1.000e-10) r (rel) = 3.789e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 136.587986 s.
j = 1.069929e+06.
End of time loop.
End of time loop.
Runtime: 136.588135 s.
j = 1.069929e+06.
Runtime: 136.588325 s.
Start evaluation of j
Runtime: 136.589583 s.
j = 1.069929e+06.
j = 1.069929e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.376e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.372e-02 (tol = 1.000e-10) r (rel) = 1.295e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.679e-05 (tol = 1.000e-10) r (rel) = 4.974e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.534e-11 (tol = 1.000e-10) r (rel) = 4.544e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 121.488718 s.
j = 1.070375e+06.
End of time loop.
End of time loop.
Runtime: 121.489604 s.
Runtime: 121.489298 s.
j = 1.070375e+06.
j = 1.070375e+06.
Start evaluation of dj
Runtime: 121.490773 s.
found a tidal farm, computing gradient
j = 1.070375e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 42.6697289944 s
|dj| = 3121.20351327
Runtime: 42.6699979305 s
|dj| = 3121.20351327
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 42.7016880512 s
|dj| = 3121.20351327
Start evaluation of j
Updating the turbine cache
Runtime: 42.7065010071 s
|dj| = 3121.20351327
   31   144    -9.483739E+05     2.765450E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.824e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.515e+01 (tol = 1.000e-10) r (rel) = 2.220e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.013e+00 (tol = 1.000e-10) r (rel) = 1.485e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.295e-03 (tol = 1.000e-10) r (rel) = 1.216e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.378e-07 (tol = 1.000e-10) r (rel) = 1.081e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.573e-12 (tol = 1.000e-10) r (rel) = 2.305e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 203.815146 s.
j = 1.040715e+06.
Runtime: 203.816795 s.
j = 1.040715e+06.
Runtime: 203.777509 s.
j = 1.040715e+06.
Runtime: 203.782244 s.
j = 1.040715e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.071e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.255e+01 (tol = 1.000e-10) r (rel) = 2.068e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.272e-01 (tol = 1.000e-10) r (rel) = 1.198e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.798e-03 (tol = 1.000e-10) r (rel) = 7.903e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.111e-07 (tol = 1.000e-10) r (rel) = 6.772e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.492e-12 (tol = 1.000e-10) r (rel) = 2.458e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 177.000103 s.
Runtime: 177.000953 s.
j = 1.069394e+06.
j = 1.069394e+06.
End of time loop.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 177.001976 s.
Start evaluation of j
Runtime: 177.001971 s.
j = 1.069394e+06.
j = 1.069394e+06.
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.948e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.549e+00 (tol = 1.000e-10) r (rel) = 1.204e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.244e-02 (tol = 1.000e-10) r (rel) = 2.797e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.435e-05 (tol = 1.000e-10) r (rel) = 2.522e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.731e-11 (tol = 1.000e-10) r (rel) = 3.301e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 147.202808 s.
j = 1.070279e+06.
Runtime: 147.204550 s.
Runtime: 147.204036 s.
j = 1.070279e+06.
j = 1.070279e+06.
Runtime: 147.203276 s.
j = 1.070279e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.623e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.056e+00 (tol = 1.000e-10) r (rel) = 6.507e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.900e-03 (tol = 1.000e-10) r (rel) = 5.485e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.183e-06 (tol = 1.000e-10) r (rel) = 7.293e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.871e-12 (tol = 1.000e-10) r (rel) = 1.153e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 150.778988 s.
j = 1.069712e+06.
Runtime: 150.779914 s.
j = 1.069712e+06.
Start evaluation of j
End of time loop.
Updating the turbine cache
Start evaluation of j
Runtime: 150.780975 s.
j = 1.069712e+06.
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 150.782318 s.
j = 1.069712e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.678e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.692e-01 (tol = 1.000e-10) r (rel) = 3.815e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.309e-03 (tol = 1.000e-10) r (rel) = 1.353e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.207e-08 (tol = 1.000e-10) r (rel) = 3.313e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.483e-12 (tol = 1.000e-10) r (rel) = 1.533e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 169.306347 s.
j = 1.069367e+06.
Runtime: 169.303051 s.
j = 1.069367e+06.
Runtime: 169.304608 s.
j = 1.069367e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 169.307752 s.
j = 1.069367e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.297e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.020e-01 (tol = 1.000e-10) r (rel) = 1.925e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.931e-05 (tol = 1.000e-10) r (rel) = 1.686e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.230e-10 (tol = 1.000e-10) r (rel) = 2.323e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 112.219791 s.
j = 1.070531e+06.
End of time loop.
Runtime: 112.220215 s.
j = 1.070531e+06.
End of time loop.
Runtime: 112.217606 s.
j = 1.070531e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 112.221390 s.
j = 1.070531e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 41.375649929 s
|dj| = 2988.16997071
Start evaluation of j
Updating the turbine cache
Runtime: 41.382666111 s
|dj| = 2988.16997071
   32   150    -9.485129E+05     2.647580E+03
Start evaluation of j
Updating the turbine cache
Runtime: 41.3971030712 s
|dj| = 2988.16997071
Runtime: 41.3982951641 s
|dj| = 2988.16997071
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.988e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.617e+01 (tol = 1.000e-10) r (rel) = 2.313e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.268e+00 (tol = 1.000e-10) r (rel) = 1.815e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.713e-02 (tol = 1.000e-10) r (rel) = 2.452e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.984e-06 (tol = 1.000e-10) r (rel) = 8.562e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.189e-12 (tol = 1.000e-10) r (rel) = 4.564e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 205.167671 s.
j = 1.017672e+06.
Runtime: 205.145587 s.
j = 1.017672e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 205.163444 s.
Runtime: 205.148284 s.
j = 1.017672e+06.
j = 1.017672e+06.
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.641e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.437e+01 (tol = 1.000e-10) r (rel) = 2.164e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.614e-01 (tol = 1.000e-10) r (rel) = 1.448e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.354e-03 (tol = 1.000e-10) r (rel) = 9.568e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.435e-07 (tol = 1.000e-10) r (rel) = 5.172e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.498e-12 (tol = 1.000e-10) r (rel) = 2.256e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 198.497824 s.
j = 1.070939e+06.
Runtime: 198.498119 s.
End of time loop.
End of time loop.
j = 1.070939e+06.
Start evaluation of j
Runtime: 198.500801 s.
Runtime: 198.500047 s.
Updating the turbine cache
j = 1.070939e+06.
j = 1.070939e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.347e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.004e+00 (tol = 1.000e-10) r (rel) = 8.540e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.597e-02 (tol = 1.000e-10) r (rel) = 1.107e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.532e-06 (tol = 1.000e-10) r (rel) = 3.210e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.684e-12 (tol = 1.000e-10) r (rel) = 2.422e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 151.401107 s.
j = 1.071462e+06.
Runtime: 151.401368 s.
j = 1.071462e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Runtime: 151.403260 s.
found a tidal farm, computing gradient
Runtime: 151.402598 s.
j = 1.071462e+06.
j = 1.071462e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 38.7722151279 s
|dj| = 2702.62209188
Start evaluation of j
Updating the turbine cache
Runtime: 38.7760710716 s
|dj| = 2702.62209188
   33   153    -9.493377E+05     2.394579E+03
Start evaluation of j
Updating the turbine cache
Runtime: 38.8161680698 s
Runtime: 38.8170650005 s
|dj| = 2702.62209188
|dj| = 2702.62209188
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.966e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.273e+01 (tol = 1.000e-10) r (rel) = 2.133e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.722e-01 (tol = 1.000e-10) r (rel) = 1.294e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.486e-03 (tol = 1.000e-10) r (rel) = 9.195e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.765e-07 (tol = 1.000e-10) r (rel) = 7.986e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.513e-12 (tol = 1.000e-10) r (rel) = 2.535e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 212.614109 s.
j = 1.053193e+06.
Runtime: 212.610032 s.
j = 1.053193e+06.
End of time loop.
Start evaluation of j
Runtime: 212.569108 s.
j = 1.053193e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 212.570736 s.
j = 1.053193e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.783e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.092e+01 (tol = 1.000e-10) r (rel) = 1.889e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.964e-01 (tol = 1.000e-10) r (rel) = 1.031e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.088e-03 (tol = 1.000e-10) r (rel) = 5.340e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.249e-07 (tol = 1.000e-10) r (rel) = 2.159e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.486e-12 (tol = 1.000e-10) r (rel) = 2.569e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 204.570766 s.
j = 1.070112e+06.
Runtime: 204.569621 s.
j = 1.070112e+06.
Runtime: 204.572156 s.
j = 1.070112e+06.
Runtime: 204.572696 s.
j = 1.070112e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.807e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.656e+00 (tol = 1.000e-10) r (rel) = 9.464e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.994e-02 (tol = 1.000e-10) r (rel) = 1.779e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.260e-05 (tol = 1.000e-10) r (rel) = 1.518e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.355e-11 (tol = 1.000e-10) r (rel) = 1.908e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 171.819860 s.
Runtime: 171.819895 s.
j = 1.071374e+06.
j = 1.071374e+06.
End of time loop.
Start evaluation of j
Runtime: 171.819589 s.
Updating the turbine cache
Start evaluation of j
j = 1.071374e+06.
Updating the turbine cache
End of time loop.
Runtime: 171.821777 s.
j = 1.071374e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.211e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.990e-01 (tol = 1.000e-10) r (rel) = 4.121e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.098e-03 (tol = 1.000e-10) r (rel) = 1.732e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.302e-08 (tol = 1.000e-10) r (rel) = 6.030e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.487e-12 (tol = 1.000e-10) r (rel) = 1.228e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 152.401692 s.
j = 1.070292e+06.
Runtime: 152.398848 s.
Runtime: 152.400463 s.
j = 1.070292e+06.
j = 1.070292e+06.
Runtime: 152.402101 s.
j = 1.070292e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.464e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.407e-01 (tol = 1.000e-10) r (rel) = 2.844e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.892e-04 (tol = 1.000e-10) r (rel) = 5.779e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.832e-09 (tol = 1.000e-10) r (rel) = 4.528e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 109.512601 s.
j = 1.071683e+06.
Runtime: 109.513091 s.
Runtime: 109.511747 s.
j = 1.071683e+06.
j = 1.071683e+06.
Runtime: 109.513290 s.
j = 1.071683e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 36.0592160225 s
|dj| = 3000.06061779
Runtime: 36.0593810081 s
|dj| = 3000.06061779
Runtime: 36.0600800514 s
|dj| = 3000.06061779
Runtime: 36.0604100227 s
|dj| = 3000.06061779
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   34   158    -9.495331E+05     2.658115E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.246e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.374e+00 (tol = 1.000e-10) r (rel) = 1.972e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.816e-01 (tol = 1.000e-10) r (rel) = 8.987e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.814e-03 (tol = 1.000e-10) r (rel) = 4.273e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.585e-08 (tol = 1.000e-10) r (rel) = 1.551e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.489e-12 (tol = 1.000e-10) r (rel) = 3.508e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 203.396303 s.
j = 1.067875e+06.
Runtime: 203.394260 s.
j = 1.067875e+06.
End of time loop.
Runtime: 203.396659 s.
Start evaluation of j
j = 1.067875e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 203.396402 s.
j = 1.067875e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.226e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.148e+00 (tol = 1.000e-10) r (rel) = 1.455e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.678e-01 (tol = 1.000e-10) r (rel) = 6.338e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.097e-03 (tol = 1.000e-10) r (rel) = 2.595e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.299e-08 (tol = 1.000e-10) r (rel) = 5.441e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 151.815779 s.
j = 1.071748e+06.
Runtime: 151.813401 s.
Runtime: 151.814837 s.
j = 1.071748e+06.
j = 1.071748e+06.
Runtime: 151.816293 s.
j = 1.071748e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.611e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.392e+00 (tol = 1.000e-10) r (rel) = 9.160e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.860e-02 (tol = 1.000e-10) r (rel) = 2.244e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.770e-05 (tol = 1.000e-10) r (rel) = 2.593e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.040e-10 (tol = 1.000e-10) r (rel) = 3.981e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 152.574441 s.
j = 1.072032e+06.
Runtime: 152.574012 s.
End of time loop.
j = 1.072032e+06.
End of time loop.
Runtime: 152.575283 s.
Start evaluation of j
j = 1.072032e+06.
Updating the turbine cache
Runtime: 152.575595 s.
j = 1.072032e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.408e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.959e-01 (tol = 1.000e-10) r (rel) = 4.941e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.062e-03 (tol = 1.000e-10) r (rel) = 3.594e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.264e-07 (tol = 1.000e-10) r (rel) = 3.738e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.520e-12 (tol = 1.000e-10) r (rel) = 1.079e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 168.088740 s.
Runtime: 168.090462 s.
j = 1.071985e+06.
j = 1.071985e+06.
Runtime: 168.089825 s.
j = 1.071985e+06.
Runtime: 168.089554 s.
j = 1.071985e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.507e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.935e-01 (tol = 1.000e-10) r (rel) = 2.577e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.579e-04 (tol = 1.000e-10) r (rel) = 4.768e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.533e-09 (tol = 1.000e-10) r (rel) = 3.374e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 136.567857 s.
j = 1.072095e+06.
End of time loop.
Runtime: 136.567971 s.
j = 1.072095e+06.
End of time loop.
Runtime: 136.568442 s.
Start evaluation of dj
j = 1.072095e+06.
found a tidal farm, computing gradient
Runtime: 136.568017 s.
j = 1.072095e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.630398035 s
|dj| = 2873.50697844
Runtime: 45.632584095 s
|dj| = 2873.50697844
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 45.667994976 s
|dj| = 2873.50697844
Runtime: 45.6724820137 s
Start evaluation of j
|dj| = 2873.50697844
Updating the turbine cache
   35   163    -9.498981E+05     2.545986E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.039e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.108e+01 (tol = 1.000e-10) r (rel) = 1.835e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.312e-01 (tol = 1.000e-10) r (rel) = 1.045e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.227e-03 (tol = 1.000e-10) r (rel) = 6.999e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.582e-07 (tol = 1.000e-10) r (rel) = 4.275e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.488e-12 (tol = 1.000e-10) r (rel) = 2.464e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 187.760969 s.
j = 1.066501e+06.
Runtime: 187.801862 s.
j = 1.066501e+06.
Runtime: 187.764653 s.
j = 1.066501e+06.
Runtime: 187.803849 s.
j = 1.066501e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.357e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.850e+00 (tol = 1.000e-10) r (rel) = 1.802e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.998e-01 (tol = 1.000e-10) r (rel) = 6.881e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.708e-04 (tol = 1.000e-10) r (rel) = 1.540e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.132e-09 (tol = 1.000e-10) r (rel) = 1.178e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 160.240764 s.
j = 1.071484e+06.
End of time loop.
End of time loop.
Runtime: 160.240987 s.
j = 1.071484e+06.
Runtime: 160.241395 s.
Runtime: 160.240407 s.
j = 1.071484e+06.
j = 1.071484e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.513e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.870e+00 (tol = 1.000e-10) r (rel) = 1.142e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.083e-02 (tol = 1.000e-10) r (rel) = 1.625e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.204e-05 (tol = 1.000e-10) r (rel) = 4.792e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.150e-12 (tol = 1.000e-10) r (rel) = 3.243e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 156.605505 s.
j = 1.072477e+06.
Runtime: 156.606015 s.
j = 1.072477e+06.
End of time loop.
Runtime: 156.606251 s.
j = 1.072477e+06.
Start evaluation of j
End of time loop.
Updating the turbine cache
Runtime: 156.608402 s.
Start evaluation of j
j = 1.072477e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.340e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.677e-01 (tol = 1.000e-10) r (rel) = 5.729e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.024e-03 (tol = 1.000e-10) r (rel) = 3.003e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.523e-07 (tol = 1.000e-10) r (rel) = 1.883e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.488e-12 (tol = 1.000e-10) r (rel) = 1.111e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 171.696091 s.
Runtime: 171.695687 s.
j = 1.073672e+06.
j = 1.073672e+06.
Runtime: 171.694550 s.
End of time loop.
j = 1.073672e+06.
Runtime: 171.697723 s.
j = 1.073672e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.6078591347 s
|dj| = 3110.16746585
Start evaluation of j
Updating the turbine cache
Runtime: 45.6118431091 s
|dj| = 3110.16746585
Start evaluation of j
Updating the turbine cache
Runtime: 45.6423788071 s
|dj| = 3110.16746585
Runtime: 45.6464648247 s
|dj| = 3110.16746585
Start evaluation of j
Updating the turbine cache
   36   167    -9.512951E+05     2.755672E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.353e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.209e+01 (tol = 1.000e-10) r (rel) = 1.903e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.566e-01 (tol = 1.000e-10) r (rel) = 1.191e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.441e-03 (tol = 1.000e-10) r (rel) = 1.014e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.937e-07 (tol = 1.000e-10) r (rel) = 1.092e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.532e-12 (tol = 1.000e-10) r (rel) = 2.411e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 206.847807 s.
j = 1.048656e+06.
Runtime: 206.812892 s.
j = 1.048656e+06.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 206.816534 s.
j = 1.048656e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 206.853224 s.
j = 1.048656e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.280e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.086e+01 (tol = 1.000e-10) r (rel) = 2.057e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.049e-01 (tol = 1.000e-10) r (rel) = 1.146e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.338e-03 (tol = 1.000e-10) r (rel) = 6.322e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.052e-07 (tol = 1.000e-10) r (rel) = 1.993e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.488e-12 (tol = 1.000e-10) r (rel) = 2.817e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 194.664817 s.
j = 1.072251e+06.
End of time loop.
End of time loop.
Runtime: 194.663250 s.
j = 1.072251e+06.
Runtime: 194.662007 s.
Runtime: 194.664521 s.
j = 1.072251e+06.
j = 1.072251e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.058e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.791e+00 (tol = 1.000e-10) r (rel) = 8.700e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.041e-02 (tol = 1.000e-10) r (rel) = 9.915e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.552e-06 (tol = 1.000e-10) r (rel) = 2.212e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.576e-12 (tol = 1.000e-10) r (rel) = 1.251e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 151.040624 s.
j = 1.071688e+06.
Runtime: 151.040058 s.
j = 1.071688e+06.
Runtime: 151.039681 s.
j = 1.071688e+06.
Runtime: 151.040109 s.
j = 1.071688e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.135e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.411e-01 (tol = 1.000e-10) r (rel) = 4.766e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.676e-03 (tol = 1.000e-10) r (rel) = 2.357e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.407e-07 (tol = 1.000e-10) r (rel) = 1.239e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.484e-12 (tol = 1.000e-10) r (rel) = 1.307e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 172.931019 s.
j = 1.073674e+06.
Runtime: 172.930992 s.
j = 1.073674e+06.
Runtime: 172.930995 s.
j = 1.073674e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 172.931222 s.
j = 1.073674e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.087e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.517e-02 (tol = 1.000e-10) r (rel) = 7.269e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.265e-06 (tol = 1.000e-10) r (rel) = 1.085e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.754e-12 (tol = 1.000e-10) r (rel) = 8.403e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 118.662686 s.
j = 1.073885e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 118.662878 s.
j = 1.073885e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
End of time loop.
Runtime: 118.670773 s.
Runtime: 118.669472 s.
j = 1.073885e+06.
j = 1.073885e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.8240401745 s
|dj| = 3158.43275576
Start evaluation of j
Updating the turbine cache
Runtime: 43.8200991154 s
|dj| = 3158.43275576
Start evaluation of j
Updating the turbine cache
Runtime: 43.8531730175 s
|dj| = 3158.43275576
   37   172    -9.514838E+05     2.798436E+03
Start evaluation of j
Updating the turbine cache
Runtime: 43.8659348488 s
|dj| = 3158.43275576
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.898e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.428e+01 (tol = 1.000e-10) r (rel) = 2.070e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.730e-01 (tol = 1.000e-10) r (rel) = 1.266e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.742e-03 (tol = 1.000e-10) r (rel) = 8.324e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.137e-07 (tol = 1.000e-10) r (rel) = 8.897e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.526e-12 (tol = 1.000e-10) r (rel) = 2.213e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 207.152773 s.
j = 1.040081e+06.
End of time loop.
Runtime: 207.156452 s.
j = 1.040081e+06.
Runtime: 207.113335 s.
j = 1.040081e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 207.119744 s.
j = 1.040081e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.697e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.245e+01 (tol = 1.000e-10) r (rel) = 2.186e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.119e-01 (tol = 1.000e-10) r (rel) = 1.250e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.457e-03 (tol = 1.000e-10) r (rel) = 9.579e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.255e-07 (tol = 1.000e-10) r (rel) = 9.226e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.517e-12 (tol = 1.000e-10) r (rel) = 2.662e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 206.783779 s.
j = 1.070682e+06.
Runtime: 206.784741 s.
Runtime: 206.785967 s.
j = 1.070682e+06.
j = 1.070682e+06.
Runtime: 206.786524 s.
j = 1.070682e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.720e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.579e+00 (tol = 1.000e-10) r (rel) = 9.483e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.826e-02 (tol = 1.000e-10) r (rel) = 1.774e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.149e-05 (tol = 1.000e-10) r (rel) = 1.893e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.605e-11 (tol = 1.000e-10) r (rel) = 2.796e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 157.677246 s.
Runtime: 157.678168 s.
j = 1.072551e+06.
j = 1.072551e+06.
Runtime: 157.678312 s.
j = 1.072551e+06.
Runtime: 157.678539 s.
j = 1.072551e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.275e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.130e-01 (tol = 1.000e-10) r (rel) = 4.024e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.005e-03 (tol = 1.000e-10) r (rel) = 1.573e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.786e-08 (tol = 1.000e-10) r (rel) = 6.107e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.484e-12 (tol = 1.000e-10) r (rel) = 1.164e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 162.472634 s.
Runtime: 162.473546 s.
j = 1.073873e+06.
Runtime: 162.473506 s.
j = 1.073873e+06.
j = 1.073873e+06.
Runtime: 162.473759 s.
j = 1.073873e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.509e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.029e-02 (tol = 1.000e-10) r (rel) = 1.337e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.905e-05 (tol = 1.000e-10) r (rel) = 6.443e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.368e-11 (tol = 1.000e-10) r (rel) = 5.252e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 109.820630 s.
j = 1.074562e+06.
Runtime: 109.821063 s.
j = 1.074562e+06.
Start evaluation of dj
End of time loop.
found a tidal farm, computing gradient
End of time loop.
Runtime: 109.821936 s.
j = 1.074562e+06.
Runtime: 109.821236 s.
j = 1.074562e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 40.0684921741 s
|dj| = 2631.04650868
Start evaluation of j
Updating the turbine cache
Runtime: 40.0887620449 s
|dj| = 2631.04650868
   38   177    -9.520840E+05     2.331161E+03
Start evaluation of j
Updating the turbine cache
Runtime: 40.0997750759 s
|dj| = 2631.04650868
Start evaluation of j
Updating the turbine cache
Runtime: 40.1019639969 s
|dj| = 2631.04650868
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.451e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.141e+01 (tol = 1.000e-10) r (rel) = 1.769e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.612e-01 (tol = 1.000e-10) r (rel) = 1.025e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.897e-03 (tol = 1.000e-10) r (rel) = 6.041e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.982e-07 (tol = 1.000e-10) r (rel) = 3.073e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.498e-12 (tol = 1.000e-10) r (rel) = 2.322e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 177.837988 s.
j = 1.077697e+06.
Runtime: 177.826878 s.
j = 1.077697e+06.
Runtime: 177.857471 s.
j = 1.077697e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 177.823416 s.
j = 1.077697e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.695e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.467e+00 (tol = 1.000e-10) r (rel) = 1.750e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.827e-01 (tol = 1.000e-10) r (rel) = 4.945e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.013e-04 (tol = 1.000e-10) r (rel) = 8.154e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.875e-09 (tol = 1.000e-10) r (rel) = 5.075e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 155.384847 s.
j = 1.076526e+06.
End of time loop.
Runtime: 155.385408 s.
j = 1.076526e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 155.387333 s.
j = 1.076526e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 155.392634 s.
j = 1.076526e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.0099310875 s
|dj| = 2440.04647453
Start evaluation of j
Updating the turbine cache
Runtime: 45.0026900768 s
Runtime: 45.0114359856 s
|dj| = 2440.04647453
|dj| = 2440.04647453
Runtime: 45.0133697987 s
|dj| = 2440.04647453
   39   179    -9.538238E+05     2.161931E+03
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.035e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.062e+01 (tol = 1.000e-10) r (rel) = 1.760e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.693e-01 (tol = 1.000e-10) r (rel) = 9.432e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.998e-03 (tol = 1.000e-10) r (rel) = 4.968e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.061e-07 (tol = 1.000e-10) r (rel) = 1.758e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.495e-12 (tol = 1.000e-10) r (rel) = 2.477e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 207.046895 s.
j = 1.071151e+06.
End of time loop.
Runtime: 207.047054 s.
j = 1.071151e+06.
Runtime: 207.046515 s.
j = 1.071151e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 207.052926 s.
Start evaluation of j
j = 1.071151e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.385e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.378e+00 (tol = 1.000e-10) r (rel) = 1.683e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.442e-01 (tol = 1.000e-10) r (rel) = 5.569e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.983e-04 (tol = 1.000e-10) r (rel) = 1.136e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.290e-09 (tol = 1.000e-10) r (rel) = 7.503e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 161.064813 s.
j = 1.076551e+06.
End of time loop.
Runtime: 161.064994 s.
j = 1.076551e+06.
Runtime: 161.064060 s.
j = 1.076551e+06.
Start evaluation of j
Runtime: 161.062678 s.
Updating the turbine cache
j = 1.076551e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.363e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.995e+00 (tol = 1.000e-10) r (rel) = 8.444e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.813e-02 (tol = 1.000e-10) r (rel) = 7.674e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.358e-06 (tol = 1.000e-10) r (rel) = 9.979e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.269e-12 (tol = 1.000e-10) r (rel) = 9.604e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 158.291754 s.
j = 1.076629e+06.
Runtime: 158.293198 s.
j = 1.076629e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Runtime: 158.293054 s.
j = 1.076629e+06.
Updating the turbine cache
End of time loop.
Runtime: 158.293328 s.
j = 1.076629e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.359e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.844e-01 (tol = 1.000e-10) r (rel) = 4.300e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.858e-03 (tol = 1.000e-10) r (rel) = 1.367e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.091e-08 (tol = 1.000e-10) r (rel) = 3.010e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.487e-12 (tol = 1.000e-10) r (rel) = 1.094e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 154.042393 s.
j = 1.077084e+06.
Runtime: 154.042576 s.
j = 1.077084e+06.
Runtime: 154.039688 s.
j = 1.077084e+06.
Runtime: 154.041494 s.
j = 1.077084e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 49.6352930069 s
|dj| = 3256.78492295
Start evaluation of j
Updating the turbine cache
Runtime: 49.6561760902 s
|dj| = 3256.78492295
   40   183    -9.543183E+05     2.885578E+03
Start evaluation of j
Updating the turbine cache
Runtime: 49.6807980537 s
|dj| = 3256.78492295
Start evaluation of j
Updating the turbine cache
Runtime: 49.7019519806 s
|dj| = 3256.78492295
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.659e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.045e+01 (tol = 1.000e-10) r (rel) = 1.847e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.603e-01 (tol = 1.000e-10) r (rel) = 9.901e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.000e-03 (tol = 1.000e-10) r (rel) = 5.301e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.154e-07 (tol = 1.000e-10) r (rel) = 2.039e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.496e-12 (tol = 1.000e-10) r (rel) = 2.643e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 213.195162 s.
j = 1.077168e+06.
Runtime: 213.169559 s.
End of time loop.
End of time loop.
j = 1.077168e+06.
Start evaluation of j
Runtime: 213.216089 s.
Runtime: 213.148995 s.
j = 1.077168e+06.
j = 1.077168e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.041e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.548e+00 (tol = 1.000e-10) r (rel) = 1.620e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.254e-01 (tol = 1.000e-10) r (rel) = 5.578e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.965e-04 (tol = 1.000e-10) r (rel) = 1.229e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.868e-09 (tol = 1.000e-10) r (rel) = 9.572e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 181.424144 s.
j = 1.078152e+06.
Runtime: 181.424870 s.
j = 1.078152e+06.
End of time loop.
Start evaluation of dj
End of time loop.
found a tidal farm, computing gradient
Start evaluation of dj
Runtime: 181.425364 s.
Runtime: 181.426703 s.
j = 1.078152e+06.
j = 1.078152e+06.
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 46.7444519997 s
|dj| = 4029.80186241
Runtime: 46.7472782135 s
|dj| = 4029.80186241
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 46.7844409943 s
|dj| = 4029.80186241
Runtime: 46.7842009068 s
|dj| = 4029.80186241
Start evaluation of j
Updating the turbine cache
   42   185    -9.552653E+05     3.570487E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.340e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.831e+01 (tol = 1.000e-10) r (rel) = 2.495e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.600e+00 (tol = 1.000e-10) r (rel) = 2.179e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.531e-02 (tol = 1.000e-10) r (rel) = 3.448e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.270e-05 (tol = 1.000e-10) r (rel) = 1.730e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.480e-12 (tol = 1.000e-10) r (rel) = 8.829e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 199.645782 s.
j = 7.907965e+05.
End of time loop.
Runtime: 199.603896 s.
j = 7.907965e+05.
End of time loop.
Runtime: 199.645695 s.
Start evaluation of j
j = 7.907965e+05.
Updating the turbine cache
Runtime: 199.606215 s.
j = 7.907965e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.178e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.574e+01 (tol = 1.000e-10) r (rel) = 2.193e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.240e+00 (tol = 1.000e-10) r (rel) = 1.727e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.393e-02 (tol = 1.000e-10) r (rel) = 1.941e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.539e-06 (tol = 1.000e-10) r (rel) = 6.323e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.453e-12 (tol = 1.000e-10) r (rel) = 3.417e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 198.787618 s.
j = 8.953357e+05.
Runtime: 198.787871 s.
j = 8.953357e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
End of time loop.
Runtime: 198.795402 s.
j = 8.953357e+05.
Runtime: 198.796366 s.
j = 8.953357e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.640e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.806e+01 (tol = 1.000e-10) r (rel) = 2.363e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.497e+00 (tol = 1.000e-10) r (rel) = 1.959e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.061e-02 (tol = 1.000e-10) r (rel) = 2.698e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.313e-06 (tol = 1.000e-10) r (rel) = 1.088e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.576e-12 (tol = 1.000e-10) r (rel) = 3.372e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 224.799207 s.
j = 9.486517e+05.
Runtime: 224.801365 s.
j = 9.486517e+05.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 224.806915 s.
Runtime: 224.808611 s.
Updating the turbine cache
j = 9.486517e+05.
j = 9.486517e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.291e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.754e+01 (tol = 1.000e-10) r (rel) = 2.406e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.243e+00 (tol = 1.000e-10) r (rel) = 1.704e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.185e-02 (tol = 1.000e-10) r (rel) = 1.625e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.555e-06 (tol = 1.000e-10) r (rel) = 2.132e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.660e-12 (tol = 1.000e-10) r (rel) = 2.276e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 205.904739 s.
Runtime: 205.903498 s.
j = 1.070249e+06.
End of time loop.
j = 1.070249e+06.
Start evaluation of j
Runtime: 205.904013 s.
j = 1.070249e+06.
End of time loop.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 205.905570 s.
j = 1.070249e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.463e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.329e+00 (tol = 1.000e-10) r (rel) = 1.828e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.966e-01 (tol = 1.000e-10) r (rel) = 8.564e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.398e-03 (tol = 1.000e-10) r (rel) = 4.037e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.630e-08 (tol = 1.000e-10) r (rel) = 1.337e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.489e-12 (tol = 1.000e-10) r (rel) = 4.300e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 197.018321 s.
j = 1.079246e+06.
Runtime: 197.019632 s.
j = 1.079246e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 197.020386 s.
j = 1.079246e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 197.018695 s.
j = 1.079246e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.461e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.413e+00 (tol = 1.000e-10) r (rel) = 9.674e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.954e-02 (tol = 1.000e-10) r (rel) = 1.338e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.783e-06 (tol = 1.000e-10) r (rel) = 4.643e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.331e-12 (tol = 1.000e-10) r (rel) = 3.650e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 173.676848 s.
j = 1.078346e+06.
Runtime: 173.675315 s.
j = 1.078346e+06.
Runtime: 173.677042 s.
j = 1.078346e+06.
Runtime: 173.674684 s.
j = 1.078346e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.782e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.314e-01 (tol = 1.000e-10) r (rel) = 5.543e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.877e-03 (tol = 1.000e-10) r (rel) = 2.411e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.097e-08 (tol = 1.000e-10) r (rel) = 7.834e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.490e-12 (tol = 1.000e-10) r (rel) = 1.914e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 177.383570 s.
j = 1.079023e+06.
End of time loop.
Runtime: 177.384942 s.
j = 1.079023e+06.
End of time loop.
Start evaluation of j
Runtime: 177.385747 s.
j = 1.079023e+06.
Updating the turbine cache
Runtime: 177.386042 s.
j = 1.079023e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.380e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.229e-02 (tol = 1.000e-10) r (rel) = 2.434e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.277e-05 (tol = 1.000e-10) r (rel) = 1.857e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.907e-11 (tol = 1.000e-10) r (rel) = 2.339e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 130.398309 s.
End of time loop.
j = 1.080194e+06.
Runtime: 130.397412 s.
End of time loop.
j = 1.080194e+06.
Runtime: 130.397976 s.
j = 1.080194e+06.
Start evaluation of dj
Runtime: 130.397395 s.
j = 1.080194e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.5012249947 s
|dj| = 3016.35022693
Start evaluation of j
Updating the turbine cache
Runtime: 43.5045731068 s
|dj| = 3016.35022693
   43   193    -9.570744E+05     2.672548E+03
Start evaluation of j
Updating the turbine cache
Runtime: 43.5441200733 s
|dj| = 3016.35022693
Runtime: 43.5439360142 s
|dj| = 3016.35022693
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.622e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.806e+01 (tol = 1.000e-10) r (rel) = 2.369e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.402e+00 (tol = 1.000e-10) r (rel) = 1.840e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.511e-02 (tol = 1.000e-10) r (rel) = 1.983e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.664e-06 (tol = 1.000e-10) r (rel) = 7.431e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.036e-12 (tol = 1.000e-10) r (rel) = 3.984e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 187.274370 s.
Runtime: 187.271326 s.
j = 8.892396e+05.
j = 8.892396e+05.
Runtime: 187.230271 s.
j = 8.892396e+05.
Runtime: 187.231102 s.
j = 8.892396e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.378e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.889e+01 (tol = 1.000e-10) r (rel) = 2.560e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.608e+00 (tol = 1.000e-10) r (rel) = 2.179e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.230e-02 (tol = 1.000e-10) r (rel) = 3.023e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.947e-06 (tol = 1.000e-10) r (rel) = 1.213e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.805e-12 (tol = 1.000e-10) r (rel) = 3.802e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 192.373821 s.
Runtime: 192.373857 s.
j = 9.893734e+05.
j = 9.893734e+05.
Runtime: 192.373287 s.
j = 9.893734e+05.
Runtime: 192.374390 s.
j = 9.893734e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.024e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.893e+01 (tol = 1.000e-10) r (rel) = 2.359e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.520e+00 (tol = 1.000e-10) r (rel) = 1.894e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.566e-02 (tol = 1.000e-10) r (rel) = 1.951e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.292e-06 (tol = 1.000e-10) r (rel) = 4.103e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.793e-12 (tol = 1.000e-10) r (rel) = 2.234e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 213.152869 s.
j = 9.797075e+05.
End of time loop.
Runtime: 213.152047 s.
j = 9.797075e+05.
End of time loop.
Start evaluation of j
Runtime: 213.153515 s.
j = 9.797075e+05.
Runtime: 213.153533 s.
Updating the turbine cache
j = 9.797075e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.706e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.559e+01 (tol = 1.000e-10) r (rel) = 2.325e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.009e+00 (tol = 1.000e-10) r (rel) = 1.505e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.843e-03 (tol = 1.000e-10) r (rel) = 1.319e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.100e-06 (tol = 1.000e-10) r (rel) = 1.641e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.546e-12 (tol = 1.000e-10) r (rel) = 2.305e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 205.678302 s.
j = 1.065741e+06.
Runtime: 205.677137 s.
End of time loop.
j = 1.065741e+06.
Runtime: 205.678092 s.
j = 1.065741e+06.
Runtime: 205.677536 s.
j = 1.065741e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.448e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.253e+00 (tol = 1.000e-10) r (rel) = 1.813e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.417e-01 (tol = 1.000e-10) r (rel) = 7.010e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.425e-04 (tol = 1.000e-10) r (rel) = 1.863e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.022e-09 (tol = 1.000e-10) r (rel) = 1.746e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 177.960260 s.
j = 1.078724e+06.
Runtime: 177.960712 s.
End of time loop.
j = 1.078724e+06.
End of time loop.
Runtime: 177.961828 s.
j = 1.078724e+06.
Start evaluation of j
Runtime: 177.961014 s.
j = 1.078724e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.129e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.639e-01 (tol = 1.000e-10) r (rel) = 7.650e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.978e-03 (tol = 1.000e-10) r (rel) = 4.408e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.201e-07 (tol = 1.000e-10) r (rel) = 1.949e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.503e-12 (tol = 1.000e-10) r (rel) = 1.331e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 173.617053 s.
Runtime: 173.616443 s.
j = 1.079498e+06.
j = 1.079498e+06.
Runtime: 173.615928 s.
j = 1.079498e+06.
Runtime: 173.616649 s.
j = 1.079498e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.377e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.026e-01 (tol = 1.000e-10) r (rel) = 3.768e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.894e-04 (tol = 1.000e-10) r (rel) = 5.383e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.176e-10 (tol = 1.000e-10) r (rel) = 1.707e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 116.521964 s.
j = 1.080114e+06.
Runtime: 116.520859 s.
j = 1.080114e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 116.522991 s.
j = 1.080114e+06.
End of time loop.
Runtime: 116.523858 s.
j = 1.080114e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.239e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.541e-02 (tol = 1.000e-10) r (rel) = 1.582e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.420e-06 (tol = 1.000e-10) r (rel) = 3.760e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.373e-12 (tol = 1.000e-10) r (rel) = 3.292e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 108.405550 s.
Runtime: 108.404091 s.
j = 1.081166e+06.
j = 1.081166e+06.
Runtime: 108.405969 s.
Runtime: 108.402841 s.
j = 1.081166e+06.
j = 1.081166e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 33.3560881615 s
|dj| = 3235.11992388
   44   201    -9.579355E+05     2.866383E+03
Start evaluation of j
Updating the turbine cache
Runtime: 33.3733301163 s
|dj| = 3235.11992388
Runtime: 33.3743300438 s
|dj| = 3235.11992388
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 33.3806359768 s
|dj| = 3235.11992388
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.036e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.907e+01 (tol = 1.000e-10) r (rel) = 2.374e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.651e+00 (tol = 1.000e-10) r (rel) = 2.055e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.546e-02 (tol = 1.000e-10) r (rel) = 4.412e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.358e-05 (tol = 1.000e-10) r (rel) = 6.667e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.359e-10 (tol = 1.000e-10) r (rel) = 1.691e-12 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 212.050474 s.
j = 8.456509e+05.
End of time loop.
End of time loop.
Runtime: 212.043499 s.
Runtime: 212.052151 s.
j = 8.456509e+05.
Start evaluation of j
j = 8.456509e+05.
Updating the turbine cache
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 212.070726 s.
Start evaluation of j
j = 8.456509e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.322e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.774e+01 (tol = 1.000e-10) r (rel) = 2.423e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.414e+00 (tol = 1.000e-10) r (rel) = 1.931e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.768e-02 (tol = 1.000e-10) r (rel) = 2.414e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.109e-06 (tol = 1.000e-10) r (rel) = 6.978e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.173e-12 (tol = 1.000e-10) r (rel) = 2.968e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 200.042170 s.
j = 9.734654e+05.
End of time loop.
Runtime: 200.041565 s.
j = 9.734654e+05.
Start evaluation of j
Runtime: 200.040148 s.
j = 9.734654e+05.
End of time loop.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 200.042423 s.
j = 9.734654e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.923e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.634e+01 (tol = 1.000e-10) r (rel) = 2.360e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.036e+00 (tol = 1.000e-10) r (rel) = 1.496e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.373e-03 (tol = 1.000e-10) r (rel) = 9.206e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.220e-07 (tol = 1.000e-10) r (rel) = 4.652e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.510e-12 (tol = 1.000e-10) r (rel) = 2.181e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 213.171024 s.
Runtime: 213.172519 s.
j = 1.047733e+06.
End of time loop.
End of time loop.
Runtime: 213.172934 s.
Runtime: 213.170398 s.
j = 1.047733e+06.
j = 1.047733e+06.
j = 1.047733e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.906e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.662e+00 (tol = 1.000e-10) r (rel) = 1.969e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.942e-01 (tol = 1.000e-10) r (rel) = 1.211e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.916e-03 (tol = 1.000e-10) r (rel) = 1.002e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.524e-07 (tol = 1.000e-10) r (rel) = 1.126e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.533e-12 (tol = 1.000e-10) r (rel) = 3.125e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 190.536891 s.
j = 1.079106e+06.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 190.538353 s.
j = 1.079106e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 190.543841 s.
j = 1.079106e+06.
End of time loop.
Runtime: 190.544600 s.
Start evaluation of j
j = 1.079106e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.399e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.209e+00 (tol = 1.000e-10) r (rel) = 8.647e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.517e-02 (tol = 1.000e-10) r (rel) = 1.085e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.398e-06 (tol = 1.000e-10) r (rel) = 2.429e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.327e-12 (tol = 1.000e-10) r (rel) = 2.379e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 169.506745 s.
j = 1.080490e+06.
Runtime: 169.508248 s.
j = 1.080490e+06.
Runtime: 169.517135 s.
j = 1.080490e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 169.524412 s.
j = 1.080490e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.043e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.483e-01 (tol = 1.000e-10) r (rel) = 4.108e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.706e-04 (tol = 1.000e-10) r (rel) = 1.110e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.210e-09 (tol = 1.000e-10) r (rel) = 1.028e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 2.471e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 171.528169 s.
End of time loop.
j = 1.081536e+06.
Runtime: 171.527252 s.
j = 1.081536e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 171.535864 s.
j = 1.081536e+06.
End of time loop.
Runtime: 171.530040 s.
j = 1.081536e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 42.4127061367 s
|dj| = 3249.71228256
Runtime: 42.414249897 s
|dj| = 3249.71228256
Start evaluation of j
Updating the turbine cache
   45   207    -9.582631E+05     2.879312E+03
Start evaluation of j
Updating the turbine cache
Runtime: 42.4416570663 s
|dj| = 3249.71228256
Start evaluation of j
Updating the turbine cache
Runtime: 42.4500508308 s
|dj| = 3249.71228256
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.698e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.787e+01 (tol = 1.000e-10) r (rel) = 2.322e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.409e+00 (tol = 1.000e-10) r (rel) = 1.831e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.469e-02 (tol = 1.000e-10) r (rel) = 1.909e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.998e-06 (tol = 1.000e-10) r (rel) = 3.894e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.069e-12 (tol = 1.000e-10) r (rel) = 2.687e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 215.803853 s.
j = 8.400310e+05.
Runtime: 215.803022 s.
j = 8.400310e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 215.759794 s.
j = 8.400310e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 215.767432 s.
j = 8.400310e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.453e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.717e+01 (tol = 1.000e-10) r (rel) = 2.304e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.310e+00 (tol = 1.000e-10) r (rel) = 1.757e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.167e-02 (tol = 1.000e-10) r (rel) = 1.566e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.367e-06 (tol = 1.000e-10) r (rel) = 1.833e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.642e-12 (tol = 1.000e-10) r (rel) = 2.203e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 200.625581 s.
j = 9.672583e+05.
Runtime: 200.626773 s.
j = 9.672583e+05.
Runtime: 200.627266 s.
j = 9.672583e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 200.625684 s.
j = 9.672583e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.239e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.615e+01 (tol = 1.000e-10) r (rel) = 2.231e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.085e+00 (tol = 1.000e-10) r (rel) = 1.498e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.637e-03 (tol = 1.000e-10) r (rel) = 1.193e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.097e-06 (tol = 1.000e-10) r (rel) = 1.515e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.600e-12 (tol = 1.000e-10) r (rel) = 2.210e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 192.020600 s.
j = 1.067459e+06.
End of time loop.
End of time loop.
Runtime: 192.023669 s.
j = 1.067459e+06.
Runtime: 192.024123 s.
Runtime: 192.022893 s.
Start evaluation of j
j = 1.067459e+06.
j = 1.067459e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.275e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.486e+00 (tol = 1.000e-10) r (rel) = 1.675e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.035e-01 (tol = 1.000e-10) r (rel) = 9.267e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.100e-03 (tol = 1.000e-10) r (rel) = 6.413e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.320e-07 (tol = 1.000e-10) r (rel) = 4.031e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.491e-12 (tol = 1.000e-10) r (rel) = 4.552e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 217.175902 s.
j = 1.081977e+06.
Runtime: 217.174795 s.
Runtime: 217.175285 s.
j = 1.081977e+06.
j = 1.081977e+06.
Runtime: 217.175080 s.
j = 1.081977e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.250e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.233e-01 (tol = 1.000e-10) r (rel) = 5.839e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.582e-03 (tol = 1.000e-10) r (rel) = 3.561e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.261e-07 (tol = 1.000e-10) r (rel) = 1.739e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 2.059e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 168.109294 s.
j = 1.081244e+06.
End of time loop.
End of time loop.
Runtime: 168.109268 s.
j = 1.081244e+06.
Runtime: 168.109719 s.
Runtime: 168.109102 s.
j = 1.081244e+06.
j = 1.081244e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.340e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.470e-01 (tol = 1.000e-10) r (rel) = 3.388e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.033e-04 (tol = 1.000e-10) r (rel) = 6.988e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.684e-09 (tol = 1.000e-10) r (rel) = 3.881e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 125.800445 s.
Runtime: 125.800471 s.
Runtime: 125.801029 s.
j = 1.081788e+06.
j = 1.081788e+06.
j = 1.081788e+06.
Runtime: 125.802011 s.
j = 1.081788e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 37.958671093 s
|dj| = 3496.24176911
Start evaluation of j
Updating the turbine cache
Runtime: 37.9616141319 s
|dj| = 3496.24176911
   46   213    -9.584866E+05     3.097742E+03
Start evaluation of j
Updating the turbine cache
Runtime: 37.9990501404 s
|dj| = 3496.24176911
Start evaluation of j
Updating the turbine cache
Runtime: 38.00258708 s
|dj| = 3496.24176911
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.524e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.762e+01 (tol = 1.000e-10) r (rel) = 2.343e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.285e+00 (tol = 1.000e-10) r (rel) = 1.708e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.068e-02 (tol = 1.000e-10) r (rel) = 1.420e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.131e-06 (tol = 1.000e-10) r (rel) = 1.504e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.630e-12 (tol = 1.000e-10) r (rel) = 2.166e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 211.509311 s.
j = 9.326431e+05.
End of time loop.
End of time loop.
Runtime: 211.471164 s.
j = 9.326431e+05.
Runtime: 211.466791 s.
j = 9.326431e+05.
Start evaluation of j
Runtime: 211.513300 s.
j = 9.326431e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.302e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.697e+01 (tol = 1.000e-10) r (rel) = 2.324e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.267e+00 (tol = 1.000e-10) r (rel) = 1.735e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.027e-02 (tol = 1.000e-10) r (rel) = 1.406e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.890e-07 (tol = 1.000e-10) r (rel) = 1.218e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.539e-12 (tol = 1.000e-10) r (rel) = 2.108e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 213.709691 s.
j = 9.615584e+05.
End of time loop.
Runtime: 213.708558 s.
j = 9.615584e+05.
Runtime: 213.709268 s.
j = 9.615584e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 213.710149 s.
Start evaluation of j
j = 9.615584e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.198e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.585e+01 (tol = 1.000e-10) r (rel) = 2.202e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.073e+00 (tol = 1.000e-10) r (rel) = 1.491e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.600e-03 (tol = 1.000e-10) r (rel) = 1.195e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.653e-07 (tol = 1.000e-10) r (rel) = 1.341e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.560e-12 (tol = 1.000e-10) r (rel) = 2.168e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 223.778094 s.
j = 1.056720e+06.
Runtime: 223.775357 s.
j = 1.056720e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 223.778742 s.
Updating the turbine cache
j = 1.056720e+06.
Updating the turbine cache
End of time loop.
Runtime: 223.778599 s.
j = 1.056720e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.487e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.686e+00 (tol = 1.000e-10) r (rel) = 1.713e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.404e-01 (tol = 1.000e-10) r (rel) = 9.815e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.205e-03 (tol = 1.000e-10) r (rel) = 7.143e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.778e-07 (tol = 1.000e-10) r (rel) = 6.190e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.503e-12 (tol = 1.000e-10) r (rel) = 3.351e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 206.541272 s.
Runtime: 206.542718 s.
j = 1.076750e+06.
j = 1.076750e+06.
Runtime: 206.543103 s.
j = 1.076750e+06.
Runtime: 206.540499 s.
j = 1.076750e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.441e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.226e+00 (tol = 1.000e-10) r (rel) = 8.510e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.126e-02 (tol = 1.000e-10) r (rel) = 1.476e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.021e-05 (tol = 1.000e-10) r (rel) = 7.087e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.007e-11 (tol = 1.000e-10) r (rel) = 6.987e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 158.182729 s.
j = 1.082053e+06.
Runtime: 158.182649 s.
Start evaluation of j
Updating the turbine cache
End of time loop.
j = 1.082053e+06.
End of time loop.
Runtime: 158.185547 s.
j = 1.082053e+06.
Runtime: 158.185898 s.
j = 1.082053e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.999e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.069e-02 (tol = 1.000e-10) r (rel) = 2.024e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.556e-05 (tol = 1.000e-10) r (rel) = 1.853e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.453e-11 (tol = 1.000e-10) r (rel) = 2.485e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 114.416780 s.
j = 1.082621e+06.
Runtime: 114.417498 s.
j = 1.082621e+06.
Runtime: 114.418534 s.
j = 1.082621e+06.
Runtime: 114.421123 s.
j = 1.082621e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 37.916960001 s
|dj| = 3428.45428181
Runtime: 37.917812109 s
|dj| = 3428.45428181
Start evaluation of j
Updating the turbine cache
   47   219    -9.592240E+05     3.037681E+03
Start evaluation of j
Updating the turbine cache
Runtime: 37.9543421268 s
|dj| = 3428.45428181
Start evaluation of j
Updating the turbine cache
Runtime: 37.9608230591 s
|dj| = 3428.45428181
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.309e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.716e+01 (tol = 1.000e-10) r (rel) = 2.348e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.332e+00 (tol = 1.000e-10) r (rel) = 1.822e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.233e-02 (tol = 1.000e-10) r (rel) = 1.686e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.687e-06 (tol = 1.000e-10) r (rel) = 2.308e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.701e-12 (tol = 1.000e-10) r (rel) = 2.328e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 205.533607 s.
j = 8.442948e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
End of time loop.
Runtime: 205.533306 s.
j = 8.442948e+05.
Start evaluation of j
Updating the turbine cache
Runtime: 205.492991 s.
j = 8.442948e+05.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 205.500487 s.
j = 8.442948e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.627e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.737e+01 (tol = 1.000e-10) r (rel) = 2.277e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.323e+00 (tol = 1.000e-10) r (rel) = 1.735e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.155e-02 (tol = 1.000e-10) r (rel) = 1.515e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.315e-06 (tol = 1.000e-10) r (rel) = 1.724e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.586e-12 (tol = 1.000e-10) r (rel) = 2.079e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 215.493828 s.
j = 1.025032e+06.
End of time loop.
Runtime: 215.499537 s.
j = 1.025032e+06.
Runtime: 215.499509 s.
j = 1.025032e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 215.497500 s.
Start evaluation of j
j = 1.025032e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.380e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.281e+01 (tol = 1.000e-10) r (rel) = 2.007e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.235e-01 (tol = 1.000e-10) r (rel) = 1.291e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.159e-03 (tol = 1.000e-10) r (rel) = 9.653e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.739e-07 (tol = 1.000e-10) r (rel) = 7.429e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.510e-12 (tol = 1.000e-10) r (rel) = 2.366e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 220.100567 s.
j = 1.078660e+06.
Runtime: 220.099033 s.
j = 1.078660e+06.
Runtime: 220.102119 s.
j = 1.078660e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 220.103138 s.
j = 1.078660e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.131e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.992e+00 (tol = 1.000e-10) r (rel) = 9.349e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.787e-02 (tol = 1.000e-10) r (rel) = 1.777e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.525e-05 (tol = 1.000e-10) r (rel) = 1.185e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.529e-11 (tol = 1.000e-10) r (rel) = 1.187e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 167.844410 s.
j = 1.080057e+06.
Runtime: 167.844739 s.
j = 1.080057e+06.
Runtime: 167.843638 s.
j = 1.080057e+06.
Runtime: 167.846383 s.
j = 1.080057e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.354e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.462e-01 (tol = 1.000e-10) r (rel) = 4.144e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.269e-03 (tol = 1.000e-10) r (rel) = 1.519e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.959e-08 (tol = 1.000e-10) r (rel) = 3.542e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.490e-12 (tol = 1.000e-10) r (rel) = 1.784e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.644295 s.
j = 1.083086e+06.
Runtime: 169.645722 s.
j = 1.083086e+06.
End of time loop.
Runtime: 169.646287 s.
j = 1.083086e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 169.647161 s.
Start evaluation of dj
j = 1.083086e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 47.4059350491 s
|dj| = 3178.25736563
Start evaluation of j
Updating the turbine cache
Runtime: 47.4129559994 s
|dj| = 3178.25736563
   48   224    -9.596360E+05     2.816001E+03
Start evaluation of j
Updating the turbine cache
Runtime: 47.4457879066 s
|dj| = 3178.25736563
Runtime: 47.448786974 s
|dj| = 3178.25736563
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.239e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.617e+01 (tol = 1.000e-10) r (rel) = 2.234e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.268e+00 (tol = 1.000e-10) r (rel) = 1.752e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.629e-02 (tol = 1.000e-10) r (rel) = 2.250e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.530e-06 (tol = 1.000e-10) r (rel) = 7.639e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.807e-12 (tol = 1.000e-10) r (rel) = 3.877e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 217.935850 s.
j = 9.106726e+05.
End of time loop.
Runtime: 217.933335 s.
j = 9.106726e+05.
Start evaluation of j
Runtime: 217.970560 s.
j = 9.106726e+05.
Updating the turbine cache
End of time loop.
Runtime: 217.976522 s.
j = 9.106726e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.761e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.586e+01 (tol = 1.000e-10) r (rel) = 2.347e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.313e+00 (tol = 1.000e-10) r (rel) = 1.942e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.031e-02 (tol = 1.000e-10) r (rel) = 3.004e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.930e-06 (tol = 1.000e-10) r (rel) = 1.173e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.542e-12 (tol = 1.000e-10) r (rel) = 3.759e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 200.794048 s.
j = 1.040947e+06.
Runtime: 200.793592 s.
j = 1.040947e+06.
Runtime: 200.794212 s.
j = 1.040947e+06.
Runtime: 200.795771 s.
j = 1.040947e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.670e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.101e+01 (tol = 1.000e-10) r (rel) = 1.942e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.105e-01 (tol = 1.000e-10) r (rel) = 1.253e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.047e-03 (tol = 1.000e-10) r (rel) = 8.900e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.018e-07 (tol = 1.000e-10) r (rel) = 7.086e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.509e-12 (tol = 1.000e-10) r (rel) = 2.661e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 190.407493 s.
End of time loop.
End of time loop.
Runtime: 190.408248 s.
j = 1.077118e+06.
j = 1.077118e+06.
Runtime: 190.408700 s.
Runtime: 190.408776 s.
j = 1.077118e+06.
j = 1.077118e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.060e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.930e+00 (tol = 1.000e-10) r (rel) = 9.370e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.023e-02 (tol = 1.000e-10) r (rel) = 1.953e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.232e-05 (tol = 1.000e-10) r (rel) = 1.569e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.380e-11 (tol = 1.000e-10) r (rel) = 1.641e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 168.884485 s.
j = 1.081055e+06.
Runtime: 168.885644 s.
j = 1.081055e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 168.885422 s.
Start evaluation of j
j = 1.081055e+06.
Updating the turbine cache
Runtime: 168.892811 s.
j = 1.081055e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.795e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.659e-01 (tol = 1.000e-10) r (rel) = 2.863e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.930e-04 (tol = 1.000e-10) r (rel) = 5.057e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.539e-09 (tol = 1.000e-10) r (rel) = 2.656e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 118.556609 s.
j = 1.082979e+06.
End of time loop.
End of time loop.
Runtime: 118.556983 s.
j = 1.082979e+06.
Runtime: 118.565607 s.
j = 1.082979e+06.
Runtime: 118.558366 s.
Start evaluation of j
j = 1.082979e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.076e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.567e-03 (tol = 1.000e-10) r (rel) = 6.104e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.434e-07 (tol = 1.000e-10) r (rel) = 5.051e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.600e-12 (tol = 1.000e-10) r (rel) = 1.487e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 125.953990 s.
j = 1.083188e+06.
Runtime: 125.952749 s.
j = 1.083188e+06.
Runtime: 125.952847 s.
j = 1.083188e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 125.954623 s.
j = 1.083188e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.3595499992 s
|dj| = 3016.75010418
Start evaluation of j
Updating the turbine cache
Runtime: 45.3610320091 s
|dj| = 3016.75010418
Start evaluation of j
Updating the turbine cache
Runtime: 45.4009389877 s
|dj| = 3016.75010418
Runtime: 45.4024240971 s
|dj| = 3016.75010418
   49   230    -9.597267E+05     2.672903E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.525e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.774e+01 (tol = 1.000e-10) r (rel) = 2.358e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.484e+00 (tol = 1.000e-10) r (rel) = 1.973e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.133e-02 (tol = 1.000e-10) r (rel) = 2.834e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.282e-05 (tol = 1.000e-10) r (rel) = 1.703e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.630e-12 (tol = 1.000e-10) r (rel) = 8.811e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 211.106180 s.
Runtime: 211.151280 s.
j = 9.555822e+05.
j = 9.555822e+05.
Runtime: 211.147608 s.
j = 9.555822e+05.
Runtime: 211.108360 s.
j = 9.555822e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.521e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.675e+01 (tol = 1.000e-10) r (rel) = 2.227e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.244e+00 (tol = 1.000e-10) r (rel) = 1.654e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.373e-02 (tol = 1.000e-10) r (rel) = 1.826e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.425e-06 (tol = 1.000e-10) r (rel) = 5.883e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.783e-12 (tol = 1.000e-10) r (rel) = 3.700e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 213.637781 s.
j = 1.063577e+06.
Runtime: 213.638079 s.
j = 1.063577e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 213.638127 s.
j = 1.063577e+06.
End of time loop.
Runtime: 213.640041 s.
j = 1.063577e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.672e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.430e+00 (tol = 1.000e-10) r (rel) = 1.663e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.911e-01 (tol = 1.000e-10) r (rel) = 8.659e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.214e-03 (tol = 1.000e-10) r (rel) = 3.903e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.515e-08 (tol = 1.000e-10) r (rel) = 1.325e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.491e-12 (tol = 1.000e-10) r (rel) = 2.629e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 223.663472 s.
j = 1.077942e+06.
Runtime: 223.662055 s.
j = 1.077942e+06.
Runtime: 223.660819 s.
j = 1.077942e+06.
Runtime: 223.664345 s.
j = 1.077942e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.345e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.622e+00 (tol = 1.000e-10) r (rel) = 6.920e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.702e-02 (tol = 1.000e-10) r (rel) = 7.258e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.035e-06 (tol = 1.000e-10) r (rel) = 1.294e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.261e-12 (tol = 1.000e-10) r (rel) = 1.391e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 160.858035 s.
End of time loop.
j = 1.081595e+06.
Runtime: 160.859257 s.
End of time loop.
j = 1.081595e+06.
Runtime: 160.859924 s.
j = 1.081595e+06.
Runtime: 160.860116 s.
j = 1.081595e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.033e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.513e-01 (tol = 1.000e-10) r (rel) = 2.152e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.471e-04 (tol = 1.000e-10) r (rel) = 2.092e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.356e-10 (tol = 1.000e-10) r (rel) = 3.350e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 122.850509 s.
End of time loop.
Runtime: 122.851736 s.
End of time loop.
j = 1.083375e+06.
j = 1.083375e+06.
Runtime: 122.851470 s.
Runtime: 122.851009 s.
j = 1.083375e+06.
j = 1.083375e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 40.9262309074 s
|dj| = 3253.78303685
   50   235    -9.598922E+05     2.882919E+03
Start evaluation of j
Updating the turbine cache
Runtime: 40.931385994 s
|dj| = 3253.78303685
Start evaluation of j
Updating the turbine cache
Runtime: 40.962086916 s
|dj| = 3253.78303685
Runtime: 40.9647758007 s
|dj| = 3253.78303685
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.441e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.681e+01 (tol = 1.000e-10) r (rel) = 2.260e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.243e+00 (tol = 1.000e-10) r (rel) = 1.670e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.098e-02 (tol = 1.000e-10) r (rel) = 1.476e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.399e-06 (tol = 1.000e-10) r (rel) = 1.880e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.664e-12 (tol = 1.000e-10) r (rel) = 2.236e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 198.745635 s.
j = 9.268251e+05.
Runtime: 198.743698 s.
j = 9.268251e+05.
Runtime: 198.783029 s.
j = 9.268251e+05.
Runtime: 198.779246 s.
j = 9.268251e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.104e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.586e+01 (tol = 1.000e-10) r (rel) = 2.232e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.104e+00 (tol = 1.000e-10) r (rel) = 1.555e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.163e-03 (tol = 1.000e-10) r (rel) = 1.290e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.329e-06 (tol = 1.000e-10) r (rel) = 1.870e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.549e-12 (tol = 1.000e-10) r (rel) = 2.181e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 203.956778 s.
j = 1.066670e+06.
End of time loop.
End of time loop.
Runtime: 203.958025 s.
j = 1.066670e+06.
Runtime: 203.958191 s.
Start evaluation of j
Runtime: 203.958173 s.
j = 1.066670e+06.
j = 1.066670e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.117e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.869e+00 (tol = 1.000e-10) r (rel) = 1.342e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.738e-01 (tol = 1.000e-10) r (rel) = 5.350e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.730e-04 (tol = 1.000e-10) r (rel) = 1.511e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.206e-09 (tol = 1.000e-10) r (rel) = 1.799e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 173.450164 s.
j = 1.079647e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 173.451557 s.
j = 1.079647e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 173.449942 s.
j = 1.079647e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 173.458964 s.
j = 1.079647e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.843e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.934e-01 (tol = 1.000e-10) r (rel) = 4.848e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.616e-03 (tol = 1.000e-10) r (rel) = 3.048e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.850e-07 (tol = 1.000e-10) r (rel) = 2.632e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.528e-12 (tol = 1.000e-10) r (rel) = 8.295e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 164.127823 s.
j = 1.083546e+06.
End of time loop.
Runtime: 164.129376 s.
j = 1.083546e+06.
Runtime: 164.128266 s.
j = 1.083546e+06.
Runtime: 164.119851 s.
j = 1.083546e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 33.708864212 s
|dj| = 3798.00130604
Runtime: 33.7108519077 s
|dj| = 3798.00130604
Runtime: 33.7108869553 s
|dj| = 3798.00130604
Start evaluation of j
Updating the turbine cache
Runtime: 33.7132589817 s
|dj| = 3798.00130604
Start evaluation of j
Updating the turbine cache
   51   239    -9.600436E+05     3.365107E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.989e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.604e+01 (tol = 1.000e-10) r (rel) = 2.295e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.141e+00 (tol = 1.000e-10) r (rel) = 1.632e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.289e-02 (tol = 1.000e-10) r (rel) = 1.845e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.276e-06 (tol = 1.000e-10) r (rel) = 4.687e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.490e-12 (tol = 1.000e-10) r (rel) = 3.562e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 206.832453 s.
j = 9.526713e+05.
Runtime: 206.833742 s.
j = 9.526713e+05.
End of time loop.
Start evaluation of j
Runtime: 206.830949 s.
j = 9.526713e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 206.833213 s.
Start evaluation of j
j = 9.526713e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.249e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.514e+01 (tol = 1.000e-10) r (rel) = 2.089e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.004e+00 (tol = 1.000e-10) r (rel) = 1.385e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.443e-03 (tol = 1.000e-10) r (rel) = 1.027e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.564e-07 (tol = 1.000e-10) r (rel) = 7.675e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.501e-12 (tol = 1.000e-10) r (rel) = 2.070e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 201.898819 s.
Runtime: 201.901554 s.
j = 1.073412e+06.
Runtime: 201.900389 s.
j = 1.073412e+06.
j = 1.073412e+06.
Runtime: 201.902164 s.
j = 1.073412e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.251e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.656e+00 (tol = 1.000e-10) r (rel) = 1.458e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.326e-01 (tol = 1.000e-10) r (rel) = 6.333e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.109e-03 (tol = 1.000e-10) r (rel) = 2.111e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.798e-08 (tol = 1.000e-10) r (rel) = 3.424e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 155.703928 s.
j = 1.081019e+06.
End of time loop.
Runtime: 155.692271 s.
j = 1.081019e+06.
End of time loop.
Runtime: 155.704465 s.
j = 1.081019e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 155.704843 s.
j = 1.081019e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.550e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.800e+00 (tol = 1.000e-10) r (rel) = 7.061e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.306e-02 (tol = 1.000e-10) r (rel) = 9.044e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.737e-06 (tol = 1.000e-10) r (rel) = 2.642e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.191e-12 (tol = 1.000e-10) r (rel) = 2.036e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 170.238809 s.
j = 1.080369e+06.
Runtime: 170.239388 s.
j = 1.080369e+06.
Start evaluation of j
Runtime: 170.241211 s.
j = 1.080369e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 170.241273 s.
j = 1.080369e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.266e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.487e-01 (tol = 1.000e-10) r (rel) = 3.544e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.512e-03 (tol = 1.000e-10) r (rel) = 1.194e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.062e-08 (tol = 1.000e-10) r (rel) = 2.418e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.488e-12 (tol = 1.000e-10) r (rel) = 1.175e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 178.739333 s.
j = 1.083960e+06.
End of time loop.
End of time loop.
Runtime: 178.740924 s.
j = 1.083960e+06.
Start evaluation of dj
Runtime: 178.742377 s.
Runtime: 178.742911 s.
j = 1.083960e+06.
j = 1.083960e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 39.6938369274 s
Runtime: 39.6938958168 s
|dj| = 3838.36448081
|dj| = 3838.36448081
Start evaluation of j
   52   244    -9.604110E+05     3.400870E+03
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 39.7353959084 s
|dj| = 3838.36448081
Runtime: 39.7365260124 s
|dj| = 3838.36448081
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.773e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.772e+01 (tol = 1.000e-10) r (rel) = 2.280e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.455e+00 (tol = 1.000e-10) r (rel) = 1.872e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.795e-02 (tol = 1.000e-10) r (rel) = 2.309e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.215e-06 (tol = 1.000e-10) r (rel) = 5.423e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.446e-12 (tol = 1.000e-10) r (rel) = 3.147e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 214.892887 s.
j = 8.951485e+05.
Runtime: 214.934733 s.
End of time loop.
j = 8.951485e+05.
Runtime: 214.935387 s.
j = 8.951485e+05.
Start evaluation of j
Runtime: 214.891378 s.
j = 8.951485e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.058e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.679e+01 (tol = 1.000e-10) r (rel) = 2.378e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.270e+00 (tol = 1.000e-10) r (rel) = 1.799e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.265e-02 (tol = 1.000e-10) r (rel) = 1.792e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.336e-06 (tol = 1.000e-10) r (rel) = 1.892e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.622e-12 (tol = 1.000e-10) r (rel) = 2.298e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 214.474512 s.
j = 1.069277e+06.
Runtime: 214.474959 s.
j = 1.069277e+06.
End of time loop.
Runtime: 214.474848 s.
j = 1.069277e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 214.477040 s.
j = 1.069277e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.870e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.528e+00 (tol = 1.000e-10) r (rel) = 1.341e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.519e-01 (tol = 1.000e-10) r (rel) = 5.173e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.843e-04 (tol = 1.000e-10) r (rel) = 1.405e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.446e-09 (tol = 1.000e-10) r (rel) = 1.324e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 162.754899 s.
j = 1.079574e+06.
End of time loop.
End of time loop.
Runtime: 162.757040 s.
Start evaluation of j
j = 1.079574e+06.
Runtime: 162.757153 s.
j = 1.079574e+06.
Updating the turbine cache
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 162.755797 s.
Start evaluation of j
j = 1.079574e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.918e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.004e+00 (tol = 1.000e-10) r (rel) = 5.239e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.569e-03 (tol = 1.000e-10) r (rel) = 3.426e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.735e-07 (tol = 1.000e-10) r (rel) = 2.469e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.530e-12 (tol = 1.000e-10) r (rel) = 7.980e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.723776 s.
j = 1.081579e+06.
Runtime: 169.726629 s.
j = 1.081579e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 169.735949 s.
j = 1.081579e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 169.739885 s.
j = 1.081579e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.543e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.133e-01 (tol = 1.000e-10) r (rel) = 1.731e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.248e-05 (tol = 1.000e-10) r (rel) = 1.260e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.649e-11 (tol = 1.000e-10) r (rel) = 1.322e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 130.632463 s.
j = 1.084149e+06.
Runtime: 130.622777 s.
j = 1.084149e+06.
Runtime: 130.642434 s.
j = 1.084149e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 130.644036 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 1.084149e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.7275919914 s
Runtime: 43.7273230553 s
|dj| = 3758.91690901
|dj| = 3758.91690901
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 43.7681519985 s
|dj| = 3758.91690901
Runtime: 43.7686910629 s
|dj| = 3758.91690901
   53   249    -9.605782E+05     3.330478E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.137e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.714e+01 (tol = 1.000e-10) r (rel) = 2.402e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.310e+00 (tol = 1.000e-10) r (rel) = 1.836e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.103e-02 (tol = 1.000e-10) r (rel) = 1.546e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.531e-07 (tol = 1.000e-10) r (rel) = 1.335e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.555e-12 (tol = 1.000e-10) r (rel) = 2.178e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 226.778372 s.
Runtime: 226.823428 s.
j = 1.002465e+06.
j = 1.002465e+06.
Runtime: 226.823694 s.
j = 1.002465e+06.
Runtime: 226.782527 s.
j = 1.002465e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.136e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.654e+01 (tol = 1.000e-10) r (rel) = 2.318e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.151e+00 (tol = 1.000e-10) r (rel) = 1.612e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.997e-03 (tol = 1.000e-10) r (rel) = 1.401e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.077e-06 (tol = 1.000e-10) r (rel) = 1.510e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.599e-12 (tol = 1.000e-10) r (rel) = 2.240e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 204.740689 s.
j = 1.054612e+06.
End of time loop.
End of time loop.
Runtime: 204.740382 s.
j = 1.054612e+06.
Runtime: 204.741756 s.
Start evaluation of j
j = 1.054612e+06.
Updating the turbine cache
Runtime: 204.741991 s.
j = 1.054612e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.901e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.763e+00 (tol = 1.000e-10) r (rel) = 1.992e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.067e-01 (tol = 1.000e-10) r (rel) = 1.034e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.831e-03 (tol = 1.000e-10) r (rel) = 5.775e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.374e-07 (tol = 1.000e-10) r (rel) = 2.803e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.491e-12 (tol = 1.000e-10) r (rel) = 3.041e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 193.212131 s.
j = 1.083421e+06.
Runtime: 193.213706 s.
j = 1.083421e+06.
Runtime: 193.212784 s.
j = 1.083421e+06.
Runtime: 193.212741 s.
j = 1.083421e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.309e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.074e-01 (tol = 1.000e-10) r (rel) = 5.403e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.584e-03 (tol = 1.000e-10) r (rel) = 2.738e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.703e-07 (tol = 1.000e-10) r (rel) = 1.301e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.498e-12 (tol = 1.000e-10) r (rel) = 1.144e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 168.997247 s.
j = 1.082924e+06.
End of time loop.
Runtime: 168.997772 s.
j = 1.082924e+06.
Runtime: 168.998021 s.
j = 1.082924e+06.
End of time loop.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Runtime: 168.998596 s.
Updating the turbine cache
j = 1.082924e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.404e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.112e-01 (tol = 1.000e-10) r (rel) = 2.852e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.352e-04 (tol = 1.000e-10) r (rel) = 4.527e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.473e-09 (tol = 1.000e-10) r (rel) = 1.989e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 119.414478 s.
End of time loop.
j = 1.083471e+06.
End of time loop.
Runtime: 119.417361 s.
j = 1.083471e+06.
Runtime: 119.417098 s.
Runtime: 119.416788 s.
j = 1.083471e+06.
j = 1.083471e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.762e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.729e-02 (tol = 1.000e-10) r (rel) = 9.883e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.180e-06 (tol = 1.000e-10) r (rel) = 1.875e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.245e-12 (tol = 1.000e-10) r (rel) = 1.537e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 137.890661 s.
j = 1.084275e+06.
Runtime: 137.890400 s.
j = 1.084275e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 137.891135 s.
j = 1.084275e+06.
Runtime: 137.892890 s.
j = 1.084275e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 41.2637941837 s
|dj| = 3743.76749912
Runtime: 41.2665569782 s
|dj| = 3743.76749912
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 41.2983810902 s
|dj| = 3743.76749912
Runtime: 41.3003389835 s
|dj| = 3743.76749912
Start evaluation of j
   54   255    -9.606901E+05     3.317055E+03
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.182e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.681e+01 (tol = 1.000e-10) r (rel) = 2.341e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.384e+00 (tol = 1.000e-10) r (rel) = 1.927e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.999e-02 (tol = 1.000e-10) r (rel) = 2.784e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.984e-06 (tol = 1.000e-10) r (rel) = 1.251e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.225e-12 (tol = 1.000e-10) r (rel) = 8.667e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 216.388299 s.
j = 9.392785e+05.
Runtime: 216.388426 s.
End of time loop.
j = 9.392785e+05.
End of time loop.
Runtime: 216.424575 s.
j = 9.392785e+05.
Runtime: 216.424577 s.
Start evaluation of j
j = 9.392785e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.204e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.573e+01 (tol = 1.000e-10) r (rel) = 2.184e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.111e+00 (tol = 1.000e-10) r (rel) = 1.542e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.361e-02 (tol = 1.000e-10) r (rel) = 1.889e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.110e-06 (tol = 1.000e-10) r (rel) = 5.705e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.258e-12 (tol = 1.000e-10) r (rel) = 3.134e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 215.702391 s.
j = 1.064399e+06.
Runtime: 215.703634 s.
j = 1.064399e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 215.704064 s.
j = 1.064399e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 215.717703 s.
j = 1.064399e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.851e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.973e+00 (tol = 1.000e-10) r (rel) = 1.551e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.054e-01 (tol = 1.000e-10) r (rel) = 5.334e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.792e-04 (tol = 1.000e-10) r (rel) = 9.847e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.792e-09 (tol = 1.000e-10) r (rel) = 4.654e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 176.930699 s.
j = 1.077917e+06.
End of time loop.
End of time loop.
Runtime: 176.946442 s.
j = 1.077917e+06.
Start evaluation of j
Runtime: 176.946715 s.
j = 1.077917e+06.
Updating the turbine cache
End of time loop.
Runtime: 176.945170 s.
j = 1.077917e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.449e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.054e+00 (tol = 1.000e-10) r (rel) = 7.277e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.248e-02 (tol = 1.000e-10) r (rel) = 8.617e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.324e-06 (tol = 1.000e-10) r (rel) = 2.295e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.986e-12 (tol = 1.000e-10) r (rel) = 2.061e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 172.260212 s.
j = 1.083462e+06.
End of time loop.
End of time loop.
Runtime: 172.244836 s.
j = 1.083462e+06.
Start evaluation of j
Runtime: 172.259459 s.
Runtime: 172.258244 s.
j = 1.083462e+06.
j = 1.083462e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.713e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.692e-02 (tol = 1.000e-10) r (rel) = 1.802e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.571e-05 (tol = 1.000e-10) r (rel) = 1.770e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.058e-10 (tol = 1.000e-10) r (rel) = 2.848e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 128.608391 s.
j = 1.084473e+06.
End of time loop.
End of time loop.
Runtime: 128.608154 s.
j = 1.084473e+06.
Runtime: 128.607740 s.
j = 1.084473e+06.
Start evaluation of dj
Runtime: 128.607954 s.
found a tidal farm, computing gradient
j = 1.084473e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.7529640198 s
|dj| = 3567.27723385
Start evaluation of j
Updating the turbine cache
Runtime: 45.7842950821 s
|dj| = 3567.27723385
Start evaluation of j
Updating the turbine cache
Runtime: 45.822496891 s
|dj| = 3567.27723385
Start evaluation of j
Updating the turbine cache
Runtime: 45.8372180462 s
|dj| = 3567.27723385
   55   260    -9.608658E+05     3.160681E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.133e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.612e+01 (tol = 1.000e-10) r (rel) = 2.260e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.140e+00 (tol = 1.000e-10) r (rel) = 1.598e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.259e-03 (tol = 1.000e-10) r (rel) = 1.298e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.246e-06 (tol = 1.000e-10) r (rel) = 1.746e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.714e-12 (tol = 1.000e-10) r (rel) = 2.403e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 208.802545 s.
j = 9.736655e+05.
End of time loop.
Runtime: 208.873227 s.
j = 9.736655e+05.
Runtime: 208.842376 s.
j = 9.736655e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 208.790326 s.
Start evaluation of j
j = 9.736655e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.983e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.640e+01 (tol = 1.000e-10) r (rel) = 2.349e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.247e+00 (tol = 1.000e-10) r (rel) = 1.786e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.446e-02 (tol = 1.000e-10) r (rel) = 2.070e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.053e-06 (tol = 1.000e-10) r (rel) = 4.372e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.814e-12 (tol = 1.000e-10) r (rel) = 2.598e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 212.058990 s.
j = 1.067430e+06.
End of time loop.
End of time loop.
Runtime: 212.059661 s.
j = 1.067430e+06.
Runtime: 212.058648 s.
Start evaluation of j
j = 1.067430e+06.
Runtime: 212.057307 s.
Updating the turbine cache
j = 1.067430e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.144e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.404e+00 (tol = 1.000e-10) r (rel) = 1.828e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.102e-01 (tol = 1.000e-10) r (rel) = 7.974e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.514e-03 (tol = 1.000e-10) r (rel) = 2.943e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.196e-08 (tol = 1.000e-10) r (rel) = 6.213e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 172.768546 s.
j = 1.079580e+06.
End of time loop.
End of time loop.
Runtime: 172.767645 s.
j = 1.079580e+06.
Start evaluation of j
Runtime: 172.768392 s.
j = 1.079580e+06.
Updating the turbine cache
Runtime: 172.767912 s.
j = 1.079580e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.794e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.648e+00 (tol = 1.000e-10) r (rel) = 9.479e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.360e-02 (tol = 1.000e-10) r (rel) = 1.560e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.094e-05 (tol = 1.000e-10) r (rel) = 1.107e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.513e-11 (tol = 1.000e-10) r (rel) = 8.993e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 160.312075 s.
j = 1.082368e+06.
Runtime: 160.312770 s.
j = 1.082368e+06.
End of time loop.
Start evaluation of j
Runtime: 160.312929 s.
j = 1.082368e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 160.315131 s.
j = 1.082368e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.268e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.150e-01 (tol = 1.000e-10) r (rel) = 4.060e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.836e-03 (tol = 1.000e-10) r (rel) = 1.448e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.442e-08 (tol = 1.000e-10) r (rel) = 4.291e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.487e-12 (tol = 1.000e-10) r (rel) = 1.173e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 168.389402 s.
j = 1.083368e+06.
Runtime: 168.388283 s.
j = 1.083368e+06.
Runtime: 168.387054 s.
j = 1.083368e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 168.397605 s.
j = 1.083368e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.239e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.363e-02 (tol = 1.000e-10) r (rel) = 1.596e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.904e-05 (tol = 1.000e-10) r (rel) = 9.361e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.310e-11 (tol = 1.000e-10) r (rel) = 8.227e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 134.047749 s.
j = 1.084985e+06.
End of time loop.
Runtime: 134.047609 s.
j = 1.084985e+06.
End of time loop.
Runtime: 134.039817 s.
j = 1.084985e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 134.049155 s.
j = 1.084985e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 41.9554390907 s
|dj| = 3427.48869344
Runtime: 41.9554710388 s
|dj| = 3427.48869344
Start evaluation of j
Updating the turbine cache
   56   266    -9.613187E+05     3.036825E+03
Start evaluation of j
Updating the turbine cache
Runtime: 41.9842739105 s
|dj| = 3427.48869344
Start evaluation of j
Updating the turbine cache
Runtime: 41.9949808121 s
|dj| = 3427.48869344
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.032e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.646e+01 (tol = 1.000e-10) r (rel) = 2.340e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.168e+00 (tol = 1.000e-10) r (rel) = 1.662e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.695e-03 (tol = 1.000e-10) r (rel) = 1.237e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.762e-07 (tol = 1.000e-10) r (rel) = 8.194e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.532e-12 (tol = 1.000e-10) r (rel) = 2.179e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 216.431094 s.
j = 9.920929e+05.
Runtime: 216.470902 s.
j = 9.920929e+05.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 216.471088 s.
j = 9.920929e+05.
Updating the turbine cache
Updating the turbine cache
Runtime: 216.441403 s.
j = 9.920929e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.991e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.507e+01 (tol = 1.000e-10) r (rel) = 2.156e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.101e+00 (tol = 1.000e-10) r (rel) = 1.575e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.215e-02 (tol = 1.000e-10) r (rel) = 1.738e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.687e-06 (tol = 1.000e-10) r (rel) = 5.274e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.256e-12 (tol = 1.000e-10) r (rel) = 3.226e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 219.089678 s.
j = 1.002759e+06.
End of time loop.
Start evaluation of j
End of time loop.
Updating the turbine cache
End of time loop.
Runtime: 219.091061 s.
Runtime: 219.089865 s.
j = 1.002759e+06.
Start evaluation of j
Updating the turbine cache
j = 1.002759e+06.
Runtime: 219.097372 s.
j = 1.002759e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.125e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.323e+01 (tol = 1.000e-10) r (rel) = 2.160e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.178e-01 (tol = 1.000e-10) r (rel) = 1.499e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.461e-03 (tol = 1.000e-10) r (rel) = 1.381e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.157e-06 (tol = 1.000e-10) r (rel) = 1.888e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.554e-12 (tol = 1.000e-10) r (rel) = 2.537e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 215.057647 s.
j = 1.069371e+06.
Runtime: 215.069248 s.
Runtime: 215.058570 s.
j = 1.069371e+06.
j = 1.069371e+06.
Runtime: 215.060924 s.
j = 1.069371e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.055e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.737e+00 (tol = 1.000e-10) r (rel) = 1.223e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.762e-02 (tol = 1.000e-10) r (rel) = 3.195e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.281e-04 (tol = 1.000e-10) r (rel) = 4.193e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.222e-10 (tol = 1.000e-10) r (rel) = 1.054e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 166.973994 s.
Runtime: 166.974003 s.
j = 1.081988e+06.
j = 1.081988e+06.
Runtime: 166.974160 s.
j = 1.081988e+06.
Runtime: 166.973213 s.
j = 1.081988e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.763e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.135e-01 (tol = 1.000e-10) r (rel) = 3.577e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.843e-04 (tol = 1.000e-10) r (rel) = 8.950e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.516e-09 (tol = 1.000e-10) r (rel) = 9.718e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 144.506508 s.
j = 1.084614e+06.
End of time loop.
Runtime: 144.506376 s.
j = 1.084614e+06.
Start evaluation of j
Runtime: 144.507122 s.
j = 1.084614e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 144.507203 s.
Start evaluation of j
j = 1.084614e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.379e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.222e-02 (tol = 1.000e-10) r (rel) = 9.340e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.912e-06 (tol = 1.000e-10) r (rel) = 1.645e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.830e-12 (tol = 1.000e-10) r (rel) = 1.610e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 127.240381 s.
j = 1.085294e+06.
End of time loop.
End of time loop.
Runtime: 127.242564 s.
Runtime: 127.243941 s.
j = 1.085294e+06.
Runtime: 127.243838 s.
j = 1.085294e+06.
j = 1.085294e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.0239191055 s
|dj| = 3274.77946781
Start evaluation of j
Updating the turbine cache
Runtime: 45.0280580521 s
|dj| = 3274.77946781
   57   272    -9.615929E+05     2.901522E+03
Start evaluation of j
Updating the turbine cache
Runtime: 45.0615389347 s
|dj| = 3274.77946781
Runtime: 45.0630960464 s
|dj| = 3274.77946781
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.441e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.835e+01 (tol = 1.000e-10) r (rel) = 2.466e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.548e+00 (tol = 1.000e-10) r (rel) = 2.081e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.761e-02 (tol = 1.000e-10) r (rel) = 2.366e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.375e-06 (tol = 1.000e-10) r (rel) = 4.536e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.220e-12 (tol = 1.000e-10) r (rel) = 2.983e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 207.808531 s.
End of time loop.
Runtime: 207.810355 s.
j = 9.246993e+05.
j = 9.246993e+05.
Runtime: 207.850010 s.
j = 9.246993e+05.
Runtime: 207.846604 s.
Start evaluation of j
j = 9.246993e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.453e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.823e+01 (tol = 1.000e-10) r (rel) = 2.446e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.456e+00 (tol = 1.000e-10) r (rel) = 1.954e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.584e-02 (tol = 1.000e-10) r (rel) = 2.125e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.817e-06 (tol = 1.000e-10) r (rel) = 2.438e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.628e-12 (tol = 1.000e-10) r (rel) = 2.184e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 207.325939 s.
j = 1.054930e+06.
End of time loop.
End of time loop.
Runtime: 207.325722 s.
j = 1.054930e+06.
Runtime: 207.325839 s.
Start evaluation of j
j = 1.054930e+06.
Updating the turbine cache
Runtime: 207.327319 s.
j = 1.054930e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.729e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.207e+01 (tol = 1.000e-10) r (rel) = 2.107e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.039e-01 (tol = 1.000e-10) r (rel) = 1.229e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.202e-03 (tol = 1.000e-10) r (rel) = 9.079e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.920e-07 (tol = 1.000e-10) r (rel) = 1.033e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.521e-12 (tol = 1.000e-10) r (rel) = 2.656e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 207.012706 s.
j = 1.077727e+06.
Runtime: 207.013202 s.
j = 1.077727e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 207.015073 s.
j = 1.077727e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 207.014536 s.
j = 1.077727e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.990e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.970e+00 (tol = 1.000e-10) r (rel) = 9.900e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.892e-02 (tol = 1.000e-10) r (rel) = 1.454e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.062e-05 (tol = 1.000e-10) r (rel) = 5.338e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.652e-12 (tol = 1.000e-10) r (rel) = 4.851e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 167.019303 s.
j = 1.079651e+06.
End of time loop.
Runtime: 167.022012 s.
j = 1.079651e+06.
Runtime: 167.022523 s.
j = 1.079651e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 167.022528 s.
Start evaluation of j
j = 1.079651e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.638e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.205e-01 (tol = 1.000e-10) r (rel) = 3.321e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.819e-04 (tol = 1.000e-10) r (rel) = 5.754e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.898e-09 (tol = 1.000e-10) r (rel) = 2.859e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 120.340025 s.
j = 1.085321e+06.
End of time loop.
Runtime: 120.337624 s.
j = 1.085321e+06.
End of time loop.
Start evaluation of j
Runtime: 120.340775 s.
j = 1.085321e+06.
Runtime: 120.339667 s.
Updating the turbine cache
j = 1.085321e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.875e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.754e-03 (tol = 1.000e-10) r (rel) = 2.986e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.495e-08 (tol = 1.000e-10) r (rel) = 4.247e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 2.542e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 129.840941 s.
j = 1.085408e+06.
End of time loop.
Runtime: 129.840375 s.
j = 1.085408e+06.
Runtime: 129.840666 s.
j = 1.085408e+06.
Start evaluation of dj
End of time loop.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 129.841325 s.
j = 1.085408e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 46.9477479458 s
|dj| = 3237.84423223
Start evaluation of j
Runtime: 46.9514420033 s
|dj| = 3237.84423223
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 46.9867188931 s
|dj| = 3237.84423223
Start evaluation of j
Updating the turbine cache
Runtime: 46.9911539555 s
|dj| = 3237.84423223
   58   278    -9.616938E+05     2.868797E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.696e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.386e+01 (tol = 1.000e-10) r (rel) = 2.071e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.148e-01 (tol = 1.000e-10) r (rel) = 1.366e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.040e-03 (tol = 1.000e-10) r (rel) = 1.051e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.584e-07 (tol = 1.000e-10) r (rel) = 1.133e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.542e-12 (tol = 1.000e-10) r (rel) = 2.303e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 228.518548 s.
j = 1.084615e+06.
End of time loop.
Runtime: 228.561721 s.
j = 1.084615e+06.
Runtime: 228.559862 s.
j = 1.084615e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 228.524831 s.
j = 1.084615e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.886e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.817e+00 (tol = 1.000e-10) r (rel) = 2.009e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.100e-01 (tol = 1.000e-10) r (rel) = 1.044e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.762e-03 (tol = 1.000e-10) r (rel) = 5.654e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.216e-07 (tol = 1.000e-10) r (rel) = 2.490e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 3.056e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 235.143390 s.
j = 1.085449e+06.
Runtime: 235.145994 s.
j = 1.085449e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 235.147749 s.
Updating the turbine cache
j = 1.085449e+06.
Updating the turbine cache
End of time loop.
Runtime: 235.148798 s.
j = 1.085449e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.867e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.509e+00 (tol = 1.000e-10) r (rel) = 1.683e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.566e-01 (tol = 1.000e-10) r (rel) = 6.635e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.662e-04 (tol = 1.000e-10) r (rel) = 2.240e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.492e-08 (tol = 1.000e-10) r (rel) = 3.858e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.256699 s.
j = 1.083475e+06.
End of time loop.
Runtime: 169.256886 s.
j = 1.083475e+06.
Runtime: 169.255938 s.
j = 1.083475e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 169.255685 s.
Start evaluation of j
j = 1.083475e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.955e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.715e+00 (tol = 1.000e-10) r (rel) = 1.257e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.802e-02 (tol = 1.000e-10) r (rel) = 2.979e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.214e-04 (tol = 1.000e-10) r (rel) = 4.110e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.767e-10 (tol = 1.000e-10) r (rel) = 1.275e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 181.601212 s.
j = 1.082980e+06.
Runtime: 181.598710 s.
j = 1.082980e+06.
End of time loop.
Start evaluation of j
End of time loop.
Runtime: 181.600724 s.
Updating the turbine cache
j = 1.082980e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 181.602706 s.
j = 1.082980e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.857e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.425e+00 (tol = 1.000e-10) r (rel) = 7.671e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.371e-02 (tol = 1.000e-10) r (rel) = 7.380e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.506e-06 (tol = 1.000e-10) r (rel) = 1.349e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.944e-12 (tol = 1.000e-10) r (rel) = 1.046e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.126519 s.
j = 1.084578e+06.
End of time loop.
Runtime: 169.124371 s.
j = 1.084578e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 169.135202 s.
j = 1.084578e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 169.142617 s.
j = 1.084578e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.280e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.570e-01 (tol = 1.000e-10) r (rel) = 3.104e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.126e-04 (tol = 1.000e-10) r (rel) = 6.191e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.038e-09 (tol = 1.000e-10) r (rel) = 4.877e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 131.738987 s.
j = 1.085470e+06.
End of time loop.
Runtime: 131.747314 s.
j = 1.085470e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 131.729391 s.
j = 1.085470e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 131.750470 s.
j = 1.085470e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.896e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.047e-02 (tol = 1.000e-10) r (rel) = 1.052e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.192e-06 (tol = 1.000e-10) r (rel) = 2.829e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.816e-12 (tol = 1.000e-10) r (rel) = 1.663e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 132.253903 s.
j = 1.085455e+06.
End of time loop.
End of time loop.
Runtime: 132.256750 s.
j = 1.085455e+06.
Runtime: 132.258320 s.
j = 1.085455e+06.
Runtime: 132.257509 s.
j = 1.085455e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.413e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.537e-03 (tol = 1.000e-10) r (rel) = 4.626e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.309e-07 (tol = 1.000e-10) r (rel) = 2.341e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.502e-12 (tol = 1.000e-10) r (rel) = 1.063e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 152.132473 s.
j = 1.085547e+06.
Runtime: 152.130798 s.
j = 1.085547e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 152.133538 s.
j = 1.085547e+06.
Runtime: 152.134708 s.
j = 1.085547e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 46.0424580574 s
|dj| = 3166.56077009
Runtime: 46.04717803 s
|dj| = 3166.56077009
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 46.0753500462 s
|dj| = 3166.56077009
Start evaluation of j
Updating the turbine cache
Runtime: 46.0792770386 s
|dj| = 3166.56077009
   59   286    -9.618172E+05     2.805638E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.128e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.357e+01 (tol = 1.000e-10) r (rel) = 2.214e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.555e-01 (tol = 1.000e-10) r (rel) = 1.396e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.296e-03 (tol = 1.000e-10) r (rel) = 8.641e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.394e-07 (tol = 1.000e-10) r (rel) = 5.539e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.518e-12 (tol = 1.000e-10) r (rel) = 2.478e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 191.036411 s.
End of time loop.
Runtime: 191.006383 s.
j = 1.057055e+06.
j = 1.057055e+06.
End of time loop.
Runtime: 191.038708 s.
j = 1.057055e+06.
Start evaluation of j
Runtime: 191.001409 s.
j = 1.057055e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.876e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.115e+01 (tol = 1.000e-10) r (rel) = 1.898e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.129e-01 (tol = 1.000e-10) r (rel) = 1.043e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.550e-03 (tol = 1.000e-10) r (rel) = 6.042e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.671e-07 (tol = 1.000e-10) r (rel) = 2.843e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 2.542e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 222.505605 s.
j = 1.077664e+06.
End of time loop.
End of time loop.
Runtime: 222.505839 s.
Runtime: 222.506769 s.
j = 1.077664e+06.
j = 1.077664e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 222.507601 s.
j = 1.077664e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.254e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.036e+00 (tol = 1.000e-10) r (rel) = 1.419e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.672e-01 (tol = 1.000e-10) r (rel) = 6.281e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.226e-03 (tol = 1.000e-10) r (rel) = 2.882e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.680e-08 (tol = 1.000e-10) r (rel) = 8.652e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 176.430736 s.
j = 1.078322e+06.
Runtime: 176.431193 s.
j = 1.078322e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 176.432729 s.
Updating the turbine cache
j = 1.078322e+06.
Updating the turbine cache
End of time loop.
Runtime: 176.432129 s.
j = 1.078322e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.852e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.916e+00 (tol = 1.000e-10) r (rel) = 1.022e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.057e-01 (tol = 1.000e-10) r (rel) = 3.705e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.095e-04 (tol = 1.000e-10) r (rel) = 1.085e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.803e-09 (tol = 1.000e-10) r (rel) = 9.827e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 175.234716 s.
End of time loop.
End of time loop.
Runtime: 175.232101 s.
j = 1.083669e+06.
j = 1.083669e+06.
Runtime: 175.235296 s.
Runtime: 175.234020 s.
j = 1.083669e+06.
j = 1.083669e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.097e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.690e-01 (tol = 1.000e-10) r (rel) = 4.276e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.454e-03 (tol = 1.000e-10) r (rel) = 3.149e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.369e-07 (tol = 1.000e-10) r (rel) = 3.072e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.496e-12 (tol = 1.000e-10) r (rel) = 1.364e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.384001 s.
j = 1.085891e+06.
End of time loop.
Runtime: 169.384810 s.
End of time loop.
j = 1.085891e+06.
Runtime: 169.384723 s.
Start evaluation of dj
j = 1.085891e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 169.391786 s.
j = 1.085891e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 52.1809098721 s
|dj| = 3175.45126059
Start evaluation of j
Updating the turbine cache
Runtime: 52.2156291008 s
|dj| = 3175.45126059
Start evaluation of j
Updating the turbine cache
Runtime: 52.2207760811 s
|dj| = 3175.45126059
Runtime: 52.2213928699 s
|dj| = 3175.45126059
   60   291    -9.621220E+05     2.813515E+03
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.042e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.405e+01 (tol = 1.000e-10) r (rel) = 1.995e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.286e-01 (tol = 1.000e-10) r (rel) = 1.319e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.301e-03 (tol = 1.000e-10) r (rel) = 1.037e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.657e-07 (tol = 1.000e-10) r (rel) = 9.454e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.534e-12 (tol = 1.000e-10) r (rel) = 2.178e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 216.246815 s.
j = 1.033115e+06.
End of time loop.
Runtime: 216.239861 s.
j = 1.033115e+06.
Runtime: 216.275019 s.
j = 1.033115e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 216.242168 s.
Start evaluation of j
j = 1.033115e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.757e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.288e+01 (tol = 1.000e-10) r (rel) = 2.238e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.759e-01 (tol = 1.000e-10) r (rel) = 1.348e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.743e-03 (tol = 1.000e-10) r (rel) = 8.239e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.988e-07 (tol = 1.000e-10) r (rel) = 3.453e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.497e-12 (tol = 1.000e-10) r (rel) = 2.601e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 219.821890 s.
j = 1.075103e+06.
End of time loop.
Runtime: 219.819583 s.
j = 1.075103e+06.
End of time loop.
Runtime: 219.822632 s.
Start evaluation of j
j = 1.075103e+06.
Updating the turbine cache
Runtime: 219.821863 s.
j = 1.075103e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.278e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.051e+00 (tol = 1.000e-10) r (rel) = 1.236e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.212e-01 (tol = 1.000e-10) r (rel) = 3.697e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.891e-04 (tol = 1.000e-10) r (rel) = 8.819e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.226e-09 (tol = 1.000e-10) r (rel) = 6.792e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 170.541345 s.
j = 1.080628e+06.
End of time loop.
End of time loop.
Runtime: 170.541446 s.
j = 1.080628e+06.
Runtime: 170.542851 s.
j = 1.080628e+06.
Start evaluation of j
Runtime: 170.541420 s.
Updating the turbine cache
j = 1.080628e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.391e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.910e-01 (tol = 1.000e-10) r (rel) = 4.967e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.600e-03 (tol = 1.000e-10) r (rel) = 3.307e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.659e-07 (tol = 1.000e-10) r (rel) = 3.349e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.503e-12 (tol = 1.000e-10) r (rel) = 1.081e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 165.403611 s.
j = 1.086088e+06.
End of time loop.
Runtime: 165.402974 s.
j = 1.086088e+06.
Runtime: 165.402436 s.
j = 1.086088e+06.
Runtime: 165.402808 s.
j = 1.086088e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 41.1106219292 s
|dj| = 3157.48881479
Runtime: 41.1129219532 s
|dj| = 3157.48881479
Start evaluation of j
Updating the turbine cache
   61   295    -9.622965E+05     2.797600E+03
Start evaluation of j
Updating the turbine cache
Runtime: 41.1457829475 s
|dj| = 3157.48881479
Start evaluation of j
Updating the turbine cache
Runtime: 41.149916172 s
|dj| = 3157.48881479
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.052e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.514e+01 (tol = 1.000e-10) r (rel) = 2.147e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.007e+00 (tol = 1.000e-10) r (rel) = 1.428e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.841e-03 (tol = 1.000e-10) r (rel) = 9.700e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.739e-07 (tol = 1.000e-10) r (rel) = 6.719e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.523e-12 (tol = 1.000e-10) r (rel) = 2.160e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 221.205315 s.
j = 1.059605e+06.
Runtime: 221.244439 s.
j = 1.059605e+06.
Runtime: 221.209616 s.
j = 1.059605e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 221.248591 s.
j = 1.059605e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.949e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.223e+01 (tol = 1.000e-10) r (rel) = 2.055e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.025e-01 (tol = 1.000e-10) r (rel) = 1.181e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.981e-03 (tol = 1.000e-10) r (rel) = 6.691e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.856e-07 (tol = 1.000e-10) r (rel) = 3.120e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.496e-12 (tol = 1.000e-10) r (rel) = 2.515e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 199.802043 s.
j = 1.079546e+06.
End of time loop.
End of time loop.
Runtime: 199.801462 s.
j = 1.079546e+06.
Start evaluation of j
Runtime: 199.802585 s.
j = 1.079546e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 199.806051 s.
j = 1.079546e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.610e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.125e+00 (tol = 1.000e-10) r (rel) = 1.420e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.486e-01 (tol = 1.000e-10) r (rel) = 4.117e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.008e-04 (tol = 1.000e-10) r (rel) = 5.563e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.320e-10 (tol = 1.000e-10) r (rel) = 1.751e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 180.722514 s.
j = 1.080974e+06.
Runtime: 180.723727 s.
j = 1.080974e+06.
Start evaluation of j
Runtime: 180.722548 s.
j = 1.080974e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 180.719537 s.
j = 1.080974e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.956e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.707e+00 (tol = 1.000e-10) r (rel) = 8.725e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.176e-02 (tol = 1.000e-10) r (rel) = 1.112e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.346e-06 (tol = 1.000e-10) r (rel) = 3.244e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.508e-12 (tol = 1.000e-10) r (rel) = 2.305e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 165.678021 s.
j = 1.083402e+06.
Runtime: 165.679100 s.
Runtime: 165.679632 s.
j = 1.083402e+06.
j = 1.083402e+06.
Runtime: 165.676501 s.
j = 1.083402e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.296e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.395e-01 (tol = 1.000e-10) r (rel) = 3.282e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.145e-04 (tol = 1.000e-10) r (rel) = 9.793e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.171e-08 (tol = 1.000e-10) r (rel) = 1.605e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.489e-12 (tol = 1.000e-10) r (rel) = 2.041e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 180.167582 s.
j = 1.086229e+06.
Runtime: 180.167561 s.
j = 1.086229e+06.
Runtime: 180.168645 s.
j = 1.086229e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 180.173420 s.
j = 1.086229e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.7595591545 s
|dj| = 3083.75333983
Runtime: 45.7661981583 s
|dj| = 3083.75333983
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 45.796683073 s
|dj| = 3083.75333983
Start evaluation of j
Updating the turbine cache
Runtime: 45.8027398586 s
|dj| = 3083.75333983
   62   300    -9.624209E+05     2.732269E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.102e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.402e+01 (tol = 1.000e-10) r (rel) = 1.974e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.513e-01 (tol = 1.000e-10) r (rel) = 1.339e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.164e-03 (tol = 1.000e-10) r (rel) = 1.009e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.329e-07 (tol = 1.000e-10) r (rel) = 7.503e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.512e-12 (tol = 1.000e-10) r (rel) = 2.130e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 212.082952 s.
j = 1.043813e+06.
Runtime: 212.090865 s.
End of time loop.
End of time loop.
j = 1.043813e+06.
Start evaluation of j
Runtime: 212.123370 s.
Runtime: 212.123767 s.
j = 1.043813e+06.
j = 1.043813e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.899e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.158e+01 (tol = 1.000e-10) r (rel) = 2.365e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.951e-01 (tol = 1.000e-10) r (rel) = 1.215e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.555e-03 (tol = 1.000e-10) r (rel) = 5.215e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.264e-08 (tol = 1.000e-10) r (rel) = 1.279e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.486e-12 (tol = 1.000e-10) r (rel) = 3.033e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 238.549501 s.
j = 1.079003e+06.
Runtime: 238.550325 s.
j = 1.079003e+06.
Runtime: 238.549706 s.
j = 1.079003e+06.
Runtime: 238.551634 s.
j = 1.079003e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.479e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.594e+00 (tol = 1.000e-10) r (rel) = 1.853e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.279e-01 (tol = 1.000e-10) r (rel) = 5.158e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.697e-04 (tol = 1.000e-10) r (rel) = 6.845e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.116e-10 (tol = 1.000e-10) r (rel) = 1.257e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 179.293559 s.
End of time loop.
End of time loop.
j = 1.081784e+06.
Runtime: 179.294241 s.
Runtime: 179.293006 s.
j = 1.081784e+06.
j = 1.081784e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 179.319460 s.
j = 1.081784e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.498e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.703e+00 (tol = 1.000e-10) r (rel) = 1.137e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.314e-02 (tol = 1.000e-10) r (rel) = 1.544e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.409e-06 (tol = 1.000e-10) r (rel) = 4.278e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.211e-12 (tol = 1.000e-10) r (rel) = 2.811e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 167.943225 s.
j = 1.085183e+06.
End of time loop.
End of time loop.
Runtime: 167.944670 s.
j = 1.085183e+06.
Runtime: 167.943886 s.
Start evaluation of j
j = 1.085183e+06.
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 167.914902 s.
j = 1.085183e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.981e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.080e-01 (tol = 1.000e-10) r (rel) = 3.478e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.542e-04 (tol = 1.000e-10) r (rel) = 9.265e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.229e-09 (tol = 1.000e-10) r (rel) = 1.209e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.489e-12 (tol = 1.000e-10) r (rel) = 2.489e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 157.773539 s.
j = 1.086094e+06.
End of time loop.
End of time loop.
Runtime: 157.773204 s.
j = 1.086094e+06.
Start evaluation of j
Runtime: 157.773300 s.
j = 1.086094e+06.
Runtime: 157.766070 s.
Updating the turbine cache
j = 1.086094e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.703e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.375e-02 (tol = 1.000e-10) r (rel) = 8.076e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.432e-06 (tol = 1.000e-10) r (rel) = 1.428e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.872e-12 (tol = 1.000e-10) r (rel) = 1.100e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 135.073840 s.
j = 1.086342e+06.
Runtime: 135.074145 s.
j = 1.086342e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Runtime: 135.074837 s.
j = 1.086342e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 135.076701 s.
j = 1.086342e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 50.1566560268 s
|dj| = 2975.75496528
Runtime: 50.1593039036 s
|dj| = 2975.75496528
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Runtime: 50.1637051105 s
Runtime: 50.1611940861 s
Updating the turbine cache
|dj| = 2975.75496528
|dj| = 2975.75496528
   63   306    -9.625217E+05     2.636580E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.196e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.018e+01 (tol = 1.000e-10) r (rel) = 1.959e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.681e-01 (tol = 1.000e-10) r (rel) = 1.093e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.352e-03 (tol = 1.000e-10) r (rel) = 8.376e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.851e-07 (tol = 1.000e-10) r (rel) = 9.336e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.522e-12 (tol = 1.000e-10) r (rel) = 2.929e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 225.832601 s.
j = 1.081160e+06.
End of time loop.
Runtime: 225.828113 s.
j = 1.081160e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 225.829497 s.
j = 1.081160e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 225.835972 s.
j = 1.081160e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.346e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.179e+00 (tol = 1.000e-10) r (rel) = 1.652e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.693e-01 (tol = 1.000e-10) r (rel) = 8.497e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.225e-03 (tol = 1.000e-10) r (rel) = 5.118e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.278e-07 (tol = 1.000e-10) r (rel) = 2.941e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.492e-12 (tol = 1.000e-10) r (rel) = 3.432e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 221.455759 s.
j = 1.082574e+06.
End of time loop.
End of time loop.
Runtime: 221.457271 s.
j = 1.082574e+06.
Start evaluation of j
Runtime: 221.455080 s.
Updating the turbine cache
j = 1.082574e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 221.460315 s.
j = 1.082574e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.622e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.687e+00 (tol = 1.000e-10) r (rel) = 1.025e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.942e-02 (tol = 1.000e-10) r (rel) = 2.648e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.603e-05 (tol = 1.000e-10) r (rel) = 3.663e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.351e-10 (tol = 1.000e-10) r (rel) = 8.967e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 173.173315 s.
j = 1.082672e+06.
End of time loop.
End of time loop.
Runtime: 173.182459 s.
j = 1.082672e+06.
Runtime: 173.182124 s.
Runtime: 173.180558 s.
j = 1.082672e+06.
j = 1.082672e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.270e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.504e-01 (tol = 1.000e-10) r (rel) = 5.120e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.501e-03 (tol = 1.000e-10) r (rel) = 3.543e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.475e-07 (tol = 1.000e-10) r (rel) = 3.522e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.518e-12 (tol = 1.000e-10) r (rel) = 1.195e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 175.630163 s.
j = 1.085733e+06.
Runtime: 175.629607 s.
j = 1.085733e+06.
End of time loop.
End of time loop.
Runtime: 175.631274 s.
j = 1.085733e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 175.631059 s.
j = 1.085733e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.164e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.859e-02 (tol = 1.000e-10) r (rel) = 1.220e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.458e-05 (tol = 1.000e-10) r (rel) = 4.610e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.075e-12 (tol = 1.000e-10) r (rel) = 2.868e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 137.895165 s.
j = 1.086566e+06.
End of time loop.
Runtime: 137.895172 s.
j = 1.086566e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 137.899882 s.
j = 1.086566e+06.
End of time loop.
Runtime: 137.899230 s.
j = 1.086566e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 47.326157093 s
|dj| = 2899.61369562
Runtime: 47.3234758377 s
|dj| = 2899.61369562
Runtime: 47.325122118 s
|dj| = 2899.61369562
Runtime: 47.3275110722 s
|dj| = 2899.61369562
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   64   311    -9.627202E+05     2.569117E+03
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.196e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.475e+01 (tol = 1.000e-10) r (rel) = 2.381e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.503e-01 (tol = 1.000e-10) r (rel) = 1.534e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.483e-03 (tol = 1.000e-10) r (rel) = 1.046e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.642e-07 (tol = 1.000e-10) r (rel) = 5.879e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.511e-12 (tol = 1.000e-10) r (rel) = 2.439e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 232.180720 s.
j = 1.065724e+06.
End of time loop.
End of time loop.
Runtime: 232.181390 s.
j = 1.065724e+06.
Runtime: 232.182533 s.
Start evaluation of j
j = 1.065724e+06.
Updating the turbine cache
Runtime: 232.181477 s.
j = 1.065724e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.631e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.257e+01 (tol = 1.000e-10) r (rel) = 1.895e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.530e-01 (tol = 1.000e-10) r (rel) = 1.136e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.415e-03 (tol = 1.000e-10) r (rel) = 8.166e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.924e-07 (tol = 1.000e-10) r (rel) = 7.426e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.520e-12 (tol = 1.000e-10) r (rel) = 2.292e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 222.204088 s.
j = 1.082160e+06.
Runtime: 222.203689 s.
j = 1.082160e+06.
Runtime: 222.205586 s.
j = 1.082160e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 222.220287 s.
j = 1.082160e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.387e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.557e+00 (tol = 1.000e-10) r (rel) = 1.267e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.277e-01 (tol = 1.000e-10) r (rel) = 5.189e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.717e-04 (tol = 1.000e-10) r (rel) = 1.987e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.665e-08 (tol = 1.000e-10) r (rel) = 3.796e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 183.229553 s.
j = 1.082850e+06.
End of time loop.
End of time loop.
Runtime: 183.231093 s.
j = 1.082850e+06.
Runtime: 183.231948 s.
j = 1.082850e+06.
Runtime: 183.215086 s.
j = 1.082850e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.593e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.061e+00 (tol = 1.000e-10) r (rel) = 7.949e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.020e-02 (tol = 1.000e-10) r (rel) = 1.936e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.390e-05 (tol = 1.000e-10) r (rel) = 2.464e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.128e-10 (tol = 1.000e-10) r (rel) = 4.350e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 173.401398 s.
j = 1.083018e+06.
End of time loop.
End of time loop.
Runtime: 173.401978 s.
Runtime: 173.403195 s.
j = 1.083018e+06.
Start evaluation of j
j = 1.083018e+06.
Updating the turbine cache
Runtime: 173.402740 s.
j = 1.083018e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.130e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.124e-01 (tol = 1.000e-10) r (rel) = 3.648e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.156e-03 (tol = 1.000e-10) r (rel) = 1.907e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.213e-07 (tol = 1.000e-10) r (rel) = 1.073e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.490e-12 (tol = 1.000e-10) r (rel) = 1.318e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 174.157080 s.
j = 1.086372e+06.
Runtime: 174.156139 s.
j = 1.086372e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 174.156547 s.
Updating the turbine cache
j = 1.086372e+06.
Updating the turbine cache
End of time loop.
Runtime: 174.157698 s.
j = 1.086372e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.769e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.084e-02 (tol = 1.000e-10) r (rel) = 6.131e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.433e-06 (tol = 1.000e-10) r (rel) = 8.104e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.619e-12 (tol = 1.000e-10) r (rel) = 9.155e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 135.224068 s.
j = 1.086645e+06.
Runtime: 135.225495 s.
j = 1.086645e+06.
Runtime: 135.225627 s.
j = 1.086645e+06.
Runtime: 135.223391 s.
j = 1.086645e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.8937418461 s
Runtime: 43.8937690258 s
|dj| = 2883.63895267
|dj| = 2883.63895267
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 43.9350960255 s
|dj| = 2883.63895267
Runtime: 43.9358379841 s
|dj| = 2883.63895267
   65   317    -9.627895E+05     2.554963E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.415e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.583e+01 (tol = 1.000e-10) r (rel) = 2.467e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.596e-01 (tol = 1.000e-10) r (rel) = 1.496e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.274e-03 (tol = 1.000e-10) r (rel) = 1.134e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.034e-07 (tol = 1.000e-10) r (rel) = 9.406e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.535e-12 (tol = 1.000e-10) r (rel) = 2.393e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 205.329725 s.
j = 1.038313e+06.
End of time loop.
End of time loop.
Runtime: 205.374856 s.
j = 1.038313e+06.
Runtime: 205.374749 s.
j = 1.038313e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 205.344936 s.
j = 1.038313e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.825e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.448e+01 (tol = 1.000e-10) r (rel) = 2.122e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.988e-01 (tol = 1.000e-10) r (rel) = 1.317e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.856e-03 (tol = 1.000e-10) r (rel) = 1.005e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.537e-07 (tol = 1.000e-10) r (rel) = 9.578e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.525e-12 (tol = 1.000e-10) r (rel) = 2.234e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 222.310546 s.
j = 1.078796e+06.
Runtime: 222.311674 s.
j = 1.078796e+06.
Runtime: 222.311437 s.
j = 1.078796e+06.
Runtime: 222.297893 s.
j = 1.078796e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.751e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.450e+00 (tol = 1.000e-10) r (rel) = 1.186e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.406e-01 (tol = 1.000e-10) r (rel) = 3.749e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.092e-04 (tol = 1.000e-10) r (rel) = 1.091e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.711e-09 (tol = 1.000e-10) r (rel) = 1.256e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.573263 s.
j = 1.082416e+06.
Runtime: 169.575109 s.
j = 1.082416e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 169.575238 s.
j = 1.082416e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 169.576630 s.
j = 1.082416e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.707e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.486e-01 (tol = 1.000e-10) r (rel) = 5.556e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.816e-03 (tol = 1.000e-10) r (rel) = 5.164e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.915e-06 (tol = 1.000e-10) r (rel) = 1.121e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.657e-12 (tol = 1.000e-10) r (rel) = 9.703e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 177.365015 s.
j = 1.085336e+06.
End of time loop.
Runtime: 177.365093 s.
End of time loop.
j = 1.085336e+06.
Runtime: 177.362733 s.
j = 1.085336e+06.
Start evaluation of j
Runtime: 177.364146 s.
j = 1.085336e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.109e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.314e-02 (tol = 1.000e-10) r (rel) = 1.627e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.753e-05 (tol = 1.000e-10) r (rel) = 1.322e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.075e-10 (tol = 1.000e-10) r (rel) = 2.105e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 129.907018 s.
j = 1.086704e+06.
End of time loop.
End of time loop.
Runtime: 129.906533 s.
j = 1.086704e+06.
Runtime: 129.907026 s.
Start evaluation of dj
j = 1.086704e+06.
found a tidal farm, computing gradient
Runtime: 129.906679 s.
j = 1.086704e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 44.5610210896 s
|dj| = 2789.13888387
Runtime: 44.5632779598 s
|dj| = 2789.13888387
Start evaluation of j
Updating the turbine cache
Runtime: 44.5659921169 s
|dj| = 2789.13888387
   66   322    -9.628425E+05     2.471234E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 44.5907890797 s
|dj| = 2789.13888387
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.244e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.359e+01 (tol = 1.000e-10) r (rel) = 2.176e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.856e-01 (tol = 1.000e-10) r (rel) = 1.418e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.279e-03 (tol = 1.000e-10) r (rel) = 1.166e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.454e-07 (tol = 1.000e-10) r (rel) = 8.735e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.506e-12 (tol = 1.000e-10) r (rel) = 2.412e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 214.432672 s.
j = 1.022211e+06.
Runtime: 214.403810 s.
j = 1.022211e+06.
End of time loop.
Runtime: 214.431533 s.
j = 1.022211e+06.
Start evaluation of j
Runtime: 214.430030 s.
j = 1.022211e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.426e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.259e+01 (tol = 1.000e-10) r (rel) = 1.959e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.839e-01 (tol = 1.000e-10) r (rel) = 1.220e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.849e-03 (tol = 1.000e-10) r (rel) = 1.221e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.442e-06 (tol = 1.000e-10) r (rel) = 2.244e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.530e-12 (tol = 1.000e-10) r (rel) = 2.380e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 219.774660 s.
Runtime: 219.774685 s.
j = 1.077564e+06.
j = 1.077564e+06.
Runtime: 219.773672 s.
j = 1.077564e+06.
Runtime: 219.774376 s.
j = 1.077564e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.701e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.286e+00 (tol = 1.000e-10) r (rel) = 1.158e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.706e-01 (tol = 1.000e-10) r (rel) = 4.610e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.504e-04 (tol = 1.000e-10) r (rel) = 1.487e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.124e-09 (tol = 1.000e-10) r (rel) = 1.655e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 177.117757 s.
j = 1.081171e+06.
Runtime: 177.118025 s.
j = 1.081171e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 177.118344 s.
j = 1.081171e+06.
End of time loop.
Runtime: 177.120613 s.
j = 1.081171e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.537e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.639e-01 (tol = 1.000e-10) r (rel) = 4.971e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.198e-03 (tol = 1.000e-10) r (rel) = 4.033e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.972e-07 (tol = 1.000e-10) r (rel) = 4.537e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.562e-12 (tol = 1.000e-10) r (rel) = 1.016e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 173.361681 s.
j = 1.086623e+06.
Runtime: 173.361574 s.
j = 1.086623e+06.
End of time loop.
Runtime: 173.358527 s.
Start evaluation of j
Start evaluation of j
j = 1.086623e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 173.361228 s.
j = 1.086623e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.132e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.495e-02 (tol = 1.000e-10) r (rel) = 7.015e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.290e-06 (tol = 1.000e-10) r (rel) = 1.074e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.261e-12 (tol = 1.000e-10) r (rel) = 1.061e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 133.103107 s.
End of time loop.
End of time loop.
j = 1.086869e+06.
Runtime: 133.105016 s.
Runtime: 133.106432 s.
j = 1.086869e+06.
j = 1.086869e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 133.107624 s.
j = 1.086869e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 48.0185329914 s
|dj| = 2549.55143116
Start evaluation of j
Updating the turbine cache
Runtime: 48.0235579014 s
|dj| = 2549.55143116
Start evaluation of j
Updating the turbine cache
Runtime: 48.0551409721 s
|dj| = 2549.55143116
Runtime: 48.0589351654 s
|dj| = 2549.55143116
Start evaluation of j
Updating the turbine cache
   67   327    -9.629881E+05     2.258955E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.928e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.269e+01 (tol = 1.000e-10) r (rel) = 2.140e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.875e-01 (tol = 1.000e-10) r (rel) = 1.328e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.622e-03 (tol = 1.000e-10) r (rel) = 9.484e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.219e-07 (tol = 1.000e-10) r (rel) = 7.117e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.529e-12 (tol = 1.000e-10) r (rel) = 2.579e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 199.432800 s.
j = 1.014709e+06.
Runtime: 199.465503 s.
j = 1.014709e+06.
Runtime: 199.469349 s.
j = 1.014709e+06.
Runtime: 199.430348 s.
j = 1.014709e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.701e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.176e+01 (tol = 1.000e-10) r (rel) = 2.063e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.472e-01 (tol = 1.000e-10) r (rel) = 1.311e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.833e-03 (tol = 1.000e-10) r (rel) = 1.023e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.591e-07 (tol = 1.000e-10) r (rel) = 8.053e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.512e-12 (tol = 1.000e-10) r (rel) = 2.652e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 187.600179 s.
Runtime: 187.600197 s.
j = 1.072765e+06.
j = 1.072765e+06.
Runtime: 187.599590 s.
j = 1.072765e+06.
Runtime: 187.600799 s.
j = 1.072765e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.255e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.087e+00 (tol = 1.000e-10) r (rel) = 1.256e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.310e-01 (tol = 1.000e-10) r (rel) = 4.024e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.029e-04 (tol = 1.000e-10) r (rel) = 9.306e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.399e-09 (tol = 1.000e-10) r (rel) = 7.372e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 156.918082 s.
j = 1.082085e+06.
Runtime: 156.919014 s.
j = 1.082085e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Runtime: 156.920035 s.
j = 1.082085e+06.
Updating the turbine cache
End of time loop.
Runtime: 156.920923 s.
j = 1.082085e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.074e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.477e-01 (tol = 1.000e-10) r (rel) = 4.168e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.693e-03 (tol = 1.000e-10) r (rel) = 1.576e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.218e-08 (tol = 1.000e-10) r (rel) = 3.927e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 1.390e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 143.501714 s.
j = 1.086458e+06.
Runtime: 143.499058 s.
Runtime: 143.500648 s.
j = 1.086458e+06.
j = 1.086458e+06.
Runtime: 143.502247 s.
j = 1.086458e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.167e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.703e-02 (tol = 1.000e-10) r (rel) = 7.862e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.248e-06 (tol = 1.000e-10) r (rel) = 1.038e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.282e-12 (tol = 1.000e-10) r (rel) = 1.053e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 131.429973 s.
Runtime: 131.429205 s.
j = 1.087046e+06.
End of time loop.
j = 1.087046e+06.
End of time loop.
Runtime: 131.430541 s.
j = 1.087046e+06.
Start evaluation of dj
Runtime: 131.430753 s.
j = 1.087046e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 42.605659008 s
|dj| = 2299.19344527
Start evaluation of j
Updating the turbine cache
Runtime: 42.6069860458 s
|dj| = 2299.19344527
Runtime: 42.6070840359 s
|dj| = 2299.19344527
Runtime: 42.6075980663 s
|dj| = 2299.19344527
   68   332    -9.631455E+05     2.037133E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.584e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.088e+01 (tol = 1.000e-10) r (rel) = 1.947e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.693e-01 (tol = 1.000e-10) r (rel) = 1.378e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.232e-02 (tol = 1.000e-10) r (rel) = 2.206e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.092e-06 (tol = 1.000e-10) r (rel) = 9.119e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.566e-12 (tol = 1.000e-10) r (rel) = 4.595e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 205.263270 s.
j = 1.054518e+06.
Runtime: 205.262111 s.
j = 1.054518e+06.
Runtime: 205.262110 s.
j = 1.054518e+06.
Runtime: 205.266343 s.
j = 1.054518e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.876e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.034e+01 (tol = 1.000e-10) r (rel) = 2.121e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.551e-01 (tol = 1.000e-10) r (rel) = 1.549e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.079e-02 (tol = 1.000e-10) r (rel) = 2.214e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.123e-06 (tol = 1.000e-10) r (rel) = 6.405e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.763e-12 (tol = 1.000e-10) r (rel) = 3.616e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 204.111751 s.
j = 1.080777e+06.
Runtime: 204.112761 s.
j = 1.080777e+06.
Runtime: 204.113396 s.
j = 1.080777e+06.
Start evaluation of j
End of time loop.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 204.115022 s.
j = 1.080777e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.187e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.077e+00 (tol = 1.000e-10) r (rel) = 9.498e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.357e-02 (tol = 1.000e-10) r (rel) = 1.535e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.428e-05 (tol = 1.000e-10) r (rel) = 6.527e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.257e-12 (tol = 1.000e-10) r (rel) = 3.775e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.401670 s.
j = 1.084753e+06.
Runtime: 169.402104 s.
End of time loop.
End of time loop.
j = 1.084753e+06.
Runtime: 169.402465 s.
Runtime: 169.400504 s.
Start evaluation of j
j = 1.084753e+06.
j = 1.084753e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.660e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.269e-01 (tol = 1.000e-10) r (rel) = 2.962e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.202e-04 (tol = 1.000e-10) r (rel) = 5.486e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.430e-09 (tol = 1.000e-10) r (rel) = 3.172e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 130.541614 s.
j = 1.086907e+06.
Runtime: 130.541016 s.
j = 1.086907e+06.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 130.540993 s.
j = 1.086907e+06.
Runtime: 130.541384 s.
Updating the turbine cache
j = 1.086907e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.606e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.414e-03 (tol = 1.000e-10) r (rel) = 5.864e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.197e-07 (tol = 1.000e-10) r (rel) = 4.482e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.545e-12 (tol = 1.000e-10) r (rel) = 9.624e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 122.338224 s.
j = 1.087155e+06.
End of time loop.
End of time loop.
Runtime: 122.338977 s.
j = 1.087155e+06.
Runtime: 122.340634 s.
Runtime: 122.339806 s.
j = 1.087155e+06.
j = 1.087155e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 38.9846529961 s
|dj| = 2272.38572721
Runtime: 38.9865028858 s
|dj| = 2272.38572721
Start evaluation of j
Updating the turbine cache
Runtime: 38.9873800278 s
|dj| = 2272.38572721
   69   337    -9.632413E+05     2.013380E+03
Start evaluation of j
Runtime: 38.9896121025 s
Updating the turbine cache
|dj| = 2272.38572721
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.153e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.208e+01 (tol = 1.000e-10) r (rel) = 1.963e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.022e-01 (tol = 1.000e-10) r (rel) = 1.141e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.634e-03 (tol = 1.000e-10) r (rel) = 5.906e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.288e-07 (tol = 1.000e-10) r (rel) = 2.093e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.506e-12 (tol = 1.000e-10) r (rel) = 2.448e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 218.630381 s.
j = 1.072196e+06.
End of time loop.
Runtime: 218.634408 s.
End of time loop.
j = 1.072196e+06.
Start evaluation of j
Runtime: 218.633579 s.
Updating the turbine cache
j = 1.072196e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 218.634927 s.
j = 1.072196e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.317e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.920e+00 (tol = 1.000e-10) r (rel) = 1.866e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.302e-01 (tol = 1.000e-10) r (rel) = 9.972e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.479e-03 (tol = 1.000e-10) r (rel) = 6.544e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.108e-07 (tol = 1.000e-10) r (rel) = 3.965e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.498e-12 (tol = 1.000e-10) r (rel) = 2.818e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 200.859195 s.
j = 1.080057e+06.
Runtime: 200.843202 s.
j = 1.080057e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 200.860161 s.
j = 1.080057e+06.
End of time loop.
Runtime: 200.862850 s.
Start evaluation of j
j = 1.080057e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.341e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.902e+00 (tol = 1.000e-10) r (rel) = 1.168e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.578e-01 (tol = 1.000e-10) r (rel) = 4.723e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.723e-04 (tol = 1.000e-10) r (rel) = 1.413e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.589e-09 (tol = 1.000e-10) r (rel) = 1.373e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 171.151838 s.
j = 1.084144e+06.
Runtime: 171.155851 s.
j = 1.084144e+06.
Start evaluation of j
Start evaluation of j
End of time loop.
Runtime: 171.155144 s.
j = 1.084144e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 171.164759 s.
j = 1.084144e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.034e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.846e-01 (tol = 1.000e-10) r (rel) = 3.719e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.682e-03 (tol = 1.000e-10) r (rel) = 1.627e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.595e-08 (tol = 1.000e-10) r (rel) = 5.409e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 1.444e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 176.269802 s.
j = 1.087181e+06.
Runtime: 176.279280 s.
j = 1.087181e+06.
End of time loop.
Runtime: 176.277695 s.
Start evaluation of dj
Start evaluation of dj
j = 1.087181e+06.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 176.273700 s.
j = 1.087181e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 47.0549850464 s
|dj| = 2187.56201711
Runtime: 47.0568549633 s
|dj| = 2187.56201711
   70   341    -9.632644E+05     1.938225E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 47.0952880383 s
|dj| = 2187.56201711
Runtime: 47.0945560932 s
|dj| = 2187.56201711
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.795e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.047e+00 (tol = 1.000e-10) r (rel) = 1.470e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.483e-01 (tol = 1.000e-10) r (rel) = 7.263e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.304e-03 (tol = 1.000e-10) r (rel) = 4.806e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.451e-07 (tol = 1.000e-10) r (rel) = 3.026e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.500e-12 (tol = 1.000e-10) r (rel) = 3.128e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 200.789194 s.
j = 1.081864e+06.
End of time loop.
Runtime: 200.828883 s.
j = 1.081864e+06.
Start evaluation of j
Start evaluation of j
Runtime: 200.786793 s.
j = 1.081864e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 200.831177 s.
Start evaluation of j
j = 1.081864e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.469e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.098e+00 (tol = 1.000e-10) r (rel) = 1.470e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.970e-01 (tol = 1.000e-10) r (rel) = 5.679e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.283e-04 (tol = 1.000e-10) r (rel) = 1.811e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.032e-08 (tol = 1.000e-10) r (rel) = 2.976e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 171.673035 s.
j = 1.084511e+06.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 171.676616 s.
j = 1.084511e+06.
Updating the turbine cache
Runtime: 171.675945 s.
j = 1.084511e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 171.680974 s.
j = 1.084511e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.873e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.595e+00 (tol = 1.000e-10) r (rel) = 8.517e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.485e-02 (tol = 1.000e-10) r (rel) = 1.327e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.120e-05 (tol = 1.000e-10) r (rel) = 5.978e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.527e-12 (tol = 1.000e-10) r (rel) = 2.951e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 158.805175 s.
j = 1.086092e+06.
Runtime: 158.809224 s.
j = 1.086092e+06.
End of time loop.
Start evaluation of j
Runtime: 158.808524 s.
j = 1.086092e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 158.812147 s.
j = 1.086092e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.032e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.161e-01 (tol = 1.000e-10) r (rel) = 3.074e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.961e-04 (tol = 1.000e-10) r (rel) = 7.055e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.513e-09 (tol = 1.000e-10) r (rel) = 6.418e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 132.555165 s.
j = 1.087252e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
End of time loop.
Runtime: 132.561806 s.
j = 1.087252e+06.
Runtime: 132.564649 s.
j = 1.087252e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 132.570592 s.
j = 1.087252e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 44.1667678356 s
|dj| = 2193.29112929
Start evaluation of j
Updating the turbine cache
Runtime: 44.1645328999 s
|dj| = 2193.29112929
Start evaluation of j
Updating the turbine cache
Runtime: 44.1920859814 s
|dj| = 2193.29112929
   71   345    -9.633276E+05     1.943301E+03
Start evaluation of j
Updating the turbine cache
Runtime: 44.1960299015 s
|dj| = 2193.29112929
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.196e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.542e+00 (tol = 1.000e-10) r (rel) = 1.644e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.554e-01 (tol = 1.000e-10) r (rel) = 8.764e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.900e-03 (tol = 1.000e-10) r (rel) = 5.581e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.637e-07 (tol = 1.000e-10) r (rel) = 3.150e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.498e-12 (tol = 1.000e-10) r (rel) = 2.883e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 211.605288 s.
j = 1.084064e+06.
Runtime: 211.645716 s.
j = 1.084064e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 211.610325 s.
j = 1.084064e+06.
End of time loop.
Runtime: 211.626830 s.
j = 1.084064e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.532e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.688e+00 (tol = 1.000e-10) r (rel) = 1.610e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.909e-01 (tol = 1.000e-10) r (rel) = 5.406e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.522e-04 (tol = 1.000e-10) r (rel) = 1.280e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.157e-09 (tol = 1.000e-10) r (rel) = 1.460e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 158.423200 s.
j = 1.082791e+06.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 158.423954 s.
j = 1.082791e+06.
Updating the turbine cache
Runtime: 158.420961 s.
j = 1.082791e+06.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 158.423675 s.
Start evaluation of j
j = 1.082791e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.401e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.533e+00 (tol = 1.000e-10) r (rel) = 1.055e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.555e-02 (tol = 1.000e-10) r (rel) = 1.897e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.583e-05 (tol = 1.000e-10) r (rel) = 1.492e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.800e-11 (tol = 1.000e-10) r (rel) = 1.582e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 168.761072 s.
j = 1.086763e+06.
Runtime: 168.759883 s.
j = 1.086763e+06.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 168.762737 s.
Runtime: 168.763465 s.
Updating the turbine cache
j = 1.086763e+06.
j = 1.086763e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.019e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.340e-01 (tol = 1.000e-10) r (rel) = 2.918e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.557e-04 (tol = 1.000e-10) r (rel) = 5.684e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.362e-09 (tol = 1.000e-10) r (rel) = 4.193e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 126.410401 s.
Runtime: 126.408850 s.
j = 1.087479e+06.
Runtime: 126.409209 s.
j = 1.087479e+06.
j = 1.087479e+06.
Runtime: 126.410313 s.
j = 1.087479e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.5274991989 s
|dj| = 2309.37903758
Runtime: 43.5281970501 s
|dj| = 2309.37903758
Start evaluation of j
Updating the turbine cache
   72   349    -9.635290E+05     2.046157E+03
Start evaluation of j
Updating the turbine cache
Runtime: 43.5656809807 s
|dj| = 2309.37903758
Start evaluation of j
Updating the turbine cache
Runtime: 43.5694591999 s
|dj| = 2309.37903758
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.509e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.984e+00 (tol = 1.000e-10) r (rel) = 1.420e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.800e-01 (tol = 1.000e-10) r (rel) = 5.129e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.265e-04 (tol = 1.000e-10) r (rel) = 1.500e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.259e-09 (tol = 1.000e-10) r (rel) = 1.783e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 174.361859 s.
j = 1.084031e+06.
Runtime: 174.358239 s.
j = 1.084031e+06.
Runtime: 174.401786 s.
j = 1.084031e+06.
Runtime: 174.400031 s.
j = 1.084031e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.499e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.057e+00 (tol = 1.000e-10) r (rel) = 1.223e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.075e-01 (tol = 1.000e-10) r (rel) = 4.302e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.157e-04 (tol = 1.000e-10) r (rel) = 1.263e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.793e-09 (tol = 1.000e-10) r (rel) = 1.118e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 173.162382 s.
j = 1.083177e+06.
Runtime: 173.162044 s.
j = 1.083177e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 173.163145 s.
j = 1.083177e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 173.162774 s.
j = 1.083177e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.580e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.176e+00 (tol = 1.000e-10) r (rel) = 7.441e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.119e-02 (tol = 1.000e-10) r (rel) = 1.341e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.240e-05 (tol = 1.000e-10) r (rel) = 7.847e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.485e-12 (tol = 1.000e-10) r (rel) = 4.737e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 170.018089 s.
Runtime: 170.017933 s.
j = 1.086164e+06.
j = 1.086164e+06.
Runtime: 170.015613 s.
j = 1.086164e+06.
Runtime: 170.016983 s.
j = 1.086164e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.098e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.195e-01 (tol = 1.000e-10) r (rel) = 2.343e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.093e-04 (tol = 1.000e-10) r (rel) = 4.107e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.170e-09 (tol = 1.000e-10) r (rel) = 2.294e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 110.792933 s.
j = 1.087707e+06.
Runtime: 110.792905 s.
j = 1.087707e+06.
Runtime: 110.792234 s.
j = 1.087707e+06.
Runtime: 110.793366 s.
j = 1.087707e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 38.6751401424 s
|dj| = 2258.9021429
Runtime: 38.6764960289 s
|dj| = 2258.9021429
   73   353    -9.637308E+05     2.001434E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 38.7149088383 s
|dj| = 2258.9021429
Start evaluation of j
Updating the turbine cache
Runtime: 38.7190890312 s
|dj| = 2258.9021429
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.509e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.300e+00 (tol = 1.000e-10) r (rel) = 2.063e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.049e-01 (tol = 1.000e-10) r (rel) = 8.980e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.260e-03 (tol = 1.000e-10) r (rel) = 2.796e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.676e-08 (tol = 1.000e-10) r (rel) = 3.716e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 166.601557 s.
j = 1.073106e+06.
Runtime: 166.642005 s.
j = 1.073106e+06.
End of time loop.
Start evaluation of j
Runtime: 166.598620 s.
j = 1.073106e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 166.644019 s.
Start evaluation of j
j = 1.073106e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.080e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.359e+00 (tol = 1.000e-10) r (rel) = 1.448e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.523e-01 (tol = 1.000e-10) r (rel) = 6.935e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.682e-03 (tol = 1.000e-10) r (rel) = 3.312e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.860e-08 (tol = 1.000e-10) r (rel) = 9.566e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.942008 s.
j = 1.082126e+06.
Runtime: 169.941072 s.
j = 1.082126e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
End of time loop.
Runtime: 169.941670 s.
j = 1.082126e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 169.949827 s.
j = 1.082126e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.837e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.577e+00 (tol = 1.000e-10) r (rel) = 9.084e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.014e-02 (tol = 1.000e-10) r (rel) = 2.825e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.503e-04 (tol = 1.000e-10) r (rel) = 5.299e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.067e-10 (tol = 1.000e-10) r (rel) = 2.138e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 167.161262 s.
Runtime: 167.169694 s.
j = 1.085493e+06.
End of time loop.
j = 1.085493e+06.
End of time loop.
Runtime: 167.167426 s.
j = 1.085493e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 167.170374 s.
j = 1.085493e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.046e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.974e-01 (tol = 1.000e-10) r (rel) = 3.801e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.197e-03 (tol = 1.000e-10) r (rel) = 2.101e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.277e-07 (tol = 1.000e-10) r (rel) = 1.221e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.494e-12 (tol = 1.000e-10) r (rel) = 1.429e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 160.514066 s.
j = 1.088039e+06.
Runtime: 160.516008 s.
j = 1.088039e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 160.515889 s.
j = 1.088039e+06.
found a tidal farm, computing gradient
End of time loop.
Runtime: 160.518037 s.
j = 1.088039e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 37.1176371574 s
|dj| = 1868.7108457
   74   357    -9.640250E+05     1.655716E+03
Start evaluation of j
Updating the turbine cache
Runtime: 37.1585230827 s
|dj| = 1868.7108457
Start evaluation of j
Updating the turbine cache
Runtime: 37.1661629677 s
|dj| = 1868.7108457
Start evaluation of j
Updating the turbine cache
Runtime: 37.1788961887 s
|dj| = 1868.7108457
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.112e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.745e+00 (tol = 1.000e-10) r (rel) = 1.906e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.733e-01 (tol = 1.000e-10) r (rel) = 9.260e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.525e-03 (tol = 1.000e-10) r (rel) = 4.939e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.112e-07 (tol = 1.000e-10) r (rel) = 2.175e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.491e-12 (tol = 1.000e-10) r (rel) = 2.916e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 201.451956 s.
j = 1.081461e+06.
End of time loop.
End of time loop.
Runtime: 201.441999 s.
j = 1.081461e+06.
Start evaluation of j
Runtime: 201.501862 s.
j = 1.081461e+06.
Updating the turbine cache
End of time loop.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 201.464138 s.
j = 1.081461e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.934e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.867e+00 (tol = 1.000e-10) r (rel) = 1.594e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.447e-01 (tol = 1.000e-10) r (rel) = 6.986e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.407e-03 (tol = 1.000e-10) r (rel) = 2.852e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.085e-08 (tol = 1.000e-10) r (rel) = 6.253e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 159.236089 s.
j = 1.083381e+06.
End of time loop.
Runtime: 159.239259 s.
j = 1.083381e+06.
Runtime: 159.238679 s.
j = 1.083381e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 159.255588 s.
j = 1.083381e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.267e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.282e+00 (tol = 1.000e-10) r (rel) = 1.004e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.918e-02 (tol = 1.000e-10) r (rel) = 2.729e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.384e-04 (tol = 1.000e-10) r (rel) = 4.236e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.191e-10 (tol = 1.000e-10) r (rel) = 1.283e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 169.506060 s.
j = 1.084478e+06.
End of time loop.
Runtime: 169.482455 s.
j = 1.084478e+06.
Runtime: 169.505739 s.
j = 1.084478e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 169.507524 s.
j = 1.084478e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.271e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.909e-01 (tol = 1.000e-10) r (rel) = 3.864e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.223e-03 (tol = 1.000e-10) r (rel) = 1.749e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.684e-08 (tol = 1.000e-10) r (rel) = 7.621e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.490e-12 (tol = 1.000e-10) r (rel) = 1.173e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 150.063895 s.
j = 1.087888e+06.
End of time loop.
Runtime: 150.063861 s.
End of time loop.
Start evaluation of j
Runtime: 150.063908 s.
j = 1.087888e+06.
Start evaluation of j
Updating the turbine cache
j = 1.087888e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 150.070559 s.
j = 1.087888e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.595e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.588e-03 (tol = 1.000e-10) r (rel) = 4.758e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.964e-07 (tol = 1.000e-10) r (rel) = 3.113e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.502e-12 (tol = 1.000e-10) r (rel) = 9.419e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 122.473447 s.
j = 1.088071e+06.
End of time loop.
Runtime: 122.477505 s.
End of time loop.
j = 1.088071e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 122.479512 s.
Runtime: 122.482400 s.
j = 1.088071e+06.
j = 1.088071e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 44.4942479134 s
|dj| = 1908.35574787
Start evaluation of j
Updating the turbine cache
Runtime: 44.4972369671 s
|dj| = 1908.35574787
   75   362    -9.640529E+05     1.690842E+03
Start evaluation of j
Updating the turbine cache
Runtime: 44.5336720943 s
|dj| = 1908.35574787
Start evaluation of j
Updating the turbine cache
Runtime: 44.5392889977 s
|dj| = 1908.35574787
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.696e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.288e+00 (tol = 1.000e-10) r (rel) = 1.220e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.150e-01 (tol = 1.000e-10) r (rel) = 4.266e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.914e-04 (tol = 1.000e-10) r (rel) = 1.081e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.112e-09 (tol = 1.000e-10) r (rel) = 7.834e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 161.018375 s.
j = 1.080463e+06.
End of time loop.
End of time loop.
Runtime: 161.061252 s.
j = 1.080463e+06.
Runtime: 161.024790 s.
Start evaluation of j
j = 1.080463e+06.
Updating the turbine cache
Runtime: 161.064850 s.
j = 1.080463e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.498e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.630e+00 (tol = 1.000e-10) r (rel) = 1.053e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.205e-02 (tol = 1.000e-10) r (rel) = 2.884e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.019e-04 (tol = 1.000e-10) r (rel) = 4.078e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.570e-10 (tol = 1.000e-10) r (rel) = 1.029e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 154.964888 s.
End of time loop.
j = 1.087186e+06.
Runtime: 154.963189 s.
End of time loop.
j = 1.087186e+06.
Runtime: 154.964633 s.
Runtime: 154.964199 s.
Start evaluation of j
j = 1.087186e+06.
j = 1.087186e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.661e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.349e-02 (tol = 1.000e-10) r (rel) = 2.006e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.527e-05 (tol = 1.000e-10) r (rel) = 1.829e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.085e-10 (tol = 1.000e-10) r (rel) = 2.328e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 123.097032 s.
j = 1.088118e+06.
Runtime: 123.096489 s.
End of time loop.
j = 1.088118e+06.
End of time loop.
Runtime: 123.097063 s.
j = 1.088118e+06.
Start evaluation of dj
Runtime: 123.098423 s.
j = 1.088118e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.2484869957 s
|dj| = 1975.0944017
Start evaluation of j
Updating the turbine cache
Runtime: 45.2583191395 s
|dj| = 1975.0944017
Runtime: 45.2610011101 s
|dj| = 1975.0944017
   76   365    -9.640953E+05     1.749974E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 45.2711040974 s
|dj| = 1975.0944017
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.257e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.209e+00 (tol = 1.000e-10) r (rel) = 1.562e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.052e-01 (tol = 1.000e-10) r (rel) = 7.709e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.525e-03 (tol = 1.000e-10) r (rel) = 4.803e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.508e-07 (tol = 1.000e-10) r (rel) = 2.869e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.485e-12 (tol = 1.000e-10) r (rel) = 2.825e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 190.555331 s.
j = 1.078629e+06.
End of time loop.
End of time loop.
Runtime: 190.546912 s.
j = 1.078629e+06.
Start evaluation of j
Runtime: 190.568617 s.
j = 1.078629e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 190.558919 s.
j = 1.078629e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.354e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.768e+00 (tol = 1.000e-10) r (rel) = 1.422e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.348e-01 (tol = 1.000e-10) r (rel) = 4.021e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.163e-04 (tol = 1.000e-10) r (rel) = 6.448e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.096e-09 (tol = 1.000e-10) r (rel) = 3.267e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 163.670977 s.
Runtime: 163.663925 s.
j = 1.083350e+06.
j = 1.083350e+06.
Runtime: 163.671355 s.
j = 1.083350e+06.
Runtime: 163.664463 s.
j = 1.083350e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.683e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.284e+00 (tol = 1.000e-10) r (rel) = 7.628e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.674e-02 (tol = 1.000e-10) r (rel) = 9.944e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.797e-06 (tol = 1.000e-10) r (rel) = 3.444e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.867e-12 (tol = 1.000e-10) r (rel) = 4.080e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 164.324162 s.
j = 1.083492e+06.
End of time loop.
Start evaluation of j
Runtime: 164.324912 s.
j = 1.083492e+06.
Updating the turbine cache
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 164.324968 s.
j = 1.083492e+06.
End of time loop.
Runtime: 164.327133 s.
Start evaluation of j
j = 1.083492e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.591e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.326e-01 (tol = 1.000e-10) r (rel) = 3.064e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.009e-04 (tol = 1.000e-10) r (rel) = 7.916e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.984e-09 (tol = 1.000e-10) r (rel) = 1.052e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.485e-12 (tol = 1.000e-10) r (rel) = 1.957e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 165.176967 s.
Runtime: 165.173905 s.
j = 1.088319e+06.
j = 1.088319e+06.
Runtime: 165.175756 s.
j = 1.088319e+06.
Runtime: 165.178404 s.
j = 1.088319e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 35.3851399422 s
|dj| = 1955.19830267
Start evaluation of j
Updating the turbine cache
Runtime: 35.3892810345 s
|dj| = 1955.19830267
   77   369    -9.642728E+05     1.732346E+03
Start evaluation of j
Updating the turbine cache
Runtime: 35.4213922024 s
|dj| = 1955.19830267
Runtime: 35.4225049019 s
|dj| = 1955.19830267
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.672e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.911e-02 (tol = 1.000e-10) r (rel) = 1.479e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.870e-05 (tol = 1.000e-10) r (rel) = 1.042e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.399e-11 (tol = 1.000e-10) r (rel) = 1.156e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 128.298019 s.
j = 1.088456e+06.
Runtime: 128.336975 s.
j = 1.088456e+06.
End of time loop.
Start evaluation of j
Runtime: 128.298149 s.
j = 1.088456e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 128.334610 s.
j = 1.088456e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.062e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.511e-02 (tol = 1.000e-10) r (rel) = 7.328e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.320e-06 (tol = 1.000e-10) r (rel) = 1.125e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.785e-12 (tol = 1.000e-10) r (rel) = 8.654e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 129.864184 s.
Runtime: 129.862893 s.
j = 1.088747e+06.
End of time loop.
j = 1.088747e+06.
End of time loop.
Runtime: 129.862010 s.
j = 1.088747e+06.
Start evaluation of dj
Runtime: 129.865037 s.
found a tidal farm, computing gradient
j = 1.088747e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 48.0683009624 s
|dj| = 1549.90929398
Runtime: 48.0693089962 s
|dj| = 1549.90929398
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 48.1087989807 s
|dj| = 1549.90929398
Runtime: 48.1119370461 s
|dj| = 1549.90929398
   78   371    -9.646524E+05     1.373252E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.821e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.708e-02 (tol = 1.000e-10) r (rel) = 1.314e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.398e-05 (tol = 1.000e-10) r (rel) = 4.956e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.607e-12 (tol = 1.000e-10) r (rel) = 2.342e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 122.093392 s.
j = 1.088706e+06.
End of time loop.
End of time loop.
Runtime: 122.048557 s.
j = 1.088706e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 122.051932 s.
j = 1.088706e+06.
Runtime: 122.092772 s.
j = 1.088706e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.601e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.116e-02 (tol = 1.000e-10) r (rel) = 6.972e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.412e-06 (tol = 1.000e-10) r (rel) = 8.822e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.567e-12 (tol = 1.000e-10) r (rel) = 9.793e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 126.898576 s.
j = 1.088957e+06.
End of time loop.
End of time loop.
Runtime: 126.898109 s.
j = 1.088957e+06.
Runtime: 126.897846 s.
Start evaluation of dj
j = 1.088957e+06.
found a tidal farm, computing gradient
Runtime: 126.897999 s.
j = 1.088957e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 47.6048419476 s
|dj| = 1384.58209985
Start evaluation of j
Updating the turbine cache
Runtime: 47.6104798317 s
|dj| = 1384.58209985
Start evaluation of j
Updating the turbine cache
Runtime: 47.6413910389 s
|dj| = 1384.58209985
Start evaluation of j
Updating the turbine cache
Runtime: 47.6463139057 s
|dj| = 1384.58209985
   79   373    -9.648385E+05     1.226768E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.858e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.148e-02 (tol = 1.000e-10) r (rel) = 6.178e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.233e-06 (tol = 1.000e-10) r (rel) = 6.634e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.580e-12 (tol = 1.000e-10) r (rel) = 8.504e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 121.084269 s.
Runtime: 121.040918 s.
j = 1.089098e+06.
End of time loop.
j = 1.089098e+06.
End of time loop.
Runtime: 121.078584 s.
j = 1.089098e+06.
Start evaluation of dj
Runtime: 121.048019 s.
j = 1.089098e+06.
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 47.333837986 s
|dj| = 1188.7404314
Start evaluation of j
Updating the turbine cache
Runtime: 47.3377161026 s
|dj| = 1188.7404314
Start evaluation of j
Updating the turbine cache
Runtime: 47.3719329834 s
|dj| = 1188.7404314
Runtime: 47.3761119843 s
|dj| = 1188.7404314
Start evaluation of j
Updating the turbine cache
   80   374    -9.649636E+05     1.053248E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.883e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.083e-02 (tol = 1.000e-10) r (rel) = 5.749e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.940e-07 (tol = 1.000e-10) r (rel) = 4.748e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.589e-12 (tol = 1.000e-10) r (rel) = 8.439e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 123.938929 s.
j = 1.089075e+06.
End of time loop.
End of time loop.
Runtime: 123.941892 s.
j = 1.089075e+06.
Start evaluation of j
Runtime: 123.977702 s.
j = 1.089075e+06.
Runtime: 123.981628 s.
Updating the turbine cache
j = 1.089075e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.001e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.080e-03 (tol = 1.000e-10) r (rel) = 3.077e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.874e-08 (tol = 1.000e-10) r (rel) = 7.867e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.491e-12 (tol = 1.000e-10) r (rel) = 1.489e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 127.304225 s.
j = 1.089206e+06.
Runtime: 127.304563 s.
j = 1.089206e+06.
End of time loop.
End of time loop.
Runtime: 127.306291 s.
Start evaluation of dj
j = 1.089206e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 127.305559 s.
j = 1.089206e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.5794248581 s
|dj| = 1126.7159455
Start evaluation of j
Updating the turbine cache
Runtime: 45.5965418816 s
|dj| = 1126.7159455
   81   376    -9.650593E+05     9.982935E+02
Start evaluation of j
Updating the turbine cache
Runtime: 45.6230809689 s
|dj| = 1126.7159455
Start evaluation of j
Updating the turbine cache
Runtime: 45.6334750652 s
|dj| = 1126.7159455
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.294e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.494e-03 (tol = 1.000e-10) r (rel) = 4.244e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.245e-07 (tol = 1.000e-10) r (rel) = 2.507e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.501e-12 (tol = 1.000e-10) r (rel) = 1.160e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 132.928240 s.
Runtime: 132.954957 s.
j = 1.089194e+06.
j = 1.089194e+06.
Runtime: 132.958330 s.
j = 1.089194e+06.
Runtime: 132.911949 s.
j = 1.089194e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.759e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.488e-03 (tol = 1.000e-10) r (rel) = 2.202e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.239e-08 (tol = 1.000e-10) r (rel) = 3.312e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.489e-12 (tol = 1.000e-10) r (rel) = 2.202e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 126.934014 s.
j = 1.089267e+06.
End of time loop.
Runtime: 126.933271 s.
j = 1.089267e+06.
End of time loop.
Start evaluation of dj
Runtime: 126.934670 s.
j = 1.089267e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 126.935472 s.
j = 1.089267e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 47.0791869164 s
|dj| = 1077.11622395
Start evaluation of j
Updating the turbine cache
Runtime: 47.085272789 s
|dj| = 1077.11622395
Runtime: 47.0845139027 s
|dj| = 1077.11622395
Runtime: 47.0898339748 s
|dj| = 1077.11622395
   82   378    -9.651126E+05     9.543471E+02
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.637e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.322e-03 (tol = 1.000e-10) r (rel) = 2.689e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.964e-08 (tol = 1.000e-10) r (rel) = 5.748e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.488e-12 (tol = 1.000e-10) r (rel) = 1.723e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 127.180947 s.
j = 1.089247e+06.
Runtime: 127.173353 s.
j = 1.089247e+06.
End of time loop.
Start evaluation of j
Runtime: 127.173864 s.
j = 1.089247e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 127.171904 s.
j = 1.089247e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.070e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.019e-04 (tol = 1.000e-10) r (rel) = 1.582e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.675e-09 (tol = 1.000e-10) r (rel) = 1.119e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.485e-12 (tol = 1.000e-10) r (rel) = 2.929e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 114.541342 s.
j = 1.089285e+06.
Runtime: 114.544218 s.
j = 1.089285e+06.
Runtime: 114.543294 s.
j = 1.089285e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 114.565038 s.
j = 1.089285e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 42.8739588261 s
|dj| = 1049.66008468
Start evaluation of j
Updating the turbine cache
Runtime: 42.9051258564 s
|dj| = 1049.66008468
Runtime: 42.9079589844 s
|dj| = 1049.66008468
   83   380    -9.651286E+05     9.300204E+02
Start evaluation of j
Updating the turbine cache
Runtime: 42.9108710289 s
|dj| = 1049.66008468
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.570e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.235e-04 (tol = 1.000e-10) r (rel) = 1.466e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.603e-09 (tol = 1.000e-10) r (rel) = 7.291e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.486e-12 (tol = 1.000e-10) r (rel) = 4.161e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 128.153758 s.
End of time loop.
j = 1.089286e+06.
Runtime: 128.145952 s.
End of time loop.
j = 1.089286e+06.
Runtime: 128.148880 s.
j = 1.089286e+06.
Start evaluation of j
End of time loop.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 128.150601 s.
j = 1.089286e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.679e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.156e-04 (tol = 1.000e-10) r (rel) = 6.885e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.510e-10 (tol = 1.000e-10) r (rel) = 8.997e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 84.992179 s.
j = 1.089290e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 84.984697 s.
j = 1.089290e+06.
End of time loop.
Runtime: 84.986584 s.
j = 1.089290e+06.
Runtime: 84.993487 s.
j = 1.089290e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 43.348856926 s
|dj| = 1043.95475534
Start evaluation of j
Updating the turbine cache
Runtime: 43.3509550095 s
|dj| = 1043.95475534
Start evaluation of j
Updating the turbine cache
Runtime: 43.3835909367 s
|dj| = 1043.95475534
Runtime: 43.3851878643 s
|dj| = 1043.95475534
   84   382    -9.651333E+05     9.249654E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.586e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.313e-04 (tol = 1.000e-10) r (rel) = 1.281e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.625e-09 (tol = 1.000e-10) r (rel) = 6.283e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.481e-12 (tol = 1.000e-10) r (rel) = 5.728e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 129.829398 s.
j = 1.089288e+06.
End of time loop.
End of time loop.
Runtime: 129.865725 s.
j = 1.089288e+06.
Start evaluation of j
Runtime: 129.830528 s.
Runtime: 129.869083 s.
j = 1.089288e+06.
j = 1.089288e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.486e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.096e-04 (tol = 1.000e-10) r (rel) = 7.378e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.789e-10 (tol = 1.000e-10) r (rel) = 1.204e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.475e-12 (tol = 1.000e-10) r (rel) = 9.930e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 126.943874 s.
j = 1.089292e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Runtime: 126.943372 s.
j = 1.089292e+06.
found a tidal farm, computing gradient
Runtime: 126.943924 s.
j = 1.089292e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 126.947777 s.
j = 1.089292e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 46.014508009 s
|dj| = 1041.41383622
Start evaluation of j
Updating the turbine cache
Runtime: 46.0301070213 s
|dj| = 1041.41383622
   85   384    -9.651349E+05     9.227141E+02
Start evaluation of j
Updating the turbine cache
Runtime: 46.0516779423 s
|dj| = 1041.41383622
Start evaluation of j
Updating the turbine cache
Runtime: 46.058068037 s
|dj| = 1041.41383622
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.501e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.496e-05 (tol = 1.000e-10) r (rel) = 2.627e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.188e-11 (tol = 1.000e-10) r (rel) = 2.303e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 84.142255 s.
j = 1.089292e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Runtime: 84.120100 s.
j = 1.089292e+06.
Runtime: 84.115372 s.
j = 1.089292e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 84.158798 s.
j = 1.089292e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 39.8834280968 s
|dj| = 1040.34468769
Runtime: 39.8876929283 s
|dj| = 1040.34468769
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 39.8930799961 s
|dj| = 1040.34468769
   86   385    -9.651355E+05     9.217668E+02
Start evaluation of j
Updating the turbine cache
Runtime: 39.9026648998 s
|dj| = 1040.34468769
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.187e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.449e-06 (tol = 1.000e-10) r (rel) = 1.629e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.961e-12 (tol = 1.000e-10) r (rel) = 1.342e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 71.868408 s.
j = 1.089293e+06.
End of time loop.
End of time loop.
Runtime: 71.863994 s.
j = 1.089293e+06.
Runtime: 71.853530 s.
Runtime: 71.868446 s.
j = 1.089293e+06.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 42.6174380779 s
|dj| = 1040.61607975
Runtime: 42.6193828583 s
Runtime: 42.6184082031 s
|dj| = 1040.61607975
|dj| = 1040.61607975
Runtime: 42.6188640594 s
|dj| = 1040.61607975
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   87   386    -9.651357E+05     9.220072E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.580e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.582e-06 (tol = 1.000e-10) r (rel) = 1.001e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.386e-12 (tol = 1.000e-10) r (rel) = 9.248e-11 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.934196 s.
j = 1.089293e+06.
End of time loop.
End of time loop.
Runtime: 78.934597 s.
Runtime: 78.934265 s.
Runtime: 78.935092 s.
j = 1.089293e+06.
j = 1.089293e+06.
Start evaluation of dj
j = 1.089293e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 44.3801958561 s
|dj| = 1040.13371351
Start evaluation of j
Updating the turbine cache
Runtime: 44.3828859329 s
|dj| = 1040.13371351
Start evaluation of j
Updating the turbine cache
Runtime: 44.4135508537 s
|dj| = 1040.13371351
   88   387    -9.651358E+05     9.215799E+02
Start evaluation of j
Updating the turbine cache
Runtime: 44.4226138592 s
|dj| = 1040.13371351
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.068e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.263e-07 (tol = 1.000e-10) r (rel) = 3.056e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.510e-12 (tol = 1.000e-10) r (rel) = 1.414e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 87.592937 s.
j = 1.089293e+06.
Runtime: 87.552637 s.
j = 1.089293e+06.
End of time loop.
Start evaluation of dj
Runtime: 87.596519 s.
found a tidal farm, computing gradient
End of time loop.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Runtime: 87.562481 s.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 37.7919371128 s
|dj| = 1040.09789882
Runtime: 37.8023889065 s
|dj| = 1040.09789882
Start evaluation of j
Runtime: 37.7935709953 s
|dj| = 1040.09789882
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   89   388    -9.651358E+05     9.215481E+02
Start evaluation of j
Updating the turbine cache
Runtime: 37.7969977856 s
|dj| = 1040.09789882
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.460e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.204e-07 (tol = 1.000e-10) r (rel) = 2.205e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.496e-12 (tol = 1.000e-10) r (rel) = 2.740e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 86.429166 s.
End of time loop.
j = 1.089293e+06.
End of time loop.
Runtime: 86.423346 s.
j = 1.089293e+06.
Runtime: 86.428242 s.
Runtime: 86.430075 s.
j = 1.089293e+06.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 44.125770092 s
|dj| = 1040.12367251
Runtime: 44.1267578602 s
|dj| = 1040.12367251
   90   389    -9.651358E+05     9.215710E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 44.1619110107 s
|dj| = 1040.12367251
Runtime: 44.1636638641 s
|dj| = 1040.12367251
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.303e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.074e-08 (tol = 1.000e-10) r (rel) = 9.307e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.492e-12 (tol = 1.000e-10) r (rel) = 4.517e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 91.920571 s.
j = 1.089293e+06.
End of time loop.
Runtime: 91.919781 s.
j = 1.089293e+06.
Runtime: 91.958574 s.
j = 1.089293e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 91.959135 s.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 48.3963029385 s
|dj| = 1040.09555383
Runtime: 48.399173975 s
|dj| = 1040.09555383
Start evaluation of j
Updating the turbine cache
   91   390    -9.651358E+05     9.215460E+02
Start evaluation of j
Updating the turbine cache
Runtime: 48.4343578815 s
|dj| = 1040.09555383
Runtime: 48.4357130527 s
|dj| = 1040.09555383
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.977e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.176e-08 (tol = 1.000e-10) r (rel) = 1.067e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.489e-12 (tol = 1.000e-10) r (rel) = 5.003e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 90.411154 s.
j = 1.089293e+06.
Runtime: 90.374497 s.
j = 1.089293e+06.
End of time loop.
Runtime: 90.410524 s.
Start evaluation of dj
Start evaluation of dj
j = 1.089293e+06.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 90.374531 s.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 44.7455749512 s
|dj| = 1040.05451004
Start evaluation of j
Updating the turbine cache
Runtime: 44.7754359245 s
|dj| = 1040.05451004
Start evaluation of j
Updating the turbine cache
Runtime: 44.7841091156 s
|dj| = 1040.05451004
   92   391    -9.651358E+05     9.215097E+02
Start evaluation of j
Updating the turbine cache
Runtime: 44.8655450344 s
|dj| = 1040.05451004
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.039e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.389e-08 (tol = 1.000e-10) r (rel) = 6.810e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.489e-12 (tol = 1.000e-10) r (rel) = 7.300e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
Runtime: 81.992956 s.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 82.071375 s.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
End of time loop.
Runtime: 82.117546 s.
j = 1.089293e+06.
Runtime: 82.083956 s.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 45.4207642078 s
|dj| = 1040.05252983
Runtime: 45.426897049 s
|dj| = 1040.05252983
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 45.4617581367 s
|dj| = 1040.05252983
   93   392    -9.651358E+05     9.215079E+02
Start evaluation of j
Updating the turbine cache
Runtime: 45.4622020721 s
|dj| = 1040.05252983
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.068e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.502e-09 (tol = 1.000e-10) r (rel) = 2.125e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.487e-12 (tol = 1.000e-10) r (rel) = 2.104e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 76.253693 s.
j = 1.089293e+06.
End of time loop.
Runtime: 76.255284 s.
j = 1.089293e+06.
Runtime: 76.217736 s.
Start evaluation of j
j = 1.089293e+06.
Updating the turbine cache
End of time loop.
Runtime: 76.214495 s.
j = 1.089293e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.210e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.194e-09 (tol = 1.000e-10) r (rel) = 1.922e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.486e-12 (tol = 1.000e-10) r (rel) = 2.393e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 91.159445 s.
j = 1.089293e+06.
End of time loop.
Runtime: 91.159568 s.
j = 1.089293e+06.
Runtime: 91.161260 s.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 91.159479 s.
Start evaluation of dj
j = 1.089293e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 46.4650690556 s
Runtime: 46.4648189545 s
|dj| = 1040.05327583
|dj| = 1040.05327583
Start evaluation of j
Updating the turbine cache
   95   394    -9.651358E+05     9.215086E+02
Start evaluation of j
Updating the turbine cache
Runtime: 46.5038468838 s
|dj| = 1040.05327583
Start evaluation of j
Updating the turbine cache
Runtime: 46.5390870571 s
|dj| = 1040.05327583
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.385e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.504e-03 (tol = 1.000e-10) r (rel) = 5.372e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.393e-07 (tol = 1.000e-10) r (rel) = 1.661e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.497e-12 (tol = 1.000e-10) r (rel) = 1.786e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 126.491539 s.
Runtime: 126.492173 s.
j = 1.088950e+06.
Runtime: 126.416700 s.
j = 1.088950e+06.
j = 1.088950e+06.
Runtime: 126.450814 s.
j = 1.088950e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.548e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.650e-03 (tol = 1.000e-10) r (rel) = 4.836e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.162e-08 (tol = 1.000e-10) r (rel) = 1.214e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.491e-12 (tol = 1.000e-10) r (rel) = 1.975e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 132.261080 s.
j = 1.089289e+06.
Runtime: 132.261058 s.
j = 1.089289e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 132.266595 s.
Runtime: 132.267590 s.
j = 1.089289e+06.
j = 1.089289e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.548e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.654e-05 (tol = 1.000e-10) r (rel) = 4.841e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.925e-11 (tol = 1.000e-10) r (rel) = 5.201e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 80.343992 s.
j = 1.089293e+06.
Runtime: 80.346513 s.
End of time loop.
j = 1.089293e+06.
End of time loop.
Runtime: 80.332608 s.
j = 1.089293e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 80.347407 s.
j = 1.089293e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.547e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.654e-07 (tol = 1.000e-10) r (rel) = 4.841e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.543e-12 (tol = 1.000e-10) r (rel) = 2.045e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 80.682765 s.
j = 1.089293e+06.
Runtime: 80.683327 s.
j = 1.089293e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 80.684729 s.
j = 1.089293e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 80.684764 s.
j = 1.089293e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.644e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.473e-09 (tol = 1.000e-10) r (rel) = 3.172e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.486e-12 (tol = 1.000e-10) r (rel) = 3.200e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 93.666627 s.
j = 1.089293e+06.
End of time loop.
Runtime: 93.666652 s.
j = 1.089293e+06.
Runtime: 93.665950 s.
j = 1.089293e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 93.665648 s.
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 48.2616729736 s
|dj| = 1040.0599174
Runtime: 48.26288414 s
|dj| = 1040.0599174
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 48.266657114 s
|dj| = 1040.0599174
Runtime: 48.2664442062 s
|dj| = 1040.0599174
Start evaluation of j
Updating the turbine cache
   96   399    -9.651358E+05     9.215145E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.093e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.969e-04 (tol = 1.000e-10) r (rel) = 9.598e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.083e-10 (tol = 1.000e-10) r (rel) = 2.290e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.485e-12 (tol = 1.000e-10) r (rel) = 4.802e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 119.723949 s.
j = 1.089277e+06.
Runtime: 119.728535 s.
j = 1.089277e+06.
Runtime: 119.729527 s.
j = 1.089277e+06.
Runtime: 119.722170 s.
j = 1.089277e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.776e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.400e-04 (tol = 1.000e-10) r (rel) = 8.646e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.674e-10 (tol = 1.000e-10) r (rel) = 1.684e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.479e-12 (tol = 1.000e-10) r (rel) = 5.329e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 126.904421 s.
j = 1.089293e+06.
Runtime: 126.904439 s.
End of time loop.
j = 1.089293e+06.
Runtime: 126.904783 s.
j = 1.089293e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 126.905139 s.
Start evaluation of j
j = 1.089293e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.784e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.428e-06 (tol = 1.000e-10) r (rel) = 8.718e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.372e-12 (tol = 1.000e-10) r (rel) = 8.519e-11 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 90.783677 s.
j = 1.089293e+06.
Runtime: 90.781113 s.
End of time loop.
j = 1.089293e+06.
Runtime: 90.784349 s.
j = 1.089293e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 90.784828 s.
j = 1.089293e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.583e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.101e-08 (tol = 1.000e-10) r (rel) = 8.134e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.493e-12 (tol = 1.000e-10) r (rel) = 5.778e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 89.385999 s.
Runtime: 89.385415 s.
j = 1.089293e+06.
End of time loop.
j = 1.089293e+06.
End of time loop.
Runtime: 89.385590 s.
j = 1.089293e+06.
Runtime: 89.383911 s.
Start evaluation of dj
j = 1.089293e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 46.4842541218 s
|dj| = 1040.06230174
Start evaluation of j
Updating the turbine cache
Runtime: 46.4892189503 s
|dj| = 1040.06230174
Start evaluation of j
Updating the turbine cache
Runtime: 46.5200321674 s
|dj| = 1040.06230174
Start evaluation of j
Updating the turbine cache
Runtime: 46.5266690254 s
|dj| = 1040.06230174
   97   403    -9.651358E+05     9.215166E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.078e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.365e-04 (tol = 1.000e-10) r (rel) = 1.806e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.415e-09 (tol = 1.000e-10) r (rel) = 1.573e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.488e-12 (tol = 1.000e-10) r (rel) = 3.649e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 127.492465 s.
j = 1.089252e+06.
End of time loop.
End of time loop.
Runtime: 127.454718 s.
j = 1.089252e+06.
Runtime: 127.460108 s.
j = 1.089252e+06.
Runtime: 127.497819 s.
j = 1.089252e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.661e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.952e-04 (tol = 1.000e-10) r (rel) = 1.626e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.150e-09 (tol = 1.000e-10) r (rel) = 1.134e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.487e-12 (tol = 1.000e-10) r (rel) = 4.062e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 121.681754 s.
j = 1.089292e+06.
Runtime: 121.683015 s.
Runtime: 121.682229 s.
j = 1.089292e+06.
j = 1.089292e+06.
Runtime: 121.682267 s.
j = 1.089292e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.671e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.991e-06 (tol = 1.000e-10) r (rel) = 1.632e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.589e-12 (tol = 1.000e-10) r (rel) = 1.522e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 88.713881 s.
j = 1.089293e+06.
End of time loop.
End of time loop.
Runtime: 88.713568 s.
j = 1.089293e+06.
Start evaluation of j
Runtime: 88.714525 s.
j = 1.089293e+06.
Updating the turbine cache
Runtime: 88.714865 s.
j = 1.089293e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.672e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.006e-08 (tol = 1.000e-10) r (rel) = 1.636e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.487e-12 (tol = 1.000e-10) r (rel) = 4.051e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 89.788488 s.
j = 1.089293e+06.
End of time loop.
End of time loop.
Runtime: 89.788390 s.
j = 1.089293e+06.
Runtime: 89.788792 s.
j = 1.089293e+06.
Start evaluation of dj
Runtime: 89.790159 s.
found a tidal farm, computing gradient
j = 1.089293e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 41.5895700455 s
Runtime: 41.5880160332 s
|dj| = 1040.05679905
|dj| = 1040.05679905
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 41.59019804 s
|dj| = 1040.05679905
Runtime: 41.5927021503 s
|dj| = 1040.05679905
   98   407    -9.651358E+05     9.215117E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.794e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.763e-05 (tol = 1.000e-10) r (rel) = 5.538e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.588e-11 (tol = 1.000e-10) r (rel) = 6.752e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 83.709245 s.
j = 1.089291e+06.
Runtime: 83.704619 s.
j = 1.089291e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 83.710697 s.
Runtime: 83.707638 s.
j = 1.089291e+06.
j = 1.089291e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.115e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.047e-05 (tol = 1.000e-10) r (rel) = 4.983e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.656e-11 (tol = 1.000e-10) r (rel) = 5.979e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 95.198279 s.
j = 1.089293e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 95.201797 s.
j = 1.089293e+06.
Runtime: 95.199759 s.
j = 1.089293e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 95.201746 s.
Start evaluation of j
j = 1.089293e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.116e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.046e-07 (tol = 1.000e-10) r (rel) = 4.981e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.533e-12 (tol = 1.000e-10) r (rel) = 2.507e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 90.539402 s.
j = 1.089293e+06.
Runtime: 90.551832 s.
j = 1.089293e+06.
Runtime: 90.547320 s.
j = 1.089293e+06.
Runtime: 90.549126 s.
j = 1.089293e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.116e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.166e-09 (tol = 1.000e-10) r (rel) = 5.176e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.483e-12 (tol = 1.000e-10) r (rel) = 2.425e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 86.141120 s.
j = 1.089293e+06.
Runtime: 86.142424 s.
j = 1.089293e+06.
Runtime: 86.142425 s.
j = 1.089293e+06.
Runtime: 86.142888 s.
j = 1.089293e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 813003 x 813003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.409e-05 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.454e-11 (tol = 1.000e-10) r (rel) = 1.600e-06 (tol = 1.000e-09)
  Newton solver finished in 1 iterations and 1 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 181202 x 181202 (PETSc Krylov solver).
Solving linear system of size 90601 x 90601 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 36.138683 s.
j = 1.089293e+06.
Runtime: 36.138653 s.
j = 1.089293e+06.
Runtime: 36.137990 s.
j = 1.089293e+06.
Runtime: 36.139181 s.
j = 1.089293e+06.
Optimization terminated successfully.    (Exit mode 0)
            Current function value: -965135.801152
            Iterations: 98
            Function evaluations: 412
            Gradient evaluations: 96
