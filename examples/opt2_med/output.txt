Number of global vertices: 40401
Number of global cells: 80000
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (386.67, 160.00).
Turbine added at (160.00, 840.00).
Turbine added at (386.67, 160.00).
Turbine added at (386.67, 386.67).
Turbine added at (386.67, 613.33).
Turbine added at (386.67, 840.00).
Turbine added at (613.33, 160.00).
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (386.67, 386.67).
Turbine added at (386.67, 613.33).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (386.67, 840.00).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (613.33, 840.00).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (840.00, 160.00).
Turbine added at (840.00, 386.67).
Turbine added at (386.67, 160.00).
Turbine added at (386.67, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 840.00).
Turbine added at (840.00, 613.33).
Turbine added at (840.00, 840.00).
Turbine added at (386.67, 613.33).
Turbine added at (386.67, 840.00).
Turbine added at (840.00, 160.00).
Turbine added at (840.00, 386.67).
Added 16 turbines to the site in an 4x4 rectangular array.
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (840.00, 613.33).
Turbine added at (840.00, 840.00).
Turbine added at (613.33, 840.00).
Added 16 turbines to the site in an 4x4 rectangular array.
Turbine added at (840.00, 160.00).
Turbine added at (840.00, 386.67).
Turbine added at (840.00, 613.33).
Turbine added at (840.00, 840.00).
Added 16 turbines to the site in an 4x4 rectangular array.
Turbine added at (160.00, 160.00).
Turbine added at (160.00, 386.67).
Turbine added at (160.00, 613.33).
Turbine added at (160.00, 840.00).
Turbine added at (386.67, 160.00).
Turbine added at (386.67, 386.67).
Turbine added at (386.67, 613.33).
Turbine added at (386.67, 840.00).
Turbine added at (613.33, 160.00).
Turbine added at (613.33, 386.67).
Turbine added at (613.33, 613.33).
Turbine added at (613.33, 840.00).
Turbine added at (840.00, 160.00).
Turbine added at (840.00, 386.67).
Turbine added at (840.00, 613.33).
Turbine added at (840.00, 840.00).
Added 16 turbines to the site in an 4x4 rectangular array.
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0

  NIT    FC           OBJFUN            GNORM
Start evaluation of j
Start evaluation of j
Start evaluation of j
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Start evaluation of j
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.005e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.091e+02 (tol = 1.000e-10) r (rel) = 2.725e+00 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.095e+01 (tol = 1.000e-10) r (rel) = 5.231e-01 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.160e+00 (tol = 1.000e-10) r (rel) = 5.394e-02 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.727e-02 (tol = 1.000e-10) r (rel) = 9.307e-04 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.486e-05 (tol = 1.000e-10) r (rel) = 3.710e-07 (tol = 1.000e-09)
  Newton iteration 6: r (abs) = 4.326e-11 (tol = 1.000e-10) r (rel) = 1.080e-12 (tol = 1.000e-09)
  Newton solver finished in 6 iterations and 6 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.499398 s.
j = 6.033373e+05.
Runtime: 78.499114 s.
j = 6.033373e+05.
Computing derivative to determine the automatic scaling factor
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 78.499415 s.
j = 6.033373e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 78.501080 s.
j = 6.033373e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 15.1045219898 s
Runtime: 15.1031110287 s
Runtime: 15.1053380966 s
Runtime: 15.1053299904 s
|dj| = 578.837303919
|dj| = 578.837303919
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 3.856443e-01.
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 3.856443e-01.
|dj| = 578.837303919
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 3.856443e-01.
|dj| = 578.837303919
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing _set_automatic_scaling_factor
Use checkpoint value.
found a tidal farm, computing _dj
Use checkpoint value.
found a tidal farm, computing _dj
Set automatic scaling factor to 3.856443e-01.
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Runtime: 0.0233240127563 s
|dj| = 578.837303919
Runtime: 0.0239338874817 s
|dj| = 578.837303919
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 0.0359628200531 s
|dj| = 578.837303919
Start evaluation of j
Updating the turbine cache
Runtime: 0.0384860038757 s
|dj| = 578.837303919
    1     1    -2.326736E+05     2.232253E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.981e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.436e+01 (tol = 1.000e-10) r (rel) = 2.440e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.312e+00 (tol = 1.000e-10) r (rel) = 2.316e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.662e-02 (tol = 1.000e-10) r (rel) = 3.669e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.396e-05 (tol = 1.000e-10) r (rel) = 1.398e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.671e-11 (tol = 1.000e-10) r (rel) = 4.680e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 79.475360 s.
Runtime: 79.471325 s.
j = 6.758518e+05.
End of time loop.
End of time loop.
j = 6.758518e+05.
Runtime: 79.490248 s.
Runtime: 79.490718 s.
j = 6.758518e+05.
j = 6.758518e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.6712207794 s
|dj| = 4177.52491043
Runtime: 14.6731100082 s
|dj| = 4177.52491043
Start evaluation of j
Updating the turbine cache
    2     2    -2.606384E+05     1.611039E+03
Start evaluation of j
Updating the turbine cache
Runtime: 14.6803240776 s
|dj| = 4177.52491043
Runtime: 14.680742979 s
|dj| = 4177.52491043
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.098e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.498e+01 (tol = 1.000e-10) r (rel) = 2.276e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.226e+00 (tol = 1.000e-10) r (rel) = 2.028e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.033e-02 (tol = 1.000e-10) r (rel) = 2.763e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.176e-05 (tol = 1.000e-10) r (rel) = 1.071e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.779e-11 (tol = 1.000e-10) r (rel) = 3.442e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.970661 s.
j = 8.032923e+05.
Runtime: 75.959837 s.
j = 8.032923e+05.
End of time loop.
Runtime: 75.970187 s.
Start evaluation of dj
Start evaluation of dj
j = 8.032923e+05.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 75.960911 s.
j = 8.032923e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 13.0709309578 s
Runtime: 13.0709218979 s
|dj| = 6113.68623345
|dj| = 6113.68623345
Runtime: 13.0685970783 s
|dj| = 6113.68623345
Runtime: 13.0709578991 s
|dj| = 6113.68623345
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
    3     3    -3.097851E+05     2.357708E+03
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.631e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.275e+01 (tol = 1.000e-10) r (rel) = 2.362e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.939e+00 (tol = 1.000e-10) r (rel) = 2.014e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.606e-02 (tol = 1.000e-10) r (rel) = 2.706e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.431e-06 (tol = 1.000e-10) r (rel) = 8.754e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.792e-11 (tol = 1.000e-10) r (rel) = 2.899e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 74.043094 s.
Runtime: 74.044269 s.
j = 7.820633e+05.
j = 7.820633e+05.
Runtime: 74.044517 s.
j = 7.820633e+05.
Runtime: 74.043608 s.
j = 7.820633e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.576e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.127e+01 (tol = 1.000e-10) r (rel) = 2.480e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.708e+00 (tol = 1.000e-10) r (rel) = 1.992e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.720e-02 (tol = 1.000e-10) r (rel) = 2.006e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.247e-06 (tol = 1.000e-10) r (rel) = 3.787e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.326e-11 (tol = 1.000e-10) r (rel) = 1.547e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 68.850371 s.
Runtime: 68.850365 s.
j = 7.677994e+05.
j = 7.677994e+05.
Runtime: 68.849669 s.
j = 7.677994e+05.
Runtime: 68.850592 s.
j = 7.677994e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.311e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.863e+01 (tol = 1.000e-10) r (rel) = 2.549e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.407e+00 (tol = 1.000e-10) r (rel) = 1.924e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.388e-02 (tol = 1.000e-10) r (rel) = 1.899e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.579e-06 (tol = 1.000e-10) r (rel) = 2.159e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.458e-12 (tol = 1.000e-10) r (rel) = 6.098e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 79.328904 s.
j = 8.103964e+05.
Runtime: 79.329035 s.
j = 8.103964e+05.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 79.328888 s.
j = 8.103964e+05.
End of time loop.
Runtime: 79.330821 s.
j = 8.103964e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.6833028793 s
|dj| = 6345.63881045
    4     6    -3.125248E+05     2.447160E+03
Start evaluation of j
Updating the turbine cache
Runtime: 14.6900467873 s
|dj| = 6345.63881045
Start evaluation of j
Updating the turbine cache
Runtime: 14.6940979958 s
|dj| = 6345.63881045
Start evaluation of j
Updating the turbine cache
Runtime: 14.7226338387 s
|dj| = 6345.63881045
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.560e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.263e+01 (tol = 1.000e-10) r (rel) = 2.367e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.894e+00 (tol = 1.000e-10) r (rel) = 1.981e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.312e-02 (tol = 1.000e-10) r (rel) = 2.418e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.763e-06 (tol = 1.000e-10) r (rel) = 7.074e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.435e-11 (tol = 1.000e-10) r (rel) = 2.547e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 79.058469 s.
j = 8.810800e+05.
Runtime: 79.074634 s.
End of time loop.
j = 8.810800e+05.
End of time loop.
Runtime: 79.035642 s.
Start evaluation of j
j = 8.810800e+05.
Updating the turbine cache
Runtime: 79.065441 s.
j = 8.810800e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.439e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.265e+01 (tol = 1.000e-10) r (rel) = 2.400e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.768e+00 (tol = 1.000e-10) r (rel) = 1.873e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.758e-02 (tol = 1.000e-10) r (rel) = 1.862e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.249e-06 (tol = 1.000e-10) r (rel) = 4.501e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.456e-11 (tol = 1.000e-10) r (rel) = 1.543e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 74.567994 s.
j = 8.873045e+05.
Runtime: 74.568004 s.
End of time loop.
j = 8.873045e+05.
End of time loop.
Runtime: 74.569996 s.
Start evaluation of j
j = 8.873045e+05.
Updating the turbine cache
Runtime: 74.569438 s.
j = 8.873045e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.785e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.363e+01 (tol = 1.000e-10) r (rel) = 2.415e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.864e+00 (tol = 1.000e-10) r (rel) = 1.905e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.030e-02 (tol = 1.000e-10) r (rel) = 2.075e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.886e-06 (tol = 1.000e-10) r (rel) = 3.971e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.609e-11 (tol = 1.000e-10) r (rel) = 1.645e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 72.138968 s.
j = 8.599327e+05.
End of time loop.
End of time loop.
Runtime: 72.138959 s.
Runtime: 72.140308 s.
j = 8.599327e+05.
j = 8.599327e+05.
Start evaluation of dj
Runtime: 72.139189 s.
found a tidal farm, computing gradient
j = 8.599327e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.5572419167 s
|dj| = 3859.6452479
Runtime: 14.5576519966 s
|dj| = 3859.6452479
Start evaluation of j
Updating the turbine cache
    5     9    -3.316282E+05     1.488450E+03
Start evaluation of j
Updating the turbine cache
Runtime: 14.5740718842 s
|dj| = 3859.6452479
Runtime: 14.5758740902 s
|dj| = 3859.6452479
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.035e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.672e+01 (tol = 1.000e-10) r (rel) = 2.581e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.204e+00 (tol = 1.000e-10) r (rel) = 2.129e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.897e-02 (tol = 1.000e-10) r (rel) = 3.764e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.390e-05 (tol = 1.000e-10) r (rel) = 3.274e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.106e-10 (tol = 1.000e-10) r (rel) = 1.068e-12 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 74.726933 s.
j = 9.027323e+05.
Runtime: 74.707013 s.
j = 9.027323e+05.
End of time loop.
Start evaluation of j
Runtime: 74.725924 s.
j = 9.027323e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 74.707576 s.
Start evaluation of j
j = 9.027323e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.064e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.474e+01 (tol = 1.000e-10) r (rel) = 2.325e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.027e+00 (tol = 1.000e-10) r (rel) = 1.905e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.832e-02 (tol = 1.000e-10) r (rel) = 2.661e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.172e-05 (tol = 1.000e-10) r (rel) = 1.102e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.853e-11 (tol = 1.000e-10) r (rel) = 3.620e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.290315 s.
j = 9.302780e+05.
Runtime: 78.287790 s.
End of time loop.
j = 9.302780e+05.
End of time loop.
Runtime: 78.289890 s.
j = 9.302780e+05.
Start evaluation of dj
Runtime: 78.291229 s.
found a tidal farm, computing gradient
j = 9.302780e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.6218078136 s
|dj| = 9008.72850258
Start evaluation of j
Runtime: 15.6238029003 s
Updating the turbine cache
|dj| = 9008.72850258
    6    11    -3.587564E+05     3.474165E+03
Start evaluation of j
Updating the turbine cache
Runtime: 15.6377859116 s
|dj| = 9008.72850258
Runtime: 15.6397109032 s
|dj| = 9008.72850258
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.076e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.527e+01 (tol = 1.000e-10) r (rel) = 2.349e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.996e+00 (tol = 1.000e-10) r (rel) = 1.856e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.202e-02 (tol = 1.000e-10) r (rel) = 2.048e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.055e-06 (tol = 1.000e-10) r (rel) = 5.630e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.936e-11 (tol = 1.000e-10) r (rel) = 1.800e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 74.445589 s.
j = 9.374292e+05.
Runtime: 74.428129 s.
j = 9.374292e+05.
End of time loop.
End of time loop.
Start evaluation of j
Updating the turbine cache
Runtime: 74.427629 s.
j = 9.374292e+05.
Runtime: 74.444262 s.
j = 9.374292e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.662e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.627e+01 (tol = 1.000e-10) r (rel) = 2.719e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.452e+00 (tol = 1.000e-10) r (rel) = 2.538e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.463e-02 (tol = 1.000e-10) r (rel) = 5.654e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.116e-05 (tol = 1.000e-10) r (rel) = 4.260e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.007e-11 (tol = 1.000e-10) r (rel) = 3.112e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.154491 s.
Runtime: 78.152867 s.
j = 9.237164e+05.
j = 9.237164e+05.
End of time loop.
End of time loop.
Start evaluation of j
Runtime: 78.154537 s.
Runtime: 78.153734 s.
j = 9.237164e+05.
j = 9.237164e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.459e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.095e+01 (tol = 1.000e-10) r (rel) = 2.477e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.426e+00 (tol = 1.000e-10) r (rel) = 1.685e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.328e-02 (tol = 1.000e-10) r (rel) = 1.569e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.781e-06 (tol = 1.000e-10) r (rel) = 2.105e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.240e-12 (tol = 1.000e-10) r (rel) = 8.558e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.540969 s.
j = 9.095822e+05.
Runtime: 75.539786 s.
j = 9.095822e+05.
End of time loop.
Runtime: 75.541017 s.
j = 9.095822e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 75.541408 s.
j = 9.095822e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.298e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.846e+01 (tol = 1.000e-10) r (rel) = 2.530e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.242e+00 (tol = 1.000e-10) r (rel) = 1.702e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.148e-02 (tol = 1.000e-10) r (rel) = 1.573e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.366e-06 (tol = 1.000e-10) r (rel) = 1.872e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.740e-12 (tol = 1.000e-10) r (rel) = 6.495e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.454386 s.
j = 9.246757e+05.
End of time loop.
Runtime: 75.457144 s.
j = 9.246757e+05.
Runtime: 75.457546 s.
j = 9.246757e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 75.457389 s.
Start evaluation of j
j = 9.246757e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.383e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.411e+00 (tol = 1.000e-10) r (rel) = 1.919e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.413e-01 (tol = 1.000e-10) r (rel) = 7.787e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.832e-04 (tol = 1.000e-10) r (rel) = 2.243e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.292e-08 (tol = 1.000e-10) r (rel) = 2.947e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 60.342805 s.
j = 9.287172e+05.
Runtime: 60.345695 s.
j = 9.287172e+05.
End of time loop.
Runtime: 60.344936 s.
j = 9.287172e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 60.347047 s.
j = 9.287172e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.255e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.678e+00 (tol = 1.000e-10) r (rel) = 1.187e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.824e-02 (tol = 1.000e-10) r (rel) = 1.696e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.115e-05 (tol = 1.000e-10) r (rel) = 4.947e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.017e-11 (tol = 1.000e-10) r (rel) = 2.225e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 57.201324 s.
j = 9.235421e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 57.201894 s.
j = 9.235421e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 57.202066 s.
j = 9.235421e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 57.205663 s.
j = 9.235421e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.091e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.830e-01 (tol = 1.000e-10) r (rel) = 6.262e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.713e-03 (tol = 1.000e-10) r (rel) = 2.488e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.753e-08 (tol = 1.000e-10) r (rel) = 6.192e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.148e-12 (tol = 1.000e-10) r (rel) = 1.052e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 54.895439 s.
j = 9.250208e+05.
Runtime: 54.895438 s.
j = 9.250208e+05.
End of time loop.
Start evaluation of j
End of time loop.
Start evaluation of j
Runtime: 54.895450 s.
j = 9.250208e+05.
Updating the turbine cache
Updating the turbine cache
Runtime: 54.890459 s.
j = 9.250208e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.012e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.985e-01 (tol = 1.000e-10) r (rel) = 3.302e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.478e-04 (tol = 1.000e-10) r (rel) = 4.121e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.118e-09 (tol = 1.000e-10) r (rel) = 1.860e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 41.180493 s.
j = 9.317797e+05.
Runtime: 41.181898 s.
j = 9.317797e+05.
End of time loop.
End of time loop.
Start evaluation of dj
Runtime: 41.182655 s.
j = 9.317797e+05.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 41.180796 s.
j = 9.317797e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.6320641041 s
|dj| = 7767.64164056
Runtime: 15.6309361458 s
|dj| = 7767.64164056
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 15.6399068832 s
|dj| = 7767.64164056
Runtime: 15.6427760124 s
|dj| = 7767.64164056
    7    19    -3.593356E+05     2.995547E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.098e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.554e+01 (tol = 1.000e-10) r (rel) = 2.325e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.052e+00 (tol = 1.000e-10) r (rel) = 1.869e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.458e-02 (tol = 1.000e-10) r (rel) = 2.238e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.603e-06 (tol = 1.000e-10) r (rel) = 6.923e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.976e-11 (tol = 1.000e-10) r (rel) = 1.800e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 75.950078 s.
j = 8.848856e+05.
Runtime: 75.960943 s.
j = 8.848856e+05.
Runtime: 75.950884 s.
j = 8.848856e+05.
Runtime: 75.961313 s.
j = 8.848856e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.518e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.252e+01 (tol = 1.000e-10) r (rel) = 2.366e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.785e+00 (tol = 1.000e-10) r (rel) = 1.875e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.001e-02 (tol = 1.000e-10) r (rel) = 2.102e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.192e-06 (tol = 1.000e-10) r (rel) = 4.404e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.724e-11 (tol = 1.000e-10) r (rel) = 1.811e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 67.171533 s.
j = 9.289133e+05.
Runtime: 67.171037 s.
j = 9.289133e+05.
End of time loop.
End of time loop.
Runtime: 67.172215 s.
Start evaluation of j
j = 9.289133e+05.
Updating the turbine cache
Runtime: 67.172521 s.
j = 9.289133e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.603e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.482e+01 (tol = 1.000e-10) r (rel) = 2.584e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.208e+00 (tol = 1.000e-10) r (rel) = 2.299e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.941e-02 (tol = 1.000e-10) r (rel) = 3.063e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.275e-06 (tol = 1.000e-10) r (rel) = 7.576e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.065e-11 (tol = 1.000e-10) r (rel) = 1.109e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 69.565835 s.
j = 9.493314e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 69.567497 s.
j = 9.493314e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
End of time loop.
Runtime: 69.576501 s.
j = 9.493314e+05.
Runtime: 69.577867 s.
j = 9.493314e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.177e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.985e+01 (tol = 1.000e-10) r (rel) = 2.427e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.386e+00 (tol = 1.000e-10) r (rel) = 1.695e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.301e-02 (tol = 1.000e-10) r (rel) = 1.591e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.633e-06 (tol = 1.000e-10) r (rel) = 1.997e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.777e-12 (tol = 1.000e-10) r (rel) = 7.065e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 76.864584 s.
j = 9.487094e+05.
Runtime: 76.859163 s.
j = 9.487094e+05.
End of time loop.
Runtime: 76.875579 s.
j = 9.487094e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 76.877452 s.
Start evaluation of j
j = 9.487094e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.677e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.194e+01 (tol = 1.000e-10) r (rel) = 2.104e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.534e-01 (tol = 1.000e-10) r (rel) = 1.151e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.421e-03 (tol = 1.000e-10) r (rel) = 7.787e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.582e-07 (tol = 1.000e-10) r (rel) = 4.549e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.375e-12 (tol = 1.000e-10) r (rel) = 2.421e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 73.521372 s.
Runtime: 73.519955 s.
End of time loop.
End of time loop.
j = 9.330630e+05.
j = 9.330630e+05.
Runtime: 73.522915 s.
Runtime: 73.522825 s.
j = 9.330630e+05.
j = 9.330630e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.561e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.819e+00 (tol = 1.000e-10) r (rel) = 1.634e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.900e-01 (tol = 1.000e-10) r (rel) = 5.335e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.239e-04 (tol = 1.000e-10) r (rel) = 1.190e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.828e-09 (tol = 1.000e-10) r (rel) = 7.942e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 56.823699 s.
j = 9.282101e+05.
Runtime: 56.823734 s.
j = 9.282101e+05.
End of time loop.
Runtime: 56.825347 s.
Start evaluation of j
Start evaluation of j
j = 9.282101e+05.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 56.825961 s.
j = 9.282101e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.923e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.949e+00 (tol = 1.000e-10) r (rel) = 1.013e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.362e-02 (tol = 1.000e-10) r (rel) = 1.228e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.106e-06 (tol = 1.000e-10) r (rel) = 3.175e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.987e-11 (tol = 1.000e-10) r (rel) = 1.033e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 65.251516 s.
j = 9.282366e+05.
End of time loop.
Runtime: 65.248839 s.
j = 9.282366e+05.
Runtime: 65.250780 s.
j = 9.282366e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 65.253192 s.
j = 9.282366e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.875e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.197e-01 (tol = 1.000e-10) r (rel) = 5.263e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.597e-03 (tol = 1.000e-10) r (rel) = 1.617e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.271e-08 (tol = 1.000e-10) r (rel) = 2.299e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.098e-12 (tol = 1.000e-10) r (rel) = 1.112e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 47.918380 s.
End of time loop.
j = 9.314510e+05.
Runtime: 47.921072 s.
j = 9.314510e+05.
Runtime: 47.920176 s.
Runtime: 47.921233 s.
j = 9.314510e+05.
j = 9.314510e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.621e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.131e-01 (tol = 1.000e-10) r (rel) = 2.447e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.238e-05 (tol = 1.000e-10) r (rel) = 1.999e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.883e-10 (tol = 1.000e-10) r (rel) = 8.404e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 35.876441 s.
Runtime: 35.875909 s.
j = 9.351320e+05.
j = 9.351320e+05.
Runtime: 35.876874 s.
j = 9.351320e+05.
Runtime: 35.877133 s.
j = 9.351320e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.5599329472 s
|dj| = 7637.55213822
Runtime: 11.5600891113 s
|dj| = 7637.55213822
Runtime: 11.5612139702 s
|dj| = 7637.55213822
Start evaluation of j
Updating the turbine cache
Runtime: 11.5621140003 s
|dj| = 7637.55213822
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
    8    28    -3.606283E+05     2.945379E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.627e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.465e+01 (tol = 1.000e-10) r (rel) = 2.560e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.891e+00 (tol = 1.000e-10) r (rel) = 1.964e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.753e-02 (tol = 1.000e-10) r (rel) = 1.821e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.424e-06 (tol = 1.000e-10) r (rel) = 2.518e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.623e-12 (tol = 1.000e-10) r (rel) = 7.918e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 57.610490 s.
Runtime: 57.612102 s.
j = 8.913469e+05.
Runtime: 57.609920 s.
j = 8.913469e+05.
j = 8.913469e+05.
Runtime: 57.609939 s.
j = 8.913469e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.007e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.380e+01 (tol = 1.000e-10) r (rel) = 2.364e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.693e+00 (tol = 1.000e-10) r (rel) = 1.682e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.420e-02 (tol = 1.000e-10) r (rel) = 1.411e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.718e-06 (tol = 1.000e-10) r (rel) = 1.707e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.961e-12 (tol = 1.000e-10) r (rel) = 5.922e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 70.186964 s.
j = 9.850807e+05.
End of time loop.
End of time loop.
Runtime: 70.186827 s.
j = 9.850807e+05.
Runtime: 70.187881 s.
j = 9.850807e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 70.193701 s.
j = 9.850807e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.633e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.451e+01 (tol = 1.000e-10) r (rel) = 2.544e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.897e+00 (tol = 1.000e-10) r (rel) = 1.970e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.975e-02 (tol = 1.000e-10) r (rel) = 2.050e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.696e-06 (tol = 1.000e-10) r (rel) = 2.799e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.155e-11 (tol = 1.000e-10) r (rel) = 1.199e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 77.920118 s.
j = 9.607755e+05.
Runtime: 77.932611 s.
j = 9.607755e+05.
End of time loop.
Runtime: 77.933742 s.
j = 9.607755e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 77.934316 s.
j = 9.607755e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.673e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.825e+01 (tol = 1.000e-10) r (rel) = 2.378e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.203e+00 (tol = 1.000e-10) r (rel) = 1.568e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.078e-02 (tol = 1.000e-10) r (rel) = 1.405e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.474e-06 (tol = 1.000e-10) r (rel) = 1.921e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.645e-12 (tol = 1.000e-10) r (rel) = 6.053e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.196447 s.
j = 9.655806e+05.
Runtime: 75.195338 s.
j = 9.655806e+05.
End of time loop.
Runtime: 75.194744 s.
j = 9.655806e+05.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 75.197781 s.
j = 9.655806e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.3287210464 s
|dj| = 7837.93521797
Runtime: 15.3290569782 s
|dj| = 7837.93521797
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 15.3418178558 s
|dj| = 7837.93521797
Runtime: 15.3452560902 s
|dj| = 7837.93521797
Start evaluation of j
Updating the turbine cache
    9    32    -3.723707E+05     3.022655E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.032e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.434e+01 (tol = 1.000e-10) r (rel) = 2.360e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.050e+00 (tol = 1.000e-10) r (rel) = 1.988e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.896e-02 (tol = 1.000e-10) r (rel) = 2.807e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.033e-05 (tol = 1.000e-10) r (rel) = 1.001e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.255e-11 (tol = 1.000e-10) r (rel) = 3.156e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 81.022382 s.
j = 8.308680e+05.
Runtime: 81.005367 s.
End of time loop.
End of time loop.
j = 8.308680e+05.
Start evaluation of j
Runtime: 81.003762 s.
Runtime: 81.022697 s.
j = 8.308680e+05.
j = 8.308680e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.539e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.207e+01 (tol = 1.000e-10) r (rel) = 2.585e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.721e+00 (tol = 1.000e-10) r (rel) = 2.016e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.477e-02 (tol = 1.000e-10) r (rel) = 1.730e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.153e-06 (tol = 1.000e-10) r (rel) = 1.351e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.565e-12 (tol = 1.000e-10) r (rel) = 4.175e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 72.600662 s.
j = 9.510678e+05.
Runtime: 72.600017 s.
j = 9.510678e+05.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Runtime: 72.600353 s.
Updating the turbine cache
j = 9.510678e+05.
Runtime: 72.600895 s.
j = 9.510678e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.662e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.890e+01 (tol = 1.000e-10) r (rel) = 2.467e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.244e+00 (tol = 1.000e-10) r (rel) = 1.623e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.833e-03 (tol = 1.000e-10) r (rel) = 1.283e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.435e-07 (tol = 1.000e-10) r (rel) = 1.101e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.579e-12 (tol = 1.000e-10) r (rel) = 4.671e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 79.912239 s.
j = 9.821067e+05.
Runtime: 79.912213 s.
j = 9.821067e+05.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Runtime: 79.910449 s.
j = 9.821067e+05.
Updating the turbine cache
End of time loop.
Runtime: 79.912592 s.
j = 9.821067e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.278e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.551e+01 (tol = 1.000e-10) r (rel) = 2.471e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.012e+00 (tol = 1.000e-10) r (rel) = 1.613e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.644e-03 (tol = 1.000e-10) r (rel) = 1.377e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.187e-07 (tol = 1.000e-10) r (rel) = 1.463e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.826e-12 (tol = 1.000e-10) r (rel) = 6.093e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 75.664042 s.
j = 9.833571e+05.
Runtime: 75.661278 s.
j = 9.833571e+05.
Runtime: 75.662628 s.
j = 9.833571e+05.
Runtime: 75.664498 s.
j = 9.833571e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 18.7585852146 s
|dj| = 7775.6748478
Runtime: 18.7619040012 s
|dj| = 7775.6748478
Start evaluation of j
Updating the turbine cache
Runtime: 18.7644631863 s
|dj| = 7775.6748478
Runtime: 18.7648050785 s
|dj| = 7775.6748478
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   10    36    -3.792261E+05     2.998645E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.170e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.983e+01 (tol = 1.000e-10) r (rel) = 2.765e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.469e+00 (tol = 1.000e-10) r (rel) = 2.049e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.134e-02 (tol = 1.000e-10) r (rel) = 1.582e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.456e-07 (tol = 1.000e-10) r (rel) = 1.319e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.127e-12 (tol = 1.000e-10) r (rel) = 2.966e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 77.047094 s.
j = 5.101132e+05.
Runtime: 77.053094 s.
j = 5.101132e+05.
End of time loop.
Runtime: 77.050258 s.
j = 5.101132e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
End of time loop.
Updating the turbine cache
Runtime: 77.049568 s.
j = 5.101132e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.624e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.841e+01 (tol = 1.000e-10) r (rel) = 2.134e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.562e+00 (tol = 1.000e-10) r (rel) = 1.811e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.353e-02 (tol = 1.000e-10) r (rel) = 2.728e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.221e-06 (tol = 1.000e-10) r (rel) = 9.532e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.506e-11 (tol = 1.000e-10) r (rel) = 1.747e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 73.882376 s.
j = 7.144874e+05.
Runtime: 73.885028 s.
j = 7.144874e+05.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 73.884701 s.
j = 7.144874e+05.
Updating the turbine cache
Updating the turbine cache
Runtime: 73.886422 s.
j = 7.144874e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.140e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.519e+01 (tol = 1.000e-10) r (rel) = 2.210e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.332e+00 (tol = 1.000e-10) r (rel) = 2.046e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.174e-02 (tol = 1.000e-10) r (rel) = 5.417e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.955e-05 (tol = 1.000e-10) r (rel) = 8.734e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.190e-10 (tol = 1.000e-10) r (rel) = 3.676e-12 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.991447 s.
j = 9.066466e+05.
End of time loop.
Runtime: 78.990173 s.
End of time loop.
j = 9.066466e+05.
Runtime: 78.992208 s.
Runtime: 78.989843 s.
j = 9.066466e+05.
j = 9.066466e+05.
Minimum distance inequality constraints (should all be > 0): [  4.62384891e+04   3.46997800e+05   1.38016187e+05   4.62202894e+05
   2.13843441e+05   7.32816878e+03   7.55808852e+04   1.20798165e+05
   4.18252802e+05   5.31488549e+05   1.25603746e+05   3.04824966e+04
   8.70244866e+04   1.42225873e+05   1.22611125e+05   1.24832565e+05
   1.11052994e+05   3.07227922e+05   3.95614356e+05   1.99741868e+04
   6.92314687e+04   5.92055021e+05   3.28407756e+05   9.56415406e+04
   7.98380795e+04   5.05098848e+05   1.70928829e+05   3.31948100e+05
   9.82111413e+04   8.10617040e+04   2.71452798e+05   3.58633499e+05
   1.97303548e+04   5.07677727e+04   1.44702028e+03   3.21387198e+05
   3.02122873e+05   1.14226638e+05   1.15048508e+04   2.81170258e+04
   3.18374635e+05   4.62089627e+04   2.10693857e+05   6.33263960e+04
   1.85258923e+05   2.56606070e+05   1.08255652e+05   7.34180756e+04
   1.05982767e+05   1.99609499e+05   2.32831136e+04   1.03515926e+05
   7.20941240e+04   9.23013808e+04   2.53247503e+04   5.19065385e+05
   2.91461210e+05   1.20567869e+05   1.19558143e+05   3.98661407e+05
   1.35210152e+05   2.41991389e+05   9.81015856e+03   2.38630271e+05
   6.78008165e+04   4.48966576e+04   4.77556336e+05   4.80192800e+05
   7.04540231e+05   7.98270850e+05   1.74816688e+05   3.47471701e+05
   1.28991267e+05   5.35152302e+05   1.66204284e+05   5.32483411e+05
   3.22431681e+05   3.94613022e+05   4.23543483e+05   3.09630879e+05
   3.33904735e+05   3.79581331e+05   2.00529664e+05   1.58702740e+05
   9.63597228e+04   1.81279023e+05   1.15208335e+05   2.17675284e+05
   9.62698489e+04   1.03649443e+05   9.31804852e+04   5.66365351e+05
   4.76870307e+05   5.43057688e+05   5.98305659e+05   2.61626041e+05
   2.97197218e+05   1.58124655e+05   3.20122628e+05   1.92065622e+05
   3.91562117e+05   2.20097092e+05   2.14778893e+05   4.41174803e+04
   2.43668092e+04   4.48439339e+05   3.35001028e+05   3.60088532e+05
   4.05864143e+05   2.12449440e+05   1.77811799e+05   1.06268660e+05
   1.94397596e+05   1.27379965e+05   2.39045800e+05   1.11152947e+05
   1.13684026e+05   8.61749232e+04  -3.47450937e+02   1.78143712e+04]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  4.62384891e+04   3.46997800e+05   1.38016187e+05   4.62202894e+05
   2.13843441e+05   7.32816878e+03   7.55808852e+04   1.20798165e+05
   4.18252802e+05   5.31488549e+05   1.25603746e+05   3.04824966e+04
   8.70244866e+04   1.42225873e+05   1.22611125e+05   1.24832565e+05
   1.11052994e+05   3.07227922e+05   3.95614356e+05   1.99741868e+04
   6.92314687e+04   5.92055021e+05   3.28407756e+05   9.56415406e+04
   7.98380795e+04   5.05098848e+05   1.70928829e+05   3.31948100e+05
   9.82111413e+04   8.10617040e+04   2.71452798e+05   3.58633499e+05
   1.97303548e+04   5.07677727e+04   1.44702028e+03   3.21387198e+05
   3.02122873e+05   1.14226638e+05   1.15048508e+04   2.81170258e+04
   3.18374635e+05   4.62089627e+04   2.10693857e+05   6.33263960e+04
   1.85258923e+05   2.56606070e+05   1.08255652e+05   7.34180756e+04
   1.05982767e+05   1.99609499e+05   2.32831136e+04   1.03515926e+05
   7.20941240e+04   9.23013808e+04   2.53247503e+04   5.19065385e+05
   2.91461210e+05   1.20567869e+05   1.19558143e+05   3.98661407e+05
   1.35210152e+05   2.41991389e+05   9.81015856e+03   2.38630271e+05
   6.78008165e+04   4.48966576e+04   4.77556336e+05   4.80192800e+05
   7.04540231e+05   7.98270850e+05   1.74816688e+05   3.47471701e+05
   1.28991267e+05   5.35152302e+05   1.66204284e+05   5.32483411e+05
   3.22431681e+05   3.94613022e+05   4.23543483e+05   3.09630879e+05
   3.33904735e+05   3.79581331e+05   2.00529664e+05   1.58702740e+05
   9.63597228e+04   1.81279023e+05   1.15208335e+05   2.17675284e+05
   9.62698489e+04   1.03649443e+05   9.31804852e+04   5.66365351e+05
   4.76870307e+05   5.43057688e+05   5.98305659e+05   2.61626041e+05
   2.97197218e+05   1.58124655e+05   3.20122628e+05   1.92065622e+05
   3.91562117e+05   2.20097092e+05   2.14778893e+05   4.41174803e+04
   2.43668092e+04   4.48439339e+05   3.35001028e+05   3.60088532e+05
   4.05864143e+05   2.12449440e+05   1.77811799e+05   1.06268660e+05
   1.94397596e+05   1.27379965e+05   2.39045800e+05   1.11152947e+05
   1.13684026e+05   8.61749232e+04  -3.47450937e+02   1.78143712e+04]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  4.62384891e+04   3.46997800e+05   1.38016187e+05   4.62202894e+05
   2.13843441e+05   7.32816878e+03   7.55808852e+04   1.20798165e+05
   4.18252802e+05   5.31488549e+05   1.25603746e+05   3.04824966e+04
   8.70244866e+04   1.42225873e+05   1.22611125e+05   1.24832565e+05
   1.11052994e+05   3.07227922e+05   3.95614356e+05   1.99741868e+04
   6.92314687e+04   5.92055021e+05   3.28407756e+05   9.56415406e+04
   7.98380795e+04   5.05098848e+05   1.70928829e+05   3.31948100e+05
   9.82111413e+04   8.10617040e+04   2.71452798e+05   3.58633499e+05
   1.97303548e+04   5.07677727e+04   1.44702028e+03   3.21387198e+05
   3.02122873e+05   1.14226638e+05   1.15048508e+04   2.81170258e+04
   3.18374635e+05   4.62089627e+04   2.10693857e+05   6.33263960e+04
   1.85258923e+05   2.56606070e+05   1.08255652e+05   7.34180756e+04
   1.05982767e+05   1.99609499e+05   2.32831136e+04   1.03515926e+05
   7.20941240e+04   9.23013808e+04   2.53247503e+04   5.19065385e+Minimum distance inequality constraints (should all be > 0): [  4.62384891e+04   3.46997800e+05   1.38016187e+05   4.62202894e+05
   2.13843441e+05   7.32816878e+03   7.55808852e+04   1.20798165e+05
   4.18252802e+05   5.31488549e+05   1.25603746e+05   3.04824966e+04
   8.70244866e+04   1.42225873e+05   1.22611125e+05   1.24832565e+05
   1.11052994e+05   3.07227922e+05   3.95614356e+05   1.99741868e+04
   6.92314687e+04   5.92055021e+05   3.28407756e+05   9.56415406e+04
   7.98380795e+04   5.05098848e+05   1.70928829e+05   3.31948100e+05
   9.82111413e+04   8.10617040e+04   2.71452798e+05   3.58633499e+05
   1.97303548e+04   5.07677727e+04   1.44702028e+03   3.21387198e+05
   3.02122873e+05   1.14226638e+05   1.15048508e+04   2.81170258e+04
   3.18374635e+05   4.62089627e+04   2.10693857e+05   6.33263960e+04
   1.85258923e+05   2.56606070e+05   1.08255652e+05   7.34180756e+04
   1.05982767e+05   1.99609499e+05   2.32831136e+04   1.03515926e+05
   7.20941240e+04   9.23013808e+04   2.53247503e+04   5.19065385e+05
   2.91461210e+05   1.20567869e+05   1.19558143e+05   3.98661407e+05
   1.35210152e+05   2.41991389e+05   9.81015856e+03   2.38630271e+05
   6.78008165e+04   4.48966576e+04   4.77556336e+05   4.80192800e+05
   7.04540231e+05   7.98270850e+05   1.74816688e+05   3.47471701e+05
   1.28991267e+05   5.35152302e+05   1.66204284e+05   5.32483411e+05
   3.22431681e+05   3.94613022e+05   4.23543483e+05   3.09630879e+05
   3.33904735e+05   3.79581331e+05   2.00529664e+05   1.58702740e+05
   9.63597228e+04   1.81279023e+05   1.15208335e+05   2.17675284e+05
   9.62698489e+04   1.03649443e+05   9.31804852e+04   5.66365351e+05
   4.76870307e+05   5.43057688e+05   5.98305659e+05   2.61626041e+05
   2.97197218e+05   1.58124655e+05   3.20122628e+05   1.92065622e+05
   3.91562117e+05   2.20097092e+05   2.14778893e+05   4.41174803e+04
   2.43668092e+04   4.48439339e+05   3.35001028e+05   3.60088532e+05
   4.05864143e+05   2.12449440e+05   1.77811799e+05   1.06268660e+05
   1.94397596e+05   1.27379965e+05   2.39045800e+05   105
   2.91461210e+05   1.20567869e+05   1.19558143e+05   3.98661407e+05
   1.35210152e+05   2.41991389e+05   9.81015856e+03   2.38630271e+05
   6.78008165e+04   4.48966576e+04   4.77556336e+05   4.80192800e+05
   7.04540231e+05   7.98270850e+05   1.74816688e+05   3.47471701e+05
   1.28991267e+05   5.35152302e+05   1.66204284e+05   5.32483411e+05
   3.22431681e+05   3.94613022e+05   4.23543483e+05   3.09630879e+05
   3.33904735e+05   3.79581331e+05   2.00529664e+05   1.58702740e+05
   9.63597228e+04   1.81279023e+05   1.15208335e+05   2.17675284e+05
   9.62698489e+04   1.03649443e+05   9.31804852e+04   5.66365351e+05
   4.76870307e+05   5.43057688e+05   5.98305659e+05   2.61626041e+05
   2.97197218e+05   1.58124655e+05   3.20122628e+05   1.92065622e+05
   3.91562117e+05   2.20097092e+05   2.14778893e+05   4.41174803e+04
   2.43668092e+04   4.48439339e+05   3.35001028e+05   3.60088532e+05
   4.05864143e+05   2.12449440e+05   1.77811799e+05   1.06268660e+05
   1.94397596e+05   1.27379965e+05   2.39045800e+05   1.11152947e+05
.11152947e+05
   1.13684026e+05   8.61749232e+04  -3.47450937e+02   1.78143712e+04]
   1.13684026e+05   8.61749232e+04  -3.47450937e+02   1.78143712e+04]
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.007e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.539e+01 (tol = 1.000e-10) r (rel) = 2.520e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.196e+00 (tol = 1.000e-10) r (rel) = 2.180e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.975e-02 (tol = 1.000e-10) r (rel) = 2.954e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.097e-06 (tol = 1.000e-10) r (rel) = 7.045e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.124e-11 (tol = 1.000e-10) r (rel) = 1.116e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 72.111731 s.
j = 8.930659e+05.
Runtime: 72.114049 s.
j = 8.930659e+05.
Runtime: 72.111888 s.
j = 8.930659e+05.
Runtime: 72.115779 s.
j = 8.930659e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.362e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.473e+01 (tol = 1.000e-10) r (rel) = 2.642e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.884e+00 (tol = 1.000e-10) r (rel) = 2.012e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.084e-02 (tol = 1.000e-10) r (rel) = 2.226e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.369e-06 (tol = 1.000e-10) r (rel) = 8.940e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.516e-11 (tol = 1.000e-10) r (rel) = 2.687e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 59.709877 s.
j = 9.559555e+05.
Runtime: 59.710110 s.
End of time loop.
j = 9.559555e+05.
End of time loop.
Runtime: 59.710384 s.
Start evaluation of j
j = 9.559555e+05.
Runtime: 59.709934 s.
Updating the turbine cache
j = 9.559555e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.182e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.740e+01 (tol = 1.000e-10) r (rel) = 2.422e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.061e+00 (tol = 1.000e-10) r (rel) = 1.477e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.353e-03 (tol = 1.000e-10) r (rel) = 1.024e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.737e-07 (tol = 1.000e-10) r (rel) = 6.596e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.821e-12 (tol = 1.000e-10) r (rel) = 2.536e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.790193 s.
j = 9.899756e+05.
End of time loop.
End of time loop.
Runtime: 78.789741 s.
j = 9.899756e+05.
Runtime: 78.789612 s.
Runtime: 78.789467 s.
Start evaluation of j
j = 9.899756e+05.
j = 9.899756e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.976e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.941e+00 (tol = 1.000e-10) r (rel) = 1.746e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.059e-01 (tol = 1.000e-10) r (rel) = 7.694e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.382e-03 (tol = 1.000e-10) r (rel) = 3.475e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.872e-08 (tol = 1.000e-10) r (rel) = 9.738e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 60.243815 s.
Runtime: 60.244946 s.
j = 9.981475e+05.
j = 9.981475e+05.
Runtime: 60.244261 s.
j = 9.981475e+05.
Runtime: 60.244119 s.
j = 9.981475e+05.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.6495780945 s
|dj| = 7454.26077103
Runtime: 11.6491680145 s
|dj| = 7454.26077103
Runtime: 11.6501278877 s
|dj| = 7454.26077103
Start evaluation of j
Start evaluation of j
Start evaluation of j
Runtime: 11.6522879601 s
Updating the turbine cache
Updating the turbine cache
|dj| = 7454.26077103
Updating the turbine cache
   11    43    -3.849299E+05     2.874693E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.103e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.531e+01 (tol = 1.000e-10) r (rel) = 2.295e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.220e+00 (tol = 1.000e-10) r (rel) = 2.012e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.660e-02 (tol = 1.000e-10) r (rel) = 2.412e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.004e-06 (tol = 1.000e-10) r (rel) = 6.350e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.628e-11 (tol = 1.000e-10) r (rel) = 2.382e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 64.601636 s.
j = 8.848312e+05.
Runtime: 64.601949 s.
j = 8.848312e+05.
Runtime: 64.601910 s.
j = 8.848312e+05.
Runtime: 64.599913 s.
j = 8.848312e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.001e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.276e+01 (tol = 1.000e-10) r (rel) = 2.273e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.714e+00 (tol = 1.000e-10) r (rel) = 1.712e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.753e-02 (tol = 1.000e-10) r (rel) = 1.751e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.267e-06 (tol = 1.000e-10) r (rel) = 4.262e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.655e-11 (tol = 1.000e-10) r (rel) = 1.654e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 70.766550 s.
Runtime: 70.767263 s.
j = 9.281199e+05.
End of time loop.
End of time loop.
j = 9.281199e+05.
Runtime: 70.767707 s.
Runtime: 70.767742 s.
j = 9.281199e+05.
j = 9.281199e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.349e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.320e+01 (tol = 1.000e-10) r (rel) = 2.482e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.722e+00 (tol = 1.000e-10) r (rel) = 1.842e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.313e-02 (tol = 1.000e-10) r (rel) = 2.474e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.180e-05 (tol = 1.000e-10) r (rel) = 1.262e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.991e-11 (tol = 1.000e-10) r (rel) = 4.269e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 72.376614 s.
Runtime: 72.377156 s.
j = 9.352082e+05.
j = 9.352082e+05.
Runtime: 72.376179 s.
j = 9.352082e+05.
Runtime: 72.376457 s.
j = 9.352082e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.255e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.579e+01 (tol = 1.000e-10) r (rel) = 2.176e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.709e-01 (tol = 1.000e-10) r (rel) = 1.200e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.575e-03 (tol = 1.000e-10) r (rel) = 7.685e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.499e-07 (tol = 1.000e-10) r (rel) = 6.201e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.059e-12 (tol = 1.000e-10) r (rel) = 2.838e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 77.342821 s.
j = 1.001551e+06.
End of time loop.
Runtime: 77.343178 s.
End of time loop.
j = 1.001551e+06.
Runtime: 77.342597 s.
j = 1.001551e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 77.343470 s.
j = 1.001551e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.513e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.403e+00 (tol = 1.000e-10) r (rel) = 9.562e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.424e-02 (tol = 1.000e-10) r (rel) = 1.363e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.253e-05 (tol = 1.000e-10) r (rel) = 4.985e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.234e-11 (tol = 1.000e-10) r (rel) = 2.481e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 61.035552 s.
j = 9.958497e+05.
Runtime: 61.034375 s.
j = 9.958497e+05.
End of time loop.
Start evaluation of j
Runtime: 61.035358 s.
j = 9.958497e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 61.035727 s.
j = 9.958497e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.481e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.519e-01 (tol = 1.000e-10) r (rel) = 5.751e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.311e-03 (tol = 1.000e-10) r (rel) = 2.910e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.898e-07 (tol = 1.000e-10) r (rel) = 1.281e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.393e-12 (tol = 1.000e-10) r (rel) = 9.403e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 59.189129 s.
j = 9.942503e+05.
Runtime: 59.192081 s.
End of time loop.
j = 9.942503e+05.
Runtime: 59.191192 s.
j = 9.942503e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Start evaluation of j
Runtime: 59.193275 s.
Updating the turbine cache
j = 9.942503e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.217e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.342e-01 (tol = 1.000e-10) r (rel) = 3.626e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.795e-04 (tol = 1.000e-10) r (rel) = 9.542e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.165e-08 (tol = 1.000e-10) r (rel) = 1.264e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.072e-12 (tol = 1.000e-10) r (rel) = 1.163e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 57.955920 s.
j = 1.000329e+06.
Runtime: 57.954395 s.
j = 1.000329e+06.
Runtime: 57.957194 s.
j = 1.000329e+06.
Runtime: 57.956848 s.
j = 1.000329e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.1679039001 s
|dj| = 8729.6802482
Runtime: 12.1691172123 s
|dj| = 8729.6802482
Runtime: 12.1702508926 s
|dj| = 8729.6802482
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   12    50    -3.857712E+05     3.366552E+03
Start evaluation of j
Updating the turbine cache
Runtime: 12.2531359196 s
|dj| = 8729.6802482
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.011e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.378e+01 (tol = 1.000e-10) r (rel) = 2.353e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.786e+00 (tol = 1.000e-10) r (rel) = 1.767e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.458e-02 (tol = 1.000e-10) r (rel) = 2.432e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.749e-05 (tol = 1.000e-10) r (rel) = 1.730e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.829e-11 (tol = 1.000e-10) r (rel) = 5.767e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 75.173582 s.
Runtime: 75.257505 s.
j = 8.824568e+05.
Runtime: 75.257318 s.
j = 8.824568e+05.
j = 8.824568e+05.
Runtime: 75.256752 s.
j = 8.824568e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.613e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.124e+01 (tol = 1.000e-10) r (rel) = 2.210e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.542e+00 (tol = 1.000e-10) r (rel) = 1.604e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.704e-02 (tol = 1.000e-10) r (rel) = 1.773e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.421e-06 (tol = 1.000e-10) r (rel) = 4.599e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.948e-11 (tol = 1.000e-10) r (rel) = 2.026e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 68.723218 s.
j = 9.298395e+05.
End of time loop.
Runtime: 68.733124 s.
j = 9.298395e+05.
Runtime: 68.733107 s.
j = 9.298395e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 68.734647 s.
Start evaluation of j
j = 9.298395e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.907e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.031e+01 (tol = 1.000e-10) r (rel) = 2.280e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.391e+00 (tol = 1.000e-10) r (rel) = 1.562e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.063e-02 (tol = 1.000e-10) r (rel) = 1.193e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.950e-07 (tol = 1.000e-10) r (rel) = 8.926e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.305e-12 (tol = 1.000e-10) r (rel) = 2.588e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 71.783441 s.
Runtime: 71.781040 s.
j = 9.838218e+05.
Runtime: 71.782595 s.
j = 9.838218e+05.
j = 9.838218e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
End of time loop.
Updating the turbine cache
Updating the turbine cache
Runtime: 71.793182 s.
j = 9.838218e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.127e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.379e+00 (tol = 1.000e-10) r (rel) = 1.531e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.041e-01 (tol = 1.000e-10) r (rel) = 6.596e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.258e-03 (tol = 1.000e-10) r (rel) = 2.053e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.781e-08 (tol = 1.000e-10) r (rel) = 2.906e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 59.892845 s.
Runtime: 59.883675 s.
j = 9.950140e+05.
Start evaluation of j
Updating the turbine cache
j = 9.950140e+05.
Runtime: 59.895311 s.
Runtime: 59.902458 s.
j = 9.950140e+05.
j = 9.950140e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.955e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.534e+00 (tol = 1.000e-10) r (rel) = 8.575e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.821e-02 (tol = 1.000e-10) r (rel) = 1.293e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.698e-05 (tol = 1.000e-10) r (rel) = 5.744e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.627e-11 (tol = 1.000e-10) r (rel) = 3.258e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 63.242272 s.
j = 9.936047e+05.
Runtime: 63.236067 s.
j = 9.936047e+05.
Runtime: 63.252013 s.
j = 9.936047e+05.
Runtime: 63.243207 s.
j = 9.936047e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.468e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.426e-01 (tol = 1.000e-10) r (rel) = 4.377e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.229e-03 (tol = 1.000e-10) r (rel) = 1.518e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.070e-08 (tol = 1.000e-10) r (rel) = 2.773e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.122e-12 (tol = 1.000e-10) r (rel) = 7.643e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 67.804504 s.
Runtime: 67.804517 s.
j = 1.006049e+06.
Runtime: 67.803467 s.
j = 1.006049e+06.
j = 1.006049e+06.
Runtime: 67.805191 s.
j = 1.006049e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 18.6170158386 s
|dj| = 6356.69738709
Runtime: 18.6175601482 s
|dj| = 6356.69738709
Runtime: 18.6199381351 s
|dj| = 6356.69738709
Runtime: 18.6209490299 s
|dj| = 6356.69738709
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   13    56    -3.879771E+05     2.451424E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.698e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.454e+01 (tol = 1.000e-10) r (rel) = 2.531e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.030e+00 (tol = 1.000e-10) r (rel) = 2.094e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.682e-02 (tol = 1.000e-10) r (rel) = 2.766e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.956e-06 (tol = 1.000e-10) r (rel) = 8.204e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.403e-11 (tol = 1.000e-10) r (rel) = 3.509e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 86.636201 s.
Runtime: 86.634604 s.
j = 7.592591e+05.
j = 7.592591e+05.
Runtime: 86.632490 s.
j = 7.592591e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 86.648786 s.
j = 7.592591e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.833e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.214e+01 (tol = 1.000e-10) r (rel) = 2.252e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.587e+00 (tol = 1.000e-10) r (rel) = 1.614e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.154e-02 (tol = 1.000e-10) r (rel) = 1.174e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.372e-07 (tol = 1.000e-10) r (rel) = 8.514e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.920e-12 (tol = 1.000e-10) r (rel) = 3.986e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.841343 s.
j = 9.440948e+05.
End of time loop.
End of time loop.
Runtime: 78.820856 s.
j = 9.440948e+05.
Runtime: 78.842865 s.
Runtime: 78.843145 s.
j = 9.440948e+05.
j = 9.440948e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.700e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.121e+01 (tol = 1.000e-10) r (rel) = 2.187e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.439e+00 (tol = 1.000e-10) r (rel) = 1.483e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.077e-02 (tol = 1.000e-10) r (rel) = 1.110e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.341e-07 (tol = 1.000e-10) r (rel) = 8.599e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.830e-12 (tol = 1.000e-10) r (rel) = 2.918e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 81.819003 s.
Runtime: 81.820236 s.
j = 1.008579e+06.
Runtime: 81.818972 s.
j = 1.008579e+06.
j = 1.008579e+06.
Runtime: 81.820039 s.
j = 1.008579e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.710e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.965e+00 (tol = 1.000e-10) r (rel) = 1.485e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.680e-01 (tol = 1.000e-10) r (rel) = 6.974e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.696e-03 (tol = 1.000e-10) r (rel) = 2.527e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.185e-08 (tol = 1.000e-10) r (rel) = 4.746e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 65.586685 s.
j = 1.006229e+06.
Runtime: 65.586825 s.
j = 1.006229e+06.
End of time loop.
Runtime: 65.586186 s.
j = 1.006229e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 65.588361 s.
Start evaluation of j
j = 1.006229e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.023e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.863e+00 (tol = 1.000e-10) r (rel) = 9.600e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.552e-02 (tol = 1.000e-10) r (rel) = 2.126e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.488e-05 (tol = 1.000e-10) r (rel) = 1.861e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.871e-10 (tol = 1.000e-10) r (rel) = 9.620e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.485564 s.
Runtime: 46.488303 s.
j = 1.007738e+06.
j = 1.007738e+06.
Runtime: 46.488317 s.
j = 1.007738e+06.
Runtime: 46.487620 s.
j = 1.007738e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.879e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.828e-01 (tol = 1.000e-10) r (rel) = 5.230e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.722e-03 (tol = 1.000e-10) r (rel) = 3.045e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.407e-07 (tol = 1.000e-10) r (rel) = 1.813e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.088e-12 (tol = 1.000e-10) r (rel) = 1.111e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 54.826447 s.
j = 9.977935e+05.
End of time loop.
Runtime: 54.827537 s.
j = 9.977935e+05.
End of time loop.
Runtime: 54.828087 s.
Start evaluation of j
j = 9.977935e+05.
Runtime: 54.828262 s.
Updating the turbine cache
j = 9.977935e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.509e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.783e-01 (tol = 1.000e-10) r (rel) = 3.832e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.927e-03 (tol = 1.000e-10) r (rel) = 1.277e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.357e-08 (tol = 1.000e-10) r (rel) = 2.225e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.108e-12 (tol = 1.000e-10) r (rel) = 7.344e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 58.179409 s.
Runtime: 58.177885 s.
j = 1.005315e+06.
j = 1.005315e+06.
Runtime: 58.178213 s.
j = 1.005315e+06.
Runtime: 58.178974 s.
j = 1.005315e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.854e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.625e-02 (tol = 1.000e-10) r (rel) = 1.200e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.437e-05 (tol = 1.000e-10) r (rel) = 3.730e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.798e-11 (tol = 1.000e-10) r (rel) = 1.764e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 40.904443 s.
j = 1.007318e+06.
End of time loop.
Runtime: 40.904626 s.
j = 1.007318e+06.
Runtime: 40.904996 s.
j = 1.007318e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Runtime: 40.905032 s.
j = 1.007318e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.8048160076 s
|dj| = 6345.4453427
Runtime: 15.8070108891 s
|dj| = 6345.4453427
Start evaluation of j
Updating the turbine cache
   14    64    -3.884665E+05     2.447085E+03
Start evaluation of j
Updating the turbine cache
Runtime: 15.8232400417 s
|dj| = 6345.4453427
Runtime: 15.8247051239 s
|dj| = 6345.4453427
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.056e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.639e+01 (tol = 1.000e-10) r (rel) = 2.499e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.214e+00 (tol = 1.000e-10) r (rel) = 2.096e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.938e-02 (tol = 1.000e-10) r (rel) = 2.782e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.615e-05 (tol = 1.000e-10) r (rel) = 1.529e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.091e-11 (tol = 1.000e-10) r (rel) = 2.926e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 80.588172 s.
j = 9.329508e+05.
End of time loop.
End of time loop.
Runtime: 80.605798 s.
j = 9.329508e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 80.590367 s.
j = 9.329508e+05.
Start evaluation of j
Updating the turbine cache
Runtime: 80.612793 s.
j = 9.329508e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.015e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.400e+01 (tol = 1.000e-10) r (rel) = 2.365e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.798e+00 (tol = 1.000e-10) r (rel) = 1.772e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.731e-02 (tol = 1.000e-10) r (rel) = 1.706e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.390e-06 (tol = 1.000e-10) r (rel) = 3.341e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.253e-11 (tol = 1.000e-10) r (rel) = 1.235e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 71.741331 s.
j = 8.832570e+05.
Runtime: 71.730830 s.
End of time loop.
j = 8.832570e+05.
End of time loop.
Runtime: 71.737792 s.
Start evaluation of j
j = 8.832570e+05.
Runtime: 71.741466 s.
j = 8.832570e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.006e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.358e+01 (tol = 1.000e-10) r (rel) = 2.345e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.721e+00 (tol = 1.000e-10) r (rel) = 1.711e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.578e-02 (tol = 1.000e-10) r (rel) = 1.569e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.690e-06 (tol = 1.000e-10) r (rel) = 1.680e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.295e-12 (tol = 1.000e-10) r (rel) = 7.253e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 62.048204 s.
j = 9.935615e+05.
Runtime: 62.048845 s.
j = 9.935615e+05.
Runtime: 62.048562 s.
j = 9.935615e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 62.058955 s.
j = 9.935615e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.016e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.353e+00 (tol = 1.000e-10) r (rel) = 1.665e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.273e-01 (tol = 1.000e-10) r (rel) = 6.525e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.977e-04 (tol = 1.000e-10) r (rel) = 1.790e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.012e-08 (tol = 1.000e-10) r (rel) = 2.018e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 62.388074 s.
j = 9.988315e+05.
Runtime: 62.387812 s.
j = 9.988315e+05.
Runtime: 62.388660 s.
j = 9.988315e+05.
Runtime: 62.379596 s.
j = 9.988315e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.090e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.854e+00 (tol = 1.000e-10) r (rel) = 8.869e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.137e-02 (tol = 1.000e-10) r (rel) = 1.022e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.362e-06 (tol = 1.000e-10) r (rel) = 2.566e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.268e-11 (tol = 1.000e-10) r (rel) = 1.564e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 48.050100 s.
j = 9.930890e+05.
Runtime: 48.049329 s.
j = 9.930890e+05.
Runtime: 48.050251 s.
j = 9.930890e+05.
Runtime: 48.050572 s.
j = 9.930890e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.685e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.931e-01 (tol = 1.000e-10) r (rel) = 4.058e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.733e-04 (tol = 1.000e-10) r (rel) = 9.016e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.817e-09 (tol = 1.000e-10) r (rel) = 9.103e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 43.512846 s.
j = 1.007553e+06.
End of time loop.
Runtime: 43.513990 s.
j = 1.007553e+06.
End of time loop.
Runtime: 43.514649 s.
j = 1.007553e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 43.516039 s.
j = 1.007553e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.3429889679 s
|dj| = 6453.79511552
Runtime: 15.3341860771 s
|dj| = 6453.79511552
Start evaluation of j
Updating the turbine cache
   15    70    -3.885572E+05     2.488869E+03
Start evaluation of j
Updating the turbine cache
Runtime: 15.3590111732 s
|dj| = 6453.79511552
Runtime: 15.3628749847 s
|dj| = 6453.79511552
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.056e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.544e+01 (tol = 1.000e-10) r (rel) = 2.408e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.300e+00 (tol = 1.000e-10) r (rel) = 2.178e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.562e-02 (tol = 1.000e-10) r (rel) = 3.372e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.271e-05 (tol = 1.000e-10) r (rel) = 3.097e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.490e-11 (tol = 1.000e-10) r (rel) = 5.198e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 71.298628 s.
j = 7.890779e+05.
Runtime: 71.301910 s.
j = 7.890779e+05.
Runtime: 71.318610 s.
j = 7.890779e+05.
Runtime: 71.318449 s.
j = 7.890779e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.662e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.451e+01 (tol = 1.000e-10) r (rel) = 2.536e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.101e+00 (tol = 1.000e-10) r (rel) = 2.174e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.957e-02 (tol = 1.000e-10) r (rel) = 3.060e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.758e-06 (tol = 1.000e-10) r (rel) = 1.010e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.679e-12 (tol = 1.000e-10) r (rel) = 7.948e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 64.853683 s.
j = 9.509966e+05.
Runtime: 64.853100 s.
j = 9.509966e+05.
End of time loop.
Runtime: 64.854239 s.
j = 9.509966e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 64.855212 s.
j = 9.509966e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.121e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.655e+01 (tol = 1.000e-10) r (rel) = 2.324e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.126e+00 (tol = 1.000e-10) r (rel) = 1.581e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.184e-02 (tol = 1.000e-10) r (rel) = 1.662e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.257e-06 (tol = 1.000e-10) r (rel) = 3.169e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 7.031e-12 (tol = 1.000e-10) r (rel) = 9.872e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 67.312059 s.
j = 9.994814e+05.
Runtime: 67.309433 s.
j = 9.994814e+05.
Runtime: 67.312262 s.
j = 9.994814e+05.
Runtime: 67.311258 s.
j = 9.994814e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.795e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.590e+00 (tol = 1.000e-10) r (rel) = 9.264e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.570e-02 (tol = 1.000e-10) r (rel) = 1.635e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.606e-05 (tol = 1.000e-10) r (rel) = 9.321e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.316e-10 (tol = 1.000e-10) r (rel) = 4.706e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.316653 s.
j = 9.996152e+05.
Runtime: 46.317644 s.
j = 9.996152e+05.
End of time loop.
Runtime: 46.317721 s.
Runtime: 46.318058 s.
j = 9.996152e+05.
j = 9.996152e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.235e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.903e-01 (tol = 1.000e-10) r (rel) = 3.968e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.682e-03 (tol = 1.000e-10) r (rel) = 1.361e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.217e-08 (tol = 1.000e-10) r (rel) = 2.604e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.106e-12 (tol = 1.000e-10) r (rel) = 8.951e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 55.070997 s.
j = 1.006879e+06.
End of time loop.
End of time loop.
Runtime: 55.072322 s.
j = 1.006879e+06.
Start evaluation of j
Runtime: 55.072697 s.
j = 1.006879e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 55.081659 s.
j = 1.006879e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.311e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.515e-02 (tol = 1.000e-10) r (rel) = 6.554e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.299e-06 (tol = 1.000e-10) r (rel) = 5.621e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.020e-11 (tol = 1.000e-10) r (rel) = 4.415e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 50.155997 s.
Runtime: 50.137806 s.
j = 1.007776e+06.
End of time loop.
End of time loop.
j = 1.007776e+06.
Runtime: 50.155247 s.
Runtime: 50.155666 s.
j = 1.007776e+06.
j = 1.007776e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.6464290619 s
|dj| = 6435.0200161
Runtime: 16.6464519501 s
|dj| = 6435.0200161
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 16.6648659706 s
|dj| = 6435.0200161
Runtime: 16.6647570133 s
|dj| = 6435.0200161
Start evaluation of j
Updating the turbine cache
   16    76    -3.886432E+05     2.481629E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.030e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.579e+01 (tol = 1.000e-10) r (rel) = 2.505e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.953e+00 (tol = 1.000e-10) r (rel) = 1.897e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.042e-02 (tol = 1.000e-10) r (rel) = 1.983e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.192e-06 (tol = 1.000e-10) r (rel) = 4.072e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.410e-11 (tol = 1.000e-10) r (rel) = 1.369e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.977327 s.
Runtime: 78.995925 s.
j = 9.642738e+05.
End of time loop.
j = 9.642738e+05.
Runtime: 78.997362 s.
j = 9.642738e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 78.991222 s.
j = 9.642738e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.070e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.669e+01 (tol = 1.000e-10) r (rel) = 2.494e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.010e+00 (tol = 1.000e-10) r (rel) = 1.879e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.064e-02 (tol = 1.000e-10) r (rel) = 1.929e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.197e-06 (tol = 1.000e-10) r (rel) = 2.988e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.406e-11 (tol = 1.000e-10) r (rel) = 1.314e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 75.913650 s.
j = 9.730472e+05.
Runtime: 75.922178 s.
j = 9.730472e+05.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 75.904124 s.
Updating the turbine cache
j = 9.730472e+05.
Updating the turbine cache
Runtime: 75.922819 s.
j = 9.730472e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.642e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.437e+01 (tol = 1.000e-10) r (rel) = 1.880e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.827e-01 (tol = 1.000e-10) r (rel) = 8.933e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.847e-03 (tol = 1.000e-10) r (rel) = 3.725e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.572e-08 (tol = 1.000e-10) r (rel) = 9.909e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 61.870433 s.
j = 9.856753e+05.
End of time loop.
End of time loop.
Runtime: 61.868246 s.
j = 9.856753e+05.
Runtime: 61.869593 s.
Runtime: 61.871023 s.
j = 9.856753e+05.
j = 9.856753e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.007e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.905e+00 (tol = 1.000e-10) r (rel) = 9.745e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.514e-02 (tol = 1.000e-10) r (rel) = 1.875e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.027e-05 (tol = 1.000e-10) r (rel) = 1.504e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.113e-10 (tol = 1.000e-10) r (rel) = 5.273e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 51.897895 s.
Runtime: 51.896801 s.
j = 1.002401e+06.
j = 1.002401e+06.
Runtime: 51.897180 s.
j = 1.002401e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 51.897993 s.
j = 1.002401e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.625e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.421e-01 (tol = 1.000e-10) r (rel) = 2.515e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.214e-04 (tol = 1.000e-10) r (rel) = 3.339e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.628e-09 (tol = 1.000e-10) r (rel) = 1.691e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 39.327176 s.
End of time loop.
End of time loop.
Runtime: 39.328555 s.
End of time loop.
j = 1.007723e+06.
Runtime: 39.327903 s.
j = 1.007723e+06.
Runtime: 39.329084 s.
j = 1.007723e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
j = 1.007723e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.358e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.634e-03 (tol = 1.000e-10) r (rel) = 3.412e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.241e-07 (tol = 1.000e-10) r (rel) = 9.139e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.175e-12 (tol = 1.000e-10) r (rel) = 8.649e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 47.145360 s.
j = 1.007946e+06.
Runtime: 47.132334 s.
End of time loop.
j = 1.007946e+06.
End of time loop.
Start evaluation of dj
Runtime: 47.145850 s.
j = 1.007946e+06.
found a tidal farm, computing gradient
Runtime: 47.146342 s.
j = 1.007946e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.2655198574 s
|dj| = 6087.27709939
Start evaluation of j
Updating the turbine cache
Runtime: 15.2684729099 s
|dj| = 6087.27709939
   17    82    -3.887085E+05     2.347524E+03
Start evaluation of j
Updating the turbine cache
Runtime: 15.2848007679 s
Runtime: 15.2836508751 s
|dj| = 6087.27709939
|dj| = 6087.27709939
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.349e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.518e+01 (tol = 1.000e-10) r (rel) = 2.693e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.979e+00 (tol = 1.000e-10) r (rel) = 2.117e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.973e-02 (tol = 1.000e-10) r (rel) = 2.110e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.837e-06 (tol = 1.000e-10) r (rel) = 3.035e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.097e-11 (tol = 1.000e-10) r (rel) = 1.173e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 70.784253 s.
j = 8.774545e+05.
End of time loop.
Runtime: 70.784487 s.
End of time loop.
j = 8.774545e+05.
Runtime: 70.805109 s.
j = 8.774545e+05.
Start evaluation of j
Runtime: 70.801563 s.
Updating the turbine cache
j = 8.774545e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.983e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.252e+01 (tol = 1.000e-10) r (rel) = 2.256e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.647e+00 (tol = 1.000e-10) r (rel) = 1.650e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.481e-02 (tol = 1.000e-10) r (rel) = 1.483e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.500e-06 (tol = 1.000e-10) r (rel) = 1.503e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.273e-12 (tol = 1.000e-10) r (rel) = 6.284e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 68.566338 s.
j = 1.000764e+06.
Runtime: 68.566163 s.
j = 1.000764e+06.
End of time loop.
Runtime: 68.566427 s.
j = 1.000764e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 68.568862 s.
j = 1.000764e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.697e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.685e+00 (tol = 1.000e-10) r (rel) = 1.423e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.555e-01 (tol = 1.000e-10) r (rel) = 5.440e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.390e-04 (tol = 1.000e-10) r (rel) = 1.573e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.650e-09 (tol = 1.000e-10) r (rel) = 1.629e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 54.217799 s.
j = 1.000232e+06.
End of time loop.
Runtime: 54.219623 s.
End of time loop.
j = 1.000232e+06.
Runtime: 54.221227 s.
j = 1.000232e+06.
Runtime: 54.221280 s.
Start evaluation of j
j = 1.000232e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.478e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.066e+00 (tol = 1.000e-10) r (rel) = 8.339e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.003e-02 (tol = 1.000e-10) r (rel) = 1.212e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.117e-05 (tol = 1.000e-10) r (rel) = 4.507e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.056e-11 (tol = 1.000e-10) r (rel) = 2.040e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 62.574730 s.
Runtime: 62.575160 s.
j = 1.003917e+06.
Runtime: 62.574735 s.
j = 1.003917e+06.
j = 1.003917e+06.
Runtime: 62.576285 s.
j = 1.003917e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.323e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.872e-01 (tol = 1.000e-10) r (rel) = 2.557e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.661e-04 (tol = 1.000e-10) r (rel) = 3.634e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.634e-09 (tol = 1.000e-10) r (rel) = 2.231e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 38.236139 s.
j = 1.007964e+06.
Runtime: 38.236882 s.
j = 1.007964e+06.
End of time loop.
Runtime: 38.237517 s.
Start evaluation of j
Start evaluation of j
j = 1.007964e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 38.238393 s.
j = 1.007964e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.463e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.341e-03 (tol = 1.000e-10) r (rel) = 2.075e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.399e-08 (tol = 1.000e-10) r (rel) = 2.165e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.082e-12 (tol = 1.000e-10) r (rel) = 1.675e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 46.879769 s.
j = 1.008021e+06.
Runtime: 46.878326 s.
j = 1.008021e+06.
End of time loop.
Runtime: 46.881730 s.
j = 1.008021e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 46.882633 s.
j = 1.008021e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.5944590569 s
|dj| = 6169.24348811
Runtime: 14.5945088863 s
|dj| = 6169.24348811
Start evaluation of j
Runtime: 14.5936911106 s
|dj| = 6169.24348811
Updating the turbine cache
Runtime: 14.5974419117 s
|dj| = 6169.24348811
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   18    88    -3.887376E+05     2.379134E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.052e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.257e+01 (tol = 1.000e-10) r (rel) = 2.493e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.576e+00 (tol = 1.000e-10) r (rel) = 1.742e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.702e-02 (tol = 1.000e-10) r (rel) = 2.985e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.389e-05 (tol = 1.000e-10) r (rel) = 2.640e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 8.869e-11 (tol = 1.000e-10) r (rel) = 9.798e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 70.075027 s.
j = 9.354861e+05.
End of time loop.
Runtime: 70.077506 s.
j = 9.354861e+05.
End of time loop.
Start evaluation of j
Runtime: 70.076372 s.
j = 9.354861e+05.
Runtime: 70.074254 s.
j = 9.354861e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.242e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.966e+01 (tol = 1.000e-10) r (rel) = 2.127e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.235e+00 (tol = 1.000e-10) r (rel) = 1.336e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.298e-03 (tol = 1.000e-10) r (rel) = 1.006e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.611e-07 (tol = 1.000e-10) r (rel) = 8.235e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.717e-12 (tol = 1.000e-10) r (rel) = 2.940e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 70.148086 s.
j = 9.846708e+05.
Runtime: 70.149502 s.
j = 9.846708e+05.
Runtime: 70.148987 s.
j = 9.846708e+05.
Runtime: 70.148480 s.
j = 9.846708e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.507e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.828e+00 (tol = 1.000e-10) r (rel) = 1.421e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.182e-01 (tol = 1.000e-10) r (rel) = 5.777e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.158e-04 (tol = 1.000e-10) r (rel) = 1.300e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.606e-09 (tol = 1.000e-10) r (rel) = 1.199e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 49.732901 s.
j = 9.991986e+05.
End of time loop.
End of time loop.
Runtime: 49.733133 s.
j = 9.991986e+05.
Runtime: 49.733475 s.
Runtime: 49.732639 s.
j = 9.991986e+05.
j = 9.991986e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.048e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.085e+00 (tol = 1.000e-10) r (rel) = 5.297e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.589e-03 (tol = 1.000e-10) r (rel) = 3.705e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.999e-07 (tol = 1.000e-10) r (rel) = 2.928e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.380e-12 (tol = 1.000e-10) r (rel) = 2.138e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 56.838401 s.
Runtime: 56.839700 s.
j = 1.006759e+06.
j = 1.006759e+06.
Runtime: 56.838552 s.
j = 1.006759e+06.
Runtime: 56.839276 s.
j = 1.006759e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.149e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.458e-02 (tol = 1.000e-10) r (rel) = 1.075e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.358e-05 (tol = 1.000e-10) r (rel) = 3.272e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.614e-11 (tol = 1.000e-10) r (rel) = 2.076e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 35.302314 s.
j = 1.008127e+06.
Runtime: 35.303304 s.
j = 1.008127e+06.
Runtime: 35.303277 s.
j = 1.008127e+06.
Runtime: 35.303482 s.
j = 1.008127e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.5895500183 s
|dj| = 5978.89631796
Runtime: 11.5894939899 s
|dj| = 5978.89631796
Start evaluation of j
Updating the turbine cache
Runtime: 11.5919749737 s
Runtime: 11.5919978619 s
|dj| = 5978.89631796
|dj| = 5978.89631796
Start evaluation of j
Updating the turbine cache
   19    93    -3.887784E+05     2.305727E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.545e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.119e+01 (tol = 1.000e-10) r (rel) = 2.019e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.932e-01 (tol = 1.000e-10) r (rel) = 8.895e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.911e-03 (tol = 1.000e-10) r (rel) = 3.446e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.578e-08 (tol = 1.000e-10) r (rel) = 8.256e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 57.806660 s.
j = 9.916976e+05.
Runtime: 57.808284 s.
j = 9.916976e+05.
Runtime: 57.806075 s.
j = 9.916976e+05.
Runtime: 57.809510 s.
j = 9.916976e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.675e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.472e+00 (tol = 1.000e-10) r (rel) = 1.316e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.091e-01 (tol = 1.000e-10) r (rel) = 5.447e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.189e-04 (tol = 1.000e-10) r (rel) = 1.619e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.065e-08 (tol = 1.000e-10) r (rel) = 1.876e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 46.312646 s.
j = 9.989091e+05.
Runtime: 46.311836 s.
j = 9.989091e+05.
End of time loop.
End of time loop.
Runtime: 46.313208 s.
j = 9.989091e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 46.313525 s.
j = 9.989091e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.067e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.337e+00 (tol = 1.000e-10) r (rel) = 7.620e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.943e-02 (tol = 1.000e-10) r (rel) = 1.286e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.120e-05 (tol = 1.000e-10) r (rel) = 6.914e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.286e-10 (tol = 1.000e-10) r (rel) = 4.193e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 61.671330 s.
End of time loop.
Runtime: 61.670100 s.
j = 9.959244e+05.
End of time loop.
j = 9.959244e+05.
Runtime: 61.669078 s.
Runtime: 61.671712 s.
j = 9.959244e+05.
j = 9.959244e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.344e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.587e-01 (tol = 1.000e-10) r (rel) = 4.157e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.242e-03 (tol = 1.000e-10) r (rel) = 2.412e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.839e-07 (tol = 1.000e-10) r (rel) = 1.368e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.245e-12 (tol = 1.000e-10) r (rel) = 9.263e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 47.480944 s.
j = 1.008262e+06.
Runtime: 47.480434 s.
j = 1.008262e+06.
Runtime: 47.481525 s.
j = 1.008262e+06.
Runtime: 47.480781 s.
j = 1.008262e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.120775938 s
|dj| = 5677.60527532
Runtime: 12.1227710247 s
|dj| = 5677.60527532
Runtime: 12.1232059002 s
|dj| = 5677.60527532
Start evaluation of j
Updating the turbine cache
Start evaluation of j
   20    97    -3.888305E+05     2.189536E+03
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 12.1992321014 s
|dj| = 5677.60527532
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.099e+02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.683e+01 (tol = 1.000e-10) r (rel) = 2.442e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.178e+00 (tol = 1.000e-10) r (rel) = 1.982e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.761e-02 (tol = 1.000e-10) r (rel) = 2.513e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.474e-06 (tol = 1.000e-10) r (rel) = 7.713e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.464e-11 (tol = 1.000e-10) r (rel) = 3.153e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 72.055891 s.
Runtime: 72.150985 s.
j = 9.207096e+05.
j = 9.207096e+05.
Runtime: 72.149736 s.
j = 9.207096e+05.
Runtime: 72.150204 s.
j = 9.207096e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.992e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.218e+01 (tol = 1.000e-10) r (rel) = 2.466e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.549e+00 (tol = 1.000e-10) r (rel) = 1.722e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.388e-02 (tol = 1.000e-10) r (rel) = 1.543e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.725e-06 (tol = 1.000e-10) r (rel) = 1.919e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.194e-12 (tol = 1.000e-10) r (rel) = 5.776e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.350012 s.
j = 9.743685e+05.
Runtime: 78.348989 s.
j = 9.743685e+05.
End of time loop.
Runtime: 78.350967 s.
Start evaluation of j
j = 9.743685e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 78.351882 s.
j = 9.743685e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.980e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.304e+01 (tol = 1.000e-10) r (rel) = 2.180e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.544e-01 (tol = 1.000e-10) r (rel) = 1.094e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.147e-03 (tol = 1.000e-10) r (rel) = 6.933e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.338e-07 (tol = 1.000e-10) r (rel) = 5.582e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.597e-12 (tol = 1.000e-10) r (rel) = 2.670e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 74.781080 s.
j = 9.917409e+05.
Runtime: 74.779976 s.
j = 9.917409e+05.
End of time loop.
Runtime: 74.781782 s.
Start evaluation of j
j = 9.917409e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 74.780143 s.
j = 9.917409e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.961e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.765e+00 (tol = 1.000e-10) r (rel) = 1.271e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.647e-02 (tol = 1.000e-10) r (rel) = 2.245e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.472e-05 (tol = 1.000e-10) r (rel) = 1.173e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.536e-10 (tol = 1.000e-10) r (rel) = 5.188e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 56.453010 s.
j = 9.950883e+05.
Runtime: 56.452942 s.
j = 9.950883e+05.
Runtime: 56.450426 s.
j = 9.950883e+05.
Runtime: 56.452201 s.
j = 9.950883e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.452e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.567e-01 (tol = 1.000e-10) r (rel) = 5.211e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.245e-03 (tol = 1.000e-10) r (rel) = 2.234e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.048e-07 (tol = 1.000e-10) r (rel) = 7.219e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.143e-12 (tol = 1.000e-10) r (rel) = 7.873e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.495583 s.
Runtime: 48.495600 s.
End of time loop.
j = 1.008393e+06.
End of time loop.
j = 1.008393e+06.
Runtime: 48.496009 s.
j = 1.008393e+06.
Runtime: 48.495344 s.
j = 1.008393e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.136e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.370e-02 (tol = 1.000e-10) r (rel) = 6.412e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.094e-06 (tol = 1.000e-10) r (rel) = 5.123e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.775e-12 (tol = 1.000e-10) r (rel) = 2.236e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 45.130929 s.
j = 1.008913e+06.
End of time loop.
End of time loop.
Runtime: 45.130705 s.
j = 1.008913e+06.
Runtime: 45.130936 s.
Runtime: 45.132155 s.
j = 1.008913e+06.
j = 1.008913e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 18.0488269329 s
|dj| = 5568.32491881
Start evaluation of j
Updating the turbine cache
Runtime: 18.0584127903 s
|dj| = 5568.32491881
Start evaluation of j
Updating the turbine cache
Runtime: 18.0685288906 s
|dj| = 5568.32491881
Runtime: 18.0682439804 s
|dj| = 5568.32491881
Start evaluation of j
Updating the turbine cache
   21   103    -3.890817E+05     2.147393E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.941e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.431e+01 (tol = 1.000e-10) r (rel) = 2.446e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.736e+00 (tol = 1.000e-10) r (rel) = 1.746e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.647e-02 (tol = 1.000e-10) r (rel) = 1.657e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.248e-06 (tol = 1.000e-10) r (rel) = 2.261e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.019e-11 (tol = 1.000e-10) r (rel) = 1.025e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 62.020334 s.
j = 9.633304e+05.
Runtime: 62.032463 s.
End of time loop.
j = 9.633304e+05.
Runtime: 62.041262 s.
j = 9.633304e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 62.023608 s.
j = 9.633304e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.945e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.038e+01 (tol = 1.000e-10) r (rel) = 2.278e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.293e+00 (tol = 1.000e-10) r (rel) = 1.445e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.931e-03 (tol = 1.000e-10) r (rel) = 1.110e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.012e-06 (tol = 1.000e-10) r (rel) = 1.131e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.170e-12 (tol = 1.000e-10) r (rel) = 4.661e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 78.472963 s.
j = 9.952326e+05.
End of time loop.
End of time loop.
Runtime: 78.473205 s.
j = 9.952326e+05.
Runtime: 78.472474 s.
j = 9.952326e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 78.478037 s.
j = 9.952326e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.689e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.046e+01 (tol = 1.000e-10) r (rel) = 1.839e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.766e-01 (tol = 1.000e-10) r (rel) = 8.378e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.479e-03 (tol = 1.000e-10) r (rel) = 4.358e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.197e-07 (tol = 1.000e-10) r (rel) = 2.105e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.116e-12 (tol = 1.000e-10) r (rel) = 1.962e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 74.515378 s.
j = 1.001627e+06.
Runtime: 74.506035 s.
j = 1.001627e+06.
End of time loop.
Runtime: 74.516736 s.
j = 1.001627e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 74.516771 s.
j = 1.001627e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.123e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.569e+00 (tol = 1.000e-10) r (rel) = 1.143e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.685e-02 (tol = 1.000e-10) r (rel) = 1.820e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.357e-05 (tol = 1.000e-10) r (rel) = 7.547e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.949e-11 (tol = 1.000e-10) r (rel) = 2.545e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 61.861366 s.
j = 1.003617e+06.
End of time loop.
End of time loop.
Runtime: 61.861724 s.
j = 1.003617e+06.
Runtime: 61.860920 s.
Runtime: 61.859362 s.
Start evaluation of j
j = 1.003617e+06.
j = 1.003617e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.603e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.586e-01 (tol = 1.000e-10) r (rel) = 5.980e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.224e-03 (tol = 1.000e-10) r (rel) = 3.259e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.225e-07 (tol = 1.000e-10) r (rel) = 2.012e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.327e-12 (tol = 1.000e-10) r (rel) = 8.277e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 53.392420 s.
Runtime: 53.391542 s.
j = 1.006477e+06.
j = 1.006477e+06.
End of time loop.
Runtime: 53.391535 s.
j = 1.006477e+06.
Runtime: 53.391649 s.
j = 1.006477e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.202e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.222e-01 (tol = 1.000e-10) r (rel) = 1.970e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.668e-05 (tol = 1.000e-10) r (rel) = 1.398e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.555e-10 (tol = 1.000e-10) r (rel) = 4.119e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 44.630625 s.
j = 1.009262e+06.
End of time loop.
End of time loop.
Runtime: 44.631923 s.
j = 1.009262e+06.
Runtime: 44.631834 s.
Runtime: 44.632287 s.
j = 1.009262e+06.
j = 1.009262e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.1722609997 s
|dj| = 4815.5887316
Runtime: 15.1731829643 s
|dj| = 4815.5887316
Runtime: 15.1747031212 s
|dj| = 4815.5887316
Start evaluation of j
Runtime: 15.1743369102 s
|dj| = 4815.5887316
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   22   109    -3.892161E+05     1.857104E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.397e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.954e+01 (tol = 1.000e-10) r (rel) = 2.327e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.425e+00 (tol = 1.000e-10) r (rel) = 1.697e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.645e-02 (tol = 1.000e-10) r (rel) = 1.959e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.787e-06 (tol = 1.000e-10) r (rel) = 5.701e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.108e-11 (tol = 1.000e-10) r (rel) = 2.511e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
Runtime: 65.476850 s.
Runtime: 65.476679 s.
j = 9.604551e+05.
j = 9.604551e+05.
End of time loop.
Runtime: 65.474982 s.
j = 9.604551e+05.
Runtime: 65.476016 s.
j = 9.604551e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.354e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.523e+01 (tol = 1.000e-10) r (rel) = 2.071e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.694e-01 (tol = 1.000e-10) r (rel) = 1.182e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.426e-03 (tol = 1.000e-10) r (rel) = 7.378e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.399e-07 (tol = 1.000e-10) r (rel) = 4.622e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.625e-12 (tol = 1.000e-10) r (rel) = 2.210e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 72.819856 s.
j = 9.929976e+05.
End of time loop.
End of time loop.
Runtime: 72.819351 s.
j = 9.929976e+05.
Runtime: 72.820267 s.
Start evaluation of j
j = 9.929976e+05.
Runtime: 72.820236 s.
j = 9.929976e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.356e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.665e+00 (tol = 1.000e-10) r (rel) = 1.300e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.578e-01 (tol = 1.000e-10) r (rel) = 3.623e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.364e-04 (tol = 1.000e-10) r (rel) = 5.427e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.194e-09 (tol = 1.000e-10) r (rel) = 2.740e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 59.807645 s.
j = 9.991680e+05.
Runtime: 59.807190 s.
j = 9.991680e+05.
Runtime: 59.808606 s.
j = 9.991680e+05.
Runtime: 59.807554 s.
j = 9.991680e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.953e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.230e+00 (tol = 1.000e-10) r (rel) = 6.296e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.905e-03 (tol = 1.000e-10) r (rel) = 4.559e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.105e-07 (tol = 1.000e-10) r (rel) = 4.661e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.052e-12 (tol = 1.000e-10) r (rel) = 1.562e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 56.846904 s.
j = 1.008374e+06.
Runtime: 56.846233 s.
j = 1.008374e+06.
Runtime: 56.847168 s.
j = 1.008374e+06.
Runtime: 56.847474 s.
j = 1.008374e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.679e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.087e-02 (tol = 1.000e-10) r (rel) = 1.111e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.148e-05 (tol = 1.000e-10) r (rel) = 3.119e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.746e-11 (tol = 1.000e-10) r (rel) = 1.018e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.861932 s.
Runtime: 48.861931 s.
j = 1.009345e+06.
j = 1.009345e+06.
End of time loop.
End of time loop.
Runtime: 48.861585 s.
Runtime: 48.862301 s.
j = 1.009345e+06.
j = 1.009345e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.4792530537 s
|dj| = 4602.22357416
Start evaluation of j
Updating the turbine cache
Runtime: 16.481842041 s
|dj| = 4602.22357416
   23   114    -3.892483E+05     1.774821E+03
Start evaluation of j
Updating the turbine cache
Runtime: 16.4985890388 s
|dj| = 4602.22357416
Runtime: 16.4985589981 s
|dj| = 4602.22357416
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.423e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.150e+01 (tol = 1.000e-10) r (rel) = 1.790e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.430e-01 (tol = 1.000e-10) r (rel) = 8.454e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.512e-03 (tol = 1.000e-10) r (rel) = 3.911e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.497e-08 (tol = 1.000e-10) r (rel) = 1.167e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.098e-12 (tol = 1.000e-10) r (rel) = 1.709e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 71.578756 s.
j = 1.001157e+06.
Runtime: 71.596599 s.
j = 1.001157e+06.
End of time loop.
Runtime: 71.579506 s.
j = 1.001157e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 71.600413 s.
j = 1.001157e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.272e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.152e+00 (tol = 1.000e-10) r (rel) = 1.546e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.220e-01 (tol = 1.000e-10) r (rel) = 6.108e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.197e-03 (tol = 1.000e-10) r (rel) = 2.271e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.371e-08 (tol = 1.000e-10) r (rel) = 4.497e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 59.263762 s.
Runtime: 59.266465 s.
j = 9.952869e+05.
j = 9.952869e+05.
End of time loop.
Runtime: 59.266960 s.
j = 9.952869e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 59.266700 s.
j = 9.952869e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.876e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.280e+00 (tol = 1.000e-10) r (rel) = 1.104e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.211e-01 (tol = 1.000e-10) r (rel) = 3.124e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.493e-04 (tol = 1.000e-10) r (rel) = 6.432e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.363e-09 (tol = 1.000e-10) r (rel) = 3.516e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 52.278809 s.
j = 1.009261e+06.
Runtime: 52.279867 s.
j = 1.009261e+06.
Runtime: 52.279958 s.
j = 1.009261e+06.
Runtime: 52.277471 s.
j = 1.009261e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.736e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.634e-01 (tol = 1.000e-10) r (rel) = 2.112e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.739e-04 (tol = 1.000e-10) r (rel) = 2.248e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.657e-10 (tol = 1.000e-10) r (rel) = 8.605e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 38.511042 s.
j = 1.009044e+06.
End of time loop.
Runtime: 38.511027 s.
j = 1.009044e+06.
Runtime: 38.511544 s.
j = 1.009044e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 38.511694 s.
j = 1.009044e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.982e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.164e-02 (tol = 1.000e-10) r (rel) = 1.438e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.224e-05 (tol = 1.000e-10) r (rel) = 8.479e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.300e-10 (tol = 1.000e-10) r (rel) = 2.609e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 36.719516 s.
j = 1.009697e+06.
End of time loop.
Runtime: 36.722603 s.
End of time loop.
j = 1.009697e+06.
Runtime: 36.721633 s.
j = 1.009697e+06.
Runtime: 36.723084 s.
Start evaluation of dj
j = 1.009697e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.4189319611 s
|dj| = 4253.56468515
Start evaluation of j
Updating the turbine cache
Runtime: 14.4208140373 s
|dj| = 4253.56468515
Runtime: 14.4227230549 s
|dj| = 4253.56468515
Start evaluation of j
Updating the turbine cache
   24   119    -3.893839E+05     1.640363E+03
Start evaluation of j
Updating the turbine cache
Runtime: 14.4299149513 s
|dj| = 4253.56468515
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.518e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.264e+01 (tol = 1.000e-10) r (rel) = 2.379e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.682e+00 (tol = 1.000e-10) r (rel) = 1.767e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.827e-02 (tol = 1.000e-10) r (rel) = 1.920e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.421e-06 (tol = 1.000e-10) r (rel) = 3.595e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 6.591e-12 (tol = 1.000e-10) r (rel) = 6.925e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 66.672868 s.
Runtime: 66.674562 s.
j = 9.356002e+05.
Runtime: 66.677241 s.
j = 9.356002e+05.
j = 9.356002e+05.
Runtime: 66.667730 s.
j = 9.356002e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.481e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.056e+01 (tol = 1.000e-10) r (rel) = 2.424e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.370e+00 (tol = 1.000e-10) r (rel) = 1.615e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.224e-02 (tol = 1.000e-10) r (rel) = 1.443e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.683e-06 (tol = 1.000e-10) r (rel) = 1.984e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.932e-12 (tol = 1.000e-10) r (rel) = 5.815e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 78.705646 s.
j = 9.959192e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 78.705254 s.
j = 9.959192e+05.
Start evaluation of j
Updating the turbine cache
End of time loop.
End of time loop.
Runtime: 78.705669 s.
j = 9.959192e+05.
Start evaluation of j
Updating the turbine cache
Runtime: 78.720694 s.
j = 9.959192e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.001e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.668e+00 (tol = 1.000e-10) r (rel) = 1.667e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.648e-01 (tol = 1.000e-10) r (rel) = 6.618e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.214e-03 (tol = 1.000e-10) r (rel) = 3.033e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.908e-08 (tol = 1.000e-10) r (rel) = 7.268e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 49.950623 s.
j = 1.002440e+06.
Runtime: 49.950691 s.
j = 1.002440e+06.
Runtime: 49.951468 s.
j = 1.002440e+06.
Runtime: 49.935161 s.
j = 1.002440e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.740e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.046e+00 (tol = 1.000e-10) r (rel) = 6.016e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.283e-02 (tol = 1.000e-10) r (rel) = 7.376e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.259e-06 (tol = 1.000e-10) r (rel) = 1.874e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.092e-11 (tol = 1.000e-10) r (rel) = 6.275e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 53.869123 s.
j = 1.009484e+06.
End of time loop.
Runtime: 53.868950 s.
End of time loop.
j = 1.009484e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 53.870152 s.
j = 1.009484e+06.
Runtime: 53.870628 s.
j = 1.009484e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.882e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.250e-02 (tol = 1.000e-10) r (rel) = 6.645e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.731e-06 (tol = 1.000e-10) r (rel) = 9.199e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.290e-12 (tol = 1.000e-10) r (rel) = 2.280e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 46.954537 s.
j = 1.009715e+06.
Runtime: 46.955954 s.
j = 1.009715e+06.
End of time loop.
Start evaluation of dj
Runtime: 46.957884 s.
Start evaluation of dj
j = 1.009715e+06.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 46.957926 s.
j = 1.009715e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 13.7593159676 s
Runtime: 13.7580468655 s
Runtime: 13.7593510151 s
|dj| = 4242.26813463
|dj| = 4242.26813463
|dj| = 4242.26813463
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 13.7588551044 s
|dj| = 4242.26813463
Start evaluation of j
Updating the turbine cache
   25   124    -3.893908E+05     1.636007E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.397e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.217e+01 (tol = 1.000e-10) r (rel) = 1.645e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.029e-01 (tol = 1.000e-10) r (rel) = 9.503e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.568e-03 (tol = 1.000e-10) r (rel) = 6.175e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.429e-07 (tol = 1.000e-10) r (rel) = 3.283e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.421e-12 (tol = 1.000e-10) r (rel) = 1.921e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 75.206977 s.
Runtime: 75.204817 s.
j = 9.823280e+05.
j = 9.823280e+05.
Runtime: 75.206604 s.
j = 9.823280e+05.
Runtime: 75.207579 s.
j = 9.823280e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.950e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.001e+01 (tol = 1.000e-10) r (rel) = 2.023e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.917e-01 (tol = 1.000e-10) r (rel) = 7.913e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.601e-04 (tol = 1.000e-10) r (rel) = 1.737e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.469e-09 (tol = 1.000e-10) r (rel) = 1.105e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 68.405807 s.
j = 1.000712e+06.
End of time loop.
Runtime: 68.405957 s.
End of time loop.
j = 1.000712e+06.
Runtime: 68.405278 s.
Start evaluation of j
j = 1.000712e+06.
Runtime: 68.406541 s.
j = 1.000712e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.465e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.257e+00 (tol = 1.000e-10) r (rel) = 1.321e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.065e-02 (tol = 1.000e-10) r (rel) = 1.649e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.476e-06 (tol = 1.000e-10) r (rel) = 3.844e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.407e-11 (tol = 1.000e-10) r (rel) = 1.788e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 62.741177 s.
j = 1.009346e+06.
End of time loop.
End of time loop.
Runtime: 62.742606 s.
j = 1.009346e+06.
End of time loop.
Start evaluation of j
Runtime: 62.741522 s.
j = 1.009346e+06.
Updating the turbine cache
Runtime: 62.742027 s.
Start evaluation of j
j = 1.009346e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.602e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.411e-01 (tol = 1.000e-10) r (rel) = 2.138e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.115e-04 (tol = 1.000e-10) r (rel) = 1.688e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.453e-10 (tol = 1.000e-10) r (rel) = 8.259e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 47.289558 s.
j = 1.009781e+06.
Runtime: 47.292102 s.
j = 1.009781e+06.
Runtime: 47.291301 s.
j = 1.009781e+06.
Runtime: 47.291705 s.
j = 1.009781e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.931180954 s
|dj| = 4471.01926034
Runtime: 11.9314730167 s
|dj| = 4471.01926034
Runtime: 11.9312291145 s
|dj| = 4471.01926034
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Runtime: 11.9335780144 s
Updating the turbine cache
|dj| = 4471.01926034
Start evaluation of j
Updating the turbine cache
   26   128    -3.894164E+05     1.724223E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.623e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.910e+00 (tol = 1.000e-10) r (rel) = 1.407e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.483e-01 (tol = 1.000e-10) r (rel) = 6.194e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.296e-03 (tol = 1.000e-10) r (rel) = 2.306e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.902e-08 (tol = 1.000e-10) r (rel) = 3.382e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 45.860269 s.
Runtime: 45.861451 s.
j = 9.979352e+05.
j = 9.979352e+05.
Runtime: 45.859358 s.
j = 9.979352e+05.
Runtime: 45.861745 s.
j = 9.979352e+05.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.657e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.089e+00 (tol = 1.000e-10) r (rel) = 1.392e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.114e-01 (tol = 1.000e-10) r (rel) = 3.046e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.252e-04 (tol = 1.000e-10) r (rel) = 3.424e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.315e-10 (tol = 1.000e-10) r (rel) = 1.180e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 50.696793 s.
j = 1.002022e+06.
End of time loop.
Runtime: 50.696990 s.
End of time loop.
j = 1.002022e+06.
Runtime: 50.697502 s.
Runtime: 50.696826 s.
j = 1.002022e+06.
Start evaluation of j
j = 1.002022e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.884e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.393e+00 (tol = 1.000e-10) r (rel) = 7.394e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.007e-02 (tol = 1.000e-10) r (rel) = 5.346e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.128e-07 (tol = 1.000e-10) r (rel) = 4.845e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.509e-12 (tol = 1.000e-10) r (rel) = 1.862e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 65.911627 s.
Runtime: 65.912383 s.
j = 1.010130e+06.
j = 1.010130e+06.
Runtime: 65.911397 s.
j = 1.010130e+06.
Runtime: 65.913133 s.
j = 1.010130e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.4252169132 s
|dj| = 4431.15099047
Runtime: 15.4252119064 s
|dj| = 4431.15099047
Runtime: 15.4263207912 s
|dj| = 4431.15099047
Start evaluation of j
Updating the turbine cache
Runtime: 15.4282910824 s
Start evaluation of j
Start evaluation of j
|dj| = 4431.15099047
Updating the turbine cache
Updating the turbine cache
   27   131    -3.895507E+05     1.708848E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.871e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.400e+01 (tol = 1.000e-10) r (rel) = 1.779e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.578e-01 (tol = 1.000e-10) r (rel) = 9.627e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.018e-03 (tol = 1.000e-10) r (rel) = 5.104e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.584e-07 (tol = 1.000e-10) r (rel) = 2.013e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.208e-12 (tol = 1.000e-10) r (rel) = 1.535e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 77.905827 s.
j = 1.000270e+06.
End of time loop.
End of time loop.
Runtime: 77.904184 s.
j = 1.000270e+06.
Runtime: 77.906670 s.
Runtime: 77.907898 s.
j = 1.000270e+06.
j = 1.000270e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.205e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.769e+00 (tol = 1.000e-10) r (rel) = 1.877e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.636e-01 (tol = 1.000e-10) r (rel) = 6.985e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.208e-03 (tol = 1.000e-10) r (rel) = 2.320e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.484e-08 (tol = 1.000e-10) r (rel) = 4.773e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 63.745551 s.
j = 1.008269e+06.
Runtime: 63.746647 s.
j = 1.008269e+06.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 63.746320 s.
j = 1.008269e+06.
Updating the turbine cache
Updating the turbine cache
Runtime: 63.747364 s.
j = 1.008269e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.280e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.207e+00 (tol = 1.000e-10) r (rel) = 1.283e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.502e-02 (tol = 1.000e-10) r (rel) = 2.287e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.672e-05 (tol = 1.000e-10) r (rel) = 1.424e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.721e-10 (tol = 1.000e-10) r (rel) = 5.247e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 62.181932 s.
End of time loop.
Runtime: 62.183412 s.
j = 9.977488e+05.
j = 9.977488e+05.
End of time loop.
Runtime: 62.183737 s.
j = 9.977488e+05.
Runtime: 62.181166 s.
j = 9.977488e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.596e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.383e+00 (tol = 1.000e-10) r (rel) = 9.180e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.513e-02 (tol = 1.000e-10) r (rel) = 9.681e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.546e-06 (tol = 1.000e-10) r (rel) = 2.136e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.701e-11 (tol = 1.000e-10) r (rel) = 6.553e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 56.992176 s.
j = 1.009118e+06.
Runtime: 56.993278 s.
j = 1.009118e+06.
End of time loop.
Runtime: 56.992778 s.
j = 1.009118e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 56.994213 s.
j = 1.009118e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.797e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.946e-02 (tol = 1.000e-10) r (rel) = 1.716e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.036e-05 (tol = 1.000e-10) r (rel) = 1.214e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.866e-10 (tol = 1.000e-10) r (rel) = 3.218e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 38.369637 s.
Runtime: 38.372289 s.
j = 1.010632e+06.
j = 1.010632e+06.
Runtime: 38.372335 s.
j = 1.010632e+06.
Runtime: 38.371538 s.
j = 1.010632e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.1869680882 s
|dj| = 4541.13423427
Runtime: 12.1872820854 s
|dj| = 4541.13423427
Runtime: 12.1882879734 s
|dj| = 4541.13423427
Start evaluation of j
Updating the turbine cache
Runtime: 12.1895258427 s
|dj| = 4541.13423427
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   28   136    -3.897446E+05     1.751263E+03
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.644e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.134e+00 (tol = 1.000e-10) r (rel) = 1.752e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.750e-01 (tol = 1.000e-10) r (rel) = 5.921e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.727e-04 (tol = 1.000e-10) r (rel) = 1.018e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.020e-09 (tol = 1.000e-10) r (rel) = 4.349e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 62.705301 s.
j = 1.002291e+06.
End of time loop.
Runtime: 62.703749 s.
j = 1.002291e+06.
Runtime: 62.706117 s.
j = 1.002291e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
End of time loop.
Updating the turbine cache
Runtime: 62.708360 s.
j = 1.002291e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.473e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.731e+00 (tol = 1.000e-10) r (rel) = 1.281e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.722e-01 (tol = 1.000e-10) r (rel) = 6.086e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.163e-03 (tol = 1.000e-10) r (rel) = 2.599e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.350e-08 (tol = 1.000e-10) r (rel) = 5.255e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 59.644121 s.
Runtime: 59.643193 s.
j = 1.006879e+06.
j = 1.006879e+06.
End of time loop.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Runtime: 59.642698 s.
Updating the turbine cache
End of time loop.
j = 1.006879e+06.
Runtime: 59.646397 s.
j = 1.006879e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.659e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.269e+00 (tol = 1.000e-10) r (rel) = 8.536e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.060e-02 (tol = 1.000e-10) r (rel) = 2.279e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.678e-05 (tol = 1.000e-10) r (rel) = 2.512e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.510e-10 (tol = 1.000e-10) r (rel) = 9.440e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.313568 s.
j = 1.005327e+06.
Runtime: 46.315592 s.
j = 1.005327e+06.
Runtime: 46.315892 s.
j = 1.005327e+06.
Runtime: 46.305033 s.
j = 1.005327e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.376e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.585e-01 (tol = 1.000e-10) r (rel) = 4.784e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.734e-03 (tol = 1.000e-10) r (rel) = 3.440e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.896e-07 (tol = 1.000e-10) r (rel) = 2.831e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.666e-12 (tol = 1.000e-10) r (rel) = 1.211e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.754654 s.
j = 1.010463e+06.
Runtime: 46.754733 s.
j = 1.010463e+06.
Runtime: 46.753924 s.
j = 1.010463e+06.
Runtime: 46.754865 s.
j = 1.010463e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.406e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.287e-02 (tol = 1.000e-10) r (rel) = 9.503e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.563e-06 (tol = 1.000e-10) r (rel) = 2.312e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.756e-11 (tol = 1.000e-10) r (rel) = 7.299e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 36.366383 s.
j = 1.010819e+06.
Runtime: 36.366487 s.
j = 1.010819e+06.
End of time loop.
Runtime: 36.367101 s.
Start evaluation of dj
j = 1.010819e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 36.367213 s.
j = 1.010819e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.9730849266 s
|dj| = 4342.3852673
Runtime: 12.9758749008 s
|dj| = 4342.3852673
Runtime: 12.9737269878 s
Start evaluation of j
|dj| = 4342.3852673
Updating the turbine cache
Runtime: 12.976788044 s
|dj| = 4342.3852673
Start evaluation of j
Updating the turbine cache
Start evaluation of j
   29   141    -3.898165E+05     1.674616E+03
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.801e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.016e+01 (tol = 1.000e-10) r (rel) = 1.494e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.023e-01 (tol = 1.000e-10) r (rel) = 7.386e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.543e-03 (tol = 1.000e-10) r (rel) = 3.739e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.723e-08 (tol = 1.000e-10) r (rel) = 1.283e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.126e-12 (tol = 1.000e-10) r (rel) = 1.656e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 70.411674 s.
j = 9.981135e+05.
Runtime: 70.412099 s.
End of time loop.
j = 9.981135e+05.
Start evaluation of j
End of time loop.
Runtime: 70.412874 s.
Runtime: 70.415079 s.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
j = 9.981135e+05.
Start evaluation of j
Updating the turbine cache
j = 9.981135e+05.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.101e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.989e+00 (tol = 1.000e-10) r (rel) = 1.704e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.784e-01 (tol = 1.000e-10) r (rel) = 4.349e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.591e-04 (tol = 1.000e-10) r (rel) = 3.879e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.547e-10 (tol = 1.000e-10) r (rel) = 1.109e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.799562 s.
Runtime: 46.794055 s.
j = 1.007486e+06.
j = 1.007486e+06.
Runtime: 46.788296 s.
j = 1.007486e+06.
Runtime: 46.790187 s.
j = 1.007486e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.955e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.387e+00 (tol = 1.000e-10) r (rel) = 7.093e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.844e-03 (tol = 1.000e-10) r (rel) = 5.036e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.625e-07 (tol = 1.000e-10) r (rel) = 4.924e-08 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.213e-12 (tol = 1.000e-10) r (rel) = 1.644e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 51.709720 s.
j = 1.010811e+06.
Runtime: 51.709026 s.
j = 1.010811e+06.
End of time loop.
End of time loop.
Start evaluation of j
Start evaluation of j
Runtime: 51.710777 s.
j = 1.010811e+06.
Updating the turbine cache
Updating the turbine cache
Runtime: 51.711385 s.
j = 1.010811e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.135e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.175e-01 (tol = 1.000e-10) r (rel) = 1.916e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.975e-05 (tol = 1.000e-10) r (rel) = 1.626e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.907e-10 (tol = 1.000e-10) r (rel) = 4.739e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 51.941640 s.
Runtime: 51.941677 s.
j = 1.010892e+06.
j = 1.010892e+06.
Runtime: 51.940425 s.
j = 1.010892e+06.
Runtime: 51.939851 s.
j = 1.010892e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.724e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.443e-02 (tol = 1.000e-10) r (rel) = 8.968e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.071e-06 (tol = 1.000e-10) r (rel) = 1.862e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.595e-11 (tol = 1.000e-10) r (rel) = 5.855e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.148691 s.
j = 1.010864e+06.
Runtime: 46.149972 s.
j = 1.010864e+06.
Runtime: 46.150090 s.
j = 1.010864e+06.
Runtime: 46.150327 s.
j = 1.010864e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.362e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.954e-03 (tol = 1.000e-10) r (rel) = 3.638e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.316e-07 (tol = 1.000e-10) r (rel) = 9.665e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.156e-12 (tol = 1.000e-10) r (rel) = 8.494e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 45.428655 s.
j = 1.010935e+06.
Runtime: 45.427907 s.
j = 1.010935e+06.
End of time loop.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 45.429421 s.
j = 1.010935e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 45.430341 s.
j = 1.010935e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.2983539104 s
|dj| = 4127.59108341
Runtime: 15.2996270657 s
|dj| = 4127.59108341
Start evaluation of j
Updating the turbine cache
   30   147    -3.898612E+05     1.591782E+03
Start evaluation of j
Updating the turbine cache
Runtime: 15.3117890358 s
|dj| = 4127.59108341
Runtime: 15.3122200966 s
|dj| = 4127.59108341
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.561e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.976e+01 (tol = 1.000e-10) r (rel) = 2.066e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.292e+00 (tol = 1.000e-10) r (rel) = 1.351e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.047e-02 (tol = 1.000e-10) r (rel) = 1.095e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.166e-06 (tol = 1.000e-10) r (rel) = 1.220e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 4.666e-12 (tol = 1.000e-10) r (rel) = 4.880e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 77.158697 s.
j = 9.924413e+05.
End of time loop.
Runtime: 77.142990 s.
j = 9.924413e+05.
End of time loop.
Start evaluation of j
Runtime: 77.158412 s.
j = 9.924413e+05.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 77.142257 s.
Start evaluation of j
j = 9.924413e+05.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.169e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.468e+01 (tol = 1.000e-10) r (rel) = 2.047e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.476e-01 (tol = 1.000e-10) r (rel) = 1.182e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.146e-03 (tol = 1.000e-10) r (rel) = 8.573e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.258e-07 (tol = 1.000e-10) r (rel) = 7.335e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.076e-12 (tol = 1.000e-10) r (rel) = 2.896e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 69.428048 s.
Runtime: 69.427028 s.
j = 9.997359e+05.
j = 9.997359e+05.
Runtime: 69.425465 s.
j = 9.997359e+05.
Runtime: 69.428557 s.
j = 9.997359e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.331e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.173e+00 (tol = 1.000e-10) r (rel) = 1.425e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.155e-01 (tol = 1.000e-10) r (rel) = 4.976e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.649e-04 (tol = 1.000e-10) r (rel) = 1.766e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.428e-08 (tol = 1.000e-10) r (rel) = 3.297e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 61.938574 s.
j = 1.000245e+06.
Runtime: 61.938842 s.
j = 1.000245e+06.
End of time loop.
Runtime: 61.939367 s.
j = 1.000245e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 61.939280 s.
j = 1.000245e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.376e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.084e+00 (tol = 1.000e-10) r (rel) = 8.772e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.665e-02 (tol = 1.000e-10) r (rel) = 1.542e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.382e-05 (tol = 1.000e-10) r (rel) = 1.003e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.655e-11 (tol = 1.000e-10) r (rel) = 3.642e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 54.342705 s.
j = 1.008698e+06.
Runtime: 54.342693 s.
j = 1.008698e+06.
Runtime: 54.340168 s.
j = 1.008698e+06.
Runtime: 54.341959 s.
j = 1.008698e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 7.085e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.211e-01 (tol = 1.000e-10) r (rel) = 3.121e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.672e-04 (tol = 1.000e-10) r (rel) = 9.417e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.238e-09 (tol = 1.000e-10) r (rel) = 1.163e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.071e-12 (tol = 1.000e-10) r (rel) = 1.512e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 50.567424 s.
Runtime: 50.567587 s.
j = 1.010673e+06.
j = 1.010673e+06.
End of time loop.
End of time loop.
Runtime: 50.567251 s.
Runtime: 50.568115 s.
j = 1.010673e+06.
j = 1.010673e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.091e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.543e-02 (tol = 1.000e-10) r (rel) = 7.379e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.818e-06 (tol = 1.000e-10) r (rel) = 1.348e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.265e-11 (tol = 1.000e-10) r (rel) = 1.083e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
Runtime: 50.032880 s.
End of time loop.
j = 1.011217e+06.
Runtime: 50.033411 s.
End of time loop.
j = 1.011217e+06.
Runtime: 50.034335 s.
j = 1.011217e+06.
End of time loop.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 50.035698 s.
Start evaluation of dj
j = 1.011217e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.279471159 s
|dj| = 3891.59630985
Runtime: 16.2806210518 s
|dj| = 3891.59630985
Runtime: 16.280850172 s
|dj| = 3891.59630985
Runtime: 16.2798919678 s
|dj| = 3891.59630985
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
   31   153    -3.899703E+05     1.500772E+03
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.421e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.247e+00 (tol = 1.000e-10) r (rel) = 9.282e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.512e-02 (tol = 1.000e-10) r (rel) = 1.037e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.525e-06 (tol = 1.000e-10) r (rel) = 1.869e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.340e-11 (tol = 1.000e-10) r (rel) = 5.534e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.328043 s.
Runtime: 46.327945 s.
j = 9.965526e+05.
j = 9.965526e+05.
Runtime: 46.327756 s.
j = 9.965526e+05.
Runtime: 46.327735 s.
j = 9.965526e+05.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.600e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.873e+00 (tol = 1.000e-10) r (rel) = 7.203e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.292e-02 (tol = 1.000e-10) r (rel) = 1.651e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.178e-05 (tol = 1.000e-10) r (rel) = 1.607e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.427e-10 (tol = 1.000e-10) r (rel) = 5.487e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 49.293064 s.
j = 1.010625e+06.
Runtime: 49.293064 s.
j = 1.010625e+06.
End of time loop.
End of time loop.
Runtime: 49.292774 s.
Runtime: 49.293550 s.
Start evaluation of j
j = 1.010625e+06.
j = 1.010625e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.726e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.048e-02 (tol = 1.000e-10) r (rel) = 1.491e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.073e-05 (tol = 1.000e-10) r (rel) = 1.285e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.244e-10 (tol = 1.000e-10) r (rel) = 4.749e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 35.319274 s.
Runtime: 35.318142 s.
j = 1.011892e+06.
j = 1.011892e+06.
Runtime: 35.318253 s.
j = 1.011892e+06.
Runtime: 35.319185 s.
j = 1.011892e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.3345360756 s
|dj| = 3073.09995409
Start evaluation of j
Runtime: 12.3373100758 s
|dj| = 3073.09995409
Updating the turbine cache
   32   156    -3.902303E+05     1.185124E+03
Start evaluation of j
Updating the turbine cache
Runtime: 12.3516559601 s
|dj| = 3073.09995409
Runtime: 12.3548719883 s
Start evaluation of j
|dj| = 3073.09995409
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.366e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.038e+01 (tol = 1.000e-10) r (rel) = 1.631e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.489e-01 (tol = 1.000e-10) r (rel) = 7.052e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.999e-03 (tol = 1.000e-10) r (rel) = 3.140e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.623e-08 (tol = 1.000e-10) r (rel) = 1.040e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.096e-12 (tol = 1.000e-10) r (rel) = 1.722e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 66.792371 s.
Runtime: 66.790437 s.
j = 1.001378e+06.
j = 1.001378e+06.
Runtime: 66.775020 s.
j = 1.001378e+06.
Runtime: 66.772111 s.
j = 1.001378e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.824e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.385e+00 (tol = 1.000e-10) r (rel) = 1.324e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.507e-01 (tol = 1.000e-10) r (rel) = 5.197e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.063e-04 (tol = 1.000e-10) r (rel) = 1.879e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.711e-08 (tol = 1.000e-10) r (rel) = 3.546e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.384655 s.
j = 1.000380e+06.
Runtime: 46.385607 s.
Runtime: 46.385590 s.
j = 1.000380e+06.
j = 1.000380e+06.
Runtime: 46.385775 s.
j = 1.000380e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.562e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.028e+00 (tol = 1.000e-10) r (rel) = 7.916e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.627e-02 (tol = 1.000e-10) r (rel) = 1.806e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.617e-05 (tol = 1.000e-10) r (rel) = 1.802e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.837e-10 (tol = 1.000e-10) r (rel) = 7.170e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 57.127925 s.
j = 1.009319e+06.
Runtime: 57.127149 s.
j = 1.009319e+06.
Runtime: 57.127898 s.
j = 1.009319e+06.
Runtime: 57.128143 s.
j = 1.009319e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.381e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.535e-01 (tol = 1.000e-10) r (rel) = 2.405e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.058e-04 (tol = 1.000e-10) r (rel) = 4.792e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.691e-09 (tol = 1.000e-10) r (rel) = 4.217e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 38.962309 s.
j = 1.011873e+06.
Runtime: 38.962440 s.
j = 1.011873e+06.
End of time loop.
Runtime: 38.962907 s.
j = 1.011873e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 38.963265 s.
j = 1.011873e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.226e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.258e-03 (tol = 1.000e-10) r (rel) = 4.290e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.846e-07 (tol = 1.000e-10) r (rel) = 2.322e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.898e-12 (tol = 1.000e-10) r (rel) = 1.548e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 45.553105 s.
End of time loop.
j = 1.012094e+06.
Runtime: 45.553728 s.
j = 1.012094e+06.
Start evaluation of dj
Runtime: 45.551630 s.
j = 1.012094e+06.
End of time loop.
found a tidal farm, computing gradient
Runtime: 45.553833 s.
Start evaluation of dj
found a tidal farm, computing gradient
j = 1.012094e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.2651131153 s
|dj| = 2707.63859176
Start evaluation of j
Updating the turbine cache
Runtime: 16.2674980164 s
|dj| = 2707.63859176
   33   161    -3.903084E+05     1.044185E+03
Start evaluation of j
Updating the turbine cache
Runtime: 16.2718520164 s
|dj| = 2707.63859176
Runtime: 16.2657558918 s
|dj| = 2707.63859176
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.782e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.775e+00 (tol = 1.000e-10) r (rel) = 1.208e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.327e-01 (tol = 1.000e-10) r (rel) = 4.867e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.834e-04 (tol = 1.000e-10) r (rel) = 1.429e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.799e-09 (tol = 1.000e-10) r (rel) = 1.422e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 61.957603 s.
Runtime: 61.959414 s.
j = 1.004409e+06.
j = 1.004409e+06.
Runtime: 61.975367 s.
j = 1.004409e+06.
Runtime: 61.972495 s.
j = 1.004409e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.699e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.955e+00 (tol = 1.000e-10) r (rel) = 1.095e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.671e-02 (tol = 1.000e-10) r (rel) = 1.360e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.950e-06 (tol = 1.000e-10) r (rel) = 2.945e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.410e-11 (tol = 1.000e-10) r (rel) = 8.927e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 55.646153 s.
j = 1.000909e+06.
Runtime: 55.646173 s.
j = 1.000909e+06.
Runtime: 55.645514 s.
j = 1.000909e+06.
Runtime: 55.646686 s.
j = 1.000909e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.514e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.581e-01 (tol = 1.000e-10) r (rel) = 5.666e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.936e-03 (tol = 1.000e-10) r (rel) = 2.599e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.465e-07 (tol = 1.000e-10) r (rel) = 9.675e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.151e-12 (tol = 1.000e-10) r (rel) = 7.600e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 46.970917 s.
j = 1.011930e+06.
Runtime: 46.971068 s.
j = 1.011930e+06.
Runtime: 46.971058 s.
j = 1.011930e+06.
Runtime: 46.970025 s.
j = 1.011930e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.269e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.474e-02 (tol = 1.000e-10) r (rel) = 6.497e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.495e-06 (tol = 1.000e-10) r (rel) = 6.587e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.615e-12 (tol = 1.000e-10) r (rel) = 2.033e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 42.373696 s.
j = 1.012318e+06.
Runtime: 42.372948 s.
j = 1.012318e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
Runtime: 42.374395 s.
j = 1.012318e+06.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 42.375247 s.
j = 1.012318e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.6098599434 s
|dj| = 2617.57665223
Start evaluation of j
Runtime: 15.6116919518 s
Updating the turbine cache
|dj| = 2617.57665223
   34   165    -3.903948E+05     1.009454E+03
Start evaluation of j
Updating the turbine cache
Runtime: 15.6229300499 s
|dj| = 2617.57665223
Start evaluation of j
Updating the turbine cache
Runtime: 15.6254951954 s
|dj| = 2617.57665223
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.761e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.077e+00 (tol = 1.000e-10) r (rel) = 7.522e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.051e-02 (tol = 1.000e-10) r (rel) = 1.105e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.114e-05 (tol = 1.000e-10) r (rel) = 4.034e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.444e-11 (tol = 1.000e-10) r (rel) = 1.247e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 61.596776 s.
j = 1.004082e+06.
End of time loop.
End of time loop.
Runtime: 61.576597 s.
j = 1.004082e+06.
Runtime: 61.595567 s.
Start evaluation of j
Runtime: 61.581472 s.
j = 1.004082e+06.
j = 1.004082e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.065e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.354e+00 (tol = 1.000e-10) r (rel) = 6.557e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.501e-02 (tol = 1.000e-10) r (rel) = 7.270e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.410e-06 (tol = 1.000e-10) r (rel) = 2.136e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.502e-11 (tol = 1.000e-10) r (rel) = 7.275e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 65.769443 s.
j = 1.011404e+06.
Runtime: 65.769797 s.
j = 1.011404e+06.
Runtime: 65.770772 s.
j = 1.011404e+06.
Runtime: 65.769967 s.
j = 1.011404e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.736e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.781e-02 (tol = 1.000e-10) r (rel) = 1.432e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.907e-05 (tol = 1.000e-10) r (rel) = 8.250e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.820e-10 (tol = 1.000e-10) r (rel) = 3.843e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 53.841926 s.
j = 1.012461e+06.
Runtime: 53.842319 s.
j = 1.012461e+06.
End of time loop.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Runtime: 53.842300 s.
j = 1.012461e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 53.854163 s.
j = 1.012461e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.6260480881 s
|dj| = 2476.25846172
Runtime: 16.6336150169 s
|dj| = 2476.25846172
Start evaluation of j
Updating the turbine cache
   35   168    -3.904497E+05     9.549550E+02
Start evaluation of j
Updating the turbine cache
Runtime: 16.6536068916 s
|dj| = 2476.25846172
Runtime: 16.6524438858 s
|dj| = 2476.25846172
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.617e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.500e-01 (tol = 1.000e-10) r (rel) = 2.670e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.471e-04 (tol = 1.000e-10) r (rel) = 4.398e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.951e-09 (tol = 1.000e-10) r (rel) = 3.474e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 45.724822 s.
j = 1.012426e+06.
End of time loop.
End of time loop.
Runtime: 45.723252 s.
j = 1.012426e+06.
Runtime: 45.709249 s.
Runtime: 45.708421 s.
Start evaluation of j
j = 1.012426e+06.
j = 1.012426e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.288e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.194e-02 (tol = 1.000e-10) r (rel) = 1.276e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.166e-05 (tol = 1.000e-10) r (rel) = 6.587e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.608e-10 (tol = 1.000e-10) r (rel) = 4.892e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 47.515349 s.
End of time loop.
End of time loop.
j = 1.012762e+06.
Runtime: 47.516085 s.
j = 1.012762e+06.
Runtime: 47.517169 s.
Runtime: 47.515790 s.
j = 1.012762e+06.
j = 1.012762e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.6257078648 s
|dj| = 1804.60293185
Runtime: 17.6261050701 s
|dj| = 1804.60293185
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 17.6597859859 s
Runtime: 17.6582448483 s
|dj| = 1804.60293185
Start evaluation of j
|dj| = 1804.60293185
Updating the turbine cache
   36   170    -3.905658E+05     6.959349E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.817e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.670e+00 (tol = 1.000e-10) r (rel) = 9.615e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.145e-01 (tol = 1.000e-10) r (rel) = 3.001e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.272e-04 (tol = 1.000e-10) r (rel) = 5.953e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.138e-09 (tol = 1.000e-10) r (rel) = 2.982e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 61.436038 s.
j = 1.010656e+06.
End of time loop.
Runtime: 61.433307 s.
End of time loop.
j = 1.010656e+06.
Runtime: 61.471531 s.
j = 1.010656e+06.
Start evaluation of j
Runtime: 61.471857 s.
j = 1.010656e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.057e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.596e+00 (tol = 1.000e-10) r (rel) = 7.759e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.531e-02 (tol = 1.000e-10) r (rel) = 7.446e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.488e-06 (tol = 1.000e-10) r (rel) = 1.210e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.200e-11 (tol = 1.000e-10) r (rel) = 5.837e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 52.307763 s.
j = 1.011313e+06.
End of time loop.
End of time loop.
Runtime: 52.308641 s.
j = 1.011313e+06.
Runtime: 52.309678 s.
Start evaluation of j
j = 1.011313e+06.
Runtime: 52.308608 s.
j = 1.011313e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.066e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.722e-01 (tol = 1.000e-10) r (rel) = 3.492e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.046e-03 (tol = 1.000e-10) r (rel) = 9.814e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.644e-08 (tol = 1.000e-10) r (rel) = 1.542e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.074e-12 (tol = 1.000e-10) r (rel) = 1.008e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 50.643160 s.
j = 1.012284e+06.
Runtime: 50.643145 s.
j = 1.012284e+06.
Runtime: 50.644589 s.
j = 1.012284e+06.
Runtime: 50.644035 s.
Start evaluation of j
Start evaluation of j
Start evaluation of j
j = 1.012284e+06.
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.449e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.443e-02 (tol = 1.000e-10) r (rel) = 9.982e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.841e-06 (tol = 1.000e-10) r (rel) = 2.273e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.009e-11 (tol = 1.000e-10) r (rel) = 1.162e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 35.078826 s.
Runtime: 35.063545 s.
j = 1.012975e+06.
j = 1.012975e+06.
Runtime: 35.078960 s.
j = 1.012975e+06.
Runtime: 35.079301 s.
j = 1.012975e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.2586598396 s
|dj| = 1640.45493738
Runtime: 12.2598068714 s
Runtime: 12.2599887848 s
|dj| = 1640.45493738
|dj| = 1640.45493738
Runtime: 12.2612159252 s
|dj| = 1640.45493738
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
   37   174    -3.906479E+05     6.326321E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.327e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.329e-01 (tol = 1.000e-10) r (rel) = 3.570e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.343e-03 (tol = 1.000e-10) r (rel) = 1.440e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.377e-08 (tol = 1.000e-10) r (rel) = 3.620e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.085e-12 (tol = 1.000e-10) r (rel) = 1.163e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.542910 s.
j = 1.011840e+06.
Runtime: 48.543064 s.
j = 1.011840e+06.
End of time loop.
Runtime: 48.541801 s.
j = 1.011840e+06.
End of time loop.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 48.544462 s.
j = 1.011840e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.366e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.852e-01 (tol = 1.000e-10) r (rel) = 2.909e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.609e-04 (tol = 1.000e-10) r (rel) = 5.669e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.888e-09 (tol = 1.000e-10) r (rel) = 4.537e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 40.511597 s.
j = 1.012925e+06.
Runtime: 40.512610 s.
j = 1.012925e+06.
Runtime: 40.512741 s.
j = 1.012925e+06.
Runtime: 40.510380 s.
j = 1.012925e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.183e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.914e-03 (tol = 1.000e-10) r (rel) = 4.153e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.980e-07 (tol = 1.000e-10) r (rel) = 1.673e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.318e-12 (tol = 1.000e-10) r (rel) = 1.113e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 40.974971 s.
j = 1.013047e+06.
Runtime: 40.975764 s.
j = 1.013047e+06.
Runtime: 40.975779 s.
j = 1.013047e+06.
Runtime: 40.976182 s.
j = 1.013047e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.8655588627 s
Runtime: 11.8648941517 s
|dj| = 1521.10796499
|dj| = 1521.10796499
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 11.8720939159 s
|dj| = 1521.10796499
Start evaluation of j
Updating the turbine cache
Runtime: 11.881816864 s
|dj| = 1521.10796499
   38   177    -3.906758E+05     5.866066E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.064e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.898e-02 (tol = 1.000e-10) r (rel) = 9.197e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.608e-06 (tol = 1.000e-10) r (rel) = 1.748e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.646e-11 (tol = 1.000e-10) r (rel) = 1.766e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 43.255276 s.
j = 1.013135e+06.
End of time loop.
End of time loop.
Runtime: 43.235574 s.
j = 1.013135e+06.
Runtime: 43.255628 s.
Runtime: 43.242301 s.
j = 1.013135e+06.
j = 1.013135e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 16.3314859867 s
|dj| = 1543.94094294
Runtime: 16.333083868 s
|dj| = 1543.94094294
Runtime: 16.3323578835 s
|dj| = 1543.94094294
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 16.3358709812 s
|dj| = 1543.94094294
   39   178    -3.907099E+05     5.954121E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.078e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.561e-03 (tol = 1.000e-10) r (rel) = 6.087e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.068e-07 (tol = 1.000e-10) r (rel) = 4.702e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.459e-12 (tol = 1.000e-10) r (rel) = 4.137e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 42.927640 s.
j = 1.013368e+06.
End of time loop.
Runtime: 42.931450 s.
End of time loop.
j = 1.013368e+06.
Runtime: 42.931519 s.
Runtime: 42.932172 s.
j = 1.013368e+06.
j = 1.013368e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.8372859955 s
|dj| = 960.702260625
Runtime: 15.8388330936 s
|dj| = 960.702260625
Runtime: 15.8389980793 s
Start evaluation of j
|dj| = 960.702260625
Updating the turbine cache
Start evaluation of j
Runtime: 15.8417060375 s
Updating the turbine cache
|dj| = 960.702260625
Start evaluation of j
Updating the turbine cache
   40   179    -3.907996E+05     3.704894E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.497e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.853e-03 (tol = 1.000e-10) r (rel) = 3.004e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.827e-08 (tol = 1.000e-10) r (rel) = 6.136e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.133e-12 (tol = 1.000e-10) r (rel) = 1.193e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 40.487631 s.
j = 1.013357e+06.
End of time loop.
End of time loop.
Runtime: 40.485067 s.
j = 1.013357e+06.
Runtime: 40.486130 s.
Runtime: 40.487437 s.
Start evaluation of j
j = 1.013357e+06.
j = 1.013357e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.146e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.393e-04 (tol = 1.000e-10) r (rel) = 1.631e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.887e-09 (tol = 1.000e-10) r (rel) = 1.144e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.080e-12 (tol = 1.000e-10) r (rel) = 2.099e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 48.850272 s.
Runtime: 48.848793 s.
j = 1.013392e+06.
j = 1.013392e+06.
End of time loop.
End of time loop.
Runtime: 48.849408 s.
Runtime: 48.850107 s.
j = 1.013392e+06.
j = 1.013392e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.1067910194 s
|dj| = 881.81365565
Runtime: 17.107432127 s
|dj| = 881.81365565
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 17.1258900166 s
|dj| = 881.81365565
Runtime: 17.1253921986 s
|dj| = 881.81365565
Start evaluation of j
Updating the turbine cache
   41   181    -3.908087E+05     3.400664E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.802e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.512e-04 (tol = 1.000e-10) r (rel) = 1.564e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.680e-09 (tol = 1.000e-10) r (rel) = 1.183e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.070e-12 (tol = 1.000e-10) r (rel) = 2.227e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 47.919884 s.
j = 1.013401e+06.
Runtime: 47.901271 s.
End of time loop.
j = 1.013401e+06.
End of time loop.
Runtime: 47.921420 s.
j = 1.013401e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 47.901234 s.
j = 1.013401e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.8539400101 s
Runtime: 17.8553769588 s
|dj| = 845.142884869
|dj| = 845.142884869
Runtime: 17.8543169498 s
|dj| = 845.142884869
Runtime: 17.8543748856 s
|dj| = 845.142884869
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
   42   182    -3.908125E+05     3.259246E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.860e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.702e-04 (tol = 1.000e-10) r (rel) = 1.218e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.614e-09 (tol = 1.000e-10) r (rel) = 6.773e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.071e-12 (tol = 1.000e-10) r (rel) = 2.776e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 51.596719 s.
Runtime: 51.597329 s.
j = 1.013406e+06.
j = 1.013406e+06.
End of time loop.
End of time loop.
Runtime: 51.598640 s.
Runtime: 51.598615 s.
j = 1.013406e+06.
j = 1.013406e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 14.3984758854 s
|dj| = 828.216442999
Runtime: 14.4008588791 s
|dj| = 828.216442999
Start evaluation of j
Runtime: 14.4003119469 s
|dj| = 828.216442999
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 14.4036948681 s
|dj| = 828.216442999
   43   183    -3.908144E+05     3.193970E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.220e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.647e-04 (tol = 1.000e-10) r (rel) = 7.422e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.073e-09 (tol = 1.000e-10) r (rel) = 4.834e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.065e-12 (tol = 1.000e-10) r (rel) = 4.798e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 44.845908 s.
j = 1.013409e+06.
Runtime: 44.844294 s.
End of time loop.
End of time loop.
j = 1.013409e+06.
Runtime: 44.844765 s.
j = 1.013409e+06.
Start evaluation of dj
Runtime: 44.842590 s.
found a tidal farm, computing gradient
j = 1.013409e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 15.5499470234 s
|dj| = 824.727115114
Runtime: 15.54956007 s
|dj| = 824.727115114
Runtime: 15.5511260033 s
Start evaluation of j
|dj| = 824.727115114
Updating the turbine cache
Runtime: 15.5508210659 s
|dj| = 824.727115114
Start evaluation of j
Updating the turbine cache
   44   184    -3.908153E+05     3.180513E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.007e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.555e-05 (tol = 1.000e-10) r (rel) = 4.523e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.862e-10 (tol = 1.000e-10) r (rel) = 3.835e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.048e-12 (tol = 1.000e-10) r (rel) = 1.041e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 48.453686 s.
Runtime: 48.452610 s.
j = 1.013410e+06.
j = 1.013410e+06.
Runtime: 48.455213 s.
j = 1.013410e+06.
Runtime: 48.453188 s.
j = 1.013410e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.3333959579 s
|dj| = 823.194973221
Runtime: 17.3232049942 s
|dj| = 823.194973221
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Runtime: 17.3495330811 s
|dj| = 823.194973221
Start evaluation of j
Runtime: 17.345927 s
Updating the turbine cache
|dj| = 823.194973221
   45   185    -3.908156E+05     3.174605E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.153e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.670e-06 (tol = 1.000e-10) r (rel) = 1.365e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.660e-11 (tol = 1.000e-10) r (rel) = 6.405e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 34.988645 s.
Runtime: 34.972597 s.
j = 1.013410e+06.
j = 1.013410e+06.
Runtime: 34.988695 s.
j = 1.013410e+06.
Runtime: 34.970088 s.
j = 1.013410e+06.
Start evaluation of dj
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 19.0420768261 s
|dj| = 822.353883444
Runtime: 19.0424890518 s
|dj| = 822.353883444
Runtime: 19.0433139801 s
|dj| = 822.353883444
Runtime: 19.0434470177 s
|dj| = 822.353883444
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   46   186    -3.908157E+05     3.171361E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.512e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.835e-07 (tol = 1.000e-10) r (rel) = 4.520e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.313e-12 (tol = 1.000e-10) r (rel) = 2.852e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 32.835332 s.
j = 1.013410e+06.
Runtime: 32.835292 s.
j = 1.013410e+06.
Runtime: 32.832946 s.
j = 1.013410e+06.
Runtime: 32.834907 s.
j = 1.013410e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 12.1678569317 s
|dj| = 822.120030939
Runtime: 12.1678700447 s
|dj| = 822.120030939
Runtime: 12.1696059704 s
Runtime: 12.1694920063 s
|dj| = 822.120030939
|dj| = 822.120030939
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   47   187    -3.908157E+05     3.170459E+02
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.129e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.545e-07 (tol = 1.000e-10) r (rel) = 3.141e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.583e-12 (tol = 1.000e-10) r (rel) = 1.403e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 24.577886 s.
j = 1.013410e+06.
Runtime: 24.578090 s.
j = 1.013410e+06.
End of time loop.
Start evaluation of dj
Start evaluation of dj
Runtime: 24.578560 s.
j = 1.013410e+06.
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 24.581086 s.
j = 1.013410e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.8749849796 s
|dj| = 822.095999547
Runtime: 17.8772768974 s
|dj| = 822.095999547
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Runtime: 17.888035059 s
|dj| = 822.095999547
Start evaluation of j
Runtime: 17.8939599991 s
Updating the turbine cache
|dj| = 822.095999547
   48   188    -3.908157E+05     3.170367E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.338e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.840e-08 (tol = 1.000e-10) r (rel) = 1.577e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.242e-12 (tol = 1.000e-10) r (rel) = 2.862e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 31.442371 s.
j = 1.013410e+06.
Runtime: 31.428236 s.
j = 1.013410e+06.
End of time loop.
End of time loop.
Start evaluation of dj
Runtime: 31.425418 s.
j = 1.013410e+06.
found a tidal farm, computing gradient
Runtime: 31.444419 s.
j = 1.013410e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.2349410057 s
|dj| = 822.097556951
Start evaluation of j
Updating the turbine cache
Runtime: 17.2429618835 s
|dj| = 822.097556951
Start evaluation of j
Updating the turbine cache
Runtime: 17.2493422031 s
|dj| = 822.097556951
Start evaluation of j
Updating the turbine cache
Runtime: 17.254034996 s
|dj| = 822.097556951
   49   189    -3.908157E+05     3.170373E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.265e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.102e-09 (tol = 1.000e-10) r (rel) = 4.824e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.076e-12 (tol = 1.000e-10) r (rel) = 8.505e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 30.993442 s.
j = 1.013410e+06.
Runtime: 31.014667 s.
j = 1.013410e+06.
End of time loop.
Runtime: 30.998604 s.
j = 1.013410e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 31.008034 s.
j = 1.013410e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.6631319523 s
|dj| = 822.097287431
Runtime: 17.6678850651 s
|dj| = 822.097287431
Runtime: 17.6672549248 s
|dj| = 822.097287431
Start evaluation of j
Updating the turbine cache
Runtime: 17.6699149609 s
|dj| = 822.097287431
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
   50   190    -3.908157E+05     3.170371E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.390e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.370e-09 (tol = 1.000e-10) r (rel) = 4.397e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.069e-12 (tol = 1.000e-10) r (rel) = 1.983e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 34.858498 s.
j = 1.013410e+06.
Runtime: 34.854696 s.
j = 1.013410e+06.
End of time loop.
Start evaluation of dj
Runtime: 34.856620 s.
j = 1.013410e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
End of time loop.
Runtime: 34.855359 s.
j = 1.013410e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 13.0557119846 s
|dj| = 822.096819725
Start evaluation of j
Updating the turbine cache
Runtime: 13.0553770065 s
|dj| = 822.096819725
   51   191    -3.908157E+05     3.170370E+02
Start evaluation of j
Updating the turbine cache
Runtime: 13.0704698563 s
|dj| = 822.096819725
Start evaluation of j
Updating the turbine cache
Runtime: 13.0909900665 s
|dj| = 822.096819725
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.153e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.341e-09 (tol = 1.000e-10) r (rel) = 4.543e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.070e-12 (tol = 1.000e-10) r (rel) = 2.077e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 30.509381 s.
j = 1.013410e+06.
End of time loop.
End of time loop.
Runtime: 30.472550 s.
j = 1.013410e+06.
Start evaluation of dj
Runtime: 30.491680 s.
Runtime: 30.507307 s.
j = 1.013410e+06.
j = 1.013410e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 17.9815437794 s
|dj| = 822.096891911
Runtime: 17.9822080135 s
|dj| = 822.096891911
Start evaluation of j
Updating the turbine cache
   53   192    -3.908157E+05     3.170370E+02
Start evaluation of j
Updating the turbine cache
Runtime: 17.9971160889 s
|dj| = 822.096891911
Runtime: 17.9969098568 s
|dj| = 822.096891911
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.011e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.315e-05 (tol = 1.000e-10) r (rel) = 7.237e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.231e-10 (tol = 1.000e-10) r (rel) = 4.186e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.059e-12 (tol = 1.000e-10) r (rel) = 1.048e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 36.936004 s.
j = 1.013406e+06.
Runtime: 36.920624 s.
j = 1.013406e+06.
Runtime: 36.919674 s.
j = 1.013406e+06.
Runtime: 36.937013 s.
j = 1.013406e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.097e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.921e-05 (tol = 1.000e-10) r (rel) = 6.509e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.400e-10 (tol = 1.000e-10) r (rel) = 3.737e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.051e-12 (tol = 1.000e-10) r (rel) = 1.156e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 42.655297 s.
j = 1.013410e+06.
Runtime: 42.655714 s.
End of time loop.
j = 1.013410e+06.
End of time loop.
Runtime: 42.656191 s.
Start evaluation of j
j = 1.013410e+06.
Updating the turbine cache
Runtime: 42.655452 s.
j = 1.013410e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.098e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.936e-07 (tol = 1.000e-10) r (rel) = 6.525e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.602e-12 (tol = 1.000e-10) r (rel) = 3.959e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 34.923674 s.
j = 1.013410e+06.
Runtime: 34.924473 s.
j = 1.013410e+06.
End of time loop.
Runtime: 34.923916 s.
Start evaluation of j
Start evaluation of j
j = 1.013410e+06.
Updating the turbine cache
Updating the turbine cache
End of time loop.
Runtime: 34.924639 s.
Start evaluation of j
j = 1.013410e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.098e-04 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.544e-09 (tol = 1.000e-10) r (rel) = 9.391e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.076e-12 (tol = 1.000e-10) r (rel) = 1.182e-09 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
End of time loop.
End of time loop.
Runtime: 34.452902 s.
j = 1.013410e+06.
Runtime: 34.452894 s.
j = 1.013410e+06.
Runtime: 34.450210 s.
j = 1.013410e+06.
Runtime: 34.452293 s.
j = 1.013410e+06.
Start evaluation of j
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 362003 x 362003 (PETSc Krylov solver).
Start of time loop
Start of time loop
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.475e-05 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.827e-10 (tol = 1.000e-10) r (rel) = 6.989e-06 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.049e-12 (tol = 1.000e-10) r (rel) = 1.916e-08 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Write state to disk...
Write state to disk...
Solving linear system of size 80802 x 80802 (PETSc Krylov solver).
Solving linear system of size 40401 x 40401 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 34.644112 s.
j = 1.013410e+06.
Runtime: 34.644332 s.
End of time loop.
j = 1.013410e+06.
End of time loop.
Runtime: 34.644953 s.
j = 1.013410e+06.
Runtime: 34.644047 s.
j = 1.013410e+06.
Optimization terminated successfully.    (Exit mode 0)
            Current function value: -390815.731986
            Iterations: 53
            Function evaluations: 197
            Gradient evaluations: 52
