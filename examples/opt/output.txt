Turbine added at (170.00, 90.00).
Turbine added at (170.00, 136.67).
Turbine added at (170.00, 183.33).
Turbine added at (170.00, 230.00).
Turbine added at (212.86, 90.00).
Turbine added at (212.86, 136.67).
Turbine added at (212.86, 183.33).
Turbine added at (212.86, 230.00).
Turbine added at (255.71, 90.00).
Turbine added at (255.71, 136.67).
Turbine added at (255.71, 183.33).
Turbine added at (255.71, 230.00).
Turbine added at (298.57, 90.00).
Turbine added at (298.57, 136.67).
Turbine added at (298.57, 183.33).
Turbine added at (298.57, 230.00).
Turbine added at (341.43, 90.00).
Turbine added at (341.43, 136.67).
Turbine added at (341.43, 183.33).
Turbine added at (341.43, 230.00).
Turbine added at (384.29, 90.00).
Turbine added at (384.29, 136.67).
Turbine added at (384.29, 183.33).
Turbine added at (384.29, 230.00).
Turbine added at (427.14, 90.00).
Turbine added at (427.14, 136.67).
Turbine added at (427.14, 183.33).
Turbine added at (427.14, 230.00).
Turbine added at (470.00, 90.00).
Turbine added at (470.00, 136.67).
Turbine added at (470.00, 183.33).
Turbine added at (470.00, 230.00).
Added 32 turbines to the site in an 8x4 rectangular array.
Turbine added at (170.00, 90.00).
Turbine added at (170.00, 136.67).
Turbine added at (170.00, 183.33).
Turbine added at (170.00, 230.00).
Turbine added at (212.86, 90.00).
Turbine added at (212.86, 136.67).
Turbine added at (212.86, 183.33).
Turbine added at (212.86, 230.00).
Turbine added at (255.71, 90.00).
Turbine added at (255.71, 136.67).
Turbine added at (255.71, 183.33).
Turbine added at (255.71, 230.00).
Turbine added at (298.57, 90.00).
Turbine added at (298.57, 136.67).
Turbine added at (298.57, 183.33).
Turbine added at (298.57, 230.00).
Turbine added at (341.43, 90.00).
Turbine added at (341.43, 136.67).
Turbine added at (341.43, 183.33).
Turbine added at (341.43, 230.00).
Turbine added at (384.29, 90.00).
Turbine added at (384.29, 136.67).
Turbine added at (384.29, 183.33).
Turbine added at (384.29, 230.00).
Turbine added at (427.14, 90.00).
Turbine added at (427.14, 136.67).
Turbine added at (427.14, 183.33).
Turbine added at (427.14, 230.00).
Turbine added at (470.00, 90.00).
Turbine added at (470.00, 136.67).
Turbine added at (470.00, 183.33).
Turbine added at (470.00, 230.00).
Added 32 turbines to the site in an 8x4 rectangular array.
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0
automatic_scaling: 5.0
checkpoints_basefilename: checkpoints
load_checkpoints: false
save_checkpoints: false
scale: 1.0


  NIT    FC           OBJFUN            GNORM
Start evaluation of j
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Start evaluation of j
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Set the initial guess for the nonlinear solver to the initial condition.
Set the initial guess for the nonlinear solver to the initial condition.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.149e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.948e+01 (tol = 1.000e-10) r (rel) = 6.918e+00 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.785e+01 (tol = 1.000e-10) r (rel) = 1.553e+00 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.073e+00 (tol = 1.000e-10) r (rel) = 2.675e-01 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.909e-01 (tol = 1.000e-10) r (rel) = 6.884e-02 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.779e-01 (tol = 1.000e-10) r (rel) = 5.030e-02 (tol = 1.000e-09)
  Newton iteration 6: r (abs) = 3.530e-01 (tol = 1.000e-10) r (rel) = 3.072e-02 (tol = 1.000e-09)
  Newton iteration 7: r (abs) = 2.480e-01 (tol = 1.000e-10) r (rel) = 2.158e-02 (tol = 1.000e-09)
  Newton iteration 8: r (abs) = 7.464e-02 (tol = 1.000e-10) r (rel) = 6.497e-03 (tol = 1.000e-09)
  Newton iteration 9: r (abs) = 1.560e-04 (tol = 1.000e-10) r (rel) = 1.358e-05 (tol = 1.000e-09)
  Newton iteration 10: r (abs) = 3.950e-10 (tol = 1.000e-10) r (rel) = 3.438e-11 (tol = 1.000e-09)
  Newton solver finished in 10 iterations and 10 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 56.864497 s.
j = 6.586424e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 56.884772 s.
j = 6.586424e+05.
Computing derivative to determine the automatic scaling factor
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 4.72219705582 s
Runtime: 4.72145700455 s
|dj| = 7757.16696285
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 2.234662e-02.
|dj| = 7757.16696285
found a tidal farm, computing _set_automatic_scaling_factor
Set automatic scaling factor to 2.234662e-02.
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Start evaluation of dj
Use checkpoint value.
found a tidal farm, computing _dj
Runtime: 0.0156350135803 s
|dj| = 7757.16696285
Runtime: 0.0163691043854 s
|dj| = 7757.16696285
Start evaluation of j
Updating the turbine cache
    1     1    -1.471843E+04     1.733465E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.951e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.927e+01 (tol = 1.000e-10) r (rel) = 2.772e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.347e+00 (tol = 1.000e-10) r (rel) = 4.815e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.193e-01 (tol = 1.000e-10) r (rel) = 3.156e-03 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.500e-02 (tol = 1.000e-10) r (rel) = 2.157e-04 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.475e-06 (tol = 1.000e-10) r (rel) = 3.560e-08 (tol = 1.000e-09)
  Newton iteration 6: r (abs) = 3.285e-13 (tol = 1.000e-10) r (rel) = 4.727e-15 (tol = 1.000e-09)
  Newton solver finished in 6 iterations and 6 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 29.546598 s.
j = 9.217066e+05.
Runtime: 29.542160 s.
j = 9.217066e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 4.6883661747 s
|dj| = 14452.1030211
Runtime: 4.68778991699 s
|dj| = 14452.1030211
Start evaluation of j
Updating the turbine cache
    2     2    -2.059703E+04     3.229557E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.817e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.927e+00 (tol = 1.000e-10) r (rel) = 2.104e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.023e-01 (tol = 1.000e-10) r (rel) = 1.428e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.369e-03 (tol = 1.000e-10) r (rel) = 1.196e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.082e-07 (tol = 1.000e-10) r (rel) = 1.094e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.103e-13 (tol = 1.000e-10) r (rel) = 1.101e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 23.633841 s.
j = 9.250585e+05.
End of time loop.
Runtime: 23.633727 s.
j = 9.250585e+05.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.100e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.735e+00 (tol = 1.000e-10) r (rel) = 1.578e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.248e-02 (tol = 1.000e-10) r (rel) = 3.862e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.334e-05 (tol = 1.000e-10) r (rel) = 3.940e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.186e-11 (tol = 1.000e-10) r (rel) = 5.624e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 23.146308 s.
Runtime: 23.143902 s.
j = 9.548412e+05.
j = 9.548412e+05.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 4.9422659874 s
|dj| = 12905.109587
Runtime: 4.94301581383 s
|dj| = 12905.109587
Start evaluation of j
    3     4    -2.133747E+04     2.883856E+02
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.424e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.574e+00 (tol = 1.000e-10) r (rel) = 3.537e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.461e-01 (tol = 1.000e-10) r (rel) = 3.078e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.190e-03 (tol = 1.000e-10) r (rel) = 3.791e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.109e-06 (tol = 1.000e-10) r (rel) = 1.695e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.159e-12 (tol = 1.000e-10) r (rel) = 2.128e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 23.781173 s.
j = 1.043200e+06.
Runtime: 23.781636 s.
j = 1.043200e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.81851410866 s
|dj| = 14062.8095949
Runtime: 5.82036805153 s
|dj| = 14062.8095949
    4     5    -2.331199E+04     3.142563E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.697e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.064e+01 (tol = 1.000e-10) r (rel) = 3.946e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.100e-01 (tol = 1.000e-10) r (rel) = 3.374e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.367e-02 (tol = 1.000e-10) r (rel) = 5.068e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.962e-06 (tol = 1.000e-10) r (rel) = 1.840e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.913e-12 (tol = 1.000e-10) r (rel) = 7.092e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 30.699825 s.
j = 1.054547e+06.
Runtime: 30.697962 s.
j = 1.054547e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.840e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.882e+00 (tol = 1.000e-10) r (rel) = 1.566e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.363e-01 (tol = 1.000e-10) r (rel) = 7.407e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.740e-04 (tol = 1.000e-10) r (rel) = 2.576e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.632e-09 (tol = 1.000e-10) r (rel) = 3.604e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 25.101054 s.
j = 1.082259e+06.
End of time loop.
Runtime: 25.100678 s.
j = 1.082259e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.83229207993 s
|dj| = 14421.8057065
    5     7    -2.418484E+04     3.222786E+02
Runtime: 5.84115099907 s
Start evaluation of j
Updating the turbine cache
|dj| = 14421.8057065
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.191e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.132e+00 (tol = 1.000e-10) r (rel) = 2.549e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.379e-01 (tol = 1.000e-10) r (rel) = 2.313e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.580e-02 (tol = 1.000e-10) r (rel) = 4.951e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.270e-05 (tol = 1.000e-10) r (rel) = 3.979e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.158e-11 (tol = 1.000e-10) r (rel) = 3.629e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 26.506826 s.
j = 1.091737e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 26.531566 s.
j = 1.091737e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.620e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.100e+00 (tol = 1.000e-10) r (rel) = 1.913e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.373e-01 (tol = 1.000e-10) r (rel) = 8.470e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.811e-04 (tol = 1.000e-10) r (rel) = 2.969e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.229e-09 (tol = 1.000e-10) r (rel) = 4.461e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 23.918944 s.
j = 1.072047e+06.
End of time loop.
Runtime: 23.922082 s.
j = 1.072047e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.070e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.511e+00 (tol = 1.000e-10) r (rel) = 1.413e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.667e-02 (tol = 1.000e-10) r (rel) = 3.428e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.409e-05 (tol = 1.000e-10) r (rel) = 3.186e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.693e-11 (tol = 1.000e-10) r (rel) = 3.452e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 22.951312 s.
j = 1.099688e+06.
Start evaluation of dj
End of time loop.
found a tidal farm, computing gradient
Runtime: 22.954189 s.
j = 1.099688e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.80566096306 s
Runtime: 5.80342698097 s
|dj| = 14102.1159814
|dj| = 14102.1159814
Start evaluation of j
Updating the turbine cache
    6    10    -2.457431E+04     3.151347E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.093e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.503e+01 (tol = 1.000e-10) r (rel) = 3.673e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.905e+00 (tol = 1.000e-10) r (rel) = 4.655e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.480e-02 (tol = 1.000e-10) r (rel) = 1.828e-03 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.961e-04 (tol = 1.000e-10) r (rel) = 4.791e-06 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.641e-09 (tol = 1.000e-10) r (rel) = 6.454e-11 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 29.266790 s.
j = 1.114153e+06.
Runtime: 29.260497 s.
j = 1.114153e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.930e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.551e+00 (tol = 1.000e-10) r (rel) = 2.577e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.142e-01 (tol = 1.000e-10) r (rel) = 2.096e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.566e-03 (tol = 1.000e-10) r (rel) = 2.924e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.019e-06 (tol = 1.000e-10) r (rel) = 1.030e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.369e-12 (tol = 1.000e-10) r (rel) = 4.671e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 29.580325 s.
j = 1.120368e+06.
Runtime: 29.587857 s.
j = 1.120368e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.38071393967 s
|dj| = 14621.0507563
    7    12    -2.503644E+04     3.267311E+02
Start evaluation of j
Updating the turbine cache
Runtime: 6.4107439518 s
|dj| = 14621.0507563
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.726e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.626e+01 (tol = 1.000e-10) r (rel) = 3.440e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.949e+00 (tol = 1.000e-10) r (rel) = 4.124e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.840e-02 (tol = 1.000e-10) r (rel) = 1.659e-03 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.643e-04 (tol = 1.000e-10) r (rel) = 3.477e-06 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 8.510e-10 (tol = 1.000e-10) r (rel) = 1.801e-11 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 28.118430 s.
j = 1.099436e+06.
Runtime: 28.158872 s.
j = 1.099436e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.182e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.305e+00 (tol = 1.000e-10) r (rel) = 2.924e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.360e-01 (tol = 1.000e-10) r (rel) = 2.627e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.388e-02 (tol = 1.000e-10) r (rel) = 4.362e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.797e-06 (tol = 1.000e-10) r (rel) = 1.508e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.636e-12 (tol = 1.000e-10) r (rel) = 1.143e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 32.007352 s.
j = 1.085991e+06.
Runtime: 32.001373 s.
j = 1.085991e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.045e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.079e+00 (tol = 1.000e-10) r (rel) = 1.995e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.320e-01 (tol = 1.000e-10) r (rel) = 1.134e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.571e-03 (tol = 1.000e-10) r (rel) = 7.684e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.457e-07 (tol = 1.000e-10) r (rel) = 7.126e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.088e-13 (tol = 1.000e-10) r (rel) = 1.510e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 28.264229 s.
j = 1.139576e+06.
Runtime: 28.274376 s.
j = 1.139576e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.43783998489 s
|dj| = 14104.0072023
Runtime: 5.43493890762 s
|dj| = 14104.0072023
Start evaluation of j
Updating the turbine cache
    8    15    -2.546566E+04     3.151769E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.154e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.570e+01 (tol = 1.000e-10) r (rel) = 3.778e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.161e+00 (tol = 1.000e-10) r (rel) = 5.203e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.088e-01 (tol = 1.000e-10) r (rel) = 2.620e-03 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.341e-04 (tol = 1.000e-10) r (rel) = 1.045e-05 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 9.668e-09 (tol = 1.000e-10) r (rel) = 2.327e-10 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 34.521608 s.
j = 1.143739e+06.
Runtime: 34.534014 s.
j = 1.143739e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.734e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.550e+00 (tol = 1.000e-10) r (rel) = 2.030e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.255e-01 (tol = 1.000e-10) r (rel) = 1.191e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.862e-03 (tol = 1.000e-10) r (rel) = 1.047e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.744e-07 (tol = 1.000e-10) r (rel) = 1.735e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.310e-13 (tol = 1.000e-10) r (rel) = 1.211e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 27.826188 s.
j = 1.176309e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 27.833075 s.
j = 1.176309e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.56116104126 s
|dj| = 14761.8204033
Runtime: 5.56515717506 s
|dj| = 14761.8204033
Start evaluation of j
Updating the turbine cache
    9    17    -2.628654E+04     3.298768E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.272e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.523e+01 (tol = 1.000e-10) r (rel) = 3.564e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.816e+00 (tol = 1.000e-10) r (rel) = 4.252e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 7.653e-02 (tol = 1.000e-10) r (rel) = 1.791e-03 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.823e-04 (tol = 1.000e-10) r (rel) = 6.607e-06 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.591e-09 (tol = 1.000e-10) r (rel) = 1.309e-10 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 27.515505 s.
j = 1.125682e+06.
Runtime: 27.512734 s.
j = 1.125682e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.976e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.198e+00 (tol = 1.000e-10) r (rel) = 2.418e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.042e-01 (tol = 1.000e-10) r (rel) = 1.694e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.533e-03 (tol = 1.000e-10) r (rel) = 1.523e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.497e-07 (tol = 1.000e-10) r (rel) = 2.183e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.594e-13 (tol = 1.000e-10) r (rel) = 1.208e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 26.816611 s.
j = 1.213476e+06.
End of time loop.
Runtime: 26.819253 s.
j = 1.213476e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.20297408104 s
Runtime: 5.19994616508 s
|dj| = 13615.4352915
|dj| = 13615.4352915
   10    19    -2.711708E+04     3.042590E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.862e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.974e+00 (tol = 1.000e-10) r (rel) = 2.437e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.314e-01 (tol = 1.000e-10) r (rel) = 1.857e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.080e-02 (tol = 1.000e-10) r (rel) = 1.775e-03 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.526e-05 (tol = 1.000e-10) r (rel) = 2.979e-06 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.759e-10 (tol = 1.000e-10) r (rel) = 6.145e-12 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 32.590089 s.
j = 1.222861e+06.
End of time loop.
Runtime: 32.592281 s.
j = 1.222861e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.484e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.152e+00 (tol = 1.000e-10) r (rel) = 1.451e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.254e-02 (tol = 1.000e-10) r (rel) = 4.216e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.586e-04 (tol = 1.000e-10) r (rel) = 1.069e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.483e-09 (tol = 1.000e-10) r (rel) = 1.674e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 27.886822 s.
j = 1.235347e+06.
Runtime: 27.892284 s.
j = 1.235347e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.56382894516 s
Runtime: 7.55505895615 s
|dj| = 13485.5644281
|dj| = 13485.5644281
Start evaluation of j
Updating the turbine cache
   11    21    -2.760584E+04     3.013568E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.712e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.410e+01 (tol = 1.000e-10) r (rel) = 3.797e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.461e+00 (tol = 1.000e-10) r (rel) = 3.936e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.028e-01 (tol = 1.000e-10) r (rel) = 2.770e-03 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.520e-02 (tol = 1.000e-10) r (rel) = 4.096e-04 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.561e-03 (tol = 1.000e-10) r (rel) = 6.899e-05 (tol = 1.000e-09)
  Newton iteration 6: r (abs) = 2.325e-07 (tol = 1.000e-10) r (rel) = 6.264e-09 (tol = 1.000e-09)
  Newton iteration 7: r (abs) = 3.108e-13 (tol = 1.000e-10) r (rel) = 8.373e-15 (tol = 1.000e-09)
  Newton solver finished in 7 iterations and 7 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 46.048388 s.
j = 1.142080e+06.
Start evaluation of j
Runtime: 46.051464 s.
j = 1.142080e+06.
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.404e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.728e+00 (tol = 1.000e-10) r (rel) = 2.564e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.555e-01 (tol = 1.000e-10) r (rel) = 2.219e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.311e-02 (tol = 1.000e-10) r (rel) = 3.850e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.882e-06 (tol = 1.000e-10) r (rel) = 2.022e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.478e-12 (tol = 1.000e-10) r (rel) = 1.022e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 30.419373 s.
j = 1.251651e+06.
End of time loop.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 30.423730 s.
j = 1.251651e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.29228496552 s
|dj| = 14261.2402574
Runtime: 5.2905189991 s
|dj| = 14261.2402574
   12    23    -2.797018E+04     3.186905E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.932e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.610e+00 (tol = 1.000e-10) r (rel) = 2.937e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.555e-01 (tol = 1.000e-10) r (rel) = 2.236e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.750e-02 (tol = 1.000e-10) r (rel) = 1.279e-03 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.345e-02 (tol = 1.000e-10) r (rel) = 4.589e-04 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.295e-03 (tol = 1.000e-10) r (rel) = 4.416e-05 (tol = 1.000e-09)
  Newton iteration 6: r (abs) = 3.171e-07 (tol = 1.000e-10) r (rel) = 1.082e-08 (tol = 1.000e-09)
  Newton iteration 7: r (abs) = 3.043e-13 (tol = 1.000e-10) r (rel) = 1.038e-14 (tol = 1.000e-09)
  Newton solver finished in 7 iterations and 7 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 44.659474 s.
j = 1.247110e+06.
End of time loop.
Runtime: 44.660939 s.
j = 1.247110e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.883e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.783e+00 (tol = 1.000e-10) r (rel) = 1.477e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.069e-01 (tol = 1.000e-10) r (rel) = 5.675e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.304e-03 (tol = 1.000e-10) r (rel) = 6.923e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.316e-07 (tol = 1.000e-10) r (rel) = 6.985e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.063e-13 (tol = 1.000e-10) r (rel) = 1.626e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 36.500181 s.
Runtime: 36.497901 s.
j = 1.273890e+06.
j = 1.273890e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.27399778366 s
|dj| = 13108.1988012
Runtime: 7.2878549099 s
|dj| = 13108.1988012
   13    25    -2.846714E+04     2.929240E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.847e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.324e+00 (tol = 1.000e-10) r (rel) = 2.923e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.599e-01 (tol = 1.000e-10) r (rel) = 1.966e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.033e-02 (tol = 1.000e-10) r (rel) = 3.628e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.923e-04 (tol = 1.000e-10) r (rel) = 6.753e-06 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 2.746e-09 (tol = 1.000e-10) r (rel) = 9.645e-11 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 29.890749 s.
j = 1.249956e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 29.915174 s.
j = 1.249956e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.266e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.436e+00 (tol = 1.000e-10) r (rel) = 1.516e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.321e-01 (tol = 1.000e-10) r (rel) = 5.827e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.286e-04 (tol = 1.000e-10) r (rel) = 2.333e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.495e-08 (tol = 1.000e-10) r (rel) = 6.595e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 28.308435 s.
j = 1.288958e+06.
End of time loop.
Runtime: 28.304875 s.
j = 1.288958e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.41707706451 s
|dj| = 13555.3790122
   14    27    -2.880386E+04     3.029169E+02
Start evaluation of j
Updating the turbine cache
Runtime: 7.44068002701 s
|dj| = 13555.3790122
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.607e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.112e+01 (tol = 1.000e-10) r (rel) = 3.084e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 9.488e-01 (tol = 1.000e-10) r (rel) = 2.630e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.919e-02 (tol = 1.000e-10) r (rel) = 5.321e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.202e-05 (tol = 1.000e-10) r (rel) = 3.331e-07 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 8.595e-12 (tol = 1.000e-10) r (rel) = 2.383e-13 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 35.186022 s.
j = 1.274924e+06.
End of time loop.
Runtime: 35.145176 s.
j = 1.274924e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.696e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.353e+00 (tol = 1.000e-10) r (rel) = 1.615e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.064e-01 (tol = 1.000e-10) r (rel) = 7.658e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.345e-04 (tol = 1.000e-10) r (rel) = 3.096e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.741e-08 (tol = 1.000e-10) r (rel) = 6.459e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 28.063194 s.
j = 1.313375e+06.
Runtime: 28.060968 s.
j = 1.313375e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.58648514748 s
|dj| = 13442.0690637
Runtime: 6.59076285362 s
|dj| = 13442.0690637
   15    29    -2.934950E+04     3.003848E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.993e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.724e+00 (tol = 1.000e-10) r (rel) = 3.249e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.848e-01 (tol = 1.000e-10) r (rel) = 2.288e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.324e-03 (tol = 1.000e-10) r (rel) = 2.781e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.306e-06 (tol = 1.000e-10) r (rel) = 7.705e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 1.301e-12 (tol = 1.000e-10) r (rel) = 4.346e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 36.288142 s.
j = 1.274073e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 36.302593 s.
j = 1.274073e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.552e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.152e+00 (tol = 1.000e-10) r (rel) = 2.019e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.669e-01 (tol = 1.000e-10) r (rel) = 1.046e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.298e-03 (tol = 1.000e-10) r (rel) = 5.085e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.576e-08 (tol = 1.000e-10) r (rel) = 1.401e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.119e-13 (tol = 1.000e-10) r (rel) = 1.222e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 38.741666 s.
j = 1.320550e+06.
End of time loop.
Runtime: 38.734224 s.
j = 1.320550e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.19157004356 s
|dj| = 13436.1521039
Runtime: 7.20428085327 s
|dj| = 13436.1521039
Start evaluation of j
Updating the turbine cache
   16    31    -2.950984E+04     3.002526E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.324e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.807e+00 (tol = 1.000e-10) r (rel) = 2.649e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.769e-01 (tol = 1.000e-10) r (rel) = 1.735e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.695e-03 (tol = 1.000e-10) r (rel) = 1.713e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.028e-06 (tol = 1.000e-10) r (rel) = 3.092e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.983e-13 (tol = 1.000e-10) r (rel) = 1.198e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 31.824561 s.
j = 1.286744e+06.
Runtime: 31.794753 s.
j = 1.286744e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.602e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.809e+00 (tol = 1.000e-10) r (rel) = 1.848e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.381e-01 (tol = 1.000e-10) r (rel) = 9.151e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.516e-04 (tol = 1.000e-10) r (rel) = 3.657e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.118e-08 (tol = 1.000e-10) r (rel) = 8.141e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 27.767116 s.
j = 1.328686e+06.
Runtime: 27.774476 s.
j = 1.328686e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.88546919823 s
|dj| = 12650.4114713
Runtime: 5.88896417618 s
|dj| = 12650.4114713
Start evaluation of j
Updating the turbine cache
   17    33    -2.969164E+04     2.826940E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.804e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.183e+00 (tol = 1.000e-10) r (rel) = 2.562e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.938e-01 (tol = 1.000e-10) r (rel) = 1.761e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.962e-03 (tol = 1.000e-10) r (rel) = 1.770e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.005e-07 (tol = 1.000e-10) r (rel) = 2.855e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 5.427e-13 (tol = 1.000e-10) r (rel) = 1.935e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 38.316702 s.
j = 1.300258e+06.
Runtime: 38.339310 s.
Start evaluation of j
j = 1.300258e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.239e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.540e+00 (tol = 1.000e-10) r (rel) = 1.581e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.458e-01 (tol = 1.000e-10) r (rel) = 6.512e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.014e-04 (tol = 1.000e-10) r (rel) = 1.792e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.477e-09 (tol = 1.000e-10) r (rel) = 1.999e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 28.695886 s.
j = 1.331976e+06.
Runtime: 28.698545 s.
j = 1.331976e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.93794989586 s
|dj| = 12586.3813236
Runtime: 5.94326877594 s
|dj| = 12586.3813236
   18    35    -2.976517E+04     2.812631E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.831e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.271e+00 (tol = 1.000e-10) r (rel) = 2.332e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.297e-01 (tol = 1.000e-10) r (rel) = 1.254e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.011e-03 (tol = 1.000e-10) r (rel) = 1.098e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.518e-07 (tol = 1.000e-10) r (rel) = 8.289e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.071e-13 (tol = 1.000e-10) r (rel) = 1.677e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 29.541813 s.
j = 1.312402e+06.
Start evaluation of j
End of time loop.
Runtime: 29.579518 s.
j = 1.312402e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.625e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.098e+00 (tol = 1.000e-10) r (rel) = 1.291e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.216e-02 (tol = 1.000e-10) r (rel) = 4.441e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.189e-04 (tol = 1.000e-10) r (rel) = 5.656e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.507e-08 (tol = 1.000e-10) r (rel) = 4.005e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.080e-13 (tol = 1.000e-10) r (rel) = 1.896e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 35.344176 s.
j = 1.335672e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 35.336798 s.
j = 1.335672e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.47482299805 s
|dj| = 12578.7504106
Runtime: 6.47255992889 s
|dj| = 12578.7504106
   19    37    -2.984775E+04     2.810926E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.107e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.182e+00 (tol = 1.000e-10) r (rel) = 2.934e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.654e-01 (tol = 1.000e-10) r (rel) = 1.734e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.252e-03 (tol = 1.000e-10) r (rel) = 1.544e-04 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.356e-07 (tol = 1.000e-10) r (rel) = 1.118e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.313e-13 (tol = 1.000e-10) r (rel) = 1.572e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 32.219374 s.
j = 1.283868e+06.
End of time loop.
Runtime: 32.231814 s.
j = 1.283868e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.376e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.476e+00 (tol = 1.000e-10) r (rel) = 1.463e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.585e-01 (tol = 1.000e-10) r (rel) = 6.671e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.864e-03 (tol = 1.000e-10) r (rel) = 7.843e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.507e-07 (tol = 1.000e-10) r (rel) = 1.055e-08 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.129e-13 (tol = 1.000e-10) r (rel) = 1.317e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 28.159292 s.
j = 1.338185e+06.
Runtime: 28.163738 s.
j = 1.338185e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.98584103584 s
|dj| = 12803.8742857
Runtime: 6.98518204689 s
|dj| = 12803.8742857
Start evaluation of j
Updating the turbine cache
   20    39    -2.990391E+04     2.861233E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.795e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.847e+00 (tol = 1.000e-10) r (rel) = 2.144e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.918e-01 (tol = 1.000e-10) r (rel) = 1.069e-02 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.007e-03 (tol = 1.000e-10) r (rel) = 5.609e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.649e-08 (tol = 1.000e-10) r (rel) = 2.033e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.182e-13 (tol = 1.000e-10) r (rel) = 1.773e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 30.355737 s.
j = 1.323465e+06.
Start evaluation of j
Updating the turbine cache
End of time loop.
Runtime: 30.338573 s.
j = 1.323465e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.504e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.804e+00 (tol = 1.000e-10) r (rel) = 1.199e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.085e-02 (tol = 1.000e-10) r (rel) = 4.046e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.702e-04 (tol = 1.000e-10) r (rel) = 1.797e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.585e-09 (tol = 1.000e-10) r (rel) = 2.384e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 31.616000 s.
j = 1.343852e+06.
End of time loop.
Runtime: 31.627877 s.
j = 1.343852e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.97211790085 s
|dj| = 12870.4853461
Runtime: 5.98056101799 s
|dj| = 12870.4853461
Start evaluation of j
Updating the turbine cache
   21    41    -3.003054E+04     2.876119E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.035e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.545e+00 (tol = 1.000e-10) r (rel) = 2.234e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.973e-01 (tol = 1.000e-10) r (rel) = 9.697e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.250e-03 (tol = 1.000e-10) r (rel) = 6.142e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.094e-08 (tol = 1.000e-10) r (rel) = 1.029e-09 (tol = 1.000e-09)
  Newton iteration 5: r (abs) = 3.135e-13 (tol = 1.000e-10) r (rel) = 1.541e-14 (tol = 1.000e-09)
  Newton solver finished in 5 iterations and 5 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 31.906735 s.
j = 1.311912e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 31.920746 s.
j = 1.311912e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.112e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.477e+00 (tol = 1.000e-10) r (rel) = 1.173e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.353e-02 (tol = 1.000e-10) r (rel) = 3.481e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.814e-04 (tol = 1.000e-10) r (rel) = 1.806e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.994e-09 (tol = 1.000e-10) r (rel) = 4.258e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 28.531772 s.
j = 1.346829e+06.
Runtime: 28.546669 s.
j = 1.346829e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.80615901947 s
|dj| = 12834.068969
Runtime: 5.824862957 s
|dj| = 12834.068969
   22    43    -3.009707E+04     2.867981E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.711e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.419e+00 (tol = 1.000e-10) r (rel) = 1.998e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.240e-01 (tol = 1.000e-10) r (rel) = 7.248e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.560e-04 (tol = 1.000e-10) r (rel) = 2.081e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.568e-09 (tol = 1.000e-10) r (rel) = 2.670e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 23.509529 s.
j = 1.346065e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 23.501007 s.
j = 1.346065e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.272e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.176e-01 (tol = 1.000e-10) r (rel) = 7.213e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.164e-02 (tol = 1.000e-10) r (rel) = 9.153e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.002e-06 (tol = 1.000e-10) r (rel) = 3.145e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.458e-12 (tol = 1.000e-10) r (rel) = 1.146e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 30.935631 s.
j = 1.353714e+06.
End of time loop.
Runtime: 30.949212 s.
j = 1.353714e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.5371530056 s
|dj| = 12514.0456616
Runtime: 7.55732512474 s
|dj| = 12514.0456616
Start evaluation of j
Updating the turbine cache
   23    45    -3.025092E+04     2.796466E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.638e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.776e+00 (tol = 1.000e-10) r (rel) = 1.695e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.282e-02 (tol = 1.000e-10) r (rel) = 5.057e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.599e-04 (tol = 1.000e-10) r (rel) = 9.766e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.335e-09 (tol = 1.000e-10) r (rel) = 8.153e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 24.695895 s.
Runtime: 24.731087 s.
j = 1.346318e+06.
j = 1.346318e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.399e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.114e+00 (tol = 1.000e-10) r (rel) = 7.959e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.619e-02 (tol = 1.000e-10) r (rel) = 1.157e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.032e-06 (tol = 1.000e-10) r (rel) = 4.310e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.312e-12 (tol = 1.000e-10) r (rel) = 2.366e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 27.583420 s.
j = 1.355939e+06.
Runtime: 27.584383 s.
j = 1.355939e+06.
Start evaluation of dj
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.3991060257 s
|dj| = 12637.4677843
Runtime: 7.40987110138 s
|dj| = 12637.4677843
   24    47    -3.030065E+04     2.824047E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.653e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.618e+00 (tol = 1.000e-10) r (rel) = 1.584e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.901e-02 (tol = 1.000e-10) r (rel) = 4.175e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.287e-05 (tol = 1.000e-10) r (rel) = 5.619e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 2.751e-10 (tol = 1.000e-10) r (rel) = 1.664e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 28.219325 s.
j = 1.353710e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 28.224625 s.
j = 1.353710e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.137e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.100e-01 (tol = 1.000e-10) r (rel) = 7.126e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.319e-03 (tol = 1.000e-10) r (rel) = 7.318e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.651e-06 (tol = 1.000e-10) r (rel) = 1.452e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.734e-13 (tol = 1.000e-10) r (rel) = 5.045e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 21.798950 s.
j = 1.361559e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 21.795835 s.
j = 1.361559e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.00332689285 s
|dj| = 12474.9082558
   25    49    -3.042625E+04     2.787721E+02
Start evaluation of j
Updating the turbine cache
Runtime: 6.03777313232 s
|dj| = 12474.9082558
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.032e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.565e+00 (tol = 1.000e-10) r (rel) = 2.247e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.724e-01 (tol = 1.000e-10) r (rel) = 8.485e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.294e-04 (tol = 1.000e-10) r (rel) = 2.606e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 8.792e-09 (tol = 1.000e-10) r (rel) = 4.327e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 27.115688 s.
j = 1.352827e+06.
End of time loop.
Runtime: 27.041599 s.
j = 1.352827e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.944e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.802e+00 (tol = 1.000e-10) r (rel) = 9.270e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.252e-02 (tol = 1.000e-10) r (rel) = 1.673e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.326e-05 (tol = 1.000e-10) r (rel) = 1.196e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.780e-11 (tol = 1.000e-10) r (rel) = 9.153e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 27.666022 s.
j = 1.363254e+06.
Runtime: 27.665610 s.
j = 1.363254e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.96039199829 s
|dj| = 12672.0821194
Runtime: 7.96771907806 s
|dj| = 12672.0821194
   26    51    -3.046413E+04     2.831782E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.552e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.418e+00 (tol = 1.000e-10) r (rel) = 1.558e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.244e-02 (tol = 1.000e-10) r (rel) = 3.378e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.733e-05 (tol = 1.000e-10) r (rel) = 4.337e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.757e-10 (tol = 1.000e-10) r (rel) = 1.132e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 24.306598 s.
j = 1.367827e+06.
Start evaluation of dj
End of time loop.
Runtime: 24.315860 s.
j = 1.367827e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.51724100113 s
|dj| = 12843.2190911
Runtime: 5.53000092506 s
|dj| = 12843.2190911
   27    52    -3.056632E+04     2.870026E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.643e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.783e+00 (tol = 1.000e-10) r (rel) = 1.694e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.258e-01 (tol = 1.000e-10) r (rel) = 7.656e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.052e-04 (tol = 1.000e-10) r (rel) = 3.075e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.211e-08 (tol = 1.000e-10) r (rel) = 7.372e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 25.719707 s.
j = 1.361649e+06.
End of time loop.
Runtime: 25.698244 s.
j = 1.361649e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.240e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.208e+00 (tol = 1.000e-10) r (rel) = 9.746e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.696e-02 (tol = 1.000e-10) r (rel) = 2.175e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.054e-05 (tol = 1.000e-10) r (rel) = 1.657e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.633e-11 (tol = 1.000e-10) r (rel) = 1.317e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 26.318967 s.
j = 1.372008e+06.
Runtime: 26.331922 s.
j = 1.372008e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.31014990807 s
|dj| = 12695.4894226
Runtime: 6.3268020153 s
|dj| = 12695.4894226
Start evaluation of j
Updating the turbine cache
   28    54    -3.065975E+04     2.837013E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.492e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.108e+00 (tol = 1.000e-10) r (rel) = 1.413e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.243e-02 (tol = 1.000e-10) r (rel) = 2.844e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.127e-05 (tol = 1.000e-10) r (rel) = 2.766e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 5.593e-11 (tol = 1.000e-10) r (rel) = 3.749e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 25.047220 s.
j = 1.377624e+06.
Runtime: 25.053121 s.
j = 1.377624e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.36428713799 s
|dj| = 13016.2064543
Runtime: 7.3615128994 s
|dj| = 13016.2064543
Start evaluation of j
Updating the turbine cache
   29    55    -3.078525E+04     2.908682E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.752e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.375e+00 (tol = 1.000e-10) r (rel) = 1.926e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.197e-01 (tol = 1.000e-10) r (rel) = 6.832e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.085e-04 (tol = 1.000e-10) r (rel) = 2.331e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.040e-09 (tol = 1.000e-10) r (rel) = 3.447e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 25.726771 s.
j = 1.372722e+06.
Runtime: 25.732229 s.
j = 1.372722e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.483e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.242e+00 (tol = 1.000e-10) r (rel) = 8.372e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.928e-02 (tol = 1.000e-10) r (rel) = 1.300e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.137e-05 (tol = 1.000e-10) r (rel) = 7.668e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.413e-12 (tol = 1.000e-10) r (rel) = 4.997e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 24.090731 s.
j = 1.377930e+06.
Runtime: 24.090282 s.
j = 1.377930e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.426e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.261e-01 (tol = 1.000e-10) r (rel) = 2.849e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.116e-04 (tol = 1.000e-10) r (rel) = 4.781e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.453e-09 (tol = 1.000e-10) r (rel) = 3.283e-10 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 18.878120 s.
j = 1.379152e+06.
Start evaluation of dj
End of time loop.
Runtime: 18.886958 s.
j = 1.379152e+06.
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 8.35922217369 s
|dj| = 12884.3486804
Runtime: 8.37904810905 s
|dj| = 12884.3486804
Start evaluation of j
Updating the turbine cache
   30    58    -3.081938E+04     2.879217E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.399e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.073e+00 (tol = 1.000e-10) r (rel) = 2.196e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.388e-01 (tol = 1.000e-10) r (rel) = 9.924e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.233e-04 (tol = 1.000e-10) r (rel) = 3.741e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 9.244e-09 (tol = 1.000e-10) r (rel) = 6.607e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 27.836424 s.
j = 1.374797e+06.
End of time loop.
Runtime: 27.819885 s.
j = 1.374797e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.383e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.305e+00 (tol = 1.000e-10) r (rel) = 9.435e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.666e-02 (tol = 1.000e-10) r (rel) = 2.650e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.611e-05 (tol = 1.000e-10) r (rel) = 3.333e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.792e-11 (tol = 1.000e-10) r (rel) = 5.632e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 24.404443 s.
j = 1.379675e+06.
End of time loop.
Start evaluation of dj
found a tidal farm, computing gradient
Runtime: 24.405963 s.
j = 1.379675e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 8.07216191292 s
|dj| = 12856.7984912
Runtime: 8.08026814461 s
|dj| = 12856.7984912
Start evaluation of j
   31    60    -3.083107E+04     2.873060E+02
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.425e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.180e+00 (tol = 1.000e-10) r (rel) = 2.231e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.368e-01 (tol = 1.000e-10) r (rel) = 9.599e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.965e-04 (tol = 1.000e-10) r (rel) = 3.483e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 7.625e-09 (tol = 1.000e-10) r (rel) = 5.350e-10 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 29.285245 s.
j = 1.370144e+06.
Start evaluation of j
Runtime: 29.286472 s.
j = 1.370144e+06.
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.475e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.494e+00 (tol = 1.000e-10) r (rel) = 1.013e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.400e-02 (tol = 1.000e-10) r (rel) = 2.983e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.247e-05 (tol = 1.000e-10) r (rel) = 4.236e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.505e-10 (tol = 1.000e-10) r (rel) = 1.020e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 26.226842 s.
j = 1.381333e+06.
Runtime: 26.219107 s.
j = 1.381333e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.09394693375 s
|dj| = 12793.375414
Runtime: 6.10331201553 s
|dj| = 12793.375414
   32    62    -3.086812E+04     2.858887E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.257e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.590e+00 (tol = 1.000e-10) r (rel) = 1.264e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.823e-02 (tol = 1.000e-10) r (rel) = 3.041e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.667e-05 (tol = 1.000e-10) r (rel) = 2.917e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 4.719e-11 (tol = 1.000e-10) r (rel) = 3.753e-12 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 23.501847 s.
Runtime: 23.508467 s.
j = 1.374617e+06.
j = 1.374617e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.957e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.676e-01 (tol = 1.000e-10) r (rel) = 8.570e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.018e-02 (tol = 1.000e-10) r (rel) = 1.136e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.978e-06 (tol = 1.000e-10) r (rel) = 3.325e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.663e-12 (tol = 1.000e-10) r (rel) = 1.857e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 19.811196 s.
j = 1.381451e+06.
Runtime: 19.811432 s.
j = 1.381451e+06.
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.084e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.274e-02 (tol = 1.000e-10) r (rel) = 2.050e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.274e-05 (tol = 1.000e-10) r (rel) = 1.571e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.545e-11 (tol = 1.000e-10) r (rel) = 1.701e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 13.265175 s.
j = 1.382241e+06.
Runtime: 13.265662 s.
j = 1.382241e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 4.35882711411 s
|dj| = 12710.2873363
Runtime: 4.35711312294 s
|dj| = 12710.2873363
   33    65    -3.088841E+04     2.840320E+02
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
Solve a steady-state shallow water problem
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.034e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.688e-01 (tol = 1.000e-10) r (rel) = 9.368e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.152e-02 (tol = 1.000e-10) r (rel) = 1.114e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 2.562e-06 (tol = 1.000e-10) r (rel) = 2.477e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.650e-12 (tol = 1.000e-10) r (rel) = 1.596e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 24.148230 s.
j = 1.384434e+06.
Runtime: 24.148745 s.
j = 1.384434e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.19775700569 s
|dj| = 12633.7452867
Runtime: 6.20076608658 s
|dj| = 12633.7452867
   34    66    -3.093742E+04     2.823215E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.155e+01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.203e+00 (tol = 1.000e-10) r (rel) = 1.041e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.537e-02 (tol = 1.000e-10) r (rel) = 1.330e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.344e-06 (tol = 1.000e-10) r (rel) = 4.626e-07 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.251e-12 (tol = 1.000e-10) r (rel) = 2.814e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 25.037257 s.
j = 1.384375e+06.
End of time loop.
Runtime: 25.054829 s.
j = 1.384375e+06.
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.930e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.940e-01 (tol = 1.000e-10) r (rel) = 4.242e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.074e-03 (tol = 1.000e-10) r (rel) = 1.549e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.249e-08 (tol = 1.000e-10) r (rel) = 4.688e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.144e-13 (tol = 1.000e-10) r (rel) = 4.537e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 25.160482 s.
End of time loop.
j = 1.386363e+06.
Runtime: 25.164074 s.
j = 1.386363e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.63014507294 s
|dj| = 12618.3329291
Runtime: 6.64019799232 s
|dj| = 12618.3329291
   35    68    -3.098054E+04     2.819771E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.891e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.317e-01 (tol = 1.000e-10) r (rel) = 4.814e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.500e-03 (tol = 1.000e-10) r (rel) = 2.177e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.211e-08 (tol = 1.000e-10) r (rel) = 7.562e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.266e-13 (tol = 1.000e-10) r (rel) = 4.740e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 24.827022 s.
j = 1.388075e+06.
Runtime: 24.817401 s.
j = 1.388075e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.39946603775 s
|dj| = 12520.8498762
Runtime: 6.40365600586 s
|dj| = 12520.8498762
   36    69    -3.101879E+04     2.797987E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.011e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.344e-01 (tol = 1.000e-10) r (rel) = 3.900e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.455e-04 (tol = 1.000e-10) r (rel) = 1.074e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 8.978e-09 (tol = 1.000e-10) r (rel) = 1.494e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.146e-13 (tol = 1.000e-10) r (rel) = 5.234e-14 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 22.985955 s.
j = 1.387367e+06.
Runtime: 22.998778 s.
j = 1.387367e+06.
Minimum distance inequality constraints (should all be > 0): [  2.16503352e+03   1.64696277e+04   7.85061371e+03   1.87000000e+04
   1.51236987e+04   3.43426732e+03   3.77767062e+03   1.74532638e-02
   1.27322932e+04   2.33776706e+04   1.29231313e+04   3.06942160e+03
   7.95997454e+03   2.21967347e+04   2.33020288e+03   2.18836763e+04
   9.05650021e+03   1.58335780e+03   1.24440985e+04   1.15600248e+04
   3.57049713e+03   2.51395333e+04   1.35346465e+04   3.99893303e-01
   5.53953326e+03   1.88404984e+04   1.07191378e+04   1.28244657e+03
   1.07442595e+04   3.01317126e+03   1.48370232e+04   3.03442595e+04
   6.61440894e+02   4.74040630e+02   9.85944010e+03   1.94651789e+04
   2.06659265e+04   7.51503128e+03   8.84194229e+03   2.54440346e+04
   6.60638592e+03   4.87677369e-02   2.42427978e+03   9.89903061e+03
   2.74735158e+03   2.45367376e+04   1.00888796e+04   5.28776150e+03
   1.99746172e+04   1.08675001e+04   2.04746422e+03   1.65013882e+00
   4.88755935e+03   7.23396757e+03   2.20895106e+02   3.27566263e+04
   1.73184761e+04   2.90341888e+03   1.31566263e+04   2.12167425e+04
   9.78166273e+03   4.95820071e+02   5.67958100e+02   1.88134667e+04
   7.01956432e+03   2.22674033e+03   1.81187759e+04   7.38622322e+03
   1.85203961e+04   3.77187759e+04   3.93234632e+03   1.15028743e+03
   1.06538021e+04   2.20248919e+04   4.83593682e-04   1.90300949e+03
   6.56082739e+03   1.90743426e+04   2.99647908e+04   1.35818989e+04
   1.08791234e+04   2.94767582e+04   1.27062721e+04   2.69001217e+03
   2.69238527e+03   1.01783646e+04   6.99899408e+03   6.59002896e-01
   2.45575094e-01   5.50683527e+03   4.75145765e+03   3.49317808e+04
   1.72761222e+04   8.30727124e+03   2.48734491e+04   1.81499384e+04
   5.91398514e+03   1.33399661e+03   6.13434403e+03   1.27180652e+04
   2.30373239e+03   3.10608569e+00   1.72984809e+03   1.06796172e+04
   2.80391645e+02   4.33413554e+04   2.40598302e+04   8.76163893e+03
   2.37413554e+04   2.65467980e+04   1.17892580e+04   2.65466182e+03
   4.98733175e+03   2.11075786e+04   7.08004565e+03   2.50644569e+03
   5.75712882e+02   1.90635533e+04   3.77052631e+03   2.61276928e+02
   2.72932906e+04   1.35592742e+04   2.40037682e+04   4.68932906e+04
   9.00325110e+03   3.62653428e+03   1.32481640e+04   2.63846045e+04
   2.70000097e+03   2.85866787e+03   7.68768763e+03   2.11352186e+04
   1.08627773e-08   4.30392205e+03   1.04411700e+04   1.88195289e+04
   3.32305480e+04   1.67633216e+04   2.20390862e+04   4.55559346e+04
   1.28887035e+04   4.29831733e+03   1.05062710e+04   2.26398473e+04
   5.40000121e+03   1.93589672e+03   5.11718702e+03   1.62410433e+04
   1.80000000e+03   1.70228000e+03   6.16804602e+03   1.27729032e+04
   3.43523766e-07   3.67995448e+04   1.86076318e+04   1.82399030e+04
   4.07184332e+04   1.60469344e+04   4.98231534e+03   7.18902272e+03
   1.73203907e+04   8.32090772e+03   1.50362018e+03   2.69902170e+03
   1.06914761e+04   4.54072884e+03   2.13905197e-01   2.43454457e+03
   6.99261859e+03   2.56055122e+03   1.04107728e+01   5.18327628e+04
   2.98865428e+04   1.50027157e+04   3.38775689e+04   3.10140339e+04
   1.41453526e+04   5.91177772e+03   1.04019488e+04   2.32498065e+04
   8.13361556e+03   4.11981311e+03   3.73599477e+03   1.94406255e+04
   3.66902930e+03   7.66384198e+02   4.01245927e-05   1.74314458e+04
   1.08074805e+04   5.20323721e+03   3.82678053e+04   2.15323253e+04
   3.12871403e+04   5.78678053e+04   1.58741559e+04   7.90278114e+03
   1.76425260e+04   3.25443170e+04   7.20000145e+03   5.61432625e+03
   1.06145479e+04   2.49960947e+04   2.70000000e+03   5.65638646e+03
   1.20027229e+04   2.03755044e+04  -4.80554263e-09   3.29975364e-07
   2.38037360e+03   1.72222660e+04   4.50215859e+04   2.51519287e+04
   2.73530879e+04   5.36737037e+04   2.08787820e+04   8.91745617e+03
   1.34812794e+04   2.62979168e+04   1.11940350e+04   4.72533977e+03
   7.18997148e+03   1.77698207e+04   5.92678738e+03   2.69854968e+03
   6.46119051e+03   1.21667718e+04   2.45954145e+03   4.42447505e+01
   2.84660941e-02   8.72050584e+03   7.92295519e+02   5.51019777e+04
   3.19955666e+04   2.44187155e+04   4.92803499e+04   2.98864858e+04
   1.34341167e+04   1.11193810e+04   2.06459685e+04   1.95819818e+04
   7.18465311e+03   6.24536138e+03   1.15169540e+04   1.38442121e+04
   2.84665892e+03   3.13033134e+03   5.31140164e+03   9.90644423e+03
   4.56989411e+03   1.37466298e+03   2.01103100e+03   7.76867636e+03
   1.83355503e+03   5.93234814e+04   3.52891463e+04   2.21985916e+04
   4.50099779e+04   3.48063362e+04   1.65585205e+04   1.01698575e+04
   1.71949730e+04   2.49053095e+04   9.59397181e+03   6.60217633e+03
   8.45717138e+03   1.94738614e+04   4.35396993e+03   2.52885103e+03
   2.64386381e+03   1.58424151e+04   9.08313002e+03   4.09746593e+03
   1.98370102e-01   1.40109688e+04   5.83478226e+03   4.58600019e+01
   5.06037715e+04   3.05939946e+04   3.81827291e+04   6.79388751e+04
   2.42581208e+04   1.31913100e+04   2.19635967e+04   3.79784684e+04
   1.33006556e+04   9.17870451e+03   1.38041435e+04   2.82163406e+04
   7.06715499e+03   7.56514511e+03   1.35598927e+04   2.13760048e+04
   2.63365633e+03   1.34659462e+03   3.06773690e+03   1.66178587e+04
   1.57669141e-01   3.21006909e+02   6.00798570e+03   1.20546392e+04
   6.33015204e+04   3.99910971e+04   4.40381355e+04   7.61775621e+04
   3.34760867e+04   1.90344114e+04   2.57782035e+04   4.21342949e+04
   2.05081397e+04   1.32210062e+04   1.69291553e+04   3.04227975e+04
   1.27482730e+04   9.81853316e+03   1.49019471e+04   2.16279499e+04
   6.78840864e+03   3.91066530e+03   4.52276794e+03   1.55600850e+04
   2.62854426e+03   1.05344466e+03   4.69501837e+03   1.00354624e+04
   7.77199097e-01   6.26090062e+04   3.81033672e+04   3.35605444e+04
   6.21632762e+04   3.42352451e+04   1.72021091e+04   1.75446091e+04
   2.98232695e+04   2.21060176e+04   1.03988656e+04   1.08722575e+04
   1.89249971e+04   1.49829101e+04   5.70312838e+03   7.46019514e+03
   1.09455198e+04   9.65980480e+03   4.62822828e+03   2.44719597e+03
   6.06106019e+03   6.13669950e+03   1.11247655e+03   1.72592921e+00
   2.34791872e+03   3.35246144e+03   1.47627123e+03   6.96382984e+04
   4.32983969e+04   3.15297774e+04   5.82914093e+04   4.12818073e+04
   2.13879150e+04   1.65259544e+04   2.59716655e+04   2.91625575e+04
   1.33409148e+04   1.12161548e+04   1.50830677e+04   2.20470253e+04
   7.18661770e+03   6.28139245e+03   7.11329043e+03   1.67314953e+04
   9.68070333e+03   5.16265954e+03   2.69366486e+03   1.32159652e+04
   5.15046590e+03   1.66800302e+01   7.12325337e-02   9.80917565e+03
   6.69938501e+03   6.15771942e+02   7.22067985e+04   4.82203714e+04
   5.63090576e+04   9.18067985e+04   3.98996331e+04   2.56600741e+04
   3.56851620e+04   5.48516933e+04   2.54978393e+04   1.96981760e+04
   2.51119877e+04   4.17499334e+04   1.66493900e+04   1.63503950e+04
   2.32018480e+04   3.15611559e+04   9.60094337e+03   7.42672005e+03
   9.37181988e+03   2.41436489e+04   4.35249673e+03   4.19127669e+03
   1.00309689e+04   1.70132740e+04   1.06486193e+03   5.84858537e+00
   5.05228876e+03   1.21498547e+04   7.14798087e+04   4.56800963e+04
   4.43337189e+04   7.66314736e+04   4.00402398e+04   2.25431475e+04
   2.56459592e+04   4.06943271e+04   2.61397090e+04   1.52457867e+04
   1.71807813e+04   2.80785935e+04   1.76718208e+04   1.02536789e+04
   1.35335052e+04   1.83771244e+04   1.10039351e+04   6.33871539e+03
   5.22344197e+03   1.19390539e+04   6.13604937e+03   2.10187240e+03
   2.70631078e+03   6.49391721e+03   2.38012016e+03   2.94277410e-01
   1.97080337e+00   3.07998618e+03   1.80291314e+03   7.73124846e+04
   4.96016205e+04   4.09092368e+04   7.13987086e+04   4.58231157e+04
   2.53795832e+04   2.32014405e+04   3.54031313e+04   3.18938125e+04
   1.67947733e+04   1.60952703e+04   2.27594998e+04   2.34040801e+04
   1.02991018e+04   1.08799457e+04   1.30300592e+04   1.67143502e+04
   9.98471848e+03   6.49425825e+03   7.03486600e+03   1.18246203e+04
   4.69074596e+03   1.20380135e+03   2.59802446e+03   7.40831524e+03
   3.75125452e+03   1.66751242e-01   1.07679243e+00   7.43871282e+03
   6.61918053e+02   8.13242060e+04   5.27108665e+04   3.52684029e+04
   6.17242060e+04   5.17711648e+04   2.89466053e+04   2.01792394e+04
   2.80005393e+04   3.89605955e+04   1.95097497e+04   1.54684314e+04
   1.64416358e+04   3.13202106e+04   1.18375770e+04   8.97840191e+03
   7.79978471e+03   2.54798279e+04   1.66350232e+04   1.02945505e+04
   3.21176184e+03   2.14394453e+04   1.08452776e+04   2.52701342e+03
   8.11856188e+02   1.70503460e+04   1.25566860e+04   3.85399576e+03
   4.53184747e+01   1.91053941e+04   7.10455988e+03   1.68957924e+03]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  2.16503352e+03   1.64696277e+04   7.85061371e+03   1.87000000e+04
   1.51236987e+04   3.43426732e+03   3.77767062e+03   1.74532638e-02
   1.27322932e+04   2.33776706e+04   1.29231313e+04   3.06942160e+03
   7.95997454e+03   2.21967347e+04   2.33020288e+03   2.18836763e+04
   9.05650021e+03   1.58335780e+03   1.24440985e+04   1.15600248e+04
   3.57049713e+03   2.51395333e+04   1.35346465e+04   3.99893303e-01
   5.53953326e+03   1.88404984e+04   1.07191378e+04   1.28244657e+03
   1.07442595e+04   3.01317126e+03   1.48370232e+04   3.03442595e+04
   6.61440894e+02   4.74040630e+02   9.85944010e+03   1.94651789e+04
   2.06659265e+04   7.51503128e+03   8.84194229e+03   2.54440346e+04
   6.60638592e+03   4.87677369e-02   2.42427978e+03   9.89903061e+03
   2.74735158e+03   2.45367376e+04   1.00888796e+04   5.28776150e+03
   1.99746172e+04   1.08675001e+04   2.04746422e+03   1.65013882e+00
   4.88755935e+03   7.23396757e+03   2.20895106e+02   3.27566263e+04
   1.73184761e+04   2.90341888e+03   1.31566263e+04   2.12167425e+04
   9.78166273e+03   4.95820071e+02   5.67958100e+02   1.88134667e+04
   7.01956432e+03   2.22674033e+03   1.81187759e+04   7.38622322e+03
   1.85203961e+04   3.77187759e+04   3.93234632e+03   1.15028743e+03
   1.06538021e+04   2.20248919e+04   4.83593682e-04   1.90300949e+03
   6.56082739e+03   1.90743426e+04   2.99647908e+04   1.35818989e+04
   1.08791234e+04   2.94767582e+04   1.27062721e+04   2.69001217e+03
   2.69238527e+03   1.01783646e+04   6.99899408e+03   6.59002896e-01
   2.45575094e-01   5.50683527e+03   4.75145765e+03   3.49317808e+04
   1.72761222e+04   8.30727124e+03   2.48734491e+04   1.81499384e+04
   5.91398514e+03   1.33399661e+03   6.13434403e+03   1.27180652e+04
   2.30373239e+03   3.10608569e+00   1.72984809e+03   1.06796172e+04
   2.80391645e+02   4.33413554e+04   2.40598302e+04   8.76163893e+03
   2.37413554e+04   2.65467980e+04   1.17892580e+04   2.65466182e+03
   4.98733175e+03   2.11075786e+04   7.08004565e+03   2.50644569e+03
   5.75712882e+02   1.90635533e+04   3.77052631e+03   2.61276928e+02
   2.72932906e+04   1.35592742e+04   2.40037682e+04   4.68932906e+04
   9.00325110e+03   3.62653428e+03   1.32481640e+04   2.63846045e+04
   2.70000097e+03   2.85866787e+03   7.68768763e+03   2.11352186e+04
   1.08627773e-08   4.30392205e+03   1.04411700e+04   1.88195289e+04
   3.32305480e+04   1.67633216e+04   2.20390862e+04   4.55559346e+04
   1.28887035e+04   4.29831733e+03   1.05062710e+04   2.26398473e+04
   5.40000121e+03   1.93589672e+03   5.11718702e+03   1.62410433e+04
   1.80000000e+03   1.70228000e+03   6.16804602e+03   1.27729032e+04
   3.43523766e-07   3.67995448e+04   1.86076318e+04   1.82399030e+04
   4.07184332e+04   1.60469344e+04   4.98231534e+03   7.18902272e+03
   1.73203907e+04   8.32090772e+03   1.50362018e+03   2.69902170e+03
   1.06914761e+04   4.54072884e+03   2.13905197e-01   2.43454457e+03
   6.99261859e+03   2.56055122e+03   1.04107728e+01   5.18327628e+04
   2.98865428e+04   1.50027157e+04   3.38775689e+04   3.10140339e+04
   1.41453526e+04   5.91177772e+03   1.04019488e+04   2.32498065e+04
   8.13361556e+03   4.11981311e+03   3.73599477e+03   1.94406255e+04
   3.66902930e+03   7.66384198e+02   4.01245927e-05   1.74314458e+04
   1.08074805e+04   5.20323721e+03   3.82678053e+04   2.15323253e+04
   3.12871403e+04   5.78678053e+04   1.58741559e+04   7.90278114e+03
   1.76425260e+04   3.25443170e+04   7.20000145e+03   5.61432625e+03
   1.06145479e+04   2.49960947e+04   2.70000000e+03   5.65638646e+03
   1.20027229e+04   2.03755044e+04  -4.80554263e-09   3.29975364e-07
   2.38037360e+03   1.72222660e+04   4.50215859e+04   2.51519287e+04
   2.73530879e+04   5.36737037e+04   2.08787820e+04   8.91745617e+03
   1.34812794e+04   2.62979168e+04   1.11940350e+04   4.72533977e+03
   7.18997148e+03   1.77698207e+04   5.92678738e+03   2.69854968e+03
   6.46119051e+03   1.21667718e+04   2.45954145e+03   4.42447505e+01
   2.84660941e-02   8.72050584e+03   7.92295519e+02   5.51019777e+04
   3.19955666e+04   2.44187155e+04   4.92803499e+04   2.98864858e+04
   1.34341167e+04   1.11193810e+04   2.06459685e+04   1.95819818e+04
   7.18465311e+03   6.24536138e+03   1.15169540e+04   1.38442121e+04
   2.84665892e+03   3.13033134e+03   5.31140164e+03   9.90644423e+03
   4.56989411e+03   1.37466298e+03   2.01103100e+03   7.76867636e+03
   1.83355503e+03   5.93234814e+04   3.52891463e+04   2.21985916e+04
   4.50099779e+04   3.48063362e+04   1.65585205e+04   1.01698575e+04
   1.71949730e+04   2.49053095e+04   9.59397181e+03   6.60217633e+03
   8.45717138e+03   1.94738614e+04   4.35396993e+03   2.52885103e+03
   2.64386381e+03   1.58424151e+04   9.08313002e+03   4.09746593e+03
   1.98370102e-01   1.40109688e+04   5.83478226e+03   4.58600019e+01
   5.06037715e+04   3.05939946e+04   3.81827291e+04   6.79388751e+04
   2.42581208e+04   1.31913100e+04   2.19635967e+04   3.79784684e+04
   1.33006556e+04   9.17870451e+03   1.38041435e+04   2.82163406e+04
   7.06715499e+03   7.56514511e+03   1.35598927e+04   2.13760048e+04
   2.63365633e+03   1.34659462e+03   3.06773690e+03   1.66178587e+04
   1.57669141e-01   3.21006909e+02   6.00798570e+03   1.20546392e+04
   6.33015204e+04   3.99910971e+04   4.40381355e+04   7.61775621e+04
   3.34760867e+04   1.90344114e+04   2.57782035e+04   4.21342949e+04
   2.05081397e+04   1.32210062e+04   1.69291553e+04   3.04227975e+04
   1.27482730e+04   9.81853316e+03   1.49019471e+04   2.16279499e+04
   6.78840864e+03   3.91066530e+03   4.52276794e+03   1.55600850e+04
   2.62854426e+03   1.05344466e+03   4.69501837e+03   1.00354624e+04
   7.77199097e-01   6.26090062e+04   3.81033672e+04   3.35605444e+04
   6.21632762e+04   3.42352451e+04   1.72021091e+04   1.75446091e+04
   2.98232695e+04   2.21060176e+04   1.03988656e+04   1.08722575e+04
   1.89249971e+04   1.49829101e+04   5.70312838e+03   7.46019514e+03
   1.09455198e+04   9.65980480e+03   4.62822828e+03   2.44719597e+03
   6.06106019e+03   6.13669950e+03   1.11247655e+03   1.72592921e+00
   2.34791872e+03   3.35246144e+03   1.47627123e+03   6.96382984e+04
   4.32983969e+04   3.15297774e+04   5.82914093e+04   4.12818073e+04
   2.13879150e+04   1.65259544e+04   2.59716655e+04   2.91625575e+04
   1.33409148e+04   1.12161548e+04   1.50830677e+04   2.20470253e+04
   7.18661770e+03   6.28139245e+03   7.11329043e+03   1.67314953e+04
   9.68070333e+03   5.16265954e+03   2.69366486e+03   1.32159652e+04
   5.15046590e+03   1.66800302e+01   7.12325337e-02   9.80917565e+03
   6.69938501e+03   6.15771942e+02   7.22067985e+04   4.82203714e+04
   5.63090576e+04   9.18067985e+04   3.98996331e+04   2.56600741e+04
   3.56851620e+04   5.48516933e+04   2.54978393e+04   1.96981760e+04
   2.51119877e+04   4.17499334e+04   1.66493900e+04   1.63503950e+04
   2.32018480e+04   3.15611559e+04   9.60094337e+03   7.42672005e+03
   9.37181988e+03   2.41436489e+04   4.35249673e+03   4.19127669e+03
   1.00309689e+04   1.70132740e+04   1.06486193e+03   5.84858537e+00
   5.05228876e+03   1.21498547e+04   7.14798087e+04   4.56800963e+04
   4.43337189e+04   7.66314736e+04   4.00402398e+04   2.25431475e+04
   2.56459592e+04   4.06943271e+04   2.61397090e+04   1.52457867e+04
   1.71807813e+04   2.80785935e+04   1.76718208e+04   1.02536789e+04
   1.35335052e+04   1.83771244e+04   1.10039351e+04   6.33871539e+03
   5.22344197e+03   1.19390539e+04   6.13604937e+03   2.10187240e+03
   2.70631078e+03   6.49391721e+03   2.38012016e+03   2.94277410e-01
   1.97080337e+00   3.07998618e+03   1.80291314e+03   7.73124846e+04
   4.96016205e+04   4.09092368e+04   7.13987086e+04   4.58231157e+04
   2.53795832e+04   2.32014405e+04   3.54031313e+04   3.18938125e+04
   1.67947733e+04   1.60952703e+04   2.27594998e+04   2.34040801e+04
   1.02991018e+04   1.08799457e+04   1.30300592e+04   1.67143502e+04
   9.98471848e+03   6.49425825e+03   7.03486600e+03   1.18246203e+04
   4.69074596e+03   1.20380135e+03   2.59802446e+03   7.40831524e+03
   3.75125452e+03   1.66751242e-01   1.07679243e+00   7.43871282e+03
   6.61918053e+02   8.13242060e+04   5.27108665e+04   3.52684029e+04
   6.17242060e+04   5.17711648e+04   2.89466053e+04   2.01792394e+04
   2.80005393e+04   3.89605955e+04   1.95097497e+04   1.54684314e+04
   1.64416358e+04   3.13202106e+04   1.18375770e+04   8.97840191e+03
   7.79978471e+03   2.54798279e+04   1.66350232e+04   1.02945505e+04
   3.21176184e+03   2.14394453e+04   1.08452776e+04   2.52701342e+03
   8.11856188e+02   1.70503460e+04   1.25566860e+04   3.85399576e+03
   4.53184747e+01   1.91053941e+04   7.10455988e+03   1.68957924e+03]
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.497e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.932e-02 (tol = 1.000e-10) r (rel) = 2.268e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.493e-05 (tol = 1.000e-10) r (rel) = 2.143e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.393e-10 (tol = 1.000e-10) r (rel) = 3.983e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 19.621862 s.
j = 1.388946e+06.
End of time loop.
Runtime: 19.620333 s.
j = 1.388946e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.18546414375 s
|dj| = 12463.5170041
Runtime: 6.19360589981 s
|dj| = 12463.5170041
   37    71    -3.103825E+04     2.785175E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.073e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.378e-02 (tol = 1.000e-10) r (rel) = 2.401e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.647e-05 (tol = 1.000e-10) r (rel) = 2.163e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.109e-10 (tol = 1.000e-10) r (rel) = 3.609e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 19.853811 s.
j = 1.389551e+06.
End of time loop.
Runtime: 19.878820 s.
j = 1.389551e+06.
Minimum distance inequality constraints (should all be > 0): [  2.24793478e+03   1.65542091e+04   7.91993791e+03   1.87000000e+04
   1.52742181e+04   3.46060857e+03   3.94933995e+03   1.00633819e-01
   1.27948091e+04   2.35493399e+04   1.30306162e+04   3.02474045e+03
   8.07699632e+03   2.23984127e+04   2.24943187e+03   2.21801302e+04
   9.14728868e+03   1.68356177e+03   1.27227462e+04   1.15765404e+04
   3.62187366e+03   2.52284248e+04   1.35679322e+04   4.82725129e-01
   5.62842485e+03   1.88245783e+04   1.07910493e+04   1.32144223e+03
   1.04557516e+04   2.74312974e+03   1.47363078e+04   3.00557516e+04
   4.63541793e+02   4.67524553e+02   9.88880519e+03   1.93638198e+04
   2.07352809e+04   7.40764571e+03   8.77260005e+03   2.53777453e+04
   6.49761927e+03   7.26316460e-01   2.31662623e+03   9.75989972e+03
   2.88286326e+03   2.45906824e+04   9.98320891e+03   5.39983072e+03
   2.02326942e+04   1.06666579e+04   2.01224099e+03   7.27088521e-02
   4.97875547e+03   7.21821255e+03   1.38338406e+02   3.35669171e+04
   1.77144698e+04   3.25421209e+03   1.39669171e+04   2.14345333e+04
   9.89735307e+03   5.32642445e+02   7.91783775e+02   1.89361324e+04
   6.82463098e+03   2.22873681e+03   1.78092348e+04   7.01686842e+03
   1.83541183e+04   3.74092348e+04   3.60838423e+03   1.03830513e+03
   1.05366510e+04   2.18341004e+04   1.31478208e+01   1.95374168e+03
   6.42519047e+03   1.89205741e+04   3.01554404e+04   1.35309430e+04
   1.10428242e+04   2.98012879e+04   1.25574945e+04   2.70116100e+03
   2.67904546e+03   1.02845709e+04   7.16089748e+03   5.62053832e-01
   3.25559756e-01   5.36454603e+03   4.77361564e+03   3.49199977e+04
   1.71078057e+04   8.25871052e+03   2.48799123e+04   1.79186978e+04
   5.89900466e+03   1.21444766e+03   6.05547187e+03   1.28384812e+04
   2.24345935e+03   5.49467836e-03   1.48785675e+03   1.07101077e+04
   3.15001483e+02   4.33030937e+04   2.38913414e+04   8.67301807e+03
   2.37030937e+04   2.63067233e+04   1.17946627e+04   2.51901755e+03
   4.88437290e+03   2.12291208e+04   6.98848212e+03   2.54988010e+03
   3.19669411e+02   1.91028863e+04   3.84318035e+03   2.65715130e+02
   2.69161371e+04   1.30662782e+04   2.37523392e+04   4.65161371e+04
   8.53705439e+03   3.41151173e+03   1.29863661e+04   2.60930825e+04
   2.72624797e+03   2.83788334e+03   7.44444827e+03   2.07116783e+04
  -1.51028416e-07   4.21013264e+03   1.04036623e+04   1.87985646e+04
   3.28543985e+04   1.62480601e+04   2.17702524e+04   4.51966484e+04
   1.23716713e+04   4.06505247e+03   1.01930074e+04   2.23327767e+04
   5.44537594e+03   1.86683431e+03   4.87502317e+03   1.57088523e+04
   1.80627343e+03   1.58513059e+03   6.11475447e+03   1.27407395e+04
   1.45229179e-02   3.70466312e+04   1.85576784e+04   1.84508328e+04
   4.10983390e+04   1.58911262e+04   5.00898365e+03   7.16785609e+03
   1.74538566e+04   8.60808042e+03   1.57162004e+03   2.69802873e+03
   1.04325551e+04   4.67703304e+03   6.85904422e-02   2.52256952e+03
   7.12703742e+03   2.58093865e+03   3.21738422e-02   5.18352487e+04
   2.96916105e+04   1.49039918e+04   3.38409160e+04   3.07376396e+04
   1.41363259e+04   5.70687564e+03   1.02636089e+04   2.34852939e+04
   8.06207355e+03   4.12476449e+03   3.27650372e+03   1.95793698e+04
   3.70048882e+03   7.72069227e+02   2.13262515e-02   1.75082171e+04
   1.08581169e+04   5.29950831e+03   3.79051928e+04   2.09765784e+04
   3.10069218e+04   5.75051928e+04   1.53188208e+04   7.62004293e+03
   1.72719379e+04   3.22005037e+04   7.27703648e+03   5.54699405e+03
   1.02896148e+04   2.43340590e+04   2.72507934e+03   5.46155135e+03
   1.19139062e+04   2.03109469e+04   1.25614351e+01   1.45677828e-02
   2.28908757e+03   1.72414813e+04   4.54771946e+04   2.52074643e+04
   2.76321405e+04   5.41447613e+04   2.08303565e+04   9.01772441e+03
   1.34572206e+04   2.64493540e+04   1.16959791e+04   4.89251220e+03
   7.19164083e+03   1.73658923e+04   6.24990417e+03   2.69968389e+03
   6.57749874e+03   1.23094355e+04   2.64972873e+03   1.66162750e+02
   1.67655580e-01   8.81647168e+03   8.43336634e+02   5.53326084e+04
   3.18864798e+04   2.43140226e+04   4.92197875e+04   2.97322239e+04
   1.34783304e+04   1.08372397e+04   2.04179993e+04   2.00922144e+04
   7.23159756e+03   6.16793509e+03   1.07713243e+04   1.42323580e+04
   2.82441785e+03   3.10880543e+03   5.23665429e+03   1.02213908e+04
   4.79446078e+03   1.43636538e+03   1.94588647e+03   8.00135014e+03
   1.93335272e+03   5.93662643e+04   3.50672674e+04   2.20971400e+04
   4.49820115e+04   3.44959274e+04   1.65294854e+04   9.90280220e+03
   1.70272830e+04   2.52430365e+04   9.54585851e+03   6.55943892e+03
   7.81181153e+03   1.96999766e+04   4.33730132e+03   2.53298851e+03
   2.64326776e+03   1.60035169e+04   9.20350607e+03   4.14669914e+03
   1.72583690e-02   1.41001710e+04   5.88046270e+03   1.36925466e-01
   5.02622449e+04   3.00229085e+04   3.80431504e+04   6.77928437e+04
   2.36258272e+04   1.29098195e+04   2.16420785e+04   3.77889667e+04
   1.34364455e+04   9.14393530e+03   1.35423854e+04   2.75303574e+04
   7.12701336e+03   7.39150483e+03   1.35816829e+04   2.14761061e+04
   2.66971868e+03   1.39557377e+03   2.96603859e+03   1.67787797e+04
   2.46605885e-01   3.06026253e+02   6.28558176e+03   1.22526053e+04
   6.27773765e+04   3.92052943e+04   4.36223358e+04   7.57197191e+04
   3.26380547e+04   1.85819711e+04   2.51749349e+04   4.16514918e+04
   2.05912059e+04   1.30146120e+04   1.64728602e+04   2.93238880e+04
   1.27617252e+04   9.46369582e+03   1.47356537e+04   2.15128947e+04
   6.79536466e+03   3.91193914e+03   4.26902861e+03   1.55222495e+04
   2.60633214e+03   8.88314059e+02   4.79346891e+03   1.00560169e+04
   1.09929029e+00   6.22513519e+04   3.74860306e+04   3.31910838e+04
   6.17814631e+04   3.35550438e+04   1.68805911e+04   1.70061195e+04
   2.93875360e+04   2.22733746e+04   1.02107360e+04   1.05428261e+04
   1.79122499e+04   1.50700745e+04   5.45019186e+03   7.31934810e+03
   1.08249427e+04   9.72537037e+03   4.67170442e+03   2.29229410e+03
   5.99387547e+03   6.16231744e+03   1.01034635e+03   2.82836702e-01
   2.32415089e+03   3.45162576e+03   1.50183826e+03   6.98187020e+04
   4.31258734e+04   3.14525382e+04   5.82993602e+04   4.10205190e+04
   2.13995680e+04   1.62206367e+04   2.57872296e+04   2.96848290e+04
   1.33614587e+04   1.11598515e+04   1.42517709e+04   2.24373213e+04
   7.15720279e+03   6.30241550e+03   7.11337239e+03   1.70487291e+04
   9.92719682e+03   5.20383302e+03   2.69182129e+03   1.34414828e+04
   5.18630198e+03   1.84084172e-02   5.49243647e-02   1.01049394e+04
   6.82504822e+03   6.57810703e+02   7.17563728e+04   4.74328944e+04
   5.58882696e+04   9.13563727e+04   3.90645113e+04   2.51850787e+04
   3.50220173e+04   5.43264841e+04   2.56641401e+04   1.95105711e+04
   2.45799843e+04   4.04912195e+04   1.67270115e+04   1.59238975e+04
   2.29979245e+04   3.14001016e+04   9.66100612e+03   7.45657771e+03
   9.04465341e+03   2.40573713e+04   4.36468138e+03   3.96112582e+03
   1.01255967e+04   1.69850868e+04   1.04500365e+03   1.25637634e+00
   5.06078231e+03   1.22337996e+04   7.08883156e+04   4.48234915e+04
   4.38346687e+04   7.61000833e+04   3.91141171e+04   2.20402426e+04
   2.49506566e+04   4.01349408e+04   2.62003505e+04   1.49583600e+04
   1.66945109e+04   2.68416950e+04   1.76614321e+04   9.85563541e+03
   1.33180194e+04   1.82107944e+04   1.09907598e+04   6.32143905e+03
   4.93015469e+03   1.18454673e+04   6.09251744e+03   1.87120361e+03
   2.70080337e+03   6.45521622e+03   2.39647720e+03   6.07969362e-02
   1.36792337e-01   3.12712745e+03   1.78399029e+03   7.69794297e+04
   4.89674915e+04   4.05714658e+04   7.11026733e+04   4.50855162e+04
   2.50440337e+04   2.26315514e+04   3.49986279e+04   3.21082689e+04
   1.65828291e+04   1.57768887e+04   2.16346722e+04   2.35174014e+04
   1.00252315e+04   1.07551153e+04   1.29437333e+04   1.67951554e+04
   1.00468649e+04   6.30212624e+03   6.98197868e+03   1.18449806e+04
   4.50577047e+03   1.14266437e+03   2.56634432e+03   7.51357628e+03
   3.77603961e+03   2.54838603e-03   1.71284104e-01   7.41171693e+03
   6.69047102e+02   8.11170331e+04   5.22290641e+04   3.49924832e+04
   6.15170331e+04   5.11708899e+04   2.87385723e+04   1.97000531e+04
   2.76729470e+04   3.92264768e+04   1.93172693e+04   1.52974385e+04
   1.54594443e+04   3.14808239e+04   1.16852828e+04   8.90446518e+03
   7.74533201e+03   2.55976856e+04   1.67310536e+04   1.02190521e+04
   3.16933899e+03   2.14924539e+04   1.07397877e+04   2.39382210e+03
   7.75202193e+02   1.72499522e+04   1.26096288e+04   3.84840281e+03
   8.08096053e-01   1.90886595e+04   7.12462506e+03   1.69771919e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.24793478e+03   1.65542091e+04   7.91993791e+03   1.87000000e+04
   1.52742181e+04   3.46060857e+03   3.94933995e+03   1.00633819e-01
   1.27948091e+04   2.35493399e+04   1.30306162e+04   3.02474045e+03
   8.07699632e+03   2.23984127e+04   2.24943187e+03   2.21801302e+04
   9.14728868e+03   1.68356177e+03   1.27227462e+04   1.15765404e+04
   3.62187366e+03   2.52284248e+04   1.35679322e+04   4.82725129e-01
   5.62842485e+03   1.88245783e+04   1.07910493e+04   1.32144223e+03
   1.04557516e+04   2.74312974e+03   1.47363078e+04   3.00557516e+04
   4.63541793e+02   4.67524553e+02   9.88880519e+03   1.93638198e+04
   2.07352809e+04   7.40764571e+03   8.77260005e+03   2.53777453e+04
   6.49761927e+03   7.26316460e-01   2.31662623e+03   9.75989972e+03
   2.88286326e+03   2.45906824e+04   9.98320891e+03   5.39983072e+03
   2.02326942e+04   1.06666579e+04   2.01224099e+03   7.27088521e-02
   4.97875547e+03   7.21821255e+03   1.38338406e+02   3.35669171e+04
   1.77144698e+04   3.25421209e+03   1.39669171e+04   2.14345333e+04
   9.89735307e+03   5.32642445e+02   7.91783775e+02   1.89361324e+04
   6.82463098e+03   2.22873681e+03   1.78092348e+04   7.01686842e+03
   1.83541183e+04   3.74092348e+04   3.60838423e+03   1.03830513e+03
   1.05366510e+04   2.18341004e+04   1.31478208e+01   1.95374168e+03
   6.42519047e+03   1.89205741e+04   3.01554404e+04   1.35309430e+04
   1.10428242e+04   2.98012879e+04   1.25574945e+04   2.70116100e+03
   2.67904546e+03   1.02845709e+04   7.16089748e+03   5.62053832e-01
   3.25559756e-01   5.36454603e+03   4.77361564e+03   3.49199977e+04
   1.71078057e+04   8.25871052e+03   2.48799123e+04   1.79186978e+04
   5.89900466e+03   1.21444766e+03   6.05547187e+03   1.28384812e+04
   2.24345935e+03   5.49467836e-03   1.48785675e+03   1.07101077e+04
   3.15001483e+02   4.33030937e+04   2.38913414e+04   8.67301807e+03
   2.37030937e+04   2.63067233e+04   1.17946627e+04   2.51901755e+03
   4.88437290e+03   2.12291208e+04   6.98848212e+03   2.54988010e+03
   3.19669411e+02   1.91028863e+04   3.84318035e+03   2.65715130e+02
   2.69161371e+04   1.30662782e+04   2.37523392e+04   4.65161371e+04
   8.53705439e+03   3.41151173e+03   1.29863661e+04   2.60930825e+04
   2.72624797e+03   2.83788334e+03   7.44444827e+03   2.07116783e+04
  -1.51028416e-07   4.21013264e+03   1.04036623e+04   1.87985646e+04
   3.28543985e+04   1.62480601e+04   2.17702524e+04   4.51966484e+04
   1.23716713e+04   4.06505247e+03   1.01930074e+04   2.23327767e+04
   5.44537594e+03   1.86683431e+03   4.87502317e+03   1.57088523e+04
   1.80627343e+03   1.58513059e+03   6.11475447e+03   1.27407395e+04
   1.45229179e-02   3.70466312e+04   1.85576784e+04   1.84508328e+04
   4.10983390e+04   1.58911262e+04   5.00898365e+03   7.16785609e+03
   1.74538566e+04   8.60808042e+03   1.57162004e+03   2.69802873e+03
   1.04325551e+04   4.67703304e+03   6.85904422e-02   2.52256952e+03
   7.12703742e+03   2.58093865e+03   3.21738422e-02   5.18352487e+04
   2.96916105e+04   1.49039918e+04   3.38409160e+04   3.07376396e+04
   1.41363259e+04   5.70687564e+03   1.02636089e+04   2.34852939e+04
   8.06207355e+03   4.12476449e+03   3.27650372e+03   1.95793698e+04
   3.70048882e+03   7.72069227e+02   2.13262515e-02   1.75082171e+04
   1.08581169e+04   5.29950831e+03   3.79051928e+04   2.09765784e+04
   3.10069218e+04   5.75051928e+04   1.53188208e+04   7.62004293e+03
   1.72719379e+04   3.22005037e+04   7.27703648e+03   5.54699405e+03
   1.02896148e+04   2.43340590e+04   2.72507934e+03   5.46155135e+03
   1.19139062e+04   2.03109469e+04   1.25614351e+01   1.45677828e-02
   2.28908757e+03   1.72414813e+04   4.54771946e+04   2.52074643e+04
   2.76321405e+04   5.41447613e+04   2.08303565e+04   9.01772441e+03
   1.34572206e+04   2.64493540e+04   1.16959791e+04   4.89251220e+03
   7.19164083e+03   1.73658923e+04   6.24990417e+03   2.69968389e+03
   6.57749874e+03   1.23094355e+04   2.64972873e+03   1.66162750e+02
   1.67655580e-01   8.81647168e+03   8.43336634e+02   5.53326084e+04
   3.18864798e+04   2.43140226e+04   4.92197875e+04   2.97322239e+04
   1.34783304e+04   1.08372397e+04   2.04179993e+04   2.00922144e+04
   7.23159756e+03   6.16793509e+03   1.07713243e+04   1.42323580e+04
   2.82441785e+03   3.10880543e+03   5.23665429e+03   1.02213908e+04
   4.79446078e+03   1.43636538e+03   1.94588647e+03   8.00135014e+03
   1.93335272e+03   5.93662643e+04   3.50672674e+04   2.20971400e+04
   4.49820115e+04   3.44959274e+04   1.65294854e+04   9.90280220e+03
   1.70272830e+04   2.52430365e+04   9.54585851e+03   6.55943892e+03
   7.81181153e+03   1.96999766e+04   4.33730132e+03   2.53298851e+03
   2.64326776e+03   1.60035169e+04   9.20350607e+03   4.14669914e+03
   1.72583690e-02   1.41001710e+04   5.88046270e+03   1.36925466e-01
   5.02622449e+04   3.00229085e+04   3.80431504e+04   6.77928437e+04
   2.36258272e+04   1.29098195e+04   2.16420785e+04   3.77889667e+04
   1.34364455e+04   9.14393530e+03   1.35423854e+04   2.75303574e+04
   7.12701336e+03   7.39150483e+03   1.35816829e+04   2.14761061e+04
   2.66971868e+03   1.39557377e+03   2.96603859e+03   1.67787797e+04
   2.46605885e-01   3.06026253e+02   6.28558176e+03   1.22526053e+04
   6.27773765e+04   3.92052943e+04   4.36223358e+04   7.57197191e+04
   3.26380547e+04   1.85819711e+04   2.51749349e+04   4.16514918e+04
   2.05912059e+04   1.30146120e+04   1.64728602e+04   2.93238880e+04
   1.27617252e+04   9.46369582e+03   1.47356537e+04   2.15128947e+04
   6.79536466e+03   3.91193914e+03   4.26902861e+03   1.55222495e+04
   2.60633214e+03   8.88314059e+02   4.79346891e+03   1.00560169e+04
   1.09929029e+00   6.22513519e+04   3.74860306e+04   3.31910838e+04
   6.17814631e+04   3.35550438e+04   1.68805911e+04   1.70061195e+04
   2.93875360e+04   2.22733746e+04   1.02107360e+04   1.05428261e+04
   1.79122499e+04   1.50700745e+04   5.45019186e+03   7.31934810e+03
   1.08249427e+04   9.72537037e+03   4.67170442e+03   2.29229410e+03
   5.99387547e+03   6.16231744e+03   1.01034635e+03   2.82836702e-01
   2.32415089e+03   3.45162576e+03   1.50183826e+03   6.98187020e+04
   4.31258734e+04   3.14525382e+04   5.82993602e+04   4.10205190e+04
   2.13995680e+04   1.62206367e+04   2.57872296e+04   2.96848290e+04
   1.33614587e+04   1.11598515e+04   1.42517709e+04   2.24373213e+04
   7.15720279e+03   6.30241550e+03   7.11337239e+03   1.70487291e+04
   9.92719682e+03   5.20383302e+03   2.69182129e+03   1.34414828e+04
   5.18630198e+03   1.84084172e-02   5.49243647e-02   1.01049394e+04
   6.82504822e+03   6.57810703e+02   7.17563728e+04   4.74328944e+04
   5.58882696e+04   9.13563727e+04   3.90645113e+04   2.51850787e+04
   3.50220173e+04   5.43264841e+04   2.56641401e+04   1.95105711e+04
   2.45799843e+04   4.04912195e+04   1.67270115e+04   1.59238975e+04
   2.29979245e+04   3.14001016e+04   9.66100612e+03   7.45657771e+03
   9.04465341e+03   2.40573713e+04   4.36468138e+03   3.96112582e+03
   1.01255967e+04   1.69850868e+04   1.04500365e+03   1.25637634e+00
   5.06078231e+03   1.22337996e+04   7.08883156e+04   4.48234915e+04
   4.38346687e+04   7.61000833e+04   3.91141171e+04   2.20402426e+04
   2.49506566e+04   4.01349408e+04   2.62003505e+04   1.49583600e+04
   1.66945109e+04   2.68416950e+04   1.76614321e+04   9.85563541e+03
   1.33180194e+04   1.82107944e+04   1.09907598e+04   6.32143905e+03
   4.93015469e+03   1.18454673e+04   6.09251744e+03   1.87120361e+03
   2.70080337e+03   6.45521622e+03   2.39647720e+03   6.07969362e-02
   1.36792337e-01   3.12712745e+03   1.78399029e+03   7.69794297e+04
   4.89674915e+04   4.05714658e+04   7.11026733e+04   4.50855162e+04
   2.50440337e+04   2.26315514e+04   3.49986279e+04   3.21082689e+04
   1.65828291e+04   1.57768887e+04   2.16346722e+04   2.35174014e+04
   1.00252315e+04   1.07551153e+04   1.29437333e+04   1.67951554e+04
   1.00468649e+04   6.30212624e+03   6.98197868e+03   1.18449806e+04
   4.50577047e+03   1.14266437e+03   2.56634432e+03   7.51357628e+03
   3.77603961e+03   2.54838603e-03   1.71284104e-01   7.41171693e+03
   6.69047102e+02   8.11170331e+04   5.22290641e+04   3.49924832e+04
   6.15170331e+04   5.11708899e+04   2.87385723e+04   1.97000531e+04
   2.76729470e+04   3.92264768e+04   1.93172693e+04   1.52974385e+04
   1.54594443e+04   3.14808239e+04   1.16852828e+04   8.90446518e+03
   7.74533201e+03   2.55976856e+04   1.67310536e+04   1.02190521e+04
   3.16933899e+03   2.14924539e+04   1.07397877e+04   2.39382210e+03
   7.75202193e+02   1.72499522e+04   1.26096288e+04   3.84840281e+03
   8.08096053e-01   1.90886595e+04   7.12462506e+03   1.69771919e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.52912306786 s
|dj| = 12428.5930057
Runtime: 6.51712203026 s
|dj| = 12428.5930057
   38    72    -3.105176E+04     2.777371E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.020e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.363e-02 (tol = 1.000e-10) r (rel) = 1.665e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.475e-05 (tol = 1.000e-10) r (rel) = 1.226e-05 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.480e-11 (tol = 1.000e-10) r (rel) = 1.723e-11 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 21.511009 s.
j = 1.389861e+06.
Start evaluation of dj
found a tidal farm, computing gradient
End of time loop.
Runtime: 21.519871 s.
j = 1.389861e+06.
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.988476038 s
|dj| = 12440.0477855
Runtime: 12.0137929916 s
|dj| = 12440.0477855
Start evaluation of j
Updating the turbine cache
   39    73    -3.105871E+04     2.779930E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.281e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.328e-02 (tol = 1.000e-10) r (rel) = 1.459e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.485e-05 (tol = 1.000e-10) r (rel) = 6.510e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.150e-11 (tol = 1.000e-10) r (rel) = 5.042e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 36.253154 s.
j = 1.389869e+06.
Runtime: 36.243737 s.
j = 1.389869e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19892303e+03   1.65747527e+04   7.86124844e+03   1.87000000e+04
   1.51988646e+04   3.59335918e+03   3.86077772e+03   3.64432198e-01
   1.26794799e+04   2.34607777e+04   1.28421691e+04   2.98293185e+03
   7.82811098e+03   2.21944816e+04   2.23460874e+03   2.20978764e+04
   9.16174203e+03   1.52246722e+03   1.25768801e+04   1.16282001e+04
   3.64438850e+03   2.52936485e+04   1.36023648e+04   6.82073265e-02
   5.69364848e+03   1.88489106e+04   1.07017835e+04   1.24645194e+03
   1.04105183e+04   2.78264276e+03   1.45432357e+04   3.00105183e+04
   4.95211596e+02   4.64643061e+02   9.93287857e+03   1.93325042e+04
   2.05116225e+04   7.35238862e+03   8.47504635e+03   2.51707060e+04
   6.47022471e+03   1.35568973e-01   2.33463915e+03   9.63686998e+03
   2.84133855e+03   2.45491745e+04   1.00416551e+04   5.15395977e+03
   2.00699779e+04   1.07681615e+04   2.06902898e+03   2.76448056e-02
   4.84257780e+03   7.28023564e+03   1.68715483e+02   3.35316862e+Minimum distance inequality constraints (should all be > 0): [  2.19892303e+03   1.65747527e+04   7.86124844e+03   1.87000000e+04
   1.51988646e+04   3.59335918e+03   3.86077772e+03   3.64432198e-01
   1.26794799e+04   2.34607777e+04   1.28421691e+04   2.98293185e+03
   7.82811098e+03   2.21944816e+04   2.23460874e+03   2.20978764e+04
   9.16174203e+03   1.52246722e+03   1.25768801e+04   1.16282001e+04
   3.64438850e+03   2.52936485e+04   1.36023648e+04   6.82073265e-02
   5.69364848e+03   1.88489106e+04   1.07017835e+04   1.24645194e+03
   1.04105183e+04   2.78264276e+03   1.45432357e+04   3.00105183e+04
   4.95211596e+02   4.64643061e+02   9.93287857e+03   1.93325042e+04
   2.05116225e+04   7.35238862e+03   8.47504635e+03   2.51707060e+04
   6.47022471e+03   1.35568973e-01   2.33463915e+03   9.63686998e+03
   2.84133855e+03   2.45491745e+04   1.00416551e+04   5.15395977e+03
   2.00699779e+04   1.07681615e+04   2.06902898e+03   2.76448056e-02
   4.84257780e+03   7.28023564e+03   1.68715483e+02   3.35316862e+04
   1.77469941e+04   3.14670808e+03   1.39316862e+04   2.14864696e+04
   9.90032639e+03   5.26096849e+02   7.47071349e+02   1.89382235e+04
   6.81566584e+03   2.17452929e+03   1.76915771e+04   7.03783120e+03
   1.80607048e+04   3.72915771e+04   3.63636523e+03   1.06365682e+03
   1.05918434e+04   2.17414839e+04   7.83311706e-04   1.94734403e+03
   6.49945460e+03   1.89121545e+04   2.98947890e+04   1.34598514e+04
   1.06905725e+04   2.95786320e+04   1.25177540e+04   2.69876139e+03
   2.68618014e+03   1.01192257e+04   7.08310840e+03   5.53370845e-03
   1.15250920e-01   5.33603483e+03   4.73880234e+03   3.48652207e+04
   1.71797368e+04   7.95633583e+03   2.46587037e+04   1.80555414e+04
   5.99939403e+03   1.21676469e+03   5.86699440e+03   1.29280359e+04
   2.32112277e+03   8.24264248e-02   1.41751623e+03   1.08304121e+04
   3.64597478e+02   4.32163843e+04   2.39225235e+04   8.46668813e+03
   2.36163843e+04   2.63700283e+04   1.18357094e+04   2.53100647e+03
   4.78151177e+03   2.12226678e+04   7.01957426e+03   2.50973389e+03
   3.10460774e+02   1.91090973e+04   3.85798497e+03   2.25549256e+02
   2.67726331e+04   1.30930182e+04   2.33781727e+04   4.63726331e+04
   8.57751790e+03   3.46267071e+03   1.30508083e+04   2.59504629e+04
   2.70000157e+03   2.85335028e+03   7.51867429e+03   2.06860858e+04
  -3.32087211e-07   4.19449769e+03   1.05327897e+04   1.87955281e+04
   3.27440602e+04   1.63087721e+04   2.14234160e+04   4.51084548e+04
   1.24454893e+04   4.14746307e+03   1.02823927e+04   2.22108167e+04
   5.42925952e+03   1.91327151e+03   4.94935859e+03   1.57092092e+04
   1.81469028e+03   1.59918750e+03   6.23723682e+03   1.27580071e+04
   1.22996633e-01   3.67946088e+04   1.85113513e+04   1.80085633e+04
   4.08486354e+04   1.58820547e+04   5.03450598e+03   7.17720069e+03
   1.72284263e+04   8.53344279e+03   1.58392781e+03   2.69949748e+03
   1.03656803e+04   4.65191795e+03   3.25340871e-03   2.57788941e+03
   7.10488388e+03   2.57039518e+03   6.91540826e-01   5.16755694e+04
   2.96930579e+04   1.46089154e+04   3.37277013e+04   3.07701016e+04
   1.41751559e+04   5.72467261e+03   1.01158319e+04   2.34253260e+04
   8.09295141e+03   4.07925906e+03   3.25725394e+03   1.95468822e+04
   3.71904207e+03   7.45315751e+02   3.07722946e-02   1.74684406e+04
   1.08391538e+04   5.27453541e+03   3.78435727e+04   2.10893786e+04
   3.06249383e+04   5.74435727e+04   1.54419103e+04   7.74400126e+03
   1.73930550e+04   3.20708952e+04   7.28716428e+03   5.61763891e+03
   1.03979989e+04   2.43322714e+04   2.75818568e+03   5.48512844e+03
   1.20740737e+04   2.03206086e+04   2.92094567e+01   4.25548297e-02
   2.29906182e+03   1.72002379e+04   4.51354769e+04   2.51189169e+04
   2.70909993e+04   5.38497405e+04   2.07779511e+04   9.03327367e+03
   1.34695828e+04   2.61752901e+04   1.15643912e+04   4.89825481e+03
   7.19442532e+03   1.72862480e+04   6.18501700e+03   2.69894569e+03
   6.65790707e+03   1.22883627e+04   2.60564553e+03   1.35090342e+02
   2.21414290e-01   8.79298513e+03   8.12351243e+02   5.50913256e+04
   3.18662289e+04   2.38791200e+04   4.90455049e+04   2.97440677e+04
   1.35330477e+04   1.08772703e+04   2.02062807e+04   1.99947127e+04
   7.27393905e+03   6.15631382e+03   1.07350885e+04   1.41850099e+04
   2.85456112e+03   3.14845260e+03   5.23814170e+03   1.01753101e+04
   4.76166560e+03   1.43384940e+03   1.94291552e+03   7.94476001e+03
   1.93026725e+03   5.91699183e+04   3.50682022e+04   2.17213162e+04
   4.48472417e+04   3.45299293e+04   1.65894724e+04   9.93846158e+03
   1.68403723e+04   2.51634569e+04   9.59448356e+03   6.52802113e+03
   7.78518828e+03   1.96612696e+04   4.37238587e+03   2.53584074e+03
   2.64487397e+03   1.59590852e+04   9.17393042e+03   4.13703467e+03
   1.20675164e-04   1.40410009e+04   5.87333023e+03   7.36603177e-02
   5.01672901e+04   3.01273145e+04   3.75364680e+04   6.76356608e+04
   2.37611561e+04   1.30470194e+04   2.17277645e+04   3.75502902e+04
   1.34385747e+04   9.22128148e+03   1.36142271e+04   2.74562784e+04
   7.16848009e+03   7.41536012e+03   1.37050967e+04   2.14254050e+04
   2.69838861e+03   1.39111346e+03   2.98000669e+03   1.66877375e+04
   3.56013005e-02   2.97863412e+02   6.21139321e+03   1.21550082e+04
   6.27439562e+04   3.93919347e+04   4.31889387e+04   7.57013437e+04
   3.28455178e+04   1.88076413e+04   2.53670926e+04   4.15060278e+04
   2.06323645e+04   1.31823662e+04   1.66192178e+04   2.93578792e+04
   1.28438405e+04   9.58047259e+03   1.49401591e+04   2.15660498e+04
   6.85532037e+03   3.94389707e+03   4.35126948e+03   1.55297071e+04
   2.61409514e+03   9.41865643e+02   4.79384971e+03   1.00444075e+04
   4.76590888e-03   6.20967729e+04   3.75563522e+04   3.27267177e+04
   6.16451795e+04   3.36612575e+04   1.70163160e+04   1.70986680e+04
   2.91715157e+04   2.22400629e+04   1.03132335e+04   1.05841854e+04
   1.78838429e+04   1.50876075e+04   5.52197832e+03   7.41134019e+03
   1.08296763e+04   9.73515563e+03   4.67186072e+03   2.33087448e+03
   5.98212675e+03   6.14023807e+03   1.04487525e+03   4.35896520e-03
   2.31066541e+03   3.41225026e+03   1.50576130e+03   6.95644693e+04
   4.31097495e+04   3.09895145e+04   5.81374120e+04   4.10381443e+04
   2.14682282e+04   1.62676269e+04   2.55568783e+04   2.95677897e+04
   1.34183565e+04   1.11331982e+04   1.42157924e+04   2.23758510e+04
   7.20228912e+03   6.32789650e+03   7.11583602e+03   1.69839158e+04
   9.87468915e+03   5.20105777e+03   2.69214803e+03   1.33488793e+04
   5.18700561e+03   7.36546925e-02   7.36563899e-02   9.98587280e+03
   6.78306323e+03   6.36922924e+02   7.17423993e+04   4.76566588e+04
   5.54047581e+04   9.13423993e+04   3.93099349e+04   2.54525363e+04
   3.52468488e+04   5.41648954e+04   2.57249772e+04   1.97086827e+04
   2.47633538e+04   4.05262593e+04   1.68346766e+04   1.60621333e+04
   2.32487785e+04   3.14566752e+04   9.74438028e+03   7.49925743e+03
   9.15145540e+03   2.40600968e+04   4.38364257e+03   4.03552387e+03
   1.01252661e+04   1.69666031e+04   1.06503319e+03   7.39360402e-03
   5.06731558e+03   1.21802905e+04   7.07732993e+04   4.49484306e+04
   4.33228370e+04   7.59787226e+04   3.92773061e+04   2.22319160e+04
   2.50822261e+04   3.99033121e+04   2.61993107e+04   1.51023959e+04
   1.67758025e+04   2.68154986e+04   1.77161813e+04   9.95696453e+03
   1.34559836e+04   1.82181199e+04   1.10330559e+04   6.33783732e+03
   4.99878369e+03   1.18274435e+04   6.08604376e+03   1.93295374e+03
   2.70000911e+03   6.43245168e+03   2.37853269e+03   5.12926525e-01
   4.56038975e-02   3.09166729e+03   1.78895838e+03   7.68330717e+04
   4.90630278e+04   4.01002672e+04   7.10002417e+04   4.52184892e+04
   2.52146515e+04   2.27521798e+04   3.47852684e+04   3.20762949e+04
   1.67208061e+04   1.58242249e+04   2.16277019e+04   2.35416036e+04
   1.01328614e+04   1.08539392e+04   1.29705257e+04   1.68069164e+04
   1.00480394e+04   6.36123794e+03   6.99451436e+03   1.18075124e+04
   4.56476870e+03   1.16323310e+03   2.57382050e+03   7.44988493e+03
   3.75812991e+03   7.36540674e-02   4.36022869e-03   7.38549508e+03
   6.54858865e+02   8.02805094e+04   5.17499698e+04   3.40421950e+04
   6.06805094e+04   5.07968062e+04   2.85024293e+04   1.93807311e+04
   2.69732779e+04   3.88081714e+04   1.91287829e+04   1.49645346e+04
   1.50690722e+04   3.11999714e+04   1.15400172e+04   8.66059628e+03
   7.48636845e+03   2.53917752e+04   1.65624730e+04   1.00944493e+04
   2.99900149e+03   2.13337767e+04   1.07056393e+04   2.34181053e+03
   6.87255224e+02   1.71236958e+04   1.26292299e+04   3.83449978e+03
   1.33924910e-01   1.91566057e+04   7.16096855e+03   1.75597828e+03]
Start evaluation of j
Updating the turbine cache
04
   1.77469941e+04   3.14670808e+03   1.39316862e+04   2.14864696e+04
   9.90032639e+03   5.26096849e+02   7.47071349e+02   1.89382235e+04
   6.81566584e+03   2.17452929e+03   1.76915771e+04   7.03783120e+03
   1.80607048e+04   3.72915771e+04   3.63636523e+03   1.06365682e+03
   1.05918434e+04   2.17414839e+04   7.83311706e-04   1.94734403e+03
   6.49945460e+03   1.89121545e+04   2.98947890e+04   1.34598514e+04
   1.06905725e+04   2.95786320e+04   1.25177540e+04   2.69876139e+03
   2.68618014e+03   1.01192257e+04   7.08310840e+03   5.53370845e-03
   1.15250920e-01   5.33603483e+03   4.73880234e+03   3.48652207e+04
   1.71797368e+04   7.95633583e+03   2.46587037e+04   1.80555414e+04
   5.99939403e+03   1.21676469e+03   5.86699440e+03   1.29280359e+04
   2.32112277e+03   8.24264248e-02   1.41751623e+03   1.08304121e+04
   3.64597478e+02   4.32163843e+04   2.39225235e+04   8.46668813e+03
   2.36163843e+04   2.63700283e+04   1.18357094e+04   2.53100647e+03
   4.78151177e+03   2.12226678e+04   7.01957426e+03   2.50973389e+03
   3.10460774e+02   1.91090973e+04   3.85798497e+03   2.25549256e+02
   2.67726331e+04   1.30930182e+04   2.33781727e+04   4.63726331e+04
   8.57751790e+03   3.46267071e+03   1.30508083e+04   2.59504629e+04
   2.70000157e+03   2.85335028e+03   7.51867429e+03   2.06860858e+04
  -3.32087211e-07   4.19449769e+03   1.05327897e+04   1.87955281e+04
   3.27440602e+04   1.63087721e+04   2.14234160e+04   4.51084548e+04
   1.24454893e+04   4.14746307e+03   1.02823927e+04   2.22108167e+04
   5.42925952e+03   1.91327151e+03   4.94935859e+03   1.57092092e+04
   1.81469028e+03   1.59918750e+03   6.23723682e+03   1.27580071e+04
   1.22996633e-01   3.67946088e+04   1.85113513e+04   1.80085633e+04
   4.08486354e+04   1.58820547e+04   5.03450598e+03   7.17720069e+03
   1.72284263e+04   8.53344279e+03   1.58392781e+03   2.69949748e+03
   1.03656803e+04   4.65191795e+03   3.25340871e-03   2.57788941e+03
   7.10488388e+03   2.57039518e+03   6.91540826e-01   5.16755694e+04
   2.96930579e+04   1.46089154e+04   3.37277013e+04   3.07701016e+04
   1.41751559e+04   5.72467261e+03   1.01158319e+04   2.34253260e+04
   8.09295141e+03   4.07925906e+03   3.25725394e+03   1.95468822e+04
   3.71904207e+03   7.45315751e+02   3.07722946e-02   1.74684406e+04
   1.08391538e+04   5.27453541e+03   3.78435727e+04   2.10893786e+04
   3.06249383e+04   5.74435727e+04   1.54419103e+04   7.74400126e+03
   1.73930550e+04   3.20708952e+04   7.28716428e+03   5.61763891e+03
   1.03979989e+04   2.43322714e+04   2.75818568e+03   5.48512844e+03
   1.20740737e+04   2.03206086e+04   2.92094567e+01   4.25548297e-02
   2.29906182e+03   1.72002379e+04   4.51354769e+04   2.51189169e+04
   2.70909993e+04   5.38497405e+04   2.07779511e+04   9.03327367e+03
   1.34695828e+04   2.61752901e+04   1.15643912e+04   4.89825481e+03
   7.19442532e+03   1.72862480e+04   6.18501700e+03   2.69894569e+03
   6.65790707e+03   1.22883627e+04   2.60564553e+03   1.35090342e+02
   2.21414290e-01   8.79298513e+03   8.12351243e+02   5.50913256e+04
   3.18662289e+04   2.38791200e+04   4.90455049e+04   2.97440677e+04
   1.35330477e+04   1.08772703e+04   2.02062807e+04   1.99947127e+04
   7.27393905e+03   6.15631382e+03   1.07350885e+04   1.41850099e+04
   2.85456112e+03   3.14845260e+03   5.23814170e+03   1.01753101e+04
   4.76166560e+03   1.43384940e+03   1.94291552e+03   7.94476001e+03
   1.93026725e+03   5.91699183e+04   3.50682022e+04   2.17213162e+04
   4.48472417e+04   3.45299293e+04   1.65894724e+04   9.93846158e+03
   1.68403723e+04   2.51634569e+04   9.59448356e+03   6.52802113e+03
   7.78518828e+03   1.96612696e+04   4.37238587e+03   2.53584074e+03
   2.64487397e+03   1.59590852e+04   9.17393042e+03   4.13703467e+03
   1.20675164e-04   1.40410009e+04   5.87333023e+03   7.36603177e-02
   5.01672901e+04   3.01273145e+04   3.75364680e+04   6.76356608e+04
   2.37611561e+04   1.30470194e+04   2.17277645e+04   3.75502902e+04
   1.34385747e+04   9.22128148e+03   1.36142271e+04   2.74562784e+04
   7.16848009e+03   7.41536012e+03   1.37050967e+04   2.14254050e+04
   2.69838861e+03   1.39111346e+03   2.98000669e+03   1.66877375e+04
   3.56013005e-02   2.97863412e+02   6.21139321e+03   1.21550082e+04
   6.27439562e+04   3.93919347e+04   4.31889387e+04   7.57013437e+04
   3.28455178e+04   1.88076413e+04   2.53670926e+04   4.15060278e+04
   2.06323645e+04   1.31823662e+04   1.66192178e+04   2.93578792e+04
   1.28438405e+04   9.58047259e+03   1.49401591e+04   2.15660498e+04
   6.85532037e+03   3.94389707e+03   4.35126948e+03   1.55297071e+04
   2.61409514e+03   9.41865643e+02   4.79384971e+03   1.00444075e+04
   4.76590888e-03   6.20967729e+04   3.75563522e+04   3.27267177e+04
   6.16451795e+04   3.36612575e+04   1.70163160e+04   1.70986680e+04
   2.91715157e+04   2.22400629e+04   1.03132335e+04   1.05841854e+04
   1.78838429e+04   1.50876075e+04   5.52197832e+03   7.41134019e+03
   1.08296763e+04   9.73515563e+03   4.67186072e+03   2.33087448e+03
   5.98212675e+03   6.14023807e+03   1.04487525e+03   4.35896520e-03
   2.31066541e+03   3.41225026e+03   1.50576130e+03   6.95644693e+04
   4.31097495e+04   3.09895145e+04   5.81374120e+04   4.10381443e+04
   2.14682282e+04   1.62676269e+04   2.55568783e+04   2.95677897e+04
   1.34183565e+04   1.11331982e+04   1.42157924e+04   2.23758510e+04
   7.20228912e+03   6.32789650e+03   7.11583602e+03   1.69839158e+04
   9.87468915e+03   5.20105777e+03   2.69214803e+03   1.33488793e+04
   5.18700561e+03   7.36546925e-02   7.36563899e-02   9.98587280e+03
   6.78306323e+03   6.36922924e+02   7.17423993e+04   4.76566588e+04
   5.54047581e+04   9.13423993e+04   3.93099349e+04   2.54525363e+04
   3.52468488e+04   5.41648954e+04   2.57249772e+04   1.97086827e+04
   2.47633538e+04   4.05262593e+04   1.68346766e+04   1.60621333e+04
   2.32487785e+04   3.14566752e+04   9.74438028e+03   7.49925743e+03
   9.15145540e+03   2.40600968e+04   4.38364257e+03   4.03552387e+03
   1.01252661e+04   1.69666031e+04   1.06503319e+03   7.39360402e-03
   5.06731558e+03   1.21802905e+04   7.07732993e+04   4.49484306e+04
   4.33228370e+04   7.59787226e+04   3.92773061e+04   2.22319160e+04
   2.50822261e+04   3.99033121e+04   2.61993107e+04   1.51023959e+04
   1.67758025e+04   2.68154986e+04   1.77161813e+04   9.95696453e+03
   1.34559836e+04   1.82181199e+04   1.10330559e+04   6.33783732e+03
   4.99878369e+03   1.18274435e+04   6.08604376e+03   1.93295374e+03
   2.70000911e+03   6.43245168e+03   2.37853269e+03   5.12926525e-01
   4.56038975e-02   3.09166729e+03   1.78895838e+03   7.68330717e+04
   4.90630278e+04   4.01002672e+04   7.10002417e+04   4.52184892e+04
   2.52146515e+04   2.27521798e+04   3.47852684e+04   3.20762949e+04
   1.67208061e+04   1.58242249e+04   2.16277019e+04   2.35416036e+04
   1.01328614e+04   1.08539392e+04   1.29705257e+04   1.68069164e+04
   1.00480394e+04   6.36123794e+03   6.99451436e+03   1.18075124e+04
   4.56476870e+03   1.16323310e+03   2.57382050e+03   7.44988493e+03
   3.75812991e+03   7.36540674e-02   4.36022869e-03   7.38549508e+03
   6.54858865e+02   8.02805094e+04   5.17499698e+04   3.40421950e+04
   6.06805094e+04   5.07968062e+04   2.85024293e+04   1.93807311e+04
   2.69732779e+04   3.88081714e+04   1.91287829e+04   1.49645346e+04
   1.50690722e+04   3.11999714e+04   1.15400172e+04   8.66059628e+03
   7.48636845e+03   2.53917752e+04   1.65624730e+04   1.00944493e+04
   2.99900149e+03   2.13337767e+04   1.07056393e+04   2.34181053e+03
   6.87255224e+02   1.71236958e+04   1.26292299e+04   3.83449978e+03
   1.33924910e-01   1.91566057e+04   7.16096855e+03   1.75597828e+03]
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.091e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.130e-03 (tol = 1.000e-10) r (rel) = 7.452e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.502e-07 (tol = 1.000e-10) r (rel) = 7.793e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.657e-13 (tol = 1.000e-10) r (rel) = 6.102e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 36.562896 s.
j = 1.390039e+06.
Runtime: 36.576675 s.
j = 1.390039e+06.
Minimum distance inequality constraints (should all be > 0): [  2.20575052e+03   1.66046228e+04   7.90936113e+03   1.87000000e+04
   1.52583238e+04   3.60099996e+03   3.91428792e+03   1.96723995e-01
   1.27017625e+04   2.35142879e+04   1.29113308e+04   3.00849450e+03
   7.88603071e+03   2.22984768e+04   2.22247654e+03   2.21352240e+04
   9.19246319e+03   1.53485350e+03   1.26214173e+04   1.16068903e+04
   3.65804742e+03   2.53249462e+04   1.36484811e+04   9.23940523e-02
   5.72494617e+03   1.88442089e+04   1.07371010e+04   1.24834384e+03
   1.04178834e+04   2.76037228e+03   1.45568278e+04   3.00178834e+04
   4.69034892e+02   4.58824195e+02   9.92883758e+03   1.93245885e+04
   2.05818912e+04   7.38106992e+03   8.50493678e+03   2.52338257e+04
   6.45426766e+03   6.23765037e-02   2.33227491e+03   9.63852146e+03
   2.85684781e+03   2.45721077e+04   1.00518404e+04   5.17192640e+03
   2.01184401e+04   1.07207675e+04   2.06282700e+03   1.11796600e-02
   4.84723640e+03   7.27067927e+03   1.61514760e+02   3.35969144e+04
   1.78068734e+04   3.16387545e+03   1.39969144e+04   2.14739021e+04
   9.92434121e+03   5.29647893e+02   7.53165997e+02   1.89454666e+04
   6.81066794e+03   2.18128289e+03   1.77047920e+04   7.01071370e+03
   1.80729668e+04   3.73047920e+04   3.59091832e+03   1.03955130e+03
   1.05790009e+04   2.17256173e+04   8.30760080e-01   1.95006928e+03
   6.48341240e+03   1.89058211e+04   2.99751257e+04   1.34986168e+04
   1.07191828e+04   2.96435398e+04   1.24962033e+04   2.69894410e+03
   2.68413711e+03   1.01169163e+04   7.11166062e+03   1.55037736e-03
   7.79303467e-02   5.32522606e+03   4.75521347e+03   3.48984442e+04
   1.71963069e+04   7.98971378e+03   2.47467727e+04   1.79881734e+04
   5.97941235e+03   1.22020246e+03   5.88721929e+03   1.29068715e+04
   2.29733008e+03   2.33848369e-02   1.42875479e+03   1.07964055e+04
   3.46818451e+02   4.32538382e+04   2.39588143e+04   8.46835705e+03
   2.36538382e+04   2.63233110e+04   1.18405993e+04   2.52605334e+03
   4.77052247e+03   2.12312070e+04   7.00996029e+03   2.51852256e+03
   3.00187857e+02   1.91119787e+04   3.85122635e+03   2.38680901e+02
   2.67887551e+04   1.30595101e+04   2.33878993e+04   4.63887551e+04
   8.51177718e+03   3.42042584e+03   1.30292797e+04   2.59259541e+04
   2.70166133e+03   2.84412425e+03   7.49692391e+03   2.06666092e+04
  -1.36782319e-07   4.20026842e+03   1.04873282e+04   1.87941432e+04
   3.27116090e+04   1.62428258e+04   2.13764055e+04   4.50517622e+04
   1.23402265e+04   4.07961917e+03   1.02229297e+04   2.21320711e+04
   5.41324277e+03   1.87835563e+03   4.90489324e+03   1.56454205e+04
   1.80560657e+03   1.58257753e+03   6.17464865e+03   1.27272254e+04
   4.95367525e-02   3.68766599e+04   1.85406321e+04   1.80441680e+04
   4.09220011e+04   1.58444380e+04   5.01957686e+03   7.17441841e+03
   1.72270969e+04   8.56505324e+03   1.58031790e+03   2.69905091e+03
   1.03531992e+04   4.67155827e+03   4.99047372e-03   2.55315132e+03
   7.10504931e+03   2.58027431e+03   2.78585413e-01   5.16910651e+04
   2.97017144e+04   1.46061294e+04   3.37670250e+04   3.06809802e+04
   1.41458986e+04   5.70745689e+03   1.00980892e+04   2.34134002e+04
   8.06072761e+03   4.07565078e+03   3.23716356e+03   1.95294810e+04
   3.69513849e+03   7.43375345e+02   6.65445476e-02   1.74477684e+04
   1.08038547e+04   5.25632279e+03   3.77688571e+04   2.09780447e+04
   3.05600038e+04   5.73589535e+04   1.52948321e+04   7.64020704e+03
   1.73142558e+04   3.19727086e+04   7.24658745e+03   5.56376711e+03
   1.03346968e+04   2.42539248e+04   2.72941288e+03   5.45783811e+03
   1.19902892e+04   2.02858875e+04   1.47369812e+01   1.20765092e-02
   2.29008469e+03   1.71616777e+04   4.52957192e+04   2.51904690e+04
   2.71415673e+04   5.39466544e+04   2.07816638e+04   9.03237838e+03
   1.34659327e+04   2.61673044e+04   1.16455470e+04   4.90594859e+03
   7.19440364e+03   1.72530777e+04   6.24591823e+03   2.69926916e+03
   6.61180657e+03   1.22664603e+04   2.64919509e+03   1.64788929e+02
   9.56740939e-02   8.74559828e+03   8.42455586e+02   5.51807962e+04
   3.19088950e+04   2.39304999e+04   4.91534819e+04   2.96860320e+04
   1.35142450e+04   1.08867791e+04   2.02236885e+04   2.00269397e+04
   7.26448589e+03   6.17153299e+03   1.07347736e+04   1.42030865e+04
   2.85040827e+03   3.14378180e+03   5.25849161e+03   1.01823346e+04
   4.76619061e+03   1.42823617e+03   1.94966545e+03   7.94440073e+03
   1.89804417e+03   5.91910169e+04   3.50696704e+04   2.17227139e+04
   4.48935445e+04   3.44258020e+04   1.65444853e+04   9.91725818e+03
   1.68195659e+04   2.51557512e+04   9.55627514e+03   6.52134843e+03
   7.75816150e+03   1.96474785e+04   4.34473231e+03   2.52324253e+03
   2.64614094e+03   1.59421615e+04   9.15307413e+03   4.11520608e+03
   2.51686784e-03   1.40201451e+04   5.82048766e+03   3.04547227e-02
   5.00911499e+04   3.00103118e+04   3.74817728e+04   6.75749148e+04
   2.35870043e+04   1.29247638e+04   2.16503959e+04   3.74610430e+04
   1.33896465e+04   9.15456148e+03   1.35518610e+04   2.73806380e+04
   7.12916598e+03   7.37813915e+03   1.36209420e+04   2.14003753e+04
   2.67198815e+03   1.39053979e+03   2.95830786e+03   1.66586869e+04
   9.97556262e-03   3.00800513e+02   6.20355619e+03   1.21402795e+04
   6.26499614e+04   3.92557512e+04   4.31047399e+04   7.56146196e+04
   3.26364322e+04   1.86556823e+04   2.52608554e+04   4.13839838e+04
   2.05676511e+04   1.30862406e+04   1.65345145e+04   2.92471056e+04
   1.27891194e+04   9.51383382e+03   1.48318043e+04   2.15146198e+04
   6.81459052e+03   3.93284290e+03   4.30349739e+03   1.54792414e+04
   2.61174823e+03   9.07894000e+02   4.76104745e+03   1.00102624e+04
   3.16350292e-02   6.21853888e+04   3.75870473e+04   3.27847638e+04
   6.17591456e+04   3.35880602e+04   1.69826014e+04   1.71075117e+04
   2.91898168e+04   2.22744860e+04   1.03013743e+04   1.05984958e+04
   1.78828219e+04   1.51085590e+04   5.51949324e+03   7.39923804e+03
   1.08574401e+04   9.74635239e+03   4.69265899e+03   2.32696561e+03
   5.99461132e+03   6.15744160e+03   1.01677323e+03   1.43817606e-02
   2.31680073e+03   3.41895495e+03   1.49134652e+03   6.96429328e+04
   4.31454801e+04   3.10097159e+04   5.82057254e+04   4.09633182e+04
   2.14389468e+04   1.62561036e+04   2.55398691e+04   2.96058639e+04
   1.33982491e+04   1.11400414e+04   1.41846551e+04   2.24043425e+04
   7.18789703e+03   6.31411863e+03   7.11818822e+03   1.70065579e+04
   9.89573319e+03   5.19444639e+03   2.69125908e+03   1.33789972e+04
   5.14817244e+03   3.03829890e-02   3.06775629e-02   1.00144175e+04
   6.78743715e+03   6.46797183e+02   7.16609760e+04   4.75138186e+04
   5.53232921e+04   9.12609760e+04   3.90945507e+04   2.52849519e+04
   3.51320290e+04   5.40356059e+04   2.56644051e+04   1.96052878e+04
   2.46681103e+04   4.04027492e+04   1.67815693e+04   1.59878813e+04
   2.31188579e+04   3.13956111e+04   9.70324554e+03   7.49505925e+03
   9.09455435e+03   2.39949012e+04   4.38928521e+03   3.99620255e+03
   1.00739048e+04   1.69164314e+04   1.06556914e+03   1.27768982e-02
   5.03351058e+03   1.21715982e+04   7.08293405e+04   4.49429519e+04
   4.33745506e+04   7.60818336e+04   3.91643158e+04   2.21666932e+04
   2.50808460e+04   3.99138724e+04   2.62148536e+04   1.50758326e+04
   1.67800685e+04   2.68092299e+04   1.77219358e+04   9.94815786e+03
   1.34316707e+04   1.82521580e+04   1.10333503e+04   6.36407564e+03
   4.98947055e+03   1.18467794e+04   6.10868113e+03   1.90276181e+03
   2.69992108e+03   6.44720666e+03   2.39131994e+03   2.73923136e-01
   1.61926831e-02   3.11570805e+03   1.76784324e+03   7.69007707e+04
   4.90768781e+04   4.01172263e+04   7.10646354e+04   4.51185921e+04
   2.51605495e+04   2.27300829e+04   3.47592442e+04   3.21066562e+04
   1.66883840e+04   1.58202510e+04   2.15859504e+04   2.35630613e+04
   1.01102288e+04   1.08228219e+04   1.29703840e+04   1.68238220e+04
   1.00754482e+04   6.34642268e+03   6.98945233e+03   1.18452846e+04
   4.52014840e+03   1.15329206e+03   2.57004842e+03   7.48306304e+03
   3.77098326e+03   3.01062908e-02   1.43759067e-02   7.38445090e+03
   6.69050469e+02   8.04409953e+04   5.18603130e+04   3.41247043e+04
   6.08409953e+04   5.07740461e+04   2.85206157e+04   1.94184020e+04
   2.70169232e+04   3.88900831e+04   1.91412648e+04   1.50152873e+04
   1.50831384e+04   3.12614713e+04   1.15495226e+04   8.68917426e+03
   7.52369870e+03   2.54367931e+04   1.65994531e+04   1.01031363e+04
   3.02743575e+03   2.13767960e+04   1.06588714e+04   2.35364733e+03
   7.06324863e+02   1.71603483e+04   1.26324744e+04   3.84860688e+03
   5.09229078e-01   1.91365631e+04   7.18545851e+03   1.74871660e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.20575052e+03   1.66046228e+04   7.90936113e+03   1.87000000e+04
   1.52583238e+04   3.60099996e+03   3.91428792e+03   1.96723995e-01
   1.27017625e+04   2.35142879e+04   1.29113308e+04   3.00849450e+03
   7.88603071e+03   2.22984768e+04   2.22247654e+03   2.21352240e+04
   9.19246319e+03   1.53485350e+03   1.26214173e+04   1.16068903e+04
   3.65804742e+03   2.53249462e+04   1.36484811e+04   9.23940523e-02
   5.72494617e+03   1.88442089e+04   1.07371010e+04   1.24834384e+03
   1.04178834e+04   2.76037228e+03   1.45568278e+04   3.00178834e+04
   4.69034892e+02   4.58824195e+02   9.92883758e+03   1.93245885e+04
   2.05818912e+04   7.38106992e+03   8.50493678e+03   2.52338257e+04
   6.45426766e+03   6.23765037e-02   2.33227491e+03   9.63852146e+03
   2.85684781e+03   2.45721077e+04   1.00518404e+04   5.17192640e+03
   2.01184401e+04   1.07207675e+04   2.06282700e+03   1.11796600e-02
   4.84723640e+03   7.27067927e+03   1.61514760e+02   3.35969144e+04
   1.78068734e+04   3.16387545e+03   1.39969144e+04   2.14739021e+04
   9.92434121e+03   5.29647893e+02   7.53165997e+02   1.89454666e+04
   6.81066794e+03   2.18128289e+03   1.77047920e+04   7.01071370e+03
   1.80729668e+04   3.73047920e+04   3.59091832e+03   1.03955130e+03
   1.05790009e+04   2.17256173e+04   8.30760080e-01   1.95006928e+03
   6.48341240e+03   1.89058211e+04   2.99751257e+04   1.34986168e+04
   1.07191828e+04   2.96435398e+04   1.24962033e+04   2.69894410e+03
   2.68413711e+03   1.01169163e+04   7.11166062e+03   1.55037736e-03
   7.79303467e-02   5.32522606e+03   4.75521347e+03   3.48984442e+04
   1.71963069e+04   7.98971378e+03   2.47467727e+04   1.79881734e+04
   5.97941235e+03   1.22020246e+03   5.88721929e+03   1.29068715e+04
   2.29733008e+03   2.33848369e-02   1.42875479e+03   1.07964055e+04
   3.46818451e+02   4.32538382e+04   2.39588143e+04   8.46835705e+03
   2.36538382e+04   2.63233110e+04   1.18405993e+04   2.52605334e+03
   4.77052247e+03   2.12312070e+04   7.00996029e+03   2.51852256e+03
   3.00187857e+02   1.91119787e+04   3.85122635e+03   2.38680901e+02
   2.67887551e+04   1.30595101e+04   2.33878993e+04   4.63887551e+04
   8.51177718e+03   3.42042584e+03   1.30292797e+04   2.59259541e+04
   2.70166133e+03   2.84412425e+03   7.49692391e+03   2.06666092e+04
  -1.36782319e-07   4.20026842e+03   1.04873282e+04   1.87941432e+04
   3.27116090e+04   1.62428258e+04   2.13764055e+04   4.50517622e+04
   1.23402265e+04   4.07961917e+03   1.02229297e+04   2.21320711e+04
   5.41324277e+03   1.87835563e+03   4.90489324e+03   1.56454205e+04
   1.80560657e+03   1.58257753e+03   6.17464865e+03   1.27272254e+04
   4.95367525e-02   3.68766599e+04   1.85406321e+04   1.80441680e+04
   4.09220011e+04   1.58444380e+04   5.01957686e+03   7.17441841e+03
   1.72270969e+04   8.56505324e+03   1.58031790e+03   2.69905091e+03
   1.03531992e+04   4.67155827e+03   4.99047372e-03   2.55315132e+03
   7.10504931e+03   2.58027431e+03   2.78585413e-01   5.16910651e+04
   2.97017144e+04   1.46061294e+04   3.37670250e+04   3.06809802e+04
   1.41458986e+04   5.70745689e+03   1.00980892e+04   2.34134002e+04
   8.06072761e+03   4.07565078e+03   3.23716356e+03   1.95294810e+04
   3.69513849e+03   7.43375345e+02   6.65445476e-02   1.74477684e+04
   1.08038547e+04   5.25632279e+03   3.77688571e+04   2.09780447e+04
   3.05600038e+04   5.73589535e+04   1.52948321e+04   7.64020704e+03
   1.73142558e+04   3.19727086e+04   7.24658745e+03   5.56376711e+03
   1.03346968e+04   2.42539248e+04   2.72941288e+03   5.45783811e+03
   1.19902892e+04   2.02858875e+04   1.47369812e+01   1.20765092e-02
   2.29008469e+03   1.71616777e+04   4.52957192e+04   2.51904690e+04
   2.71415673e+04   5.39466544e+04   2.07816638e+04   9.03237838e+03
   1.34659327e+04   2.61673044e+04   1.16455470e+04   4.90594859e+03
   7.19440364e+03   1.72530777e+04   6.24591823e+03   2.69926916e+03
   6.61180657e+03   1.22664603e+04   2.64919509e+03   1.64788929e+02
   9.56740939e-02   8.74559828e+03   8.42455586e+02   5.51807962e+04
   3.19088950e+04   2.39304999e+04   4.91534819e+04   2.96860320e+04
   1.35142450e+04   1.08867791e+04   2.02236885e+04   2.00269397e+04
   7.26448589e+03   6.17153299e+03   1.07347736e+04   1.42030865e+04
   2.85040827e+03   3.14378180e+03   5.25849161e+03   1.01823346e+04
   4.76619061e+03   1.42823617e+03   1.94966545e+03   7.94440073e+03
   1.89804417e+03   5.91910169e+04   3.50696704e+04   2.17227139e+04
   4.48935445e+04   3.44258020e+04   1.65444853e+04   9.91725818e+03
   1.68195659e+04   2.51557512e+04   9.55627514e+03   6.52134843e+03
   7.75816150e+03   1.96474785e+04   4.34473231e+03   2.52324253e+03
   2.64614094e+03   1.59421615e+04   9.15307413e+03   4.11520608e+03
   2.51686784e-03   1.40201451e+04   5.82048766e+03   3.04547227e-02
   5.00911499e+04   3.00103118e+04   3.74817728e+04   6.75749148e+04
   2.35870043e+04   1.29247638e+04   2.16503959e+04   3.74610430e+04
   1.33896465e+04   9.15456148e+03   1.35518610e+04   2.73806380e+04
   7.12916598e+03   7.37813915e+03   1.36209420e+04   2.14003753e+04
   2.67198815e+03   1.39053979e+03   2.95830786e+03   1.66586869e+04
   9.97556262e-03   3.00800513e+02   6.20355619e+03   1.21402795e+04
   6.26499614e+04   3.92557512e+04   4.31047399e+04   7.56146196e+04
   3.26364322e+04   1.86556823e+04   2.52608554e+04   4.13839838e+04
   2.05676511e+04   1.30862406e+04   1.65345145e+04   2.92471056e+04
   1.27891194e+04   9.51383382e+03   1.48318043e+04   2.15146198e+04
   6.81459052e+03   3.93284290e+03   4.30349739e+03   1.54792414e+04
   2.61174823e+03   9.07894000e+02   4.76104745e+03   1.00102624e+04
   3.16350292e-02   6.21853888e+04   3.75870473e+04   3.27847638e+04
   6.17591456e+04   3.35880602e+04   1.69826014e+04   1.71075117e+04
   2.91898168e+04   2.22744860e+04   1.03013743e+04   1.05984958e+04
   1.78828219e+04   1.51085590e+04   5.51949324e+03   7.39923804e+03
   1.08574401e+04   9.74635239e+03   4.69265899e+03   2.32696561e+03
   5.99461132e+03   6.15744160e+03   1.01677323e+03   1.43817606e-02
   2.31680073e+03   3.41895495e+03   1.49134652e+03   6.96429328e+04
   4.31454801e+04   3.10097159e+04   5.82057254e+04   4.09633182e+04
   2.14389468e+04   1.62561036e+04   2.55398691e+04   2.96058639e+04
   1.33982491e+04   1.11400414e+04   1.41846551e+04   2.24043425e+04
   7.18789703e+03   6.31411863e+03   7.11818822e+03   1.70065579e+04
   9.89573319e+03   5.19444639e+03   2.69125908e+03   1.33789972e+04
   5.14817244e+03   3.03829890e-02   3.06775629e-02   1.00144175e+04
   6.78743715e+03   6.46797183e+02   7.16609760e+04   4.75138186e+04
   5.53232921e+04   9.12609760e+04   3.90945507e+04   2.52849519e+04
   3.51320290e+04   5.40356059e+04   2.56644051e+04   1.96052878e+04
   2.46681103e+04   4.04027492e+04   1.67815693e+04   1.59878813e+04
   2.31188579e+04   3.13956111e+04   9.70324554e+03   7.49505925e+03
   9.09455435e+03   2.39949012e+04   4.38928521e+03   3.99620255e+03
   1.00739048e+04   1.69164314e+04   1.06556914e+03   1.27768982e-02
   5.03351058e+03   1.21715982e+04   7.08293405e+04   4.49429519e+04
   4.33745506e+04   7.60818336e+04   3.91643158e+04   2.21666932e+04
   2.50808460e+04   3.99138724e+04   2.62148536e+04   1.50758326e+04
   1.67800685e+04   2.68092299e+04   1.77219358e+04   9.94815786e+03
   1.34316707e+04   1.82521580e+04   1.10333503e+04   6.36407564e+03
   4.98947055e+03   1.18467794e+04   6.10868113e+03   1.90276181e+03
   2.69992108e+03   6.44720666e+03   2.39131994e+03   2.73923136e-01
   1.61926831e-02   3.11570805e+03   1.76784324e+03   7.69007707e+04
   4.90768781e+04   4.01172263e+04   7.10646354e+04   4.51185921e+04
   2.51605495e+04   2.27300829e+04   3.47592442e+04   3.21066562e+04
   1.66883840e+04   1.58202510e+04   2.15859504e+04   2.35630613e+04
   1.01102288e+04   1.08228219e+04   1.29703840e+04   1.68238220e+04
   1.00754482e+04   6.34642268e+03   6.98945233e+03   1.18452846e+04
   4.52014840e+03   1.15329206e+03   2.57004842e+03   7.48306304e+03
   3.77098326e+03   3.01062908e-02   1.43759067e-02   7.38445090e+03
   6.69050469e+02   8.04409953e+04   5.18603130e+04   3.41247043e+04
   6.08409953e+04   5.07740461e+04   2.85206157e+04   1.94184020e+04
   2.70169232e+04   3.88900831e+04   1.91412648e+04   1.50152873e+04
   1.50831384e+04   3.12614713e+04   1.15495226e+04   8.68917426e+03
   7.52369870e+03   2.54367931e+04   1.65994531e+04   1.01031363e+04
   3.02743575e+03   2.13767960e+04   1.06588714e+04   2.35364733e+03
   7.06324863e+02   1.71603483e+04   1.26324744e+04   3.84860688e+03
   5.09229078e-01   1.91365631e+04   7.18545851e+03   1.74871660e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 11.2075281143 s
|dj| = 12420.4845296
Runtime: 11.2584478855 s
|dj| = 12420.4845296
Start evaluation of j
Updating the turbine cache
   40    75    -3.106268E+04     2.775559E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.526e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.950e-02 (tol = 1.000e-10) r (rel) = 1.278e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 7.534e-06 (tol = 1.000e-10) r (rel) = 4.937e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.780e-12 (tol = 1.000e-10) r (rel) = 2.476e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 24.742118 s.
j = 1.389907e+06.
Runtime: 24.720059 s.
j = 1.389907e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19262413e+03   1.65538600e+04   7.84728472e+03   1.87000000e+04
   1.51436330e+04   3.53452118e+03   3.80994518e+03   3.39896890e-01
   1.27116682e+04   2.34099452e+04   1.29522754e+04   3.05492520e+03
   7.91779279e+03   2.22731415e+04   2.31349948e+03   2.21555549e+04
   9.17822238e+03   1.60156913e+03   1.26597541e+04   1.16691498e+04
   3.61739250e+03   2.52532708e+04   1.35552896e+04   7.86935265e-03
   5.65327076e+03   1.88518621e+04   1.07216293e+04   1.28797271e+03
   1.04211523e+04   2.81271690e+03   1.46159736e+04   3.00211523e+04
   5.26713666e+02   4.77119519e+02   9.91663119e+03   1.93476327e+04
   2.06491774e+04   7.45297159e+03   8.61161544e+03   2.52822036e+04
   6.59342634e+03   4.16655648e-02   2.32246225e+03   9.70015399e+03
   2.87642093e+03   2.45853743e+04   1.00634886e+04   5.27256899e+03
   2.01621262e+04   1.08167951e+04   2.02939338e+03   3.10084160e-03
   4.91881397e+03   7.25784262e+03   1.50501085e+02   3.32673693e+04
   1.75723065e+04   3.06156321e+03   1.36673693e+04   2.14109014e+04
   9.84728220e+03   5.01863540e+02   6.79512641e+02   1.89043314e+04
   6.84703630e+03   2.23199757e+03   1.77052074e+04   7.07958127e+03
   1.81616093e+04   3.73052074e+04   3.69302590e+03   1.05174550e+03
   1.05578634e+04   2.17745508e+04   1.91663887e-04   1.95737505e+03
   6.46432900e+03   1.89466643e+04   3.00551699e+04   1.35849104e+04
   1.08608870e+04   2.97039205e+04   1.26849133e+04   2.69840518e+03
   2.68190219e+03   1.02122029e+04   7.14367948e+03   1.14040611e-05
   4.18428697e-02   5.43965484e+03   4.77575461e+03   3.49055045e+04
   1.72042906e+04   8.09390946e+03   2.47592923e+04   1.81226940e+04
   5.93745882e+03   1.20970486e+03   5.96050440e+03   1.29047771e+04
   2.28078650e+03   1.48070594e-02   1.52814638e+03   1.07936442e+04
   3.42058260e+02   4.32993795e+04   2.39689506e+04   8.58921016e+03
   2.36993795e+04   2.64815074e+04   1.17952059e+04   2.53004007e+03
   4.85923423e+03   2.12442934e+04   6.99525809e+03   2.53147122e+03
   4.06572048e+02   1.91178339e+04   3.84214494e+03   2.40041065e+02
   2.67892618e+04   1.31464453e+04   2.35072447e+04   4.63892618e+04
   8.65933790e+03   3.42637152e+03   1.29990957e+04   2.60014688e+04
   2.70000038e+03   2.83832937e+03   7.47081556e+03   2.07889972e+04
  -1.06994094e-07   4.20783009e+03   1.04825116e+04   1.87913747e+04
   3.26405437e+04   1.62641647e+04   2.14345209e+04   4.49458840e+04
   1.24685787e+04   4.03753604e+03   1.01417303e+04   2.21493749e+04
   5.38534822e+03   1.83641106e+03   4.84588399e+03   1.57543573e+04
   1.79270477e+03   1.55987910e+03   6.13917939e+03   1.26812030e+04
   6.17840994e-02   3.69594703e+04   1.86583638e+04   1.82221490e+04
   4.09902359e+04   1.60761676e+04   5.02763042e+03   7.17139425e+03
   1.73546592e+04   8.60143297e+03   1.57893668e+03   2.69844174e+03
   1.05477058e+04   4.69784047e+03   4.55444615e-04   2.55608104e+03
   7.09989393e+03   2.59424848e+03   1.81933090e-01   5.18496527e+04
   2.98262475e+04   1.47920734e+04   3.38402521e+04   3.09883101e+04
   1.41741603e+04   5.73791407e+03   1.02305786e+04   2.35256618e+04
   8.09769836e+03   4.12465154e+03   3.43634230e+03   1.96316687e+04
   3.72408436e+03   7.71586074e+02   9.66528102e-02   1.75376762e+04
   1.08469540e+04   5.29605785e+03   3.76736676e+04   2.10067729e+04
   3.06197512e+04   5.72335592e+04   1.54258856e+04   7.59064317e+03
   1.72107227e+04   3.19884933e+04   7.20017270e+03   5.50409091e+03
   1.02528467e+04   2.43913698e+04   2.70012159e+03   5.41957233e+03
   1.19410310e+04   2.02248943e+04   7.10540122e-02   1.08434757e-03
   2.27476371e+03   1.72052402e+04   4.53780427e+04   2.53375322e+04
   2.73541254e+04   5.40209668e+04   2.10532164e+04   9.04801502e+03
   1.34613615e+04   2.63258963e+04   1.16843454e+04   4.90249914e+03
   7.19245644e+03   1.75259562e+04   6.27635014e+03   2.69905550e+03
   6.62220436e+03   1.22655129e+04   2.66835552e+03   1.86505023e+02
   8.48030424e-04   8.79726383e+03   8.49144917e+02   5.51921690e+04
   3.19680359e+04   2.40676367e+04   4.91140072e+04   2.99301966e+04
   1.34749559e+04   1.08370894e+04   2.03135139e+04   2.00455418e+04
   7.22903770e+03   6.14659028e+03   1.09708725e+04   1.42278892e+04
   2.82406315e+03   3.12727480e+03   5.21683957e+03   1.02102374e+04
   4.78581144e+03   1.42112278e+03   1.94365263e+03   7.96629585e+03
   1.91077927e+03   5.93146663e+04   3.51930512e+04   2.19277937e+04
   4.49557560e+04   3.47447295e+04   1.65536514e+04   9.92969070e+03
   1.69715622e+04   2.52409553e+04   9.56848630e+03   6.55186186e+03
   8.02967868e+03   1.97258142e+04   4.35411680e+03   2.54504847e+03
   2.64013702e+03   1.60106738e+04   9.19531699e+03   4.13493618e+03
   8.97584607e-03   1.40607794e+04   5.85171429e+03   4.78248542e-02
   4.99983165e+04   3.00564977e+04   3.76020790e+04   6.74928783e+04
   2.37591439e+04   1.28701641e+04   2.15634127e+04   3.75397159e+04
   1.33366604e+04   9.08878495e+03   1.34820733e+04   2.76311778e+04
   7.09184159e+03   7.33723956e+03   1.35915435e+04   2.13624589e+04
   2.64702358e+03   1.39736753e+03   2.93476017e+03   1.67133117e+04
   2.28689154e-02   2.93901646e+02   6.23835600e+03   1.21897808e+04
   6.25671532e+04   3.93141288e+04   4.32714729e+04   7.55651061e+04
   3.28498832e+04   1.85926934e+04   2.51837528e+04   4.15093088e+04
   2.05131339e+04   1.30119282e+04   1.64724089e+04   2.95866042e+04
   1.27479248e+04   9.46482773e+03   1.48124594e+04   2.14859907e+04
   6.78271653e+03   3.94231344e+03   4.26788792e+03   1.55263332e+04
   2.61068210e+03   8.85376790e+02   4.79516250e+03   1.00522272e+04
   9.02167822e-03   6.22041324e+04   3.76774221e+04   3.29441516e+04
   6.17187360e+04   3.38698029e+04   1.69473869e+04   1.70438397e+04
   2.92942039e+04   2.22941925e+04   1.02558268e+04   1.05591244e+04
   1.81723603e+04   1.51335119e+04   5.48092465e+03   7.37320824e+03
   1.08001338e+04   9.77283222e+03   4.72312954e+03   2.30698851e+03
   5.98120826e+03   6.19154745e+03   1.01614159e+03   1.56729670e-03
   2.30719699e+03   3.45645609e+03   1.52040181e+03   6.96896323e+04
   4.32335185e+04   3.12249815e+04   5.82485110e+04   4.12582342e+04
   2.14018830e+04   1.62409715e+04   2.57094805e+04   2.96291995e+04
   1.33649416e+04   1.11401257e+04   1.45314245e+04   2.24260871e+04
   7.16286552e+03   6.32367913e+03   7.10807253e+03   1.70229756e+04
   9.91349867e+03   5.17742646e+03   2.69202564e+03   1.33880482e+04
   5.14013475e+03   4.78226293e-02   4.78233101e-02   1.00346029e+04
   6.80598337e+03   6.31468328e+02   7.16604405e+04   4.76616665e+04
   5.55469799e+04   9.12604405e+04   3.93971144e+04   2.52686572e+04
   3.50699951e+04   5.42014097e+04   2.56590737e+04   1.95538585e+04
   2.46172113e+04   4.08042838e+04   1.67809000e+04   1.59503460e+04
   2.31064190e+04   3.13626766e+04   9.70272725e+03   7.53895431e+03
   9.06586507e+03   2.40422411e+04   4.42445214e+03   3.97638360e+03
   1.01121916e+04   1.69509433e+04   1.08280754e+03   3.74954554e-02
   5.06508738e+03   1.21695912e+04   7.06745026e+04   4.49268866e+04
   4.34825150e+04   7.59462658e+04   3.93412230e+04   2.20409418e+04
   2.49494384e+04   3.99842834e+04   2.61150587e+04   1.49500270e+04
   1.66748113e+04   2.71257475e+04   1.76434388e+04   9.85192922e+03
   1.33697844e+04   1.81739906e+04   1.09718198e+04   6.34334546e+03
   4.91599670e+03   1.18341658e+04   6.08544960e+03   1.85212325e+03
   2.69966173e+03   6.44333911e+03   2.38297220e+03   1.87474930e-02
   1.44663257e-01   3.10973687e+03   1.76451442e+03   7.69701768e+04
   4.92114857e+04   4.03700775e+04   7.11218209e+04   4.54664215e+04
   2.51428950e+04   2.27163028e+04   3.49587516e+04   3.21464313e+04
   1.66603117e+04   1.58212408e+04   2.20014933e+04   2.36002909e+04
   1.00883081e+04   1.08381936e+04   1.29599478e+04   1.68541515e+04
   1.01193978e+04   6.33187325e+03   6.99816233e+03   1.18818808e+04
   4.51407814e+03   1.16863045e+03   2.57577805e+03   7.52128406e+03
   3.79980374e+03   4.78223734e-02   1.56766270e-03   7.39106805e+03
   6.78800869e+02   8.04965639e+04   5.19388373e+04   3.43534053e+04
   6.08965639e+04   5.10856399e+04   2.84733360e+04   1.94118682e+04
   2.72021209e+04   3.89174965e+04   1.91053790e+04   1.50255001e+04
   1.54568213e+04   3.12862012e+04   1.15212441e+04   8.70447192e+03
   7.51755853e+03   2.54549068e+04   1.66148170e+04   1.00825506e+04
   3.01211080e+03   2.13834365e+04   1.06473426e+04   2.34583850e+03
   6.94288925e+02   1.71850804e+04   1.26588913e+04   3.82182872e+03
   6.57065082e-04   1.91318627e+04   7.18651635e+03   1.74457194e+03]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  2.19262413e+03   1.65538600e+04   7.84728472e+03   1.87000000e+04
   1.51436330e+04   3.53452118e+03   3.80994518e+03   3.39896890e-01
   1.27116682e+04   2.34099452e+04   1.29522754e+04   3.05492520e+03
   7.91779279e+03   2.22731415e+04   2.31349948e+03   2.21555549e+04
   9.17822238e+03   1.60156913e+03   1.26597541e+04   1.16691498e+04
   3.61739250e+03   2.52532708e+04   1.35552896e+04   7.86935265e-03
   5.65327076e+03   1.88518621e+04   1.07216293e+04   1.28797271e+03
   1.04211523e+04   2.81271690e+03   1.46159736e+04   3.00211523e+04
   5.26713666e+02   4.77119519e+02   9.91663119e+03   1.93476327e+04
   2.06491774e+04   7.45297159e+03   8.61161544e+03   2.52822036e+04
   6.59342634e+03   4.16655648e-02   2.32246225e+03   9.70015399e+03
   2.87642093e+03   2.45853743e+04   1.00634886e+04   5.27256899e+03
   2.01621262e+04   1.08167951e+04   2.02939338e+03   3.10084160e-03
   4.91881397e+03   7.25784262e+03   1.50501085e+02   3.32673693e+04
   1.75723065e+04   3.06156321e+03   1.36673693e+04   2.14109014e+04
   9.84728220e+03   5.01863540e+02   6.79512641e+02   1.89043314e+04
   6.84703630e+03   2.23199757e+03   1.77052074e+04   7.07958127e+03
   1.81616093e+04   3.73052074e+04   3.69302590e+03   1.05174550e+03
   1.05578634e+04   2.17745508e+04   1.91663887e-04   1.95737505e+03
   6.46432900e+03   1.89466643e+04   3.00551699e+04   1.35849104e+04
   1.08608870e+04   2.97039205e+04   1.26849133e+04   2.69840518e+03
   2.68190219e+03   1.02122029e+04   7.14367948e+03   1.14040611e-05
   4.18428697e-02   5.43965484e+03   4.77575461e+03   3.49055045e+04
   1.72042906e+04   8.09390946e+03   2.47592923e+04   1.81226940e+04
   5.93745882e+03   1.20970486e+03   5.96050440e+03   1.29047771e+04
   2.28078650e+03   1.48070594e-02   1.52814638e+03   1.07936442e+04
   3.42058260e+02   4.32993795e+04   2.39689506e+04   8.58921016e+03
   2.36993795e+04   2.64815074e+04   1.17952059e+04   2.53004007e+03
   4.85923423e+03   2.12442934e+04   6.99525809e+03   2.53147122e+03
   4.06572048e+02   1.91178339e+04   3.84214494e+03   2.40041065e+02
   2.67892618e+04   1.31464453e+04   2.35072447e+04   4.63892618e+04
   8.65933790e+03   3.42637152e+03   1.29990957e+04   2.60014688e+04
   2.70000038e+03   2.83832937e+03   7.47081556e+03   2.07889972e+04
  -1.06994094e-07   4.20783009e+03   1.04825116e+04   1.87913747e+04
   3.26405437e+04   1.62641647e+04   2.14345209e+04   4.49458840e+04
   1.24685787e+04   4.03753604e+03   1.01417303e+04   2.21493749e+04
   5.38534822e+03   1.83641106e+03   4.84588399e+03   1.57543573e+04
   1.79270477e+03   1.55987910e+03   6.13917939e+03   1.26812030e+04
   6.17840994e-02   3.69594703e+04   1.86583638e+04   1.82221490e+04
   4.09902359e+04   1.60761676e+04   5.02763042e+03   7.17139425e+03
   1.73546592e+04   8.60143297e+03   1.57893668e+03   2.69844174e+03
   1.05477058e+04   4.69784047e+03   4.55444615e-04   2.55608104e+03
   7.09989393e+03   2.59424848e+03   1.81933090e-01   5.18496527e+04
   2.98262475e+04   1.47920734e+04   3.38402521e+04   3.09883101e+04
   1.41741603e+04   5.73791407e+03   1.02305786e+04   2.35256618e+04
   8.09769836e+03   4.12465154e+03   3.43634230e+03   1.96316687e+04
   3.72408436e+03   7.71586074e+02   9.66528102e-02   1.75376762e+04
   1.08469540e+04   5.29605785e+03   3.76736676e+04   2.10067729e+04
   3.06197512e+04   5.72335592e+04   1.54258856e+04   7.59064317e+03
   1.72107227e+04   3.19884933e+04   7.20017270e+03   5.50409091e+03
   1.02528467e+04   2.43913698e+04   2.70012159e+03   5.41957233e+03
   1.19410310e+04   2.02248943e+04   7.10540122e-02   1.08434757e-03
   2.27476371e+03   1.72052402e+04   4.53780427e+04   2.53375322e+04
   2.73541254e+04   5.40209668e+04   2.10532164e+04   9.04801502e+03
   1.34613615e+04   2.63258963e+04   1.16843454e+04   4.90249914e+03
   7.19245644e+03   1.75259562e+04   6.27635014e+03   2.69905550e+03
   6.62220436e+03   1.22655129e+04   2.66835552e+03   1.86505023e+02
   8.48030424e-04   8.79726383e+03   8.49144917e+02   5.51921690e+04
   3.19680359e+04   2.40676367e+04   4.91140072e+04   2.99301966e+04
   1.34749559e+04   1.08370894e+04   2.03135139e+04   2.00455418e+04
   7.22903770e+03   6.14659028e+03   1.09708725e+04   1.42278892e+04
   2.82406315e+03   3.12727480e+03   5.21683957e+03   1.02102374e+04
   4.78581144e+03   1.42112278e+03   1.94365263e+03   7.96629585e+03
   1.91077927e+03   5.93146663e+04   3.51930512e+04   2.19277937e+04
   4.49557560e+04   3.47447295e+04   1.65536514e+04   9.92969070e+03
   1.69715622e+04   2.52409553e+04   9.56848630e+03   6.55186186e+03
   8.02967868e+03   1.97258142e+04   4.35411680e+03   2.54504847e+03
   2.64013702e+03   1.60106738e+04   9.19531699e+03   4.13493618e+03
   8.97584607e-03   1.40607794e+04   5.85171429e+03   4.78248542e-02
   4.99983165e+04   3.00564977e+04   3.76020790e+04   6.74928783e+04
   2.37591439e+04   1.28701641e+04   2.15634127e+04   3.75397159e+04
   1.33366604e+04   9.08878495e+03   1.34820733e+04   2.76311778e+04
   7.09184159e+03   7.33723956e+03   1.35915435e+04   2.13624589e+04
   2.64702358e+03   1.39736753e+03   2.93476017e+03   1.67133117e+04
   2.28689154e-02   2.93901646e+02   6.23835600e+03   1.21897808e+04
   6.25671532e+04   3.93141288e+04   4.32714729e+04   7.55651061e+04
   3.28498832e+04   1.85926934e+04   2.51837528e+04   4.15093088e+04
   2.05131339e+04   1.30119282e+04   1.64724089e+04   2.95866042e+04
   1.27479248e+04   9.46482773e+03   1.48124594e+04   2.14859907e+04
   6.78271653e+03   3.94231344e+03   4.26788792e+03   1.55263332e+04
   2.61068210e+03   8.85376790e+02   4.79516250e+03   1.00522272e+04
   9.02167822e-03   6.22041324e+04   3.76774221e+04   3.29441516e+04
   6.17187360e+04   3.38698029e+04   1.69473869e+04   1.70438397e+04
   2.92942039e+04   2.22941925e+04   1.02558268e+04   1.05591244e+04
   1.81723603e+04   1.51335119e+04   5.48092465e+03   7.37320824e+03
   1.08001338e+04   9.77283222e+03   4.72312954e+03   2.30698851e+03
   5.98120826e+03   6.19154745e+03   1.01614159e+03   1.56729670e-03
   2.30719699e+03   3.45645609e+03   1.52040181e+03   6.96896323e+04
   4.32335185e+04   3.12249815e+04   5.82485110e+04   4.12582342e+04
   2.14018830e+04   1.62409715e+04   2.57094805e+04   2.96291995e+04
   1.33649416e+04   1.11401257e+04   1.45314245e+04   2.24260871e+04
   7.16286552e+03   6.32367913e+03   7.10807253e+03   1.70229756e+04
   9.91349867e+03   5.17742646e+03   2.69202564e+03   1.33880482e+04
   5.14013475e+03   4.78226293e-02   4.78233101e-02   1.00346029e+04
   6.80598337e+03   6.31468328e+02   7.16604405e+04   4.76616665e+04
   5.55469799e+04   9.12604405e+04   3.93971144e+04   2.52686572e+04
   3.50699951e+04   5.42014097e+04   2.56590737e+04   1.95538585e+04
   2.46172113e+04   4.08042838e+04   1.67809000e+04   1.59503460e+04
   2.31064190e+04   3.13626766e+04   9.70272725e+03   7.53895431e+03
   9.06586507e+03   2.40422411e+04   4.42445214e+03   3.97638360e+03
   1.01121916e+04   1.69509433e+04   1.08280754e+03   3.74954554e-02
   5.06508738e+03   1.21695912e+04   7.06745026e+04   4.49268866e+04
   4.34825150e+04   7.59462658e+04   3.93412230e+04   2.20409418e+04
   2.49494384e+04   3.99842834e+04   2.61150587e+04   1.49500270e+04
   1.66748113e+04   2.71257475e+04   1.76434388e+04   9.85192922e+03
   1.33697844e+04   1.81739906e+04   1.09718198e+04   6.34334546e+03
   4.91599670e+03   1.18341658e+04   6.08544960e+03   1.85212325e+03
   2.69966173e+03   6.44333911e+03   2.38297220e+03   1.87474930e-02
   1.44663257e-01   3.10973687e+03   1.76451442e+03   7.69701768e+04
   4.92114857e+04   4.03700775e+04   7.11218209e+04   4.54664215e+04
   2.51428950e+04   2.27163028e+04   3.49587516e+04   3.21464313e+04
   1.66603117e+04   1.58212408e+04   2.20014933e+04   2.36002909e+04
   1.00883081e+04   1.08381936e+04   1.29599478e+04   1.68541515e+04
   1.01193978e+04   6.33187325e+03   6.99816233e+03   1.18818808e+04
   4.51407814e+03   1.16863045e+03   2.57577805e+03   7.52128406e+03
   3.79980374e+03   4.78223734e-02   1.56766270e-03   7.39106805e+03
   6.78800869e+02   8.04965639e+04   5.19388373e+04   3.43534053e+04
   6.08965639e+04   5.10856399e+04   2.84733360e+04   1.94118682e+04
   2.72021209e+04   3.89174965e+04   1.91053790e+04   1.50255001e+04
   1.54568213e+04   3.12862012e+04   1.15212441e+04   8.70447192e+03
   7.51755853e+03   2.54549068e+04   1.66148170e+04   1.00825506e+04
   3.01211080e+03   2.13834365e+04   1.06473426e+04   2.34583850e+03
   6.94288925e+02   1.71850804e+04   1.26588913e+04   3.82182872e+03
   6.57065082e-04   1.91318627e+04   7.18651635e+03   1.74457194e+03]
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.586e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.891e-03 (tol = 1.000e-10) r (rel) = 8.231e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.169e-06 (tol = 1.000e-10) r (rel) = 1.220e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.022e-13 (tol = 1.000e-10) r (rel) = 6.282e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 16.985220 s.
j = 1.390107e+06.
End of time loop.
Runtime: 16.968211 s.
j = 1.390107e+06.
Minimum distance inequality constraints (should all be > 0): [  2.20097122e+03   1.65862767e+04   7.88696852e+03   1.87000000e+04
   1.52169597e+04   3.57699273e+03   3.87657058e+03   1.69964233e-01
   1.27053160e+04   2.34765706e+04   1.29260641e+04   3.02517793e+03
   7.89737690e+03   2.22893352e+04   2.25508015e+03   2.21425411e+04
   9.18724438e+03   1.55878085e+03   1.26352204e+04   1.16291259e+04
   3.64338160e+03   2.52990828e+04   1.36148774e+04   6.01336050e-02
   5.69908283e+03   1.88469429e+04   1.07314460e+04   1.26253647e+03
   1.04190609e+04   2.77917431e+03   1.45780685e+04   3.00190609e+04
   4.89674401e+02   4.65399615e+02   9.92443540e+03   1.93328412e+04
   2.06061164e+04   7.40688756e+03   8.54324096e+03   2.52512399e+04
   6.50417389e+03   4.53139454e-02   2.32873521e+03   9.66062044e+03
   2.86388761e+03   2.45768806e+04   1.00559447e+04   5.20808179e+03
   2.01341704e+04   1.07551789e+04   2.05075625e+03   7.55495911e-03
   4.87294455e+03   7.26605017e+03   1.57537975e+02   3.34777832e+04
   1.77220911e+04   3.12685505e+03   1.38777832e+04   2.14511250e+04
   9.89607722e+03   5.19113284e+02   7.26441707e+02   1.89302148e+04
   6.82319380e+03   2.19904607e+03   1.77049416e+04   7.03546947e+03
   1.81048359e+04   3.73049416e+04   3.62756654e+03   1.04392839e+03
   1.05713807e+04   2.17431986e+04   5.31534410e-01   1.95268888e+03
   6.47653243e+03   1.89201077e+04   3.00039466e+04   1.35296195e+04
   1.07701043e+04   2.96652776e+04   1.25639594e+04   2.69874068e+03
   2.68332690e+03   1.01511384e+04   7.12318364e+03   9.93402736e-04
   5.52880860e-02   5.36587168e+03   4.76260073e+03   3.49009870e+04
   1.71991231e+04   8.02717640e+03   2.47512821e+04   1.80364849e+04
   5.96428389e+03   1.21641749e+03   5.91356495e+03   1.29061169e+04
   2.29136131e+03   1.68825823e-02   1.46410943e+03   1.07954105e+04
   3.45094274e+02   4.32702379e+04   2.39623896e+04   8.51179017e+03
   2.36702379e+04   2.63801082e+04   1.18242347e+04   2.52748845e+03
   4.80239826e+03   2.12359170e+04   7.00466203e+03   2.52318395e+03
   3.37988346e+02   1.91140831e+04   3.84795276e+03   2.39168000e+02
   2.67889376e+04   1.30907740e+04   2.34308280e+04   4.63889376e+04
   8.56479821e+03   3.42255214e+03   1.30184008e+04   2.59531102e+04
   2.70106299e+03   2.84202482e+03   7.48751346e+03   2.07102693e+04
  -1.26052555e-07   4.20298031e+03   1.04855928e+04   1.87931412e+04
   3.26859963e+04   1.62504976e+04   2.13973181e+04   4.50136094e+04
   1.23863893e+04   4.06443386e+03   1.01936415e+04   2.21382886e+04
   5.40317914e+03   1.86320259e+03   4.88359938e+03   1.56843558e+04
   1.80094493e+03   1.57435766e+03   6.16185305e+03   1.27106143e+04
   3.97096580e-02   3.69064788e+04   1.85829593e+04   1.81081606e+04
   4.09465697e+04   1.59276958e+04   5.02246765e+03   7.17332527e+03
   1.72729491e+04   8.57814863e+03   1.57982027e+03   2.69882374e+03
   1.04226985e+04   4.68101514e+03   3.25194169e-03   2.55419874e+03
   7.10319078e+03   2.58529767e+03   2.01841744e-01   5.17481592e+04
   2.97465131e+04   1.46729763e+04   3.37933712e+04   3.07914496e+04
   1.41560754e+04   5.71839588e+03   1.01456955e+04   2.34538085e+04
   8.07403193e+03   4.09326032e+03   3.30832536e+03   1.95662593e+04
   3.70555245e+03   7.53506277e+02   5.51153826e-02   1.74801233e+04
   1.08193315e+04   5.27062115e+03   3.77345524e+04   2.09883773e+04
   3.05815084e+04   5.73137686e+04   1.53419758e+04   7.62232177e+03
   1.72769191e+04   3.19783826e+04   7.22985028e+03   5.54222138e+03
   1.03051725e+04   2.43031449e+04   2.71884540e+03   5.44400517e+03
   1.19725242e+04   2.02638797e+04   9.43774869e+00   7.86709119e-03
   2.28451872e+03   1.71773142e+04   4.53253647e+04   2.52433622e+04
   2.72180205e+04   5.39734142e+04   2.08792744e+04   9.03799930e+03
   1.34642838e+04   2.62243393e+04   1.16595156e+04   4.90470549e+03
   7.19369673e+03   1.73508204e+04   6.25687188e+03   2.69919161e+03
   6.61554602e+03   1.22661184e+04   2.65608860e+03   1.72571791e+02
   6.13210623e-02   8.76419123e+03   8.44820789e+02   5.51848846e+04
   3.19301764e+04   2.39798459e+04   4.91392544e+04   2.97738608e+04
   1.35000863e+04   1.08688568e+04   2.02560019e+04   2.00336318e+04
   7.25169719e+03   6.16252233e+03   1.08194180e+04   1.42120126e+04
   2.84089900e+03   3.13782475e+03   5.24347160e+03   1.01923773e+04
   4.77325137e+03   1.42565477e+03   1.94748091e+03   7.95227788e+03
   1.90261290e+03   5.92355397e+04   3.51140592e+04   2.17964750e+04
   4.49159365e+04   3.45404771e+04   1.65477862e+04   9.92171795e+03
   1.68742210e+04   2.51864265e+04   9.56066776e+03   6.53231446e+03
   7.85542000e+03   1.96756787e+04   4.34810696e+03   2.53108030e+03
   2.64396707e+03   1.59668232e+04   9.16825537e+03   4.12230627e+03
   2.77490528e-03   1.40347410e+04   5.83172737e+03   2.56899974e-02
   5.00577001e+04   3.00269094e+04   3.75250851e+04   6.75453542e+04
   2.36489408e+04   1.29050567e+04   2.16190339e+04   3.74893687e+04
   1.33705487e+04   9.13082383e+03   1.35266974e+04   2.74705789e+04
   7.11571113e+03   7.36336276e+03   1.36103389e+04   2.13866888e+04
   2.66298546e+03   1.39299310e+03   2.94978483e+03   1.66782974e+04
   9.34954189e-03   2.98278662e+02   6.21607488e+03   1.21580637e+04
   6.26201241e+04   3.92767212e+04   4.31647630e+04   7.55967755e+04
   3.27132332e+04   1.86329482e+04   2.52330598e+04   4.14291051e+04
   2.05480034e+04   1.30594321e+04   1.65121262e+04   2.93690602e+04
   1.27742717e+04   9.49614111e+03   1.48248255e+04   2.15042833e+04
   6.80310027e+03   3.93623985e+03   4.29063371e+03   1.54961332e+04
   2.61135054e+03   8.99750848e+02   4.77331285e+03   1.00253289e+04
   2.14102579e-02   6.21921301e+04   3.76195786e+04   3.28421174e+04
   6.17445791e+04   3.36894138e+04   1.69699127e+04   1.70845516e+04
   2.92273680e+04   2.22815739e+04   1.02849490e+04   1.05842854e+04
   1.79866972e+04   1.51175370e+04   5.50558228e+03   7.38984868e+03
   1.08367808e+04   9.75588033e+03   4.70362483e+03   2.31975150e+03
   5.98976914e+03   6.16971352e+03   1.01652753e+03   9.40460938e-03
   2.31333308e+03   3.43244146e+03   1.50178360e+03   6.96597526e+04
   4.31771296e+04   3.10871738e+04   5.82211354e+04   4.10693856e+04
   2.14255844e+04   1.62506505e+04   2.56009001e+04   2.96142684e+04
   1.33862468e+04   1.11400681e+04   1.43090828e+04   2.24121734e+04
   7.17887587e+03   6.31756150e+03   7.11454368e+03   1.70124699e+04
   9.90210844e+03   5.18831214e+03   2.69151261e+03   1.33822300e+04
   5.14527485e+03   2.56438047e-02   2.58323631e-02   1.00216679e+04
   6.79409993e+03   6.41263554e+02   7.16607831e+04   4.75670245e+04
   5.54038068e+04   9.12607831e+04   3.92034067e+04   2.52790668e+04
   3.51096772e+04   5.40952858e+04   2.56624846e+04   1.95867500e+04
   2.46497698e+04   4.05469631e+04   1.67813282e+04   1.59743484e+04
   2.31143769e+04   3.13837427e+04   9.70305884e+03   7.51085683e+03
   9.08420954e+03   2.40119223e+04   4.40193670e+03   3.98905496e+03
   1.00876881e+04   1.69288456e+04   1.07176875e+03   1.30396370e-02
   5.04487455e+03   1.21708733e+04   7.07735466e+04   4.49371220e+04
   4.34134251e+04   7.60329810e+04   3.92279870e+04   2.21213399e+04
   2.50334680e+04   3.99392283e+04   2.61788848e+04   1.50304536e+04
   1.67421163e+04   2.69229756e+04   1.76936406e+04   9.91343320e+03
   1.34093547e+04   1.82239581e+04   1.10111667e+04   6.35659871e+03
   4.96294609e+03   1.18421489e+04   6.10030528e+03   1.88446791e+03
   2.69980089e+03   6.44574843e+03   2.38831140e+03   1.77685007e-01
   2.91304018e-02   3.11352376e+03   1.76662496e+03   7.69257681e+04
   4.91253021e+04   4.02082160e+04   7.10852308e+04   4.52437089e+04
   2.51541815e+04   2.27251162e+04   3.48310372e+04   3.21209809e+04
   1.66782694e+04   1.58206022e+04   2.17351331e+04   2.35764684e+04
   1.01023301e+04   1.08283566e+04   1.29666241e+04   1.68347436e+04
   1.00912528e+04   6.34117990e+03   6.99257221e+03   1.18584364e+04
   4.51796054e+03   1.15880636e+03   2.57210464e+03   7.49680545e+03
   3.78134184e+03   2.54667410e-02   9.40091133e-03   7.38683086e+03
   6.72523310e+02   8.04610090e+04   5.18885291e+04   3.42069955e+04
   6.08610090e+04   5.08861127e+04   2.85035720e+04   1.94160471e+04
   2.70835633e+04   3.88999556e+04   1.91283346e+04   1.50189634e+04
   1.52172463e+04   3.12703765e+04   1.15393326e+04   8.69468325e+03
   7.52148667e+03   2.54433151e+04   1.66049594e+04   1.00957184e+04
   3.02189203e+03   2.13791564e+04   1.06547170e+04   2.35082084e+03
   7.01977608e+02   1.71692337e+04   1.26419706e+04   3.83894651e+03
   3.25883389e-01   1.91348670e+04   7.18580287e+03   1.74722319e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.20097122e+03   1.65862767e+04   7.88696852e+03   1.87000000e+04
   1.52169597e+04   3.57699273e+03   3.87657058e+03   1.69964233e-01
   1.27053160e+04   2.34765706e+04   1.29260641e+04   3.02517793e+03
   7.89737690e+03   2.22893352e+04   2.25508015e+03   2.21425411e+04
   9.18724438e+03   1.55878085e+03   1.26352204e+04   1.16291259e+04
   3.64338160e+03   2.52990828e+04   1.36148774e+04   6.01336050e-02
   5.69908283e+03   1.88469429e+04   1.07314460e+04   1.26253647e+03
   1.04190609e+04   2.77917431e+03   1.45780685e+04   3.00190609e+04
   4.89674401e+02   4.65399615e+02   9.92443540e+03   1.93328412e+04
   2.06061164e+04   7.40688756e+03   8.54324096e+03   2.52512399e+04
   6.50417389e+03   4.53139454e-02   2.32873521e+03   9.66062044e+03
   2.86388761e+03   2.45768806e+04   1.00559447e+04   5.20808179e+03
   2.01341704e+04   1.07551789e+04   2.05075625e+03   7.55495911e-03
   4.87294455e+03   7.26605017e+03   1.57537975e+02   3.34777832e+04
   1.77220911e+04   3.12685505e+03   1.38777832e+04   2.14511250e+04
   9.89607722e+03   5.19113284e+02   7.26441707e+02   1.89302148e+04
   6.82319380e+03   2.19904607e+03   1.77049416e+04   7.03546947e+03
   1.81048359e+04   3.73049416e+04   3.62756654e+03   1.04392839e+03
   1.05713807e+04   2.17431986e+04   5.31534410e-01   1.95268888e+03
   6.47653243e+03   1.89201077e+04   3.00039466e+04   1.35296195e+04
   1.07701043e+04   2.96652776e+04   1.25639594e+04   2.69874068e+03
   2.68332690e+03   1.01511384e+04   7.12318364e+03   9.93402736e-04
   5.52880860e-02   5.36587168e+03   4.76260073e+03   3.49009870e+04
   1.71991231e+04   8.02717640e+03   2.47512821e+04   1.80364849e+04
   5.96428389e+03   1.21641749e+03   5.91356495e+03   1.29061169e+04
   2.29136131e+03   1.68825823e-02   1.46410943e+03   1.07954105e+04
   3.45094274e+02   4.32702379e+04   2.39623896e+04   8.51179017e+03
   2.36702379e+04   2.63801082e+04   1.18242347e+04   2.52748845e+03
   4.80239826e+03   2.12359170e+04   7.00466203e+03   2.52318395e+03
   3.37988346e+02   1.91140831e+04   3.84795276e+03   2.39168000e+02
   2.67889376e+04   1.30907740e+04   2.34308280e+04   4.63889376e+04
   8.56479821e+03   3.42255214e+03   1.30184008e+04   2.59531102e+04
   2.70106299e+03   2.84202482e+03   7.48751346e+03   2.07102693e+04
  -1.26052555e-07   4.20298031e+03   1.04855928e+04   1.87931412e+04
   3.26859963e+04   1.62504976e+04   2.13973181e+04   4.50136094e+04
   1.23863893e+04   4.06443386e+03   1.01936415e+04   2.21382886e+04
   5.40317914e+03   1.86320259e+03   4.88359938e+03   1.56843558e+04
   1.80094493e+03   1.57435766e+03   6.16185305e+03   1.27106143e+04
   3.97096580e-02   3.69064788e+04   1.85829593e+04   1.81081606e+04
   4.09465697e+04   1.59276958e+04   5.02246765e+03   7.17332527e+03
   1.72729491e+04   8.57814863e+03   1.57982027e+03   2.69882374e+03
   1.04226985e+04   4.68101514e+03   3.25194169e-03   2.55419874e+03
   7.10319078e+03   2.58529767e+03   2.01841744e-01   5.17481592e+04
   2.97465131e+04   1.46729763e+04   3.37933712e+04   3.07914496e+04
   1.41560754e+04   5.71839588e+03   1.01456955e+04   2.34538085e+04
   8.07403193e+03   4.09326032e+03   3.30832536e+03   1.95662593e+04
   3.70555245e+03   7.53506277e+02   5.51153826e-02   1.74801233e+04
   1.08193315e+04   5.27062115e+03   3.77345524e+04   2.09883773e+04
   3.05815084e+04   5.73137686e+04   1.53419758e+04   7.62232177e+03
   1.72769191e+04   3.19783826e+04   7.22985028e+03   5.54222138e+03
   1.03051725e+04   2.43031449e+04   2.71884540e+03   5.44400517e+03
   1.19725242e+04   2.02638797e+04   9.43774869e+00   7.86709119e-03
   2.28451872e+03   1.71773142e+04   4.53253647e+04   2.52433622e+04
   2.72180205e+04   5.39734142e+04   2.08792744e+04   9.03799930e+03
   1.34642838e+04   2.62243393e+04   1.16595156e+04   4.90470549e+03
   7.19369673e+03   1.73508204e+04   6.25687188e+03   2.69919161e+03
   6.61554602e+03   1.22661184e+04   2.65608860e+03   1.72571791e+02
   6.13210623e-02   8.76419123e+03   8.44820789e+02   5.51848846e+04
   3.19301764e+04   2.39798459e+04   4.91392544e+04   2.97738608e+04
   1.35000863e+04   1.08688568e+04   2.02560019e+04   2.00336318e+04
   7.25169719e+03   6.16252233e+03   1.08194180e+04   1.42120126e+04
   2.84089900e+03   3.13782475e+03   5.24347160e+03   1.01923773e+04
   4.77325137e+03   1.42565477e+03   1.94748091e+03   7.95227788e+03
   1.90261290e+03   5.92355397e+04   3.51140592e+04   2.17964750e+04
   4.49159365e+04   3.45404771e+04   1.65477862e+04   9.92171795e+03
   1.68742210e+04   2.51864265e+04   9.56066776e+03   6.53231446e+03
   7.85542000e+03   1.96756787e+04   4.34810696e+03   2.53108030e+03
   2.64396707e+03   1.59668232e+04   9.16825537e+03   4.12230627e+03
   2.77490528e-03   1.40347410e+04   5.83172737e+03   2.56899974e-02
   5.00577001e+04   3.00269094e+04   3.75250851e+04   6.75453542e+04
   2.36489408e+04   1.29050567e+04   2.16190339e+04   3.74893687e+04
   1.33705487e+04   9.13082383e+03   1.35266974e+04   2.74705789e+04
   7.11571113e+03   7.36336276e+03   1.36103389e+04   2.13866888e+04
   2.66298546e+03   1.39299310e+03   2.94978483e+03   1.66782974e+04
   9.34954189e-03   2.98278662e+02   6.21607488e+03   1.21580637e+04
   6.26201241e+04   3.92767212e+04   4.31647630e+04   7.55967755e+04
   3.27132332e+04   1.86329482e+04   2.52330598e+04   4.14291051e+04
   2.05480034e+04   1.30594321e+04   1.65121262e+04   2.93690602e+04
   1.27742717e+04   9.49614111e+03   1.48248255e+04   2.15042833e+04
   6.80310027e+03   3.93623985e+03   4.29063371e+03   1.54961332e+04
   2.61135054e+03   8.99750848e+02   4.77331285e+03   1.00253289e+04
   2.14102579e-02   6.21921301e+04   3.76195786e+04   3.28421174e+04
   6.17445791e+04   3.36894138e+04   1.69699127e+04   1.70845516e+04
   2.92273680e+04   2.22815739e+04   1.02849490e+04   1.05842854e+04
   1.79866972e+04   1.51175370e+04   5.50558228e+03   7.38984868e+03
   1.08367808e+04   9.75588033e+03   4.70362483e+03   2.31975150e+03
   5.98976914e+03   6.16971352e+03   1.01652753e+03   9.40460938e-03
   2.31333308e+03   3.43244146e+03   1.50178360e+03   6.96597526e+04
   4.31771296e+04   3.10871738e+04   5.82211354e+04   4.10693856e+04
   2.14255844e+04   1.62506505e+04   2.56009001e+04   2.96142684e+04
   1.33862468e+04   1.11400681e+04   1.43090828e+04   2.24121734e+04
   7.17887587e+03   6.31756150e+03   7.11454368e+03   1.70124699e+04
   9.90210844e+03   5.18831214e+03   2.69151261e+03   1.33822300e+04
   5.14527485e+03   2.56438047e-02   2.58323631e-02   1.00216679e+04
   6.79409993e+03   6.41263554e+02   7.16607831e+04   4.75670245e+04
   5.54038068e+04   9.12607831e+04   3.92034067e+04   2.52790668e+04
   3.51096772e+04   5.40952858e+04   2.56624846e+04   1.95867500e+04
   2.46497698e+04   4.05469631e+04   1.67813282e+04   1.59743484e+04
   2.31143769e+04   3.13837427e+04   9.70305884e+03   7.51085683e+03
   9.08420954e+03   2.40119223e+04   4.40193670e+03   3.98905496e+03
   1.00876881e+04   1.69288456e+04   1.07176875e+03   1.30396370e-02
   5.04487455e+03   1.21708733e+04   7.07735466e+04   4.49371220e+04
   4.34134251e+04   7.60329810e+04   3.92279870e+04   2.21213399e+04
   2.50334680e+04   3.99392283e+04   2.61788848e+04   1.50304536e+04
   1.67421163e+04   2.69229756e+04   1.76936406e+04   9.91343320e+03
   1.34093547e+04   1.82239581e+04   1.10111667e+04   6.35659871e+03
   4.96294609e+03   1.18421489e+04   6.10030528e+03   1.88446791e+03
   2.69980089e+03   6.44574843e+03   2.38831140e+03   1.77685007e-01
   2.91304018e-02   3.11352376e+03   1.76662496e+03   7.69257681e+04
   4.91253021e+04   4.02082160e+04   7.10852308e+04   4.52437089e+04
   2.51541815e+04   2.27251162e+04   3.48310372e+04   3.21209809e+04
   1.66782694e+04   1.58206022e+04   2.17351331e+04   2.35764684e+04
   1.01023301e+04   1.08283566e+04   1.29666241e+04   1.68347436e+04
   1.00912528e+04   6.34117990e+03   6.99257221e+03   1.18584364e+04
   4.51796054e+03   1.15880636e+03   2.57210464e+03   7.49680545e+03
   3.78134184e+03   2.54667410e-02   9.40091133e-03   7.38683086e+03
   6.72523310e+02   8.04610090e+04   5.18885291e+04   3.42069955e+04
   6.08610090e+04   5.08861127e+04   2.85035720e+04   1.94160471e+04
   2.70835633e+04   3.88999556e+04   1.91283346e+04   1.50189634e+04
   1.52172463e+04   3.12703765e+04   1.15393326e+04   8.69468325e+03
   7.52148667e+03   2.54433151e+04   1.66049594e+04   1.00957184e+04
   3.02189203e+03   2.13791564e+04   1.06547170e+04   2.35082084e+03
   7.01977608e+02   1.71692337e+04   1.26419706e+04   3.83894651e+03
   3.25883389e-01   1.91348670e+04   7.18580287e+03   1.74722319e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.53987598419 s
|dj| = 12418.7171821
Runtime: 6.53126001358 s
|dj| = 12418.7171821
   41    77    -3.106420E+04     2.775164E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.793e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.344e-03 (tol = 1.000e-10) r (rel) = 4.940e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.574e-07 (tol = 1.000e-10) r (rel) = 1.790e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.247e-13 (tol = 1.000e-10) r (rel) = 3.692e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 22.188627 s.
j = 1.390116e+06.
Runtime: 22.196323 s.
j = 1.390116e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.44656300545 s
|dj| = 12428.179841
Runtime: 5.44640493393 s
|dj| = 12428.179841
Start evaluation of j
Updating the turbine cache
   42    78    -3.106439E+04     2.777278E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.099e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 3.724e-03 (tol = 1.000e-10) r (rel) = 4.597e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.102e-07 (tol = 1.000e-10) r (rel) = 1.361e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.248e-13 (tol = 1.000e-10) r (rel) = 4.010e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 16.902265 s.
Runtime: 16.897429 s.
j = 1.390135e+06.
j = 1.390135e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.86039686203 s
|dj| = 12418.0612304
Runtime: 5.86751008034 s
|dj| = 12418.0612304
Start evaluation of j
Updating the turbine cache
   43    79    -3.106483E+04     2.775017E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.303e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.277e-03 (tol = 1.000e-10) r (rel) = 2.967e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.347e-08 (tol = 1.000e-10) r (rel) = 5.455e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.129e-13 (tol = 1.000e-10) r (rel) = 7.271e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 22.918004 s.
j = 1.390136e+06.
Start evaluation of j
Updating the turbine cache
Runtime: 22.931519 s.
j = 1.390136e+06.
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.037e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.841e-04 (tol = 1.000e-10) r (rel) = 1.395e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.160e-09 (tol = 1.000e-10) r (rel) = 5.695e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.171e-13 (tol = 1.000e-10) r (rel) = 1.556e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 18.730824 s.
j = 1.390141e+06.
End of time loop.
Runtime: 18.739670 s.
j = 1.390141e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.24269509315 s
|dj| = 12418.6126444
Runtime: 6.24046897888 s
|dj| = 12418.6126444
Start evaluation of j
Updating the turbine cache
   44    81    -3.106496E+04     2.775140E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 3.287e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.460e-03 (tol = 1.000e-10) r (rel) = 4.443e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.303e-08 (tol = 1.000e-10) r (rel) = 2.526e-07 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.280e-13 (tol = 1.000e-10) r (rel) = 9.977e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 16.795530 s.
j = 1.390164e+06.
End of time loop.
Runtime: 16.794359 s.
j = 1.390164e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19655897e+03   1.66137465e+04   7.90516776e+03   1.87000000e+04
   1.52159978e+04   3.58529069e+03   3.87283973e+03   5.45196367e-05
   1.27197430e+04   2.34728397e+04   1.29512952e+04   3.04435690e+03
   7.91519805e+03   2.23215855e+04   2.26589334e+03   2.21390321e+04
   9.18973094e+03   1.55537168e+03   1.26443516e+04   1.16241898e+04
   3.64090030e+03   2.53278151e+04   1.36309973e+04   2.88011351e-03
   5.72781509e+03   1.88519217e+04   1.07332395e+04   1.25699493e+03
   1.04415112e+04   2.79465538e+03   1.45952109e+04   3.00415112e+04
   4.99567181e+02   4.63734486e+02   9.91439106e+03   1.93292641e+04
   2.06326606e+04   7.43075584e+03   8.54889965e+03   2.52720630e+04
   6.52204272e+03   9.50521478e-05   2.32536496e+03   9.64740505e+03
   2.86508675e+03   2.46052744e+04   1.00821848e+04   5.20927391e+03
   2.01534914e+04   1.07753891e+04   2.05477747e+03   9.36117572e-05
   4.85965175e+03   7.27045325e+03   1.58332829e+02   3.34932280e+04
   1.77394012e+04   3.12029451e+03   1.38932280e+04   2.14606274e+04
   9.90013921e+03   5.23180319e+02   7.17328306e+02   1.89289436e+04
   6.82042650e+03   2.19609252e+03   1.77344529e+04   7.06002053e+03
   1.81231892e+04   3.73344529e+04   3.64577017e+03   1.04146134e+03
   1.05662107e+04   2.17356436e+04   6.92373833e-01   1.95486551e+03
   6.48218504e+03   1.89214339e+04   3.00346372e+04   1.35601638e+04
   1.07717297e+04   2.96876426e+04   1.25882288e+04   2.69874866e+03
   2.68401671e+03   1.01320527e+04   7.12490079e+03   3.10534992e-05
   1.21569198e-03   5.36325212e+03   4.76557882e+03   3.49372539e+04
   1.72336870e+04   8.03391588e+03   2.47891459e+04   1.80609425e+04
   5.96686042e+03   1.22516360e+03   5.90536444e+03   1.29063290e+04
   2.28981972e+03   1.32908140e-04   1.46842722e+03   1.07946628e+04
   3.42302332e+02   4.32683916e+04   2.39720822e+04   8.49017974e+03
   2.36683916e+04   2.63838081e+04   1.18180178e+04   2.52775281e+03
   4.77486216e+03   2.12247151e+04   6.99729865e+03   2.51565849e+03
   3.33109611e+02   1.91094555e+04   3.84457203e+03   2.39522246e+02
   2.68249370e+04   1.31240921e+04   2.34501573e+04   4.64249370e+04
   8.59110979e+03   3.41931221e+03   1.30181259e+04   2.59414440e+04
   2.70138461e+03   2.84534031e+03   7.49456597e+03   2.07142731e+04
  -3.63717163e-07   4.20750996e+03   1.04841545e+04   1.87953551e+04
   3.27201960e+04   1.62849380e+04   2.14085517e+04   4.50455645e+04
   1.24137914e+04   4.05984396e+03   1.01947789e+04   2.21197236e+04
   5.40173972e+03   1.86423660e+03   4.88729752e+03   1.56860691e+04
   1.80000674e+03   1.57677036e+03   6.15833102e+03   1.27136786e+04
   4.49059707e-03   3.69453854e+04   1.86216967e+04   1.81109175e+04
   4.09730543e+04   1.59603384e+04   5.02065797e+03   7.17445696e+03
   1.72474938e+04   8.58079339e+03   1.58012218e+03   2.69875572e+03
   1.04187896e+04   4.68425137e+03   2.04215485e-06   2.54743067e+03
   7.10145136e+03   2.58955341e+03   2.33572700e+00   5.17576113e+04
   2.97673384e+04   1.46491441e+04   3.37930186e+04   3.08072012e+04
   1.41498306e+04   5.71925119e+03   1.01082746e+04   2.34464125e+04
   8.06756712e+03   4.08478078e+03   3.29973320e+03   1.95649171e+04
   3.70204527e+03   7.48717244e+02   5.36730338e-04   1.74852600e+04
   1.08242974e+04   5.26919003e+03   3.77154505e+04   2.09881855e+04
   3.05771454e+04   5.73154505e+04   1.53364685e+04   7.59717576e+03
   1.72700539e+04   3.19472618e+04   7.20209033e+03   5.53582407e+03
   1.03069562e+04   2.43071236e+04   2.70000898e+03   5.44944644e+03
   1.19736522e+04   2.02812607e+04   4.49103559e-03   4.49070293e-03
   2.29485696e+03   1.72056044e+04   4.53416046e+04   2.52690907e+04
   2.72182791e+04   5.39970829e+04   2.08972139e+04   9.02250986e+03
   1.34652493e+04   2.61949940e+04   1.16443913e+04   4.89919100e+03
   7.19283397e+03   1.73525453e+04   6.24507573e+03   2.69885793e+03
   6.60997489e+03   1.22768538e+04   2.64818200e+03   1.68681086e+02
   2.33043220e-03   8.77807114e+03   8.51286019e+02   5.51886069e+04
   3.19474062e+04   2.39547190e+Minimum distance inequality constraints (should all be > 0): [  2.19655897e+03   1.66137465e+04   7.90516776e+03   1.87000000e+04
   1.52159978e+04   3.58529069e+03   3.87283973e+03   5.45196367e-05
   1.27197430e+04   2.34728397e+04   1.29512952e+04   3.04435690e+03
   7.91519805e+03   2.23215855e+04   2.26589334e+03   2.21390321e+04
   9.18973094e+03   1.55537168e+03   1.26443516e+04   1.16241898e+04
   3.64090030e+03   2.53278151e+04   1.36309973e+04   2.88011351e-03
   5.72781509e+03   1.88519217e+04   1.07332395e+04   1.25699493e+03
   1.04415112e+04   2.79465538e+03   1.45952109e+04   3.00415112e+04
   4.99567181e+02   4.63734486e+02   9.91439106e+03   1.93292641e+04
   2.06326606e+04   7.43075584e+03   8.54889965e+03   2.52720630e+04
   6.52204272e+03   9.50521478e-05   2.32536496e+03   9.64740505e+03
   2.86508675e+03   2.46052744e+04   1.00821848e+04   5.20927391e+03
   2.01534914e+04   1.07753891e+04   2.05477747e+03   9.36117572e-05
   4.85965175e+03   7.27045325e+03   1.58332829e+02   3.34932280e+04
   1.77394012e+04   3.12029451e+03   1.38932280e+04   2.14606274e+04
   9.90013921e+03   5.23180319e+02   7.17328306e+02   1.89289436e+04
   6.82042650e+03   2.19609252e+03   1.77344529e+04   7.06002053e+03
   1.81231892e+04   3.73344529e+04   3.64577017e+03   1.04146134e+03
   1.05662107e+04   2.17356436e+04   6.92373833e-01   1.95486551e+03
   6.48218504e+03   1.89214339e+04   3.00346372e+04   1.35601638e+04
   1.07717297e+04   2.96876426e+04   1.25882288e+04   2.69874866e+03
   2.68401671e+03   1.01320527e+04   7.12490079e+03   3.10534992e-05
   1.21569198e-03   5.36325212e+03   4.76557882e+03   3.49372539e+04
   1.72336870e+04   8.03391588e+03   2.47891459e+04   1.80609425e+04
   5.96686042e+03   1.22516360e+03   5.90536444e+03   1.29063290e+04
   2.28981972e+03   1.32908140e-04   1.46842722e+03   1.07946628e+04
   3.42302332e+02   4.32683916e+04   2.39720822e+04   8.49017974e+03
   2.36683916e+04   2.63838081e+04   1.18180178e+04   2.52775281e+03
   4.77486216e+03   2.12247151e+04   6.99729865e+03   2.51565849e+03
   3.33109611e+02   1.91094555e+04   3.84457203e+03   2.39522246e+02
   2.68249370e+04   1.31240921e+04   2.34501573e+04   4.64249370e+04
   8.59110979e+03   3.41931221e+03   1.30181259e+04   2.59414440e+04
   2.70138461e+03   2.84534031e+03   7.49456597e+03   2.07142731e+04
  -3.63717163e-07   4.20750996e+03   1.04841545e+04   1.87953551e+04
   3.27201960e+04   1.62849380e+04   2.14085517e+04   4.50455645e+04
   1.24137914e+04   4.05984396e+03   1.01947789e+04   2.21197236e+04
   5.40173972e+03   1.86423660e+03   4.88729752e+03   1.56860691e+04
   1.80000674e+03   1.57677036e+03   6.15833102e+03   1.27136786e+04
   4.49059707e-03   3.69453854e+04   1.86216967e+04   1.81109175e+04
   4.09730543e+04   1.59603384e+04   5.02065797e+03   7.17445696e+03
   1.72474938e+04   8.58079339e+03   1.58012218e+03   2.69875572e+03
   1.04187896e+04   4.68425137e+03   2.04215485e-06   2.54743067e+03
   7.10145136e+03   2.58955341e+03   2.33572700e+00   5.17576113e+04
   2.97673384e+04   1.46491441e+04   3.37930186e+04   3.08072012e+04
   1.41498306e+04   5.71925119e+03   1.01082746e+04   2.34464125e+04
   8.06756712e+03   4.08478078e+03   3.29973320e+03   1.95649171e+04
   3.70204527e+03   7.48717244e+02   5.36730338e-04   1.74852600e+04
   1.08242974e+04   5.26919003e+03   3.77154505e+04   2.09881855e+04
   3.05771454e+04   5.73154505e+04   1.53364685e+04   7.59717576e+03
   1.72700539e+04   3.19472618e+04   7.20209033e+03   5.53582407e+03
   1.03069562e+04   2.43071236e+04   2.70000898e+03   5.44944644e+03
   1.19736522e+04   2.02812607e+04   4.49103559e-03   4.49070293e-03
   2.29485696e+03   1.72056044e+04   4.53416046e+04   2.52690907e+04
   2.72182791e+04   5.39970829e+04   2.08972139e+04   9.02250986e+03
   1.34652493e+04   2.61949940e+04   1.16443913e+04   4.89919100e+03
   7.19283397e+03   1.73525453e+04   6.24507573e+03   2.69885793e+03
   6.60997489e+03   1.22768538e+04   2.64818200e+03   1.68681086e+02
   2.33043220e-03   8.77807114e+03   8.51286019e+02   5.51886069e+04
   3.19474062e+04   2.39547190e+04   4.91389736e+04   2.97852949e+04
   1.34791631e+04   1.08622123e+04   2.02068814e+04   2.00132045e+04
   7.23706077e+03   6.14852501e+03   1.08062278e+04   1.41973240e+04
   2.83107830e+03   3.12276934e+03   5.24312522e+03   1.01840254e+04
   4.76738609e+03   1.41781426e+03   1.94939669e+03   7.97072350e+03
   1.90633191e+03   5.92335296e+04   3.51274119e+04   2.17649083e+04
   4.49107199e+04   3.45477986e+04   1.65271496e+04   9.91591724e+03
   1.68242330e+04   2.51642872e+04   9.54407641e+03   6.51573856e+03
   7.84129583e+03   1.96601310e+04   4.33647542e+03   2.51678127e+03
   2.64293322e+03   1.59584370e+04   9.16228630e+03   4.11249736e+03
   8.17417060e-06   1.40567404e+04   5.83776668e+03   1.60033831e-04
   5.00603400e+04   3.00563786e+04   3.75879794e+04   6.76409436e+04
   2.36577229e+04   1.28992183e+04   2.16721566e+04   3.75312593e+04
   1.33444963e+04   9.15037832e+03   1.35715087e+04   2.75488926e+04
   7.09450760e+03   7.40104388e+03   1.36606469e+04   2.14778523e+04
   2.64726775e+03   1.39889369e+03   2.98023130e+03   1.67726426e+04
   2.35421262e-02   3.16902066e+02   6.27460409e+03   1.22368968e+04
   6.25348151e+04   3.92256309e+04   4.30897304e+04   7.55251563e+04
   3.26606007e+04   1.85539163e+04   2.51798238e+04   4.13245037e+04
   2.04674609e+04   1.30054049e+04   1.64640683e+04   2.93212594e+04
   1.27093756e+04   9.45900180e+03   1.47782431e+04   2.14856374e+04
   6.75461892e+03   3.90063588e+03   4.26351464e+03   1.54932612e+04
   2.59985410e+03   8.83992062e+02   4.77100414e+03   1.00254917e+04
   3.62351391e-02   6.21997449e+04   3.76408640e+04   3.28168620e+04
   6.17460230e+04   3.37050178e+04   1.69443938e+04   1.70757077e+04
   2.91709733e+04   2.22588875e+04   1.02683661e+04   1.05685395e+04
   1.79707528e+04   1.51000653e+04   5.49389386e+03   7.36935038e+03
   1.08363117e+04   9.74434130e+03   4.69496196e+03   2.31012866e+03
   5.99238627e+03   6.18861067e+03   1.01768792e+03   1.12567535e-03
   2.31341285e+03   3.47769186e+03   1.50507107e+03   6.96619584e+04
   4.31955139e+04   3.10523944e+04   5.82164022e+04   4.10818354e+04
   2.13998668e+04   1.62428944e+04   2.55407212e+04   2.95894623e+04
   1.33666374e+04   1.11201181e+04   1.42907903e+04   2.23935433e+04
   7.16411783e+03   6.29640366e+03   7.11294330e+03   1.70007368e+04
   9.89298082e+03   5.17536876e+03   2.69121951e+03   1.34079235e+04
   5.14963665e+03   1.59884196e-04   1.59927311e-04   1.00947625e+04
   6.80395711e+03   6.41458772e+02   7.16052682e+04   4.75379560e+04
   5.53391973e+04   9.12052682e+04   3.91729457e+04   2.52066472e+04
   3.50591557e+04   5.39901130e+04   2.55945584e+04   1.95379188e+04
   2.46047134e+04   4.04977492e+04   1.67252054e+04   1.59383457e+04
   2.30629675e+04   3.13618639e+04   9.65960817e+03   7.47680635e+03
   9.05692468e+03   2.40041511e+04   4.39400003e+03   3.97003427e+03
   1.00795529e+04   1.69213133e+04   1.05640245e+03   8.20521191e-03
   5.04161634e+03   1.21709919e+04   7.07173996e+04   4.49108766e+04
   4.33604897e+04   7.60004990e+04   3.91947865e+04   2.20557924e+04
   2.50020487e+04   3.98573554e+04   2.61090183e+04   1.49856410e+04
   1.67053347e+04   2.68945495e+04   1.76348522e+04   9.88280391e+03
   1.33734632e+04   1.82210613e+04   1.09642900e+04   6.32211386e+03
   4.93636288e+03   1.18481194e+04   6.09371779e+03   1.86935139e+03
   2.69955120e+03   6.45133787e+03   2.40203705e+03   2.61921004e-04
   6.80380300e-03   3.12300533e+03   1.75780768e+03   7.69316389e+04
   4.91475142e+04   4.01730799e+04   7.10819942e+04   4.52601008e+04
   2.51236400e+04   2.27149324e+04   3.47633557e+04   3.20936878e+04
   1.66564853e+04   1.57986751e+04   2.17138578e+04   2.35548272e+04
   1.00854759e+04   1.08015272e+04   1.29646723e+04   1.68195952e+04
   1.00790992e+04   6.32622567e+03   6.99275161e+03   1.18843532e+04
   4.51953518e+03   1.15854380e+03   2.57195537e+03   7.55639280e+03
   3.79656656e+03   1.59834070e-04   1.12568884e-03   7.39159785e+03
   6.82003455e+02   8.04965390e+04   5.19347644e+04   3.41961946e+04
   6.08965390e+04   5.09214544e+04   2.84952099e+04   1.04   4.91389736e+04   2.97852949e+04
   1.34791631e+04   1.08622123e+04   2.02068814e+04   2.00132045e+04
   7.23706077e+03   6.14852501e+03   1.08062278e+04   1.41973240e+04
   2.83107830e+03   3.12276934e+03   5.24312522e+03   1.01840254e+04
   4.76738609e+03   1.41781426e+03   1.94939669e+03   7.97072350e+03
   1.90633191e+03   5.92335296e+04   3.51274119e+04   2.17649083e+04
   4.49107199e+04   3.45477986e+04   1.65271496e+04   9.91591724e+03
   1.68242330e+04   2.51642872e+04   9.54407641e+03   6.51573856e+03
   7.84129583e+03   1.96601310e+04   4.33647542e+03   2.51678127e+03
   2.64293322e+03   1.59584370e+04   9.16228630e+03   4.11249736e+03
   8.17417060e-06   1.40567404e+04   5.83776668e+03   1.60033831e-04
   5.00603400e+04   3.00563786e+04   3.75879794e+04   6.76409436e+04
   2.36577229e+04   1.28992183e+04   2.16721566e+04   3.75312593e+04
   1.33444963e+04   9.15037832e+03   1.35715087e+04   2.75488926e+04
   7.09450760e+03   7.40104388e+03   1.36606469e+04   2.14778523e+04
   2.64726775e+03   1.39889369e+03   2.98023130e+03   1.67726426e+04
   2.35421262e-02   3.16902066e+02   6.27460409e+03   1.22368968e+04
   6.25348151e+04   3.92256309e+04   4.30897304e+04   7.55251563e+04
   3.26606007e+04   1.85539163e+04   2.51798238e+04   4.13245037e+04
   2.04674609e+04   1.30054049e+04   1.64640683e+04   2.93212594e+04
   1.27093756e+04   9.45900180e+03   1.47782431e+04   2.14856374e+04
   6.75461892e+03   3.90063588e+03   4.26351464e+03   1.54932612e+04
   2.59985410e+03   8.83992062e+02   4.77100414e+03   1.00254917e+04
   3.62351391e-02   6.21997449e+04   3.76408640e+04   3.28168620e+04
   6.17460230e+04   3.37050178e+04   1.69443938e+04   1.70757077e+04
   2.91709733e+04   2.22588875e+04   1.02683661e+04   1.05685395e+04
   1.79707528e+04   1.51000653e+04   5.49389386e+03   7.36935038e+03
   1.08363117e+04   9.74434130e+03   4.69496196e+03   2.31012866e+03
   5.99238627e+03   6.18861067e+03   1.01768792e+03   1.12567535e-03
   2.31341285e+03   3.47769186e+03   1.50507107e+03   6.96619584e+04
   4.31955139e+04   3.10523944e+04   5.82164022e+04   4.10818354e+04
   2.13998668e+04   1.62428944e+04   2.55407212e+04   2.95894623e+04
   1.33666374e+04   1.11201181e+04   1.42907903e+04   2.23935433e+04
   7.16411783e+03   6.29640366e+03   7.11294330e+03   1.70007368e+04
   9.89298082e+03   5.17536876e+03   2.69121951e+03   1.34079235e+04
   5.14963665e+03   1.59884196e-04   1.59927311e-04   1.00947625e+04
   6.80395711e+03   6.41458772e+02   7.16052682e+04   4.75379560e+04
   5.53391973e+04   9.12052682e+04   3.91729457e+04   2.52066472e+04
   3.50591557e+04   5.39901130e+04   2.55945584e+04   1.95379188e+04
   2.46047134e+04   4.04977492e+04   1.67252054e+04   1.59383457e+04
   2.30629675e+04   3.13618639e+04   9.65960817e+03   7.47680635e+03
   9.05692468e+03   2.40041511e+04   4.39400003e+03   3.97003427e+03
   1.00795529e+04   1.69213133e+04   1.05640245e+03   8.20521191e-03
   5.04161634e+03   1.21709919e+04   7.07173996e+04   4.49108766e+04
   4.33604897e+04   7.60004990e+04   3.91947865e+04   2.20557924e+04
   2.50020487e+04   3.98573554e+04   2.61090183e+04   1.49856410e+04
   1.67053347e+04   2.68945495e+04   1.76348522e+04   9.88280391e+03
   1.33734632e+04   1.82210613e+04   1.09642900e+04   6.32211386e+03
   4.93636288e+03   1.18481194e+04   6.09371779e+03   1.86935139e+03
   2.69955120e+03   6.45133787e+03   2.40203705e+03   2.61921004e-04
   6.80380300e-03   3.12300533e+03   1.75780768e+03   7.69316389e+04
   4.91475142e+04   4.01730799e+04   7.10819942e+04   4.52601008e+04
   2.51236400e+04   2.27149324e+04   3.47633557e+04   3.20936878e+04
   1.66564853e+04   1.57986751e+04   2.17138578e+04   2.35548272e+04
   1.00854759e+04   1.08015272e+04   1.29646723e+04   1.68195952e+04
   1.00790992e+04   6.32622567e+03   6.99275161e+03   1.18843532e+04
   4.51953518e+03   1.15854380e+03   2.57195537e+03   7.55639280e+03
   3.79656656e+03   1.59834070e-04   1.12568884e-03   7.39159785e+03
   6.82003455e+02   8.04965390e+04   5.19347644e+04   3.41961946e+04
   6.08965390e+04   5.09214544e+04   2.84952099e+04   1.94316953e+04
   2.70483842e+04   3.88902971e+04   1.91208383e+04   1.50124179e+04
   1.52192687e+04   3.12621568e+04   1.15333459e+04   8.68621126e+03
   7.53569168e+03   2.54372951e+04   1.66002311e+04   1.00857829e+04
   3.03038010e+03   2.14124257e+04   1.06621618e+04   2.35359560e+03
   7.07391452e+02   1.72597967e+04   1.26522677e+04   3.83690102e+03
   3.16313257e-03   1.91276180e+04   7.19622844e+03   1.74185110e+03]
Start evaluation of dj
found a tidal farm, computing gradient
94316953e+04
   2.70483842e+04   3.88902971e+04   1.91208383e+04   1.50124179e+04
   1.52192687e+04   3.12621568e+04   1.15333459e+04   8.68621126e+03
   7.53569168e+03   2.54372951e+04   1.66002311e+04   1.00857829e+04
   3.03038010e+03   2.14124257e+04   1.06621618e+04   2.35359560e+03
   7.07391452e+02   1.72597967e+04   1.26522677e+04   3.83690102e+03
   3.16313257e-03   1.91276180e+04   7.19622844e+03   1.74185110e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 4.75889110565 s
|dj| = 12421.6144407
Runtime: 4.76772499084 s
|dj| = 12421.6144407
Start evaluation of j
Updating the turbine cache
   45    82    -3.106547E+04     2.775811E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.625e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.738e-02 (tol = 1.000e-10) r (rel) = 5.376e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.480e-04 (tol = 1.000e-10) r (rel) = 2.141e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 6.131e-09 (tol = 1.000e-10) r (rel) = 3.772e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.257e-13 (tol = 1.000e-10) r (rel) = 2.004e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 23.462868 s.
End of time loop.
j = 1.389656e+06.
Minimum distance inequality constraints (should all be > 0): [  2.20462284e+03   1.67214768e+04   7.94426916e+03   1.87000000e+04
   1.52063824e+04   3.63149123e+03   3.86881465e+03   1.03209383e-02
   1.27651581e+04   2.34688146e+04   1.29916147e+04   3.05765351e+03
   7.91048056e+03   2.23420914e+04   2.28702982e+03   2.21843193e+04
   9.20175068e+03   1.52893731e+03   1.26684504e+04   1.16534642e+04
   3.64162055e+03   2.54462952e+04   1.36584925e+04   1.24426066e-01
   5.84629520e+03   1.88710662e+04   1.06843458e+04   1.21733858e+03
   1.04077954e+04   2.77425455e+03   1.45937106e+04   3.00077954e+04
   4.89911242e+02   4.72403313e+02   9.93262889e+03   1.92857506e+04
   2.06789476e+04   7.44653379e+03   8.51268545e+03   2.52837145e+04
   6.55557475e+03   4.10418091e-03   2.31986270e+03   9.55966696e+03
   2.89525091e+03   2.46582472e+04   1.01004278e+04   5.17340433e+03
   2.01822783e+04   1.08126375e+04   2.05561691e+03   1.79195608e-04
   4.78860195e+03   7.30226936e+03   1.55827303e+02   3.35558995e+Runtime: 23.496324 s.
j = 1.389656e+06.
04
   1.77541958e+04   3.08754650e+03   1.39558995e+04   2.14908161e+04
   9.88746942e+03   5.20460874e+02   6.79978686e+02   1.89416987e+04
   6.79493794e+03   2.18375328e+03   1.76880830e+04   7.02510239e+03
   1.80835713e+04   3.72880830e+04   3.62680235e+03   1.03063999e+03
   1.05663383e+04   2.16378879e+04   1.33460231e-04   1.96827631e+03
   6.49596238e+03   1.89088991e+04   3.00941974e+04   1.35836548e+04
   1.07237948e+04   2.97215262e+04   1.26331814e+04   2.69898126e+03
   2.68407267e+03   1.00276903e+04   7.17096780e+03   1.58080144e-03
   3.71743968e-05   5.34181562e+03   4.79403337e+03   3.50069339e+04
   1.72596810e+04   7.99660470e+03   2.48599527e+04   1.81046626e+04
   5.96253519e+03   1.23322677e+03   5.83068718e+03   1.29440980e+04
   2.28052171e+03   1.51302204e-02   1.46642570e+03   1.08098969e+04
   3.34952415e+02   4.32381761e+04   2.39261718e+04   8.37774439e+03
   2.36381761e+04   2.63720178e+04   1.17807088e+04   2.50115272e+03
   4.65186320e+03   2.12309494e+04   6.96721956e+03   2.49585600e+03
   3.08388326e+02   1.91124368e+04   3.83398637e+03   2.39858751e+02
   2.67683703e+04   1.30759500e+04   2.33734318e+04   4.63683703e+04
   8.56369328e+03   3.38887669e+03   1.30000477e+04   2.57900250e+04
   2.70000027e+03   2.84130184e+03   7.48965553e+03   2.06760995e+04
  -1.37307552e-07   4.21709919e+03   1.04756962e+04   1.87939244e+04
   3.26585139e+04   1.62268929e+04   2.13018568e+04   4.49839005e+04
   1.23821388e+04   4.01592058e+03   1.01636705e+04   2.19414802e+04
   5.40000033e+03   1.84504614e+03   4.86855911e+03   1.56350863e+04
   1.80000000e+03   1.57216624e+03   6.13824404e+03   1.27100548e+04
  -4.68899088e-08   3.69900393e+04   1.86359066e+04   1.80497825e+04
   4.10080906e+04   1.59967095e+04   5.01219491e+03   7.17481400e+03
   1.71129254e+04   8.62750950e+03   1.57860671e+03   2.69859341e+03
   1.03938527e+04   4.71604520e+03   4.51367916e-03   2.53669428e+03
   7.10791875e+03   2.60458126e+03   7.19997713e+00   5.17791920e+04
   2.97597166e+04   1.45212684e+04   3.37675942e+04   3.08443210e+04
   1.41361528e+04   5.69518210e+03   9.94195983e+03   2.35066811e+04
   8.05652124e+03   4.07160592e+03   3.25653604e+03   1.96206129e+04
   3.70115155e+03   7.41441698e+02   2.92919304e-02   1.75345450e+04
   1.08616684e+04   5.29029954e+03   3.76486575e+04   2.09267976e+04
   3.04632923e+04   5.72486575e+04   1.53005842e+04   7.54711339e+03
   1.72337571e+04   3.17421622e+04   7.20000040e+03   5.51432737e+03
   1.02833487e+04   2.42432999e+04   2.70000000e+03   5.44016500e+03
   1.19414954e+04   2.02754120e+04   1.02181730e-07  -3.88789658e-08
   2.29311732e+03   1.72484772e+04   4.53340273e+04   2.52486453e+04
   2.71398824e+04   5.40242045e+04   2.08972498e+04   8.99130473e+03
   1.34652678e+04   2.60334072e+04   1.16690395e+04   4.88903015e+03
   7.19160456e+03   1.73322878e+04   6.26165115e+03   2.69865693e+03
   6.60204441e+03   1.23129829e+04   2.65426325e+03   1.75958510e+02
   3.59769352e-02   8.83708667e+03   8.46875360e+02   5.51425919e+04
   3.18859840e+04   2.37742109e+04   4.90629016e+04   2.97687611e+04
   1.34177991e+04   1.08003251e+04   1.99575745e+04   2.00346649e+04
   7.19153572e+03   6.09993904e+03   1.07170878e+04   1.42201961e+04
   2.79783491e+03   3.07333070e+03   5.22608673e+03   1.02057277e+04
   4.78293687e+03   1.40651776e+03   1.94892938e+03   7.99125926e+03
   1.92854435e+03   5.92252380e+04   3.50935563e+04   2.16031502e+04
   4.48692418e+04   3.45599009e+04   1.64858875e+04   9.87225171e+03
   1.66065961e+04   2.52082984e+04   9.51162253e+03   6.48217443e+03
   7.77391794e+03   1.97016178e+04   4.31496758e+03   2.48530502e+03
   2.63956017e+03   1.59949376e+04   9.19014996e+03   4.11305934e+03
   2.99944439e-03   1.40882574e+04   5.87730627e+03   4.17062158e-03
   5.01562020e+04   3.01923954e+04   3.79600011e+04   6.82248614e+04
   2.37266241e+04   1.30326217e+04   2.20566005e+04   3.78638298e+04
   1.34225628e+04   9.35141945e+03   1.38845687e+04   2.80156556e+04
   7.14944960e+03   7.65451331e+03   1.40131197e+04   2.19932100e+04
   2.67633693e+03   1.50559918e+03   3.16738051e+03   1.72871730e+04
   3.22425441e+00   4.30075549e+02   6.59647756e+03   1.26733541e+04
   6.22256744e+04   3.89760987e+04   4.28339338e+04   7.53460303e+04
   3.24412962e+04   1.83656044e+04   2.50691507e+04   4.09948039e+04
   2.03260826e+04   1.28828038e+04   1.63673729e+04   2.92156084e+04
   1.25955561e+04   9.38358988e+03   1.47048982e+04   2.15044154e+04
   6.66503030e+03   3.84729531e+03   4.20823894e+03   1.55677422e+04
   2.53450445e+03   8.49496132e+02   4.82186239e+03   1.01032105e+04
   2.33244539e+00   6.21163545e+04   3.75486456e+04   3.26036106e+04
   6.16454416e+04   3.36580847e+04   1.68540260e+04   1.69921522e+04
   2.88714867e+04   2.22587957e+04   1.02011585e+04   1.04986708e+04
   1.78555984e+04   1.51043655e+04   5.44025160e+03   7.29496225e+03
   1.08119450e+04   9.74993590e+03   4.69802385e+03   2.27836616e+03
   5.99170861e+03   6.19550628e+03   1.01830000e+03   3.79799316e-03
   2.31331515e+03   3.69988474e+03   1.54834628e+03   6.96221943e+04
   4.31337330e+04   3.08553593e+04   5.81604398e+04   4.10671632e+04
   2.13291377e+04   1.61793067e+04   2.52713971e+04   2.96156359e+04
   1.33109904e+04   1.10652766e+04   1.41998132e+04   2.24191700e+04
   7.12065522e+03   6.24052701e+03   7.10745182e+03   1.70227048e+04
   9.91012890e+03   5.15399839e+03   2.69129147e+03   1.34262395e+04
   5.16896190e+03   4.17055663e-03   4.17052564e-03   1.04598551e+04
   6.88688304e+03   6.41289294e+02   7.16149774e+04   4.75267390e+04
   5.52128193e+04   9.12149774e+04   3.91918313e+04   2.51681108e+04
   3.50382738e+04   5.37252039e+04   2.56520289e+04   1.95238887e+04
   2.45863251e+04   4.04271349e+04   1.67751524e+04   1.59240076e+04
   2.30155679e+04   3.13876325e+04   9.69827649e+03   7.50983857e+03
   9.04560088e+03   2.40627138e+04   4.42140064e+03   3.96187368e+03
   1.01164016e+04   1.69618169e+04   1.01312820e+03   5.65866492e-01
   5.06240197e+03   1.21909215e+04   7.03316107e+04   4.45862896e+04
   4.30072050e+04   7.57352762e+04   3.89102841e+04   2.17981697e+04
   2.48176111e+04   3.94370655e+04   2.59113330e+04   1.47943870e+04
   1.65390465e+04   2.67156433e+04   1.74696731e+04   9.74250125e+03
   1.32355919e+04   1.81804393e+04   1.08280139e+04   6.22267299e+03
   4.82523021e+03   1.18581346e+04   5.98635475e+03   1.79521494e+03
   2.69924162e+03   6.47296205e+03   2.45222083e+03   7.20250972e-03
   4.53787372e-01   3.15878839e+03   1.72322600e+03   7.68546756e+04
   4.90551132e+04   3.99434777e+04   7.10016984e+04   4.52152054e+04
   2.50240833e+04   2.26298524e+04   3.44440280e+04   3.20984853e+04
   1.65793319e+04   1.57227271e+04   2.15970425e+04   2.35620582e+04
   1.00217906e+04   1.07208772e+04   1.29520288e+04   1.68256317e+04
   1.00839346e+04   6.28456546e+03   6.99278937e+03   1.18892052e+04
   4.51743622e+03   1.15872664e+03   2.57203383e+03   7.82198093e+03
   3.87208560e+03   4.17052259e-03   3.79802320e-03   7.39564053e+03
   7.18719233e+02   8.05585930e+04   5.19495194e+04   3.40656932e+04
   6.09585930e+04   5.09767358e+04   2.84717761e+04   1.94238388e+04
   2.68482447e+04   3.89708569e+04   1.91003115e+04   1.49992657e+04
   1.51856202e+04   3.13283109e+04   1.15172864e+04   8.66808506e+03
   7.57637260e+03   2.54857654e+04   1.66398793e+04   1.00818893e+04
   3.05193800e+03   2.14432200e+04   1.06961016e+04   2.35991307e+03
   7.17960041e+02   1.77194996e+04   1.27580391e+04   3.83355463e+03
   5.79861577e-02   1.91232143e+04   7.25166076e+03   1.73241821e+03]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  2.20462284e+03   1.67214768e+04   7.94426916e+03   1.87000000e+04
   1.52063824e+04   3.63149123e+03   3.86881465e+03   1.03209383e-02
   1.27651581e+04   2.34688146e+04   1.29916147e+04   3.05765351e+03
   7.91048056e+03   2.23420914e+04   2.28702982e+03   2.21843193e+04
   9.20175068e+03   1.52893731e+03   1.26684504e+04   1.16534642e+04
   3.64162055e+03   2.54462952e+04   1.36584925e+04   1.24426066e-01
   5.84629520e+03   1.88710662e+04   1.06843458e+04   1.21733858e+03
   1.04077954e+04   2.77425455e+03   1.45937106e+04   3.00077954e+04
   4.89911242e+02   4.72403313e+02   9.93262889e+03   1.92857506e+04
   2.06789476e+04   7.44653379e+03   8.51268545e+03   2.52837145e+04
   6.55557475e+03   4.10418091e-03   2.31986270e+03   9.55966696e+03
   2.89525091e+03   2.46582472e+04   1.01004278e+04   5.17340433e+03
   2.01822783e+04   1.08126375e+04   2.05561691e+03   1.79195608e-04
   4.78860195e+03   7.30226936e+03   1.55827303e+02   3.35558995e+04
   1.77541958e+04   3.08754650e+03   1.39558995e+04   2.14908161e+04
   9.88746942e+03   5.20460874e+02   6.79978686e+02   1.89416987e+04
   6.79493794e+03   2.18375328e+03   1.76880830e+04   7.02510239e+03
   1.80835713e+04   3.72880830e+04   3.62680235e+03   1.03063999e+03
   1.05663383e+04   2.16378879e+04   1.33460231e-04   1.96827631e+03
   6.49596238e+03   1.89088991e+04   3.00941974e+04   1.35836548e+04
   1.07237948e+04   2.97215262e+04   1.26331814e+04   2.69898126e+03
   2.68407267e+03   1.00276903e+04   7.17096780e+03   1.58080144e-03
   3.71743968e-05   5.34181562e+03   4.79403337e+03   3.50069339e+04
   1.72596810e+04   7.99660470e+03   2.48599527e+04   1.81046626e+04
   5.96253519e+03   1.23322677e+03   5.83068718e+03   1.29440980e+04
   2.28052171e+03   1.51302204e-02   1.46642570e+03   1.08098969e+04
   3.34952415e+02   4.32381761e+04   2.39261718e+04   8.37774439e+03
   2.36381761e+04   2.63720178e+04   1.17807088e+04   2.50115272e+03
   4.65186320e+03   2.12309494e+04   6.96721956e+03   2.49585600e+03
   3.08388326e+02   1.91124368e+04   3.83398637e+03   2.39858751e+02
   2.67683703e+04   1.30759500e+04   2.33734318e+04   4.63683703e+04
   8.56369328e+03   3.38887669e+03   1.30000477e+04   2.57900250e+04
   2.70000027e+03   2.84130184e+03   7.48965553e+03   2.06760995e+04
  -1.37307552e-07   4.21709919e+03   1.04756962e+04   1.87939244e+04
   3.26585139e+04   1.62268929e+04   2.13018568e+04   4.49839005e+04
   1.23821388e+04   4.01592058e+03   1.01636705e+04   2.19414802e+04
   5.40000033e+03   1.84504614e+03   4.86855911e+03   1.56350863e+04
   1.80000000e+03   1.57216624e+03   6.13824404e+03   1.27100548e+04
  -4.68899088e-08   3.69900393e+04   1.86359066e+04   1.80497825e+04
   4.10080906e+04   1.59967095e+04   5.01219491e+03   7.17481400e+03
   1.71129254e+04   8.62750950e+03   1.57860671e+03   2.69859341e+03
   1.03938527e+04   4.71604520e+03   4.51367916e-03   2.53669428e+03
   7.10791875e+03   2.60458126e+03   7.19997713e+00   5.17791920e+04
   2.97597166e+04   1.45212684e+04   3.37675942e+04   3.08443210e+04
   1.41361528e+04   5.69518210e+03   9.94195983e+03   2.35066811e+04
   8.05652124e+03   4.07160592e+03   3.25653604e+03   1.96206129e+04
   3.70115155e+03   7.41441698e+02   2.92919304e-02   1.75345450e+04
   1.08616684e+04   5.29029954e+03   3.76486575e+04   2.09267976e+04
   3.04632923e+04   5.72486575e+04   1.53005842e+04   7.54711339e+03
   1.72337571e+04   3.17421622e+04   7.20000040e+03   5.51432737e+03
   1.02833487e+04   2.42432999e+04   2.70000000e+03   5.44016500e+03
   1.19414954e+04   2.02754120e+04   1.02181730e-07  -3.88789658e-08
   2.29311732e+03   1.72484772e+04   4.53340273e+04   2.52486453e+04
   2.71398824e+04   5.40242045e+04   2.08972498e+04   8.99130473e+03
   1.34652678e+04   2.60334072e+04   1.16690395e+04   4.88903015e+03
   7.19160456e+03   1.73322878e+04   6.26165115e+03   2.69865693e+03
   6.60204441e+03   1.23129829e+04   2.65426325e+03   1.75958510e+02
   3.59769352e-02   8.83708667e+03   8.46875360e+02   5.51425919e+04
   3.18859840e+04   2.37742109e+04   4.90629016e+04   2.97687611e+04
   1.34177991e+04   1.08003251e+04   1.99575745e+04   2.00346649e+04
   7.19153572e+03   6.09993904e+03   1.07170878e+04   1.42201961e+04
   2.79783491e+03   3.07333070e+03   5.22608673e+03   1.02057277e+04
   4.78293687e+03   1.40651776e+03   1.94892938e+03   7.99125926e+03
   1.92854435e+03   5.92252380e+04   3.50935563e+04   2.16031502e+04
   4.48692418e+04   3.45599009e+04   1.64858875e+04   9.87225171e+03
   1.66065961e+04   2.52082984e+04   9.51162253e+03   6.48217443e+03
   7.77391794e+03   1.97016178e+04   4.31496758e+03   2.48530502e+03
   2.63956017e+03   1.59949376e+04   9.19014996e+03   4.11305934e+03
   2.99944439e-03   1.40882574e+04   5.87730627e+03   4.17062158e-03
   5.01562020e+04   3.01923954e+04   3.79600011e+04   6.82248614e+04
   2.37266241e+04   1.30326217e+04   2.20566005e+04   3.78638298e+04
   1.34225628e+04   9.35141945e+03   1.38845687e+04   2.80156556e+04
   7.14944960e+03   7.65451331e+03   1.40131197e+04   2.19932100e+04
   2.67633693e+03   1.50559918e+03   3.16738051e+03   1.72871730e+04
   3.22425441e+00   4.30075549e+02   6.59647756e+03   1.26733541e+04
   6.22256744e+04   3.89760987e+04   4.28339338e+04   7.53460303e+04
   3.24412962e+04   1.83656044e+04   2.50691507e+04   4.09948039e+04
   2.03260826e+04   1.28828038e+04   1.63673729e+04   2.92156084e+04
   1.25955561e+04   9.38358988e+03   1.47048982e+04   2.15044154e+04
   6.66503030e+03   3.84729531e+03   4.20823894e+03   1.55677422e+04
   2.53450445e+03   8.49496132e+02   4.82186239e+03   1.01032105e+04
   2.33244539e+00   6.21163545e+04   3.75486456e+04   3.26036106e+04
   6.16454416e+04   3.36580847e+04   1.68540260e+04   1.69921522e+04
   2.88714867e+04   2.22587957e+04   1.02011585e+04   1.04986708e+04
   1.78555984e+04   1.51043655e+04   5.44025160e+03   7.29496225e+03
   1.08119450e+04   9.74993590e+03   4.69802385e+03   2.27836616e+03
   5.99170861e+03   6.19550628e+03   1.01830000e+03   3.79799316e-03
   2.31331515e+03   3.69988474e+03   1.54834628e+03   6.96221943e+04
   4.31337330e+04   3.08553593e+04   5.81604398e+04   4.10671632e+04
   2.13291377e+04   1.61793067e+04   2.52713971e+04   2.96156359e+04
   1.33109904e+04   1.10652766e+04   1.41998132e+04   2.24191700e+04
   7.12065522e+03   6.24052701e+03   7.10745182e+03   1.70227048e+04
   9.91012890e+03   5.15399839e+03   2.69129147e+03   1.34262395e+04
   5.16896190e+03   4.17055663e-03   4.17052564e-03   1.04598551e+04
   6.88688304e+03   6.41289294e+02   7.16149774e+04   4.75267390e+04
   5.52128193e+04   9.12149774e+04   3.91918313e+04   2.51681108e+04
   3.50382738e+04   5.37252039e+04   2.56520289e+04   1.95238887e+04
   2.45863251e+04   4.04271349e+04   1.67751524e+04   1.59240076e+04
   2.30155679e+04   3.13876325e+04   9.69827649e+03   7.50983857e+03
   9.04560088e+03   2.40627138e+04   4.42140064e+03   3.96187368e+03
   1.01164016e+04   1.69618169e+04   1.01312820e+03   5.65866492e-01
   5.06240197e+03   1.21909215e+04   7.03316107e+04   4.45862896e+04
   4.30072050e+04   7.57352762e+04   3.89102841e+04   2.17981697e+04
   2.48176111e+04   3.94370655e+04   2.59113330e+04   1.47943870e+04
   1.65390465e+04   2.67156433e+04   1.74696731e+04   9.74250125e+03
   1.32355919e+04   1.81804393e+04   1.08280139e+04   6.22267299e+03
   4.82523021e+03   1.18581346e+04   5.98635475e+03   1.79521494e+03
   2.69924162e+03   6.47296205e+03   2.45222083e+03   7.20250972e-03
   4.53787372e-01   3.15878839e+03   1.72322600e+03   7.68546756e+04
   4.90551132e+04   3.99434777e+04   7.10016984e+04   4.52152054e+04
   2.50240833e+04   2.26298524e+04   3.44440280e+04   3.20984853e+04
   1.65793319e+04   1.57227271e+04   2.15970425e+04   2.35620582e+04
   1.00217906e+04   1.07208772e+04   1.29520288e+04   1.68256317e+04
   1.00839346e+04   6.28456546e+03   6.99278937e+03   1.18892052e+04
   4.51743622e+03   1.15872664e+03   2.57203383e+03   7.82198093e+03
   3.87208560e+03   4.17052259e-03   3.79802320e-03   7.39564053e+03
   7.18719233e+02   8.05585930e+04   5.19495194e+04   3.40656932e+04
   6.09585930e+04   5.09767358e+04   2.84717761e+04   1.94238388e+04
   2.68482447e+04   3.89708569e+04   1.91003115e+04   1.49992657e+04
   1.51856202e+04   3.13283109e+04   1.15172864e+04   8.66808506e+03
   7.57637260e+03   2.54857654e+04   1.66398793e+04   1.00818893e+04
   3.05193800e+03   2.14432200e+04   1.06961016e+04   2.35991307e+03
   7.17960041e+02   1.77194996e+04   1.27580391e+04   3.83355463e+03
   5.79861577e-02   1.91232143e+04   7.25166076e+03   1.73241821e+03]
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.506e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.453e-02 (tol = 1.000e-10) r (rel) = 4.285e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.264e-04 (tol = 1.000e-10) r (rel) = 1.503e-04 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.026e-09 (tol = 1.000e-10) r (rel) = 2.010e-09 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 3.185e-13 (tol = 1.000e-10) r (rel) = 2.115e-13 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 25.502337 s.
Runtime: 25.494032 s.
j = 1.390210e+06.
j = 1.390210e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19785509e+03   1.66310403e+04   7.91143218e+03   1.87000000e+04
   1.52144504e+04   3.59268797e+03   3.87219222e+03   3.12749384e-04
   1.27270103e+04   2.34721922e+04   1.29577762e+04   3.04649400e+03
   7.91442481e+03   2.23248797e+04   2.26928761e+03   2.21463130e+04
   9.19166326e+03   1.55110375e+03   1.26482245e+04   1.16288940e+04
   3.64101607e+03   2.53468007e+04   1.36353578e+04   5.63576817e-03
   5.74680074e+03   1.88549243e+04   1.07253313e+04   1.25056865e+03
   1.04360849e+04   2.79136766e+03   1.45949134e+04   3.00360849e+04
   4.98011853e+02   4.65114691e+02   9.91731218e+03   1.93221601e+04
   2.06401014e+04   7.43329242e+03   8.54305918e+03   2.52739330e+04
   6.52743095e+03   1.85949433e-04   2.32447964e+03   9.63324192e+03
   2.86992579e+03   2.46137909e+04   1.00851179e+04   5.20348949e+03
   2.01581178e+04   1.07813752e+04   2.05491242e+03   8.31985623e-05
   4.84817715e+03   7.27555744e+03   1.57929592e+02   3.35032992e+04
   1.77417744e+04   3.11501583e+03   1.39032992e+04   2.14654719e+04
   9.89809935e+03   5.22740076e+02   7.11291505e+02   1.89309718e+04
   6.81632231e+03   2.19410505e+03   1.77269908e+04   7.05439716e+03
   1.81167588e+04   3.73269908e+04   3.64271669e+03   1.03970572e+03
   1.05662180e+04   2.17198125e+04   5.81015133e-01   1.95700904e+03
   6.48438690e+03   1.89193931e+04   3.00442129e+04   1.35639408e+04
   1.07640051e+04   2.96930886e+04   1.25954539e+04   2.69878599e+03
   2.68402566e+03   1.01152204e+04   7.13229675e+03   6.69630926e-05
   1.02112969e-03   5.35980139e+03   4.77014100e+03   3.49484545e+04
   1.72378632e+04   8.02790120e+03   2.48005278e+04   1.80679658e+04
   5.96616337e+03   1.22645851e+03   5.89331959e+03   1.29123840e+04
   2.28832056e+03   5.02948715e-04   1.46810515e+03   1.07970920e+04
   3.41118053e+02   4.32635304e+04   2.39646945e+04   8.47204891e+03
   2.36635304e+04   2.63819111e+04   1.18120076e+04   2.52346651e+03
   4.75498792e+03   2.12257173e+04   6.99245226e+03   2.51246479e+03
   3.29116518e+02   1.91099343e+04   3.84286045e+03   2.39562431e+02
   2.68158348e+04   1.31163417e+04   2.34377585e+04   4.64158348e+04
   8.58669741e+03   3.41440183e+03   1.30152050e+04   2.59169817e+04
   2.70116194e+03   2.84467728e+03   7.49376207e+03   2.07081086e+04
  -3.27298721e-07   4.20903782e+03   1.04827730e+04   1.87951243e+04
   3.27102711e+04   1.62755949e+04   2.13913326e+04   4.50356425e+04
   1.24086977e+04   4.05276417e+03   1.01897622e+04   2.20909468e+04
   5.40145993e+03   1.86113650e+03   4.88426951e+03   1.56778443e+04
   1.80000565e+03   1.57601534e+03   6.15507916e+03   1.27130950e+04
   3.76831595e-03   3.69525658e+04   1.86239817e+04   1.81010644e+04
   4.09786878e+04   1.59661856e+04   5.01929628e+03   7.17451408e+03
   1.72257985e+04   8.58829742e+03   1.57987734e+03   2.69872911e+03
   1.04147756e+04   4.68935442e+03   1.18481082e-04   2.54570182e+03
   7.10248570e+03   2.59195981e+03   3.10739700e+00   5.17610780e+04
   2.97661093e+04   1.46285407e+04   3.37889250e+04   3.08131676e+04
   1.41476228e+04   5.71537352e+03   1.00814368e+04   2.34561012e+04
   8.06578566e+03   4.08265518e+03   3.29276765e+03   1.95738700e+04
   3.70189493e+03   7.47531851e+02   1.20819109e-03   1.74931817e+04
   1.08303029e+04   5.27257888e+03   3.77047036e+04   2.09783047e+04
   3.05587750e+04   5.73047036e+04   1.53306941e+04   7.58910856e+03
   1.72642027e+04   3.19141653e+04   7.20175416e+03   5.53235303e+03
   1.03031450e+04   2.42968335e+04   2.70000754e+03   5.44793912e+03
   1.19684590e+04   2.02803192e+04   3.76870791e-03   3.76840607e-03
   2.29456645e+03   1.72124948e+04   4.53403838e+04   2.52657972e+04
   2.72056272e+04   5.40014431e+04   2.08972175e+04   9.01748255e+03
   1.34652446e+04   2.61689323e+04   1.16483500e+04   4.89754663e+03
   7.19262774e+03   1.73492764e+04   6.24773554e+03   2.69881670e+03
   6.60869087e+03   1.22826614e+04   2.64915391e+03   1.69845394e+02
   2.88630735e-03   8.78755115e+03   8.50570398e+02   5.51812012e+04
   3.19375213e+04   2.39256357e+04   4.91267335e+04   2.97826321e+04
   1.34692804e+04   1.08522473e+04   2.01666777e+04   2.00166546e+04
   7.22972849e+03   6.14069882e+03   1.07918664e+04   1.42010011e+04
   2.82571962e+03   3.11479688e+03   5.24038278e+03   1.01875144e+04
   4.76988568e+03   1.41598748e+03   1.94932000e+03   7.97402489e+03
   1.90989411e+03   5.92321930e+04   3.51219636e+04   2.17388509e+04
   4.49040456e+04   3.45497428e+04   1.65205046e+04   9.90888723e+03
   1.67891373e+04   2.51713634e+04   9.53885066e+03   6.51033289e+03
   7.83044081e+03   1.96668010e+04   4.33300876e+03   2.51170345e+03
   2.64238879e+03   1.59643049e+04   9.16676509e+03   4.11258159e+03
   8.44574362e-05   1.40618068e+04   5.84411720e+03   2.42203509e-04
   5.00753393e+04   3.00778094e+04   3.76472911e+04   6.77344423e+04
   2.36683836e+04   1.29202295e+04   2.17335424e+04   3.75843113e+04
   1.33566187e+04   9.18224100e+03   1.36214079e+04   2.76235573e+04
   7.10290936e+03   7.44135600e+03   1.37169306e+04   2.15603157e+04
   2.65150810e+03   1.41562118e+03   3.00990309e+03   1.68548932e+04
   1.03166636e-01   3.34742314e+02   6.32588957e+03   1.23066130e+04
   6.24850190e+04   3.91854057e+04   4.30483836e+04   7.54962719e+04
   3.26252584e+04   1.85235173e+04   2.51619161e+04   4.12712178e+04
   2.04446691e+04   1.29855738e+04   1.64484057e+04   2.93041441e+04
   1.26910177e+04   9.44676110e+03   1.47663315e+04   2.14885978e+04
   6.74015827e+03   3.89200542e+03   4.25452745e+03   1.55051517e+04
   2.58929208e+03   8.78382847e+02   4.77911594e+03   1.00379142e+04
   9.07471030e-02   6.21863268e+04   3.76260236e+04   3.27825038e+04
   6.17298399e+04   3.36974649e+04   1.69298426e+04   1.70622543e+04
   2.91226898e+04   2.22588721e+04   1.02575427e+04   1.05572867e+04
   1.79522035e+04   1.51007564e+04   5.48525062e+03   7.35736172e+03
   1.08323908e+04   9.74524057e+03   4.69545387e+03   2.30500761e+03
   5.99227352e+03   6.18971920e+03   1.01777652e+03   1.04285845e-03
   2.31339522e+03   3.51296247e+03   1.51197448e+03   6.96555606e+04
   4.31855735e+04   3.10206575e+04   5.82073991e+04   4.10794742e+04
   2.13884811e+04   1.62326589e+04   2.54973086e+04   2.95936713e+04
   1.33576794e+04   1.11112888e+04   1.42761388e+04   2.23976642e+04
   7.15711843e+03   6.28740083e+03   7.11205957e+03   1.70042692e+04
   9.89573798e+03   5.17192501e+03   2.69122917e+03   1.34108685e+04
   5.15273874e+03   2.42067505e-04   2.42098717e-04   1.01530282e+04
   6.81722905e+03   6.41430591e+02   7.16068298e+04   4.75361511e+04
   5.53188390e+04   9.12068298e+04   3.91759830e+04   2.52004457e+04
   3.50557945e+04   5.39474374e+04   2.56037979e+04   1.95356587e+04
   2.46017527e+04   4.04863838e+04   1.67332342e+04   1.59360363e+04
   2.30553379e+04   3.13660068e+04   9.66582286e+03   7.48211452e+03
   9.05510206e+03   2.40135657e+04   4.39840240e+03   3.96871962e+03
   1.00854743e+04   1.69278246e+04   1.04902410e+03   2.15243606e-02
   5.04495309e+03   1.21741947e+04   7.06552665e+04   4.48585702e+04
   4.33034465e+04   7.59577579e+04   3.91489495e+04   2.20142339e+04
Minimum distance inequality constraints (should all be > 0): [  2.19785509e+03   1.66310403e+04   7.91143218e+03   1.87000000e+04
   1.52144504e+04   3.59268797e+03   3.87219222e+03   3.12749384e-04
   1.27270103e+04   2.34721922e+04   1.29577762e+04   3.04649400e+03
   7.91442481e+03   2.23248797e+04   2.26928761e+03   2.21463130e+04
   9.19166326e+03   1.55110375e+03   1.26482245e+04   1.16288940e+04
   3.64101607e+03   2.53468007e+04   1.36353578e+04   5.63576817e-03
   5.74680074e+03   1.88549243e+04   1.07253313e+04   1.25056865e+03
   1.04360849e+04   2.79136766e+03   1.45949134e+04   3.00360849e+04
   4.98011853e+02   4.65114691e+02   9.91731218e+03   1.93221601e+04
   2.06401014e+04   7.43329242e+03   8.54305918e+03   2.52739330e+04
   6.52743095e+03   1.85949433e-04   2.32447964e+03   9.63324192e+03
   2.86992579e+03   2.46137909e+04   1.00851179e+04   5.20348949e+03
   2.01581178e+04   1.07813752e+04   2.05491242e+03   8.31985623e-05
   4.84817715e+03   7.27555744e+03   1.57929592e+02   3.35032992e+04
   1.77417744e+04   3.11501583e+03   1.39032992e+04   2.14654719e+04
   9.89809935e+03   5.22740076e+02   7.11291505e+02   1.89309718e+04
   6.81632231e+03   2.19410505e+03   1.77269908e+04   7.05439716e+03
   1.81167588e+04   3.73269908e+04   3.64271669e+03   1.03970572e+03
   1.05662180e+04   2.17198125e+04   5.81015133e-01   1.95700904e+03
   6.48438690e+03   1.89193931e+04   3.00442129e+04   1.35639408e+04
   1.07640051e+04   2.96930886e+04   1.25954539e+04   2.69878599e+03
   2.68402566e+03   1.01152204e+04   7.13229675e+03   6.69630926e-05
   1.02112969e-03   5.35980139e+03   4.77014100e+03   3.49484545e+04
   1.72378632e+04   8.02790120e+03   2.48005278e+04   1.80679658e+04
   5.96616337e+03   1.22645851e+03   5.89331959e+03   1.29123840e+04
   2.28832056e+03   5.02948715e-04   1.46810515e+03   1.07970920e+04
   3.41118053e+02   4.32635304e+04   2.39646945e+04   8.47204891e+03
   2.36635304e+04   2.63819111e+04   1.18120076e+04   2.52346651e+03
   4.75498792e+03   2.12257173e+04   6.99245226e+03   2.51246479e+03
   3.29116518e+02   1.91099343e+04   3.84286045e+03   2.39562431e+02
   2.68158348e+04   1.31163417e+04   2.34377585e+04   4.64158348e+04
   8.58669741e+03   3.41440183e+03   1.30152050e+04   2.59169817e+04
   2.70116194e+03   2.84467728e+03   7.49376207e+03   2.07081086e+04
  -3.27298721e-07   4.20903782e+03   1.04827730e+04   1.87951243e+04
   3.27102711e+04   1.62755949e+04   2.13913326e+04   4.50356425e+04
   1.24086977e+04   4.05276417e+03   1.01897622e+04   2.20909468e+04
   5.40145993e+03   1.86113650e+03   4.88426951e+03   1.56778443e+04
   1.80000565e+03   1.57601534e+03   6.15507916e+03   1.27130950e+04
   3.76831595e-03   3.69525658e+04   1.86239817e+04   1.81010644e+04
   4.09786878e+04   1.59661856e+04   5.01929628e+03   7.17451408e+03
   1.72257985e+04   8.58829742e+03   1.57987734e+03   2.69872911e+03
   1.04147756e+04   4.68935442e+03   1.18481082e-04   2.54570182e+03
   7.10248570e+03   2.59195981e+03   3.10739700e+00   5.17610780e+04
   2.97661093e+04   1.46285407e+04   3.37889250e+04   3.08131676e+04
   1.41476228e+04   5.71537352e+03   1.00814368e+04   2.34561012e+04
   8.06578566e+03   4.08265518e+03   3.29276765e+03   1.95738700e+04
   3.70189493e+03   7.47531851e+02   1.20819109e-03   1.74931817e+04
   1.08303029e+04   5.27257888e+03   3.77047036e+04   2.09783047e+04
   3.05587750e+04   5.73047036e+04   1.53306941e+04   7.58910856e+03
   1.72642027e+04   3.19141653e+04   7.20175416e+03   5.53235303e+03
   1.03031450e+04   2.42968335e+04   2.70000754e+03   5.44793912e+03
   1.19684590e+04   2.02803192e+04   3.76870791e-03   3.76840607e-03
   2.29456645e+03   1.72124948e+04   4.53403838e+04   2.52657972e+04
   2.72056272e+04   5.40014431e+04   2.08972175e+04   9.01748255e+03
   1.34652446e+04   2.61689323e+04   1.16483500e+04   4.89754663e+03
   7.19262774e+03   1.73492764e+04   6.24773554e+03   2.69881670e+03
   6.60869087e+03   1.22826614e+04   2.64915391e+03   1.69845394e+02
   2.88630735e-03   8.78755115e+03   8.50570398e+02   5.51812012e+04
   3.19375213e+04   2.39256357e+04   4.91267335e+04   2.97826321e+04
   1.34692804e+04   1.08522473e+04   2.01666777e+04   2.00166546e+04
   7.22972849e+03   6.14069882e+03   1.07918664e+04   1.42010011e+04
   2.82571962e+03   3.11479688e+03   5.24038278e+03   1.01875144e+04
   4.76988568e+03   1.41598748e+03   1.94932000e+03   7.97402489e+03
   1.90989411e+03   5.92321930e+04   3.51219636e+04   2.17388509e+04
   4.49040456e+04   3.45497428e+04   1.65205046e+04   9.90888723e+03
   1.67891373e+04   2.51713634e+04   9.53885066e+03   6.51033289e+03
   7.83044081e+03   1.96668010e+04   4.33300876e+03   2.51170345e+03
   2.64238879e+03   1.59643049e+04   9.16676509e+03   4.11258159e+03
   8.44574362e-05   1.40618068e+04   5.84411720e+03   2.42203509e-04
   5.00753393e+04   3.00778094e+04   3.76472911e+04   6.77344423e+04
   2.36683836e+04   1.29202295e+04   2.17335424e+04   3.75843113e+04
   1.33566187e+04   9.18224100e+03   1.36214079e+04   2.76235573e+04
   7.10290936e+03   7.44135600e+03   1.37169306e+04   2.15603157e+04
   2.65150810e+03   1.41562118e+03   3.00990309e+03   1.68548932e+04
   1.03166636e-01   3.34742314e+02   6.32588957e+03   1.23066130e+04
   6.24850190e+04   3.91854057e+04   4.30483836e+04   7.54962719e+04
   3.26252584e+04   1.85235173e+04   2.51619161e+04   4.12712178e+04
   2.04446691e+04   1.29855738e+04   1.64484057e+04   2.93041441e+04
   1.26910177e+04   9.44676110e+03   1.47663315e+04   2.14885978e+04
   6.74015827e+03   3.89200542e+03   4.25452745e+03   1.55051517e+04
   2.58929208e+03   8.78382847e+02   4.77911594e+03   1.00379142e+04
   9.07471030e-02   6.21863268e+04   3.76260236e+04   3.27825038e+04
   6.17298399e+04   3.36974649e+04   1.69298426e+04   1.70622543e+04
   2.91226898e+04   2.22588721e+04   1.02575427e+04   1.05572867e+04
   1.79522035e+04   1.51007564e+04   5.48525062e+03   7.35736172e+03
   1.08323908e+04   9.74524057e+03   4.69545387e+03   2.30500761e+03
   5.99227352e+03   6.18971920e+03   1.01777652e+03   1.04285845e-03
   2.31339522e+03   3.51296247e+03   1.51197448e+03   6.96555606e+04
   4.31855735e+04   3.10206575e+04   5.82073991e+04   4.10794742e+04
   2.13884811e+04   1.62326589e+04   2.54973086e+04   2.95936713e+04
   1.33576794e+04   1.11112888e+04   1.42761388e+04   2.23976642e+04
   7.15711843e+03   6.28740083e+03   7.11205957e+03   1.70042692e+04
   9.89573798e+03   5.17192501e+03   2.69122917e+03   1.34108685e+04
   5.15273874e+03   2.42067505e-04   2.42098717e-04   1.01530282e+04
   6.81722905e+03   6.41430591e+02   7.16068298e+04   4.75361511e+04
   5.53188390e+04   9.12068298e+04   3.91759830e+04   2.52004457e+04
   3.50557945e+04   5.39474374e+04   2.56037979e+04   1.95356587e+04
   2.46017527e+04   4.04863838e+04   1.67332342e+04   1.59360363e+04
   2.30553379e+04   3.13660068e+04   9.66582286e+03   7.48211452e+03
   9.05510206e+03   2.40135657e+04   4.39840240e+03   3.96871962e+03
   1.00854743e+04   1.69278246e+04   1.04902410e+03   2.15243606e-02
   5.04495309e+03   1.21741947e+04   7.06552665e+04   4.48585702e+04
   4.33034465e+04   7.59577579e+04   3.91489495e+04   2.20142339e+04
   2.49722657e+04   3.97894749e+04   2.60771645e+04   1.49547575e+04
   1.66784678e+04   2.68656375e+04   1.76082283e+04   9.86011510e+03
   1.33511596e+04   1.82144610e+04   1.09423148e+04   6.30606334e+03
   4.91838080e+03   1.18496352e+04   6.07639306e+03   1.85735631e+03
   2.69942844e+03   6.45473217e+03   2.40976368e+03   4.06110087e-04
   1.74488872e-02   3.12868877e+03   1.75215996e+03   7.69192570e+04
   4.91326466e+04   4.01360963e+04   7.10690762e+04   4.52528778e+04
   2.51076140e+04   2.27012366e+04   3.47118914e+04   3.20944594e+04
   1.66440643e+04   1.57864474e+04   2.16950467e+04   2.35559901e+04
   1.00752201e+04   1.07885364e+04   1.29626383e+04   1.68205661e+04
   1.00798769e+04   6.31951583e+03   6.99275338e+03   1.18851335e+04
   4.51919185e+03   1.15857198e+03   2.57196591e+03   7.59867178e+03
   3.80865828e+03   2.42019960e-04   1.04287461e-03   7.39224425e+03
   6.87848473e+02   8.05065177e+04   5.19371363e+04   3.41751840e+04
   6.09065177e+04   5.09303427e+04   2.84914400e+04   1.94304309e+04
   2.70161450e+04   3.89032436e+04   1.91175346e+04   1.50103014e+04
   1.52138543e+04   3.12727854e+04   1.15307617e+04   8.68329447e+03
   7.54222824e+03   2.54450794e+04   1.66065964e+04   1.00851565e+04
   3.03383893e+03   2.14173669e+04   1.06676167e+04   2.35459993e+03
   7.09083375e+02   1.73333233e+04   1.26691851e+04   3.83634877e+03
   4.15445113e-03   1.91269082e+04   7.20503785e+03   1.74032369e+03]
   2.49722657e+04   3.97894749e+04   2.60771645e+04   1.49547575e+04
   1.66784678e+04   2.68656375e+04   1.76082283e+04   9.86011510e+03
   1.33511596e+04   1.82144610e+04   1.09423148e+04   6.30606334e+03
   4.91838080e+03   1.18496352e+04   6.07639306e+03   1.85735631e+03
   2.69942844e+03   6.45473217e+03   2.40976368e+03   4.06110087e-04
   1.74488872e-02   3.12868877e+03   1.75215996e+03   7.69192570e+04
   4.91326466e+04   4.01360963e+04   7.10690762e+04   4.52528778e+04
   2.51076140e+04   2.27012366e+04   3.47118914e+04   3.20944594e+04
   1.66440643e+04   1.57864474e+04   2.16950467e+04   2.35559901e+04
   1.00752201e+04   1.07885364e+04   1.29626383e+04   1.68205661e+04
   1.00798769e+04   6.31951583e+03   6.99275338e+03   1.18851335e+04
   4.51919185e+03   1.15857198e+03   2.57196591e+03   7.59867178e+03
   3.80865828e+03   2.42019960e-04   1.04287461e-03   7.39224425e+03
   6.87848473e+02   8.05065177e+04   5.19371363e+04   3.41751840e+04
   6.09065177e+04   5.09303427e+04   2.84914400e+04   1.94304309e+04
Start evaluation of dj
   2.70161450e+04   3.89032436e+04   1.91175346e+04   1.50103014e+04
found a tidal farm, computing gradient
   1.52138543e+04   3.12727854e+04   1.15307617e+04   8.68329447e+03
   7.54222824e+03   2.54450794e+04   1.66065964e+04   1.00851565e+04
   3.03383893e+03   2.14173669e+04   1.06676167e+04   2.35459993e+03
   7.09083375e+02   1.73333233e+04   1.26691851e+04   3.83634877e+03
   4.15445113e-03   1.91269082e+04   7.20503785e+03   1.74032369e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.78526997566 s
Runtime: 7.78675794601 s
|dj| = 12426.889493
|dj| = 12426.889493
Start evaluation of j
Updating the turbine cache
   46    84    -3.106650E+04     2.776990E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 5.808e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.041e+00 (tol = 1.000e-10) r (rel) = 1.792e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.523e-02 (tol = 1.000e-10) r (rel) = 6.066e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.861e-05 (tol = 1.000e-10) r (rel) = 8.370e-06 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 1.140e-10 (tol = 1.000e-10) r (rel) = 1.963e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 24.735756 s.
End of time loop.
j = 1.385706e+06.
Runtime: 24.708554 s.
j = 1.385706e+06.
Minimum distance inequality constraints (should all be > 0): [  2.25085314e+03   1.69776306e+04   8.01262929e+03   1.87000000e+04
   1.51930246e+04   3.75664843e+03   3.88099696e+03   1.83151812e-01
   1.28632476e+04   2.34809970e+04   1.31804568e+04   3.11041387e+03
   7.93680890e+03   2.25039075e+04   2.35652430e+03   2.24063894e+04
   9.25669177e+03   1.49891761e+03   1.28228584e+04   1.17613524e+04
   3.66129028e+03   2.57343013e+04   1.36981015e+04   1.09112781e+00
   6.13430129e+03   1.89168547e+04   1.06098457e+04   1.14579202e+03
   1.03365718e+04   2.70749410e+03   1.45770973e+04   2.99365718e+04
   4.58507992e+02   4.93816470e+02   9.99400562e+03   1.91898235e+04
   2.08961094e+04   7.50681150e+03   8.46712730e+03   2.54215676e+04
   6.66664090e+03   7.82858945e-02   2.31091040e+03   9.39668146e+03
   2.98859573e+03   2.49307341e+04   1.01890623e+04   5.13602119e+03
   2.03706959e+04   1.09606294e+04   2.07615282e+03   7.13983854e-03
   4.66041119e+03   7.42083939e+03   1.56403320e+02   3.36570158e+04
   1.77128714e+04   2.98007720e+03   1.40570158e+04   2.15253610e+04
   9.85990841e+03   4.95278299e+02   5.76721734e+02   1.89655655e+04
   6.75407122e+03   2.16194590e+03   1.75967340e+04   6.91681000e+03
   1.79777995e+04   3.71967340e+04   3.56998481e+03   9.83430236e+02
   1.05612372e+04   2.14177409e+04   9.37238611e-05   2.00064136e+03
   6.54541580e+03   1.88877947e+04   3.03635964e+04   1.36686951e+04
   1.06718002e+04   2.99388318e+04   1.27823150e+04   2.69975757e+03
   2.68570259e+03   9.84828614e+03   7.31756992e+03   2.37528325e-02
   1.58202771e-02   5.34286033e+03   4.87535639e+03   3.53408912e+04
   1.73775655e+04   7.97045706e+03   2.51572700e+04   1.82886515e+04
   5.98208347e+03   1.25122952e+03   5.70843769e+03   1.31059145e+04
   2.27630729e+03   1.11218186e-01   1.49703393e+03   1.08932376e+04
   3.29371040e+02   4.31486051e+04   2.37405688e+04   8.08968495e+03
   2.35486051e+04   2.63065859e+04   1.16643035e+04   2.38779967e+03
   4.35476469e+03   2.12359080e+04   6.88085434e+03   2.41649504e+03
   2.60193854e+02   1.91144400e+04   3.81849619e+03   2.33282659e+02
   2.66568960e+04   1.29261257e+04   2.31785016e+04   4.62568960e+04
   8.48146150e+03   3.27304402e+03   1.29284688e+04   2.54456584e+04
   2.70000019e+03   2.81268708e+03   7.46999231e+03   2.06100239e+04
  -3.23666427e-09   4.23314304e+03   1.04805608e+04   1.87929720e+04
   3.25369769e+04   1.60452446e+04   2.10380375e+04   4.48623635e+04
   1.22871999e+04   3.86076105e+03   1.00462962e+04   2.15350037e+04
   5.40000023e+03   1.77122362e+03   4.79873624e+03   1.55465251e+04
   1.80000000e+03   1.54590319e+03   6.09707108e+03   1.27076247e+04
   2.70847522e-09   3.72600212e+04   1.87202914e+04   1.79836936e+04
   4.12523691e+04   1.61498785e+04   4.99514733e+03   7.17757982e+03
   1.68814088e+04   8.80405686e+03   1.57924250e+03   2.69871981e+03
   1.04147703e+04   4.83076772e+03   2.78289277e-02   2.52428412e+03
   7.15204247e+03   2.65747884e+03   2.44151534e+01   5.18240433e+04
   2.96600576e+04   1.41903612e+04   3.36887337e+04   3.08960687e+04
   1.40555456e+04   5.56193685e+03   9.53873835e+03   2.36473526e+04
   7.99614465e+03   3.98209012e+03   3.17334222e+03   1.97531012e+04
   3.68647926e+03   6.91966894e+02   3.52785661e-01   1.76588500e+04
   1.09589236e+04   5.34705707e+03   3.75170579e+04   2.07354414e+04
   3.01792037e+04   5.71170579e+04   1.51929382e+04   7.36265781e+03
   1.70957003e+04   3.12735758e+04   7.20000028e+03   5.42473280e+03
   1.01945688e+04   2.41322531e+04   2.70000000e+03   5.39092969e+03
   1.18678839e+04   2.02715041e+04   5.86965143e-09   1.78818027e-09
   2.28418995e+03   1.73645988e+04   4.55085132e+04   2.52675680e+04
   2.70498201e+04   5.42722231e+04   2.09829836e+04   8.92066047e+03
   1.34683193e+04   2.57584894e+04   1.18165735e+04   4.87235822e+03
   7.19034822e+03   1.73937031e+04   6.36144209e+03   2.69846436e+03
   6.59951817e+03   1.24485105e+04   2.70631105e+03   2.17780697e+02
   3.41344512e-01   9.00580924e+03   8.51180013e+02   5.49705670e+04
   3.16039175e+04   2.32582139e+04   4.87931913e+04   2.96453491e+04
   1.31607353e+04   1.05169568e+04   1.93094571e+04   2.00526614e+04
   6.99886591e+03   5.87560876e+03   1.05002332e+04   1.42505673e+04
   2.65787530e+03   2.88358427e+03   5.16110367e+03   1.02484737e+04
   4.81374205e+03   1.34820978e+03   1.93495291e+03   8.04637998e+03
   1.98083820e+03   5.92316933e+04   3.49452522e+04   2.11945536e+04
   4.47620389e+04   3.45708837e+04   1.63322812e+04   9.67653238e+03
   1.60842143e+04   2.53323620e+04   9.39208660e+03   6.32888256e+03
   7.64424438e+03   1.98185364e+04   4.23683548e+03   2.36141809e+03
   2.63241116e+03   1.61047112e+04   9.27525867e+03   4.10675630e+03
   7.36433907e-03   1.41908859e+04   5.98602345e+03   1.47829339e-01
   5.05550185e+04   3.06377131e+04   3.92503745e+04   7.01550185e+04
   2.39668404e+04   1.34417841e+04   2.32546029e+04   3.91393473e+04
   1.37009256e+04   9.98520045e+03   1.48706967e+04   2.96282160e+04
   7.35086790e+03   8.45669589e+03   1.51695700e+04   2.36669356e+04
   2.80081061e+03   1.87578197e+03   3.77630202e+03   1.89379465e+04
   5.07533230e+01   8.20240485e+02   7.65882891e+03   1.40996199e+04
   6.12165659e+04   3.80758580e+04   4.20061912e+04   7.46663258e+04
   3.16655116e+04   1.76556657e+04   2.45575272e+04   4.00567647e+04
   1.98202214e+04   1.23910681e+04   1.59314719e+04   2.88989748e+04
   1.21846534e+04   9.04731230e+03   1.43930102e+04   2.14781424e+04
   6.34908595e+03   3.63995989e+03   3.96648458e+03   1.57128816e+04
   2.31351847e+03   7.00729861e+02   4.94736226e+03   1.02930188e+04
   4.15054254e+01   6.17756141e+04   3.71220104e+04   3.19658892e+04
   6.12708277e+04   3.33901940e+04   1.64587189e+04   1.66082025e+04
   2.80751499e+04   2.21662507e+04   9.90126057e+03   1.01757620e+04
   1.75651770e+04   1.50364193e+04   5.20390354e+03   7.01111950e+03
   1.07185514e+04   9.70658839e+03   4.66068954e+03   2.12567246e+03
   5.97278555e+03   6.17675744e+03   9.74788387e+02   1.27738164e-01
   2.31287815e+03   4.42454526e+03   1.65483995e+03   6.94844843e+04
   4.28518405e+04   3.03347716e+04   5.79959462e+04   4.09446786e+04
   2.10361699e+04   1.58908481e+04   2.46130028e+04   2.96384394e+04
   1.30793399e+04   1.08122933e+04   1.40172280e+04   2.24416243e+04
   6.94082404e+03   6.02217213e+03   7.09455008e+03   1.70448097e+04
   9.92708877e+03   5.04328181e+03   2.69321635e+03   1.34479951e+04
   5.17417857e+03   1.47829337e-01   1.47829333e-01   1.16269365e+04
   7.08610990e+03   6.40057568e+02   7.13809131e+04   4.71909879e+04
   5.46712098e+04   9.09809131e+04   3.89826241e+04   2.47857265e+04
   3.47072467e+04   5.29177324e+04   2.56196018e+04   1.92598525e+04
   2.43029447e+04   4.01775530e+04   1.67486973e+04   1.56947012e+04
   2.27290344e+04   3.13541353e+04   9.67779332e+03   7.49234133e+03
   8.87008135e+03   2.41424158e+04   4.40688934e+03   3.83874377e+03
   1.01914213e+04   1.70359237e+04   8.65185572e+02   6.37203979e+00
   5.09768091e+03   1.22062635e+04   6.91944559e+04   4.35408302e+04
   4.19993740e+04   7.49230336e+04   3.80095009e+04   2.09429106e+04
   2.41512528e+04   3.83315946e+04   2.52932520e+04   1.41513384e+04
   1.59465003e+04   2.62657421e+04   1.69487797e+04   9.25980321e+03
   1.27737092e+04   1.80400286e+04   1.04043078e+04   5.90785665e+03
   4.44601709e+03   1.18650808e+04   5.65983586e+03   1.53646996e+03
   2.70352635e+03   6.52939209e+03   2.65920405e+03   1.24728720e-02
   5.41747261e+00   3.24684901e+03   1.63127103e+03   7.65608460e+04
   4.86388912e+04   3.93078133e+04   7.07401309e+04   4.49587339e+04
   2.46007846e+04   2.22464655e+04   3.36426916e+04   3.20201175e+04
   1.62470329e+04   1.53766973e+04   2.13449984e+04   2.34946522e+04
   9.75081119e+03   1.04125961e+04   1.29137879e+04   1.67691874e+04
   1.00389582e+04   6.08446393e+03   6.99211802e+03   1.18437226e+04
   4.43167677e+03   1.16183093e+03   2.57357147e+03   8.65706457e+03
   4.05659951e+03   1.50151489e+00   1.11939222e-01   7.37565635e+03
   8.10453683e+02   8.05854312e+04   5.17800433e+04   3.36384319e+04
   6.09854312e+04   5.09644481e+04   2.82461874e+04   1.92087653e+04
   2.62910484e+04   3.90818820e+04   1.89114676e+04   1.47937306e+04
   1.50943946e+04   3.14159739e+04   1.13696363e+04   8.49145136e+03
   7.63911437e+03   2.55500663e+04   1.66924991e+04   9.98709591e+03
   3.07886162e+03   2.14841587e+04   1.07191282e+04   2.36299157e+03
   7.22236248e+02   1.91809617e+04   1.30324831e+04   3.83068419e+03
   3.56847904e-01   1.91033378e+04   7.41077058e+03   1.72702748e+03]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  2.25085314e+03   1.69776306e+04   8.01262929e+03   1.87000000e+04
   1.51930246e+04   3.75664843e+03   3.88099696e+03   1.83151812e-01
   1.28632476e+04   2.34809970e+04   1.31804568e+04   3.11041387e+03
   7.93680890e+03   2.25039075e+04   2.35652430e+03   2.24063894e+04
   9.25669177e+03   1.49891761e+03   1.28228584e+04   1.17613524e+04
   3.66129028e+03   2.57343013e+04   1.36981015e+04   1.09112781e+00
   6.13430129e+03   1.89168547e+04   1.06098457e+04   1.14579202e+03
   1.03365718e+04   2.70749410e+03   1.45770973e+04   2.99365718e+04
   4.58507992e+02   4.93816470e+02   9.99400562e+03   1.91898235e+04
   2.08961094e+04   7.50681150e+03   8.46712730e+03   2.54215676e+04
   6.66664090e+03   7.82858945e-02   2.31091040e+03   9.39668146e+03
   2.98859573e+03   2.49307341e+04   1.01890623e+04   5.13602119e+03
   2.03706959e+04   1.09606294e+04   2.07615282e+03   7.13983854e-03
   4.66041119e+03   7.42083939e+03   1.56403320e+02   3.36570158e+04
   1.77128714e+04   2.98007720e+03   1.40570158e+04   2.15253610e+04
   9.85990841e+03   4.95278299e+02   5.76721734e+02   1.89655655e+04
   6.75407122e+03   2.16194590e+03   1.75967340e+04   6.91681000e+03
   1.79777995e+04   3.71967340e+04   3.56998481e+03   9.83430236e+02
   1.05612372e+04   2.14177409e+04   9.37238611e-05   2.00064136e+03
   6.54541580e+03   1.88877947e+04   3.03635964e+04   1.36686951e+04
   1.06718002e+04   2.99388318e+04   1.27823150e+04   2.69975757e+03
   2.68570259e+03   9.84828614e+03   7.31756992e+03   2.37528325e-02
   1.58202771e-02   5.34286033e+03   4.87535639e+03   3.53408912e+04
   1.73775655e+04   7.97045706e+03   2.51572700e+04   1.82886515e+04
   5.98208347e+03   1.25122952e+03   5.70843769e+03   1.31059145e+04
   2.27630729e+03   1.11218186e-01   1.49703393e+03   1.08932376e+04
   3.29371040e+02   4.31486051e+04   2.37405688e+04   8.08968495e+03
   2.35486051e+04   2.63065859e+04   1.16643035e+04   2.38779967e+03
   4.35476469e+03   2.12359080e+04   6.88085434e+03   2.41649504e+03
   2.60193854e+02   1.91144400e+04   3.81849619e+03   2.33282659e+02
   2.66568960e+04   1.29261257e+04   2.31785016e+04   4.62568960e+04
   8.48146150e+03   3.27304402e+03   1.29284688e+04   2.54456584e+04
   2.70000019e+03   2.81268708e+03   7.46999231e+03   2.06100239e+04
  -3.23666427e-09   4.23314304e+03   1.04805608e+04   1.87929720e+04
   3.25369769e+04   1.60452446e+04   2.10380375e+04   4.48623635e+04
   1.22871999e+04   3.86076105e+03   1.00462962e+04   2.15350037e+04
   5.40000023e+03   1.77122362e+03   4.79873624e+03   1.55465251e+04
   1.80000000e+03   1.54590319e+03   6.09707108e+03   1.27076247e+04
   2.70847522e-09   3.72600212e+04   1.87202914e+04   1.79836936e+04
   4.12523691e+04   1.61498785e+04   4.99514733e+03   7.17757982e+03
   1.68814088e+04   8.80405686e+03   1.57924250e+03   2.69871981e+03
   1.04147703e+04   4.83076772e+03   2.78289277e-02   2.52428412e+03
   7.15204247e+03   2.65747884e+03   2.44151534e+01   5.18240433e+04
   2.96600576e+04   1.41903612e+04   3.36887337e+04   3.08960687e+04
   1.40555456e+04   5.56193685e+03   9.53873835e+03   2.36473526e+04
   7.99614465e+03   3.98209012e+03   3.17334222e+03   1.97531012e+04
   3.68647926e+03   6.91966894e+02   3.52785661e-01   1.76588500e+04
   1.09589236e+04   5.34705707e+03   3.75170579e+04   2.07354414e+04
   3.01792037e+04   5.71170579e+04   1.51929382e+04   7.36265781e+03
   1.70957003e+04   3.12735758e+04   7.20000028e+03   5.42473280e+03
   1.01945688e+04   2.41322531e+04   2.70000000e+03   5.39092969e+03
   1.18678839e+04   2.02715041e+04   5.86965143e-09   1.78818027e-09
   2.28418995e+03   1.73645988e+04   4.55085132e+04   2.52675680e+04
   2.70498201e+04   5.42722231e+04   2.09829836e+04   8.92066047e+03
   1.34683193e+04   2.57584894e+04   1.18165735e+04   4.87235822e+03
   7.19034822e+03   1.73937031e+04   6.36144209e+03   2.69846436e+03
   6.59951817e+03   1.24485105e+04   2.70631105e+03   2.17780697e+02
   3.41344512e-01   9.00580924e+03   8.51180013e+02   5.49705670e+04
   3.16039175e+04   2.32582139e+04   4.87931913e+04   2.96453491e+04
   1.31607353e+04   1.05169568e+04   1.93094571e+04   2.00526614e+04
   6.99886591e+03   5.87560876e+03   1.05002332e+04   1.42505673e+04
   2.65787530e+03   2.88358427e+03   5.16110367e+03   1.02484737e+04
   4.81374205e+03   1.34820978e+03   1.93495291e+03   8.04637998e+03
   1.98083820e+03   5.92316933e+04   3.49452522e+04   2.11945536e+04
   4.47620389e+04   3.45708837e+04   1.63322812e+04   9.67653238e+03
   1.60842143e+04   2.53323620e+04   9.39208660e+03   6.32888256e+03
   7.64424438e+03   1.98185364e+04   4.23683548e+03   2.36141809e+03
   2.63241116e+03   1.61047112e+04   9.27525867e+03   4.10675630e+03
   7.36433907e-03   1.41908859e+04   5.98602345e+03   1.47829339e-01
   5.05550185e+04   3.06377131e+04   3.92503745e+04   7.01550185e+04
   2.39668404e+04   1.34417841e+04   2.32546029e+04   3.91393473e+04
   1.37009256e+04   9.98520045e+03   1.48706967e+04   2.96282160e+04
   7.35086790e+03   8.45669589e+03   1.51695700e+04   2.36669356e+04
   2.80081061e+03   1.87578197e+03   3.77630202e+03   1.89379465e+04
   5.07533230e+01   8.20240485e+02   7.65882891e+03   1.40996199e+04
   6.12165659e+04   3.80758580e+04   4.20061912e+04   7.46663258e+04
   3.16655116e+04   1.76556657e+04   2.45575272e+04   4.00567647e+04
   1.98202214e+04   1.23910681e+04   1.59314719e+04   2.88989748e+04
   1.21846534e+04   9.04731230e+03   1.43930102e+04   2.14781424e+04
   6.34908595e+03   3.63995989e+03   3.96648458e+03   1.57128816e+04
   2.31351847e+03   7.00729861e+02   4.94736226e+03   1.02930188e+04
   4.15054254e+01   6.17756141e+04   3.71220104e+04   3.19658892e+04
   6.12708277e+04   3.33901940e+04   1.64587189e+04   1.66082025e+04
   2.80751499e+04   2.21662507e+04   9.90126057e+03   1.01757620e+04
   1.75651770e+04   1.50364193e+04   5.20390354e+03   7.01111950e+03
   1.07185514e+04   9.70658839e+03   4.66068954e+03   2.12567246e+03
   5.97278555e+03   6.17675744e+03   9.74788387e+02   1.27738164e-01
   2.31287815e+03   4.42454526e+03   1.65483995e+03   6.94844843e+04
   4.28518405e+04   3.03347716e+04   5.79959462e+04   4.09446786e+04
   2.10361699e+04   1.58908481e+04   2.46130028e+04   2.96384394e+04
   1.30793399e+04   1.08122933e+04   1.40172280e+04   2.24416243e+04
   6.94082404e+03   6.02217213e+03   7.09455008e+03   1.70448097e+04
   9.92708877e+03   5.04328181e+03   2.69321635e+03   1.34479951e+04
   5.17417857e+03   1.47829337e-01   1.47829333e-01   1.16269365e+04
   7.08610990e+03   6.40057568e+02   7.13809131e+04   4.71909879e+04
   5.46712098e+04   9.09809131e+04   3.89826241e+04   2.47857265e+04
   3.47072467e+04   5.29177324e+04   2.56196018e+04   1.92598525e+04
   2.43029447e+04   4.01775530e+04   1.67486973e+04   1.56947012e+04
   2.27290344e+04   3.13541353e+04   9.67779332e+03   7.49234133e+03
   8.87008135e+03   2.41424158e+04   4.40688934e+03   3.83874377e+03
   1.01914213e+04   1.70359237e+04   8.65185572e+02   6.37203979e+00
   5.09768091e+03   1.22062635e+04   6.91944559e+04   4.35408302e+04
   4.19993740e+04   7.49230336e+04   3.80095009e+04   2.09429106e+04
   2.41512528e+04   3.83315946e+04   2.52932520e+04   1.41513384e+04
   1.59465003e+04   2.62657421e+04   1.69487797e+04   9.25980321e+03
   1.27737092e+04   1.80400286e+04   1.04043078e+04   5.90785665e+03
   4.44601709e+03   1.18650808e+04   5.65983586e+03   1.53646996e+03
   2.70352635e+03   6.52939209e+03   2.65920405e+03   1.24728720e-02
   5.41747261e+00   3.24684901e+03   1.63127103e+03   7.65608460e+04
   4.86388912e+04   3.93078133e+04   7.07401309e+04   4.49587339e+04
   2.46007846e+04   2.22464655e+04   3.36426916e+04   3.20201175e+04
   1.62470329e+04   1.53766973e+04   2.13449984e+04   2.34946522e+04
   9.75081119e+03   1.04125961e+04   1.29137879e+04   1.67691874e+04
   1.00389582e+04   6.08446393e+03   6.99211802e+03   1.18437226e+04
   4.43167677e+03   1.16183093e+03   2.57357147e+03   8.65706457e+03
   4.05659951e+03   1.50151489e+00   1.11939222e-01   7.37565635e+03
   8.10453683e+02   8.05854312e+04   5.17800433e+04   3.36384319e+04
   6.09854312e+04   5.09644481e+04   2.82461874e+04   1.92087653e+04
   2.62910484e+04   3.90818820e+04   1.89114676e+04   1.47937306e+04
   1.50943946e+04   3.14159739e+04   1.13696363e+04   8.49145136e+03
   7.63911437e+03   2.55500663e+04   1.66924991e+04   9.98709591e+03
   3.07886162e+03   2.14841587e+04   1.07191282e+04   2.36299157e+03
   7.22236248e+02   1.91809617e+04   1.30324831e+04   3.83068419e+03
   3.56847904e-01   1.91033378e+04   7.41077058e+03   1.72702748e+03]
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 6.672e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 8.474e-01 (tol = 1.000e-10) r (rel) = 1.270e-01 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.735e-02 (tol = 1.000e-10) r (rel) = 5.598e-03 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 9.524e-05 (tol = 1.000e-10) r (rel) = 1.428e-05 (tol = 1.000e-09)
  Newton iteration 4: r (abs) = 6.014e-10 (tol = 1.000e-10) r (rel) = 9.015e-11 (tol = 1.000e-09)
  Newton solver finished in 4 iterations and 4 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 22.628955 s.
j = 1.390156e+06.
End of time loop.
Runtime: 22.619767 s.
j = 1.390156e+06.
Minimum distance inequality constraints (should all be > 0): [  2.20365575e+03   1.66688522e+04   7.92241217e+03   1.87000000e+04
   1.52120738e+04   3.61043344e+03   3.87315924e+03   2.48947710e-03
   1.27417283e+04   2.34731592e+04   1.29821544e+04   3.05348739e+03
   7.91682647e+03   2.23444615e+04   2.27879524e+03   2.21748032e+04
   9.19878505e+03   1.54531767e+03   1.26673267e+04   1.16433728e+04
   3.64324122e+03   2.53888404e+04   1.36418754e+04   1.81891257e-02
   5.78884042e+03   1.88612208e+04   1.07124475e+04   1.23883926e+03
   1.04251295e+04   2.78207158e+03   1.45925249e+04   3.00251295e+04
   4.93643692e+02   4.68071925e+02   9.92555073e+03   1.93068468e+04
   2.06681557e+04   7.44135451e+03   8.53465509e+03   2.52900798e+04
   6.54266144e+03   1.11062094e-03   2.32298705e+03   9.60699710e+03
   2.88279698e+03   2.46485158e+04   1.00965095e+04   5.19603455e+03
   2.01813756e+04   1.08009828e+04   2.05724160e+03   1.60252579e-04
   4.82733906e+03   7.29131398e+03   1.57759586e+02   3.35201499e+04
   1.77385866e+04   3.10006922e+03   1.39201499e+04   2.14720208e+04
   9.89389136e+03   5.19707281e+02   6.96218784e+02   1.89346548e+04
   6.80946557e+03   2.19054887e+03   1.77126565e+04   7.03919766e+03
   1.81010560e+04   3.73126565e+04   3.63469659e+03   1.03332343e+03
   1.05654801e+04   2.16858442e+04   5.17177402e-01   1.96163311e+03
   6.49088349e+03   1.89158011e+04   3.00792237e+04   1.35754286e+04
   1.07538176e+04   2.97200081e+04   1.26159142e+04   2.69889119e+03
   2.68420973e+03   1.00856733e+04   7.15247064e+03   3.46360582e-04
   1.09992310e-03   5.35792742e+03   4.78151602e+03   3.49914399e+04
   1.72531542e+04   8.02154953e+03   2.48395912e+04   1.80920941e+04
   5.96790772e+03   1.22916964e+03   5.87286761e+03   1.29333868e+04
   2.28697997e+03   1.79036336e-03   1.47125451e+03   1.08073916e+04
   3.39817475e+02   4.32508899e+04   2.39400044e+04   8.42964434e+03
   2.36508899e+04   2.63736166e+04   1.17956092e+04   2.50839784e+03
   4.71029530e+03   2.12268360e+04   6.98004661e+03   2.50174067e+03
   3.21446418e+02   1.91104281e+04   3.84002608e+03   2.38642407e+02
   2.67983491e+04   1.30953597e+04   2.34088380e+04   4.63983491e+04
   8.57510595e+03   3.39867114e+03   1.30054842e+04   2.58644169e+04
   2.70103428e+03   2.84099235e+03   7.49094143e+03   2.06972115e+04
  -2.91692004e-07   4.21150088e+03   1.04822655e+04   1.87948866e+04
   3.26912081e+04   1.62502030e+04   2.13520796e+04   4.50165811e+04
   1.23953194e+04   4.03146883e+03   1.01738082e+04   2.20290844e+04
   5.40129954e+03   1.85108732e+03   4.87466261e+03   1.56632955e+04
   1.80000503e+03   1.57252127e+03   6.14844111e+03   1.27124928e+04
   3.35427327e-03   3.69862854e+04   1.86345469e+04   1.80880871e+04
   4.10086965e+04   1.59863162e+04   5.01664051e+03   7.17484666e+03
   1.71877206e+04   8.61184840e+03   1.57980064e+03   2.69871972e+03
   1.04147712e+04   4.70473426e+03   4.41426225e-04   2.54333484e+03
   7.10779909e+03   2.59900079e+03   5.29066635e+00   5.17679569e+04
   2.97544056e+04   1.45800859e+04   3.37778771e+04   3.08222334e+04
   1.41373491e+04   5.69838085e+03   1.00211163e+04   2.34770771e+04
   8.05802550e+03   4.07146345e+03   3.27953652e+03   1.95935247e+04
   3.70006719e+03   7.41211063e+02   5.33442882e-03   1.75113463e+04
   1.08443968e+04   5.28063572e+03   3.76840637e+04   2.09515380e+04
   3.05166349e+04   5.72840637e+04   1.53155295e+04   7.56402830e+03
   1.72454978e+04   3.18430025e+04   7.20156145e+03   5.52035826e+03
   1.02910063e+04   2.42786301e+04   2.70000671e+03   5.44148971e+03
   1.19571439e+04   2.02793495e+04   3.35462252e-03   3.35435340e-03
   2.29326842e+03   1.72291689e+04   4.53588227e+04   2.52659522e+04
   2.71882960e+04   5.40311607e+04   2.09066121e+04   9.00679544e+03
   1.34655211e+04   2.61234767e+04   1.16667353e+04   4.89471362e+03
   7.19230214e+03   1.73541419e+04   6.26012899e+03   2.69872283e+03
   6.60761166e+03   1.23008032e+04   2.65533401e+03   1.75012247e+02
   6.69003940e-03   8.81139385e+03   8.50537347e+02   5.51579953e+04
   3.19007524e+04   2.38518273e+04   4.90900232e+04   2.97674770e+04
   1.34351184e+04   1.08151699e+04   2.00715855e+04   2.00205881e+04
   7.20415657e+03   6.11132033e+03   1.07596397e+04   1.42064248e+04
   2.80704228e+03   3.08905574e+03   5.23164431e+03   1.01941899e+04
   4.77468201e+03   1.40832353e+03   1.94772248e+03   7.98195252e+03
   1.91750019e+03   5.92321050e+04   3.51024955e+04   2.16787217e+04
   4.48884095e+04   3.45520285e+04   1.64996639e+04   9.88321864e+03
   1.67109815e+04   2.51890250e+04   9.52261133e+03   6.49024773e+03
   7.80987490e+03   1.96834444e+04   4.32230371e+03   2.49497116e+03
   2.64126692e+03   1.59797036e+04   9.17865732e+03   4.11181381e+03
   1.64083425e-04   1.40759609e+04   5.85957919e+03   2.00025399e-03
   5.01232115e+04   3.01342044e+04   3.78177914e+04   6.79955700e+04
   2.36963582e+04   1.29726171e+04   2.18955385e+04   3.77503356e+04
   1.33894887e+04   9.26521272e+03   1.37534496e+04   2.78390911e+04
   7.12518996e+03   7.54784509e+03   1.38716652e+04   2.17868506e+04
   2.66294890e+03   1.46121750e+03   3.08923254e+03   1.70780487e+04
   7.04548178e-01   3.83822699e+02   6.46670349e+03   1.24980023e+04
   6.23448451e+04   3.90624002e+04   4.29318838e+04   7.54042788e+04
   3.25189732e+04   1.84267816e+04   2.50941118e+04   4.11353407e+04
   2.03754534e+04   1.29188893e+04   1.63901524e+04   2.92584886e+04
   1.26347800e+04   9.40149663e+03   1.47237924e+04   2.14868051e+04
   6.69658833e+03   3.86371103e+03   4.22160755e+03   1.55270733e+04
   2.55839057e+03   8.57920329e+02   4.79691549e+03   1.00650885e+04
   5.81848457e-01   6.21411167e+04   3.75704778e+04   3.26921770e+04
   6.16793229e+04   3.36636087e+04   1.68777446e+04   1.70120501e+04
   2.90065564e+04   2.22486737e+04   1.02181130e+04   1.05150313e+04
   1.79094454e+04   1.50936665e+04   5.45402704e+03   7.31890025e+03
   1.08198514e+04   9.74097284e+03   4.69161332e+03   2.28502263e+03
   5.99007398e+03   6.18827420e+03   1.01284107e+03   2.47038693e-03
   2.31329035e+03   3.60776619e+03   1.52715801e+03   6.96367443e+04
   4.31488375e+04   3.09448997e+04   5.81841464e+04   4.10646386e+04
   2.13495898e+04   1.61949333e+04   2.53993966e+04   2.95985879e+04
   1.33269495e+04   1.10782517e+04   1.42475810e+04   2.24024919e+04
   7.13318779e+03   6.25801402e+03   7.11013340e+03   1.70087212e+04
   9.89918028e+03   5.15764762e+03   2.69142591e+03   1.34149455e+04
   5.15499223e+03   2.00013274e-03   2.00016024e-03   1.03098301e+04
   6.84610331e+03   6.41256640e+02   7.15819900e+04   4.74981539e+04
   5.52472687e+04   9.11819900e+04   3.91547148e+04   2.51546953e+04
   3.50173224e+04   5.38335524e+04   2.56055341e+04   1.95051985e+04
   2.45687281e+04   4.04523433e+04   1.67349328e+04   1.59093492e+04
   2.30192393e+04   3.13647021e+04   9.66713778e+03   7.48323785e+03
   9.03462913e+03   2.40276871e+04   4.39933457e+03   3.95434894e+03
   1.00970903e+04   1.69396753e+04   1.02387952e+03   9.60855083e-02
   5.05072050e+03   1.21777163e+04   7.04939216e+04   4.47126483e+04
   4.31581121e+04   7.58432291e+04   3.90228826e+04   2.18950885e+04
   2.48806091e+04   3.96267685e+04   2.59904014e+04   1.48650707e+04
   1.65965365e+04   2.67985382e+04   1.75351444e+04   9.79272988e+03
   1.32861339e+04   1.81946230e+04   1.08825743e+04   6.26168339e+03
   4.86515824e+03   1.18504040e+04   6.02999684e+03   1.82110784e+03
   2.69917370e+03   6.46205461e+03   2.43299228e+03   5.12066686e-04
   8.09338622e-02   3.14097661e+03   1.73822681e+03   7.68798350e+04
   4.90782755e+04   4.00445719e+04   7.10328918e+04   4.52205087e+04
   2.50516742e+04   2.26510238e+04   3.45935398e+04   3.20862870e+04
   1.66002179e+04   1.57411599e+04   2.16564254e+04   2.35492469e+04
   1.00393372e+04   1.07469060e+04   1.29572623e+04   1.68149171e+04
   1.00753772e+04   6.29348434e+03   6.99262225e+03   1.18805798e+04
   4.50944930e+03   1.15890104e+03   2.57209355e+03   7.71008412e+03
   3.83539061e+03   1.50931582e-01   2.27966953e-03   7.39041566e+03
   7.00785802e+02   8.05151859e+04   5.19198632e+04   3.41159838e+04
   6.09151859e+04   5.09340891e+04   2.84644308e+04   1.94060148e+04
   2.69360087e+04   3.89228330e+04   1.90948404e+04   1.49864332e+04
   1.52007069e+04   3.12884785e+04   1.15130013e+04   8.66211586e+03
   7.55284654e+03   2.54565752e+04   1.66159953e+04   1.00743421e+04
   3.03873608e+03   2.14246660e+04   1.06732542e+04   2.35543629e+03
   7.10483945e+02   1.75315333e+04   1.27082224e+04   3.83561258e+03
   8.00601022e-03   1.91242856e+04   7.22672380e+03   1.73879868e+03]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  2.20365575e+03   1.66688522e+04   7.92241217e+03   1.87000000e+04
   1.52120738e+04   3.61043344e+03   3.87315924e+03   2.48947710e-03
   1.27417283e+04   2.34731592e+04   1.29821544e+04   3.05348739e+03
   7.91682647e+03   2.23444615e+04   2.27879524e+03   2.21748032e+04
   9.19878505e+03   1.54531767e+03   1.26673267e+04   1.16433728e+04
   3.64324122e+03   2.53888404e+04   1.36418754e+04   1.81891257e-02
   5.78884042e+03   1.88612208e+04   1.07124475e+04   1.23883926e+03
   1.04251295e+04   2.78207158e+03   1.45925249e+04   3.00251295e+04
   4.93643692e+02   4.68071925e+02   9.92555073e+03   1.93068468e+04
   2.06681557e+04   7.44135451e+03   8.53465509e+03   2.52900798e+04
   6.54266144e+03   1.11062094e-03   2.32298705e+03   9.60699710e+03
   2.88279698e+03   2.46485158e+04   1.00965095e+04   5.19603455e+03
   2.01813756e+04   1.08009828e+04   2.05724160e+03   1.60252579e-04
   4.82733906e+03   7.29131398e+03   1.57759586e+02   3.35201499e+04
   1.77385866e+04   3.10006922e+03   1.39201499e+04   2.14720208e+04
   9.89389136e+03   5.19707281e+02   6.96218784e+02   1.89346548e+04
   6.80946557e+03   2.19054887e+03   1.77126565e+04   7.03919766e+03
   1.81010560e+04   3.73126565e+04   3.63469659e+03   1.03332343e+03
   1.05654801e+04   2.16858442e+04   5.17177402e-01   1.96163311e+03
   6.49088349e+03   1.89158011e+04   3.00792237e+04   1.35754286e+04
   1.07538176e+04   2.97200081e+04   1.26159142e+04   2.69889119e+03
   2.68420973e+03   1.00856733e+04   7.15247064e+03   3.46360582e-04
   1.09992310e-03   5.35792742e+03   4.78151602e+03   3.49914399e+04
   1.72531542e+04   8.02154953e+03   2.48395912e+04   1.80920941e+04
   5.96790772e+03   1.22916964e+03   5.87286761e+03   1.29333868e+04
   2.28697997e+03   1.79036336e-03   1.47125451e+03   1.08073916e+04
   3.39817475e+02   4.32508899e+04   2.39400044e+04   8.42964434e+03
   2.36508899e+04   2.63736166e+04   1.17956092e+04   2.50839784e+03
   4.71029530e+03   2.12268360e+04   6.98004661e+03   2.50174067e+03
   3.21446418e+02   1.91104281e+04   3.84002608e+03   2.38642407e+02
   2.67983491e+04   1.30953597e+04   2.34088380e+04   4.63983491e+04
   8.57510595e+03   3.39867114e+03   1.30054842e+04   2.58644169e+04
   2.70103428e+03   2.84099235e+03   7.49094143e+03   2.06972115e+04
  -2.91692004e-07   4.21150088e+03   1.04822655e+04   1.87948866e+04
   3.26912081e+04   1.62502030e+04   2.13520796e+04   4.50165811e+04
   1.23953194e+04   4.03146883e+03   1.01738082e+04   2.20290844e+04
   5.40129954e+03   1.85108732e+03   4.87466261e+03   1.56632955e+04
   1.80000503e+03   1.57252127e+03   6.14844111e+03   1.27124928e+04
   3.35427327e-03   3.69862854e+04   1.86345469e+04   1.80880871e+04
   4.10086965e+04   1.59863162e+04   5.01664051e+03   7.17484666e+03
   1.71877206e+04   8.61184840e+03   1.57980064e+03   2.69871972e+03
   1.04147712e+04   4.70473426e+03   4.41426225e-04   2.54333484e+03
   7.10779909e+03   2.59900079e+03   5.29066635e+00   5.17679569e+04
   2.97544056e+04   1.45800859e+04   3.37778771e+04   3.08222334e+04
   1.41373491e+04   5.69838085e+03   1.00211163e+04   2.34770771e+04
   8.05802550e+03   4.07146345e+03   3.27953652e+03   1.95935247e+04
   3.70006719e+03   7.41211063e+02   5.33442882e-03   1.75113463e+04
   1.08443968e+04   5.28063572e+03   3.76840637e+04   2.09515380e+04
   3.05166349e+04   5.72840637e+04   1.53155295e+04   7.56402830e+03
   1.72454978e+04   3.18430025e+04   7.20156145e+03   5.52035826e+03
   1.02910063e+04   2.42786301e+04   2.70000671e+03   5.44148971e+03
   1.19571439e+04   2.02793495e+04   3.35462252e-03   3.35435340e-03
   2.29326842e+03   1.72291689e+04   4.53588227e+04   2.52659522e+04
   2.71882960e+04   5.40311607e+04   2.09066121e+04   9.00679544e+03
   1.34655211e+04   2.61234767e+04   1.16667353e+04   4.89471362e+03
   7.19230214e+03   1.73541419e+04   6.26012899e+03   2.69872283e+03
   6.60761166e+03   1.23008032e+04   2.65533401e+03   1.75012247e+02
   6.69003940e-03   8.81139385e+03   8.50537347e+02   5.51579953e+04
   3.19007524e+04   2.38518273e+04   4.90900232e+04   2.97674770e+04
   1.34351184e+04   1.08151699e+04   2.00715855e+04   2.00205881e+04
   7.20415657e+03   6.11132033e+03   1.07596397e+04   1.42064248e+04
   2.80704228e+03   3.08905574e+03   5.23164431e+03   1.01941899e+04
   4.77468201e+03   1.40832353e+03   1.94772248e+03   7.98195252e+03
   1.91750019e+03   5.92321050e+04   3.51024955e+04   2.16787217e+04
   4.48884095e+04   3.45520285e+04   1.64996639e+04   9.88321864e+03
   1.67109815e+04   2.51890250e+04   9.52261133e+03   6.49024773e+03
   7.80987490e+03   1.96834444e+04   4.32230371e+03   2.49497116e+03
   2.64126692e+03   1.59797036e+04   9.17865732e+03   4.11181381e+03
   1.64083425e-04   1.40759609e+04   5.85957919e+03   2.00025399e-03
   5.01232115e+04   3.01342044e+04   3.78177914e+04   6.79955700e+04
   2.36963582e+04   1.29726171e+04   2.18955385e+04   3.77503356e+04
   1.33894887e+04   9.26521272e+03   1.37534496e+04   2.78390911e+04
   7.12518996e+03   7.54784509e+03   1.38716652e+04   2.17868506e+04
   2.66294890e+03   1.46121750e+03   3.08923254e+03   1.70780487e+04
   7.04548178e-01   3.83822699e+02   6.46670349e+03   1.24980023e+04
   6.23448451e+04   3.90624002e+04   4.29318838e+04   7.54042788e+04
   3.25189732e+04   1.84267816e+04   2.50941118e+04   4.11353407e+04
   2.03754534e+04   1.29188893e+04   1.63901524e+04   2.92584886e+04
   1.26347800e+04   9.40149663e+03   1.47237924e+04   2.14868051e+04
   6.69658833e+03   3.86371103e+03   4.22160755e+03   1.55270733e+04
   2.55839057e+03   8.57920329e+02   4.79691549e+03   1.00650885e+04
   5.81848457e-01   6.21411167e+04   3.75704778e+04   3.26921770e+04
   6.16793229e+04   3.36636087e+04   1.68777446e+04   1.70120501e+04
   2.90065564e+04   2.22486737e+04   1.02181130e+04   1.05150313e+04
   1.79094454e+04   1.50936665e+04   5.45402704e+03   7.31890025e+03
   1.08198514e+04   9.74097284e+03   4.69161332e+03   2.28502263e+03
   5.99007398e+03   6.18827420e+03   1.01284107e+03   2.47038693e-03
   2.31329035e+03   3.60776619e+03   1.52715801e+03   6.96367443e+04
   4.31488375e+04   3.09448997e+04   5.81841464e+04   4.10646386e+04
   2.13495898e+04   1.61949333e+04   2.53993966e+04   2.95985879e+04
   1.33269495e+04   1.10782517e+04   1.42475810e+04   2.24024919e+04
   7.13318779e+03   6.25801402e+03   7.11013340e+03   1.70087212e+04
   9.89918028e+03   5.15764762e+03   2.69142591e+03   1.34149455e+04
   5.15499223e+03   2.00013274e-03   2.00016024e-03   1.03098301e+04
   6.84610331e+03   6.41256640e+02   7.15819900e+04   4.74981539e+04
   5.52472687e+04   9.11819900e+04   3.91547148e+04   2.51546953e+04
   3.50173224e+04   5.38335524e+04   2.56055341e+04   1.95051985e+04
   2.45687281e+04   4.04523433e+04   1.67349328e+04   1.59093492e+04
   2.30192393e+04   3.13647021e+04   9.66713778e+03   7.48323785e+03
   9.03462913e+03   2.40276871e+04   4.39933457e+03   3.95434894e+03
   1.00970903e+04   1.69396753e+04   1.02387952e+03   9.60855083e-02
   5.05072050e+03   1.21777163e+04   7.04939216e+04   4.47126483e+04
   4.31581121e+04   7.58432291e+04   3.90228826e+04   2.18950885e+04
   2.48806091e+04   3.96267685e+04   2.59904014e+04   1.48650707e+04
   1.65965365e+04   2.67985382e+04   1.75351444e+04   9.79272988e+03
   1.32861339e+04   1.81946230e+04   1.08825743e+04   6.26168339e+03
   4.86515824e+03   1.18504040e+04   6.02999684e+03   1.82110784e+03
   2.69917370e+03   6.46205461e+03   2.43299228e+03   5.12066686e-04
   8.09338622e-02   3.14097661e+03   1.73822681e+03   7.68798350e+04
   4.90782755e+04   4.00445719e+04   7.10328918e+04   4.52205087e+04
   2.50516742e+04   2.26510238e+04   3.45935398e+04   3.20862870e+04
   1.66002179e+04   1.57411599e+04   2.16564254e+04   2.35492469e+04
   1.00393372e+04   1.07469060e+04   1.29572623e+04   1.68149171e+04
   1.00753772e+04   6.29348434e+03   6.99262225e+03   1.18805798e+04
   4.50944930e+03   1.15890104e+03   2.57209355e+03   7.71008412e+03
   3.83539061e+03   1.50931582e-01   2.27966953e-03   7.39041566e+03
   7.00785802e+02   8.05151859e+04   5.19198632e+04   3.41159838e+04
   6.09151859e+04   5.09340891e+04   2.84644308e+04   1.94060148e+04
   2.69360087e+04   3.89228330e+04   1.90948404e+04   1.49864332e+04
   1.52007069e+04   3.12884785e+04   1.15130013e+04   8.66211586e+03
   7.55284654e+03   2.54565752e+04   1.66159953e+04   1.00743421e+04
   3.03873608e+03   2.14246660e+04   1.06732542e+04   2.35543629e+03
   7.10483945e+02   1.75315333e+04   1.27082224e+04   3.83561258e+03
   8.00601022e-03   1.91242856e+04   7.22672380e+03   1.73879868e+03]
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.906e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 7.142e-03 (tol = 1.000e-10) r (rel) = 1.456e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.671e-06 (tol = 1.000e-10) r (rel) = 5.444e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 1.031e-12 (tol = 1.000e-10) r (rel) = 2.102e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 19.494888 s.
j = 1.390243e+06.
Runtime: 19.506348 s.
j = 1.390243e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19994023e+03   1.66446289e+04   7.91537638e+03   1.87000000e+04
   1.52135952e+04   3.59906117e+03   3.87253992e+03   5.86277137e-04
   1.27322954e+04   2.34725399e+04   1.29665395e+04   3.04900781e+03
   7.91528675e+03   2.23319183e+04   2.27270413e+03   2.21565550e+04
   9.19422343e+03   1.54902173e+03   1.26550908e+04   1.16340981e+04
   3.64181611e+03   2.53619020e+04   1.36376907e+04   7.11626351e-03
   5.76190197e+03   1.88571739e+04   1.07206930e+04   1.24634486e+03
   1.04321450e+04   2.78802272e+03   1.45940423e+04   3.00321450e+04
   4.96440377e+02   4.66172462e+02   9.92026923e+03   1.93166318e+04
   2.06501870e+04   7.43619091e+03   8.54003553e+03   2.52797369e+04
   6.53290563e+03   3.00800373e-04   2.32394289e+03   9.62379770e+03
   2.87454921e+03   2.46262743e+04   1.00892132e+04   5.20080768e+03
   2.01664780e+04   1.07884232e+04   2.05574981e+03   9.10562237e-05
   4.84067836e+03   7.28121726e+03   1.57868396e+02   3.35093572e+04
   1.77406278e+04   3.10963796e+03   1.39093572e+04   2.14678258e+04
   9.89658592e+03   5.21649114e+02   7.05863549e+02   1.89322928e+04
   6.81385630e+03   2.19282568e+03   1.77218359e+04   7.04892944e+03
   1.81111001e+04   3.73218359e+04   3.63983203e+03   1.03740514e+03
   1.05659472e+04   2.17075761e+04   5.58060307e-01   1.95866692e+03
   6.48671698e+03   1.89180981e+04   3.00567997e+04   1.35680710e+04
   1.07603403e+04   2.97027659e+04   1.26028089e+04   2.69882378e+03
   2.68409184e+03   1.01045898e+04   7.13954561e+03   1.01393653e-04
   1.00548066e-03   5.35912720e+03   4.77422592e+03   3.49639072e+04
   1.72433598e+04   8.02561615e+03   2.48145703e+04   1.80766384e+04
   5.96679046e+03   1.22743307e+03   5.88596160e+03   1.29199287e+04
   2.28783793e+03   6.56679923e-04   1.46923676e+03   1.08007880e+04
   3.40650114e+02   4.32589848e+04   2.39558147e+04   8.45679006e+03
   2.36589848e+04   2.63789281e+04   1.18061063e+04   2.51804355e+03
   4.73889708e+03   2.12261196e+04   6.98798739e+03   2.50860354e+03
   3.26355764e+02   1.91101118e+04   3.84183680e+03   2.39225073e+02
   2.68095467e+04   1.31087947e+04   2.34273470e+04   4.64095467e+04
   8.58252858e+03   3.40873978e+03   1.30117042e+04   2.58980585e+04
   2.70111603e+03   2.84334743e+03   7.49274189e+03   2.07041868e+04
  -3.14495310e-07   4.20991821e+03   1.04825830e+04   1.87950388e+04
   3.27034158e+04   1.62664622e+04   2.13772058e+04   4.50287878e+04
   1.24038863e+04   4.04510120e+03   1.01840201e+04   2.20686804e+04
   5.40140226e+03   1.85751822e+03   4.88080915e+03   1.56726095e+04
   1.80000543e+03   1.57475368e+03   6.15268475e+03   1.27128784e+04
   3.61943581e-03   3.69646888e+04   1.86277802e+04   1.80963957e+04
   4.09894765e+04   1.59734226e+04   5.01834126e+03   7.17463354e+03
   1.72120998e+04   8.59676138e+03   1.57984956e+03   2.69872549e+03
   1.04147739e+04   4.69488017e+03   1.57238573e-04   2.54485032e+03
   7.10439253e+03   2.59448709e+03   3.88796119e+00   5.17635504e+04
   2.97618994e+04   1.46111087e+04   3.37849513e+04   3.08164263e+04
   1.41439242e+04   5.70925955e+03   1.00597273e+04   2.34636426e+04
   8.06299221e+03   4.07862685e+03   3.28800694e+03   1.95809363e+04
   3.70123391e+03   7.45252914e+02   1.71112514e-03   1.74997122e+04
   1.08353697e+04   5.27547234e+03   3.76972813e+04   2.09686777e+04
   3.05436100e+04   5.72972813e+04   1.53252405e+04   7.58008463e+03
   1.72574714e+04   3.18885547e+04   7.20168487e+03   5.52803516e+03
   1.02987743e+04   2.42902846e+04   2.70000724e+03   5.44561479e+03
   1.19643829e+04   2.02799705e+04   3.61981241e-03   3.61952234e-03
   2.29409522e+03   1.72184893e+04   4.53470130e+04   2.52658518e+04
   2.71993893e+04   5.40121279e+04   2.09005947e+04   9.01363833e+03
   1.34653423e+04   2.61525773e+04   1.16549581e+04   4.89652608e+03
   7.19250852e+03   1.73510255e+04   6.25218909e+03   2.69878138e+03
   6.60830078e+03   1.22891825e+04   2.65137329e+03   1.71700431e+02
   3.30508292e-03   8.79612050e+03   8.50555670e+02   5.51728551e+04
   3.19242968e+04   2.38990824e+04   4.91135315e+04   2.97771806e+04
   1.34569891e+04   1.08389083e+04   2.01324590e+04   2.00180684e+04
   7.22052757e+03   6.13012784e+03   1.07802732e+04   1.42029507e+04
   2.81899699e+03   3.10553139e+03   5.23723984e+03   1.01899141e+04
   4.77160970e+03   1.41322554e+03   1.94874503e+03   7.97687485e+03
   1.91262371e+03   5.92321604e+04   3.51149619e+04   2.17172206e+04
   4.48984223e+04   3.45505636e+04   1.65130062e+04   9.89965346e+03
   1.67610143e+04   2.51777133e+04   9.53300815e+03   6.50310652e+03
   7.82304272e+03   1.96727848e+04   4.32915555e+03   2.50568066e+03
   2.64198466e+03   1.59698411e+04   9.17104045e+03   4.11230188e+03
   9.26157931e-05   1.40668955e+04   5.84967328e+03   4.63383250e-04
   5.00924156e+04   3.00979421e+04   3.77084388e+04   6.78282004e+04
   2.36783056e+04   1.29389271e+04   2.17916466e+04   3.76438723e+04
   1.33682970e+04   9.21192638e+03   1.36687386e+04   2.77009238e+04
   7.11077985e+03   7.47950285e+03   1.37724310e+04   2.16416322e+04
   2.65548085e+03   1.43187546e+03   3.03828945e+03   1.69349722e+04
   1.78312203e-01   3.52269286e+02   6.37636260e+03   1.23752725e+04
   6.24345929e+04   3.91411446e+04   4.30064364e+04   7.54631705e+04
   3.25870170e+04   1.84886941e+04   2.51374955e+04   4.12222902e+04
   2.04197635e+04   1.29615569e+04   1.64274178e+04   2.92876951e+04
   1.26707788e+04   9.43044596e+03   1.47509922e+04   2.14879349e+04
   6.72447445e+03   3.88181433e+03   4.24265408e+03   1.55130085e+04
   2.57816354e+03   8.70998197e+02   4.78549673e+03   1.00476612e+04
   1.51948183e-01   6.21700680e+04   3.76060459e+04   3.27500073e+04
   6.17116728e+04   3.36852883e+04   1.69110999e+04   1.70441931e+04
   2.90809015e+04   2.22552044e+04   1.02433566e+04   1.05420831e+04
   1.79368221e+04   1.50982064e+04   5.47401451e+03   7.34351998e+03
   1.08278811e+04   9.74370540e+03   4.69407230e+03   2.29781350e+03
   5.99148096e+03   6.18919902e+03   1.01599582e+03   1.20104481e-03
   2.31335615e+03   3.54689944e+03   1.51741952e+03   6.96487942e+04
   4.31723622e+04   3.09934055e+04   5.81990374e+04   4.10741390e+04
   2.13744915e+04   1.62190889e+04   2.54620804e+04   2.95954391e+04
   1.33466255e+04   1.10994042e+04   1.42658670e+04   2.23994001e+04
   7.14850883e+03   6.27682706e+03   7.11136690e+03   1.70058700e+04
   9.89697568e+03   5.16678713e+03   2.69129930e+03   1.34123344e+04
   5.15354614e+03   4.63252549e-04   4.63282431e-04   1.02092643e+04
   6.82759255e+03   6.41367386e+02   7.15978975e+04   4.75224862e+04
   5.52930922e+04   9.11978975e+04   3.91683348e+04   2.51839897e+04
   3.50419558e+04   5.39064657e+04   2.56044222e+04   1.95247015e+04
   2.45898723e+04   4.04741406e+04   1.67338450e+04   1.59264354e+04
   2.30423507e+04   3.13655376e+04   9.66629567e+03   7.48251843e+03
   9.04773638e+03   2.40186424e+04   4.39873758e+03   3.96354971e+03
   1.00896504e+04   1.69320851e+04   1.03984212e+03   3.06201666e-02
   5.04702618e+03   1.21754609e+04   7.05972268e+04   4.48060678e+04
   4.32511293e+04   7.59165522e+04   3.91035940e+04   2.19713512e+04
   2.49392670e+04   3.97308978e+04   2.60459486e+04   1.49224681e+04
   1.66489644e+04   2.68414764e+04   1.75819312e+04   9.83584440e+03
   1.33277330e+04   1.82073086e+04   1.09208157e+04   6.29008751e+03
   4.89920563e+03   1.18498852e+04   6.05969223e+03   1.84429403e+03
   2.69931680e+03   6.45734011e+03   2.41799737e+03   4.09534282e-04
   2.52157124e-02   3.13308744e+03   1.74713143e+03   7.69050806e+04
   4.91130926e+04   4.01031715e+04   7.10560640e+04   4.52412372e+04
   2.50874921e+04   2.26831743e+04   3.46693101e+04   3.20915207e+04
   1.66282918e+04   1.57701555e+04   2.16811548e+04   2.35535653e+04
   1.00623107e+04   1.07735578e+04   1.29607050e+04   1.68185347e+04
   1.00782588e+04   6.31014968e+03   6.99270448e+03   1.18834960e+04
   4.51568505e+03   1.15868947e+03   2.57201042e+03   7.63859440e+03
   3.81825610e+03   5.40210739e-02   1.17639961e-03   7.39158656e+03
   6.92485260e+02   8.05096345e+04   5.19309250e+04   3.41538906e+04
   6.09096345e+04   5.09316898e+04   2.84817264e+04   1.94216497e+04
   2.69873166e+04   3.89102864e+04   1.91093728e+04   1.50017169e+04
   1.52091262e+04   3.12784271e+04   1.15243738e+04   8.67567629e+03
   7.54604557e+03   2.54492119e+04   1.66099749e+04   1.00812667e+04
   3.03559842e+03   2.14199904e+04   1.06696432e+04   2.35489823e+03
   7.09585720e+02   1.74044586e+04   1.26831970e+04   3.83608082e+03
   4.54732384e-03   1.91259642e+04   7.21280949e+03   1.73977351e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.19994023e+03   1.66446289e+04   7.91537638e+03   1.87000000e+04
   1.52135952e+04   3.59906117e+03   3.87253992e+03   5.86277137e-04
   1.27322954e+04   2.34725399e+04   1.29665395e+04   3.04900781e+03
   7.91528675e+03   2.23319183e+04   2.27270413e+03   2.21565550e+04
   9.19422343e+03   1.54902173e+03   1.26550908e+04   1.16340981e+04
   3.64181611e+03   2.53619020e+04   1.36376907e+04   7.11626351e-03
   5.76190197e+03   1.88571739e+04   1.07206930e+04   1.24634486e+03
   1.04321450e+04   2.78802272e+03   1.45940423e+04   3.00321450e+04
   4.96440377e+02   4.66172462e+02   9.92026923e+03   1.93166318e+04
   2.06501870e+04   7.43619091e+03   8.54003553e+03   2.52797369e+04
   6.53290563e+03   3.00800373e-04   2.32394289e+03   9.62379770e+03
   2.87454921e+03   2.46262743e+04   1.00892132e+04   5.20080768e+03
   2.01664780e+04   1.07884232e+04   2.05574981e+03   9.10562237e-05
   4.84067836e+03   7.28121726e+03   1.57868396e+02   3.35093572e+04
   1.77406278e+04   3.10963796e+03   1.39093572e+04   2.14678258e+04
   9.89658592e+03   5.21649114e+02   7.05863549e+02   1.89322928e+04
   6.81385630e+03   2.19282568e+03   1.77218359e+04   7.04892944e+03
   1.81111001e+04   3.73218359e+04   3.63983203e+03   1.03740514e+03
   1.05659472e+04   2.17075761e+04   5.58060307e-01   1.95866692e+03
   6.48671698e+03   1.89180981e+04   3.00567997e+04   1.35680710e+04
   1.07603403e+04   2.97027659e+04   1.26028089e+04   2.69882378e+03
   2.68409184e+03   1.01045898e+04   7.13954561e+03   1.01393653e-04
   1.00548066e-03   5.35912720e+03   4.77422592e+03   3.49639072e+04
   1.72433598e+04   8.02561615e+03   2.48145703e+04   1.80766384e+04
   5.96679046e+03   1.22743307e+03   5.88596160e+03   1.29199287e+04
   2.28783793e+03   6.56679923e-04   1.46923676e+03   1.08007880e+04
   3.40650114e+02   4.32589848e+04   2.39558147e+04   8.45679006e+03
   2.36589848e+04   2.63789281e+04   1.18061063e+04   2.51804355e+03
   4.73889708e+03   2.12261196e+04   6.98798739e+03   2.50860354e+03
   3.26355764e+02   1.91101118e+04   3.84183680e+03   2.39225073e+02
   2.68095467e+04   1.31087947e+04   2.34273470e+04   4.64095467e+04
   8.58252858e+03   3.40873978e+03   1.30117042e+04   2.58980585e+04
   2.70111603e+03   2.84334743e+03   7.49274189e+03   2.07041868e+04
  -3.14495310e-07   4.20991821e+03   1.04825830e+04   1.87950388e+04
   3.27034158e+04   1.62664622e+04   2.13772058e+04   4.50287878e+04
   1.24038863e+04   4.04510120e+03   1.01840201e+04   2.20686804e+04
   5.40140226e+03   1.85751822e+03   4.88080915e+03   1.56726095e+04
   1.80000543e+03   1.57475368e+03   6.15268475e+03   1.27128784e+04
   3.61943581e-03   3.69646888e+04   1.86277802e+04   1.80963957e+04
   4.09894765e+04   1.59734226e+04   5.01834126e+03   7.17463354e+03
   1.72120998e+04   8.59676138e+03   1.57984956e+03   2.69872549e+03
   1.04147739e+04   4.69488017e+03   1.57238573e-04   2.54485032e+03
   7.10439253e+03   2.59448709e+03   3.88796119e+00   5.17635504e+04
   2.97618994e+04   1.46111087e+04   3.37849513e+04   3.08164263e+04
   1.41439242e+04   5.70925955e+03   1.00597273e+04   2.34636426e+04
   8.06299221e+03   4.07862685e+03   3.28800694e+03   1.95809363e+04
   3.70123391e+03   7.45252914e+02   1.71112514e-03   1.74997122e+04
   1.08353697e+04   5.27547234e+03   3.76972813e+04   2.09686777e+04
   3.05436100e+04   5.72972813e+04   1.53252405e+04   7.58008463e+03
   1.72574714e+04   3.18885547e+04   7.20168487e+03   5.52803516e+03
   1.02987743e+04   2.42902846e+04   2.70000724e+03   5.44561479e+03
   1.19643829e+04   2.02799705e+04   3.61981241e-03   3.61952234e-03
   2.29409522e+03   1.72184893e+04   4.53470130e+04   2.52658518e+04
   2.71993893e+04   5.40121279e+04   2.09005947e+04   9.01363833e+03
   1.34653423e+04   2.61525773e+04   1.16549581e+04   4.89652608e+03
   7.19250852e+03   1.73510255e+04   6.25218909e+03   2.69878138e+03
   6.60830078e+03   1.22891825e+04   2.65137329e+03   1.71700431e+02
   3.30508292e-03   8.79612050e+03   8.50555670e+02   5.51728551e+04
   3.19242968e+04   2.38990824e+04   4.91135315e+04   2.97771806e+04
   1.34569891e+04   1.08389083e+04   2.01324590e+04   2.00180684e+04
   7.22052757e+03   6.13012784e+03   1.07802732e+04   1.42029507e+04
   2.81899699e+03   3.10553139e+03   5.23723984e+03   1.01899141e+04
   4.77160970e+03   1.41322554e+03   1.94874503e+03   7.97687485e+03
   1.91262371e+03   5.92321604e+04   3.51149619e+04   2.17172206e+04
   4.48984223e+04   3.45505636e+04   1.65130062e+04   9.89965346e+03
   1.67610143e+04   2.51777133e+04   9.53300815e+03   6.50310652e+03
   7.82304272e+03   1.96727848e+04   4.32915555e+03   2.50568066e+03
   2.64198466e+03   1.59698411e+04   9.17104045e+03   4.11230188e+03
   9.26157931e-05   1.40668955e+04   5.84967328e+03   4.63383250e-04
   5.00924156e+04   3.00979421e+04   3.77084388e+04   6.78282004e+04
   2.36783056e+04   1.29389271e+04   2.17916466e+04   3.76438723e+04
   1.33682970e+04   9.21192638e+03   1.36687386e+04   2.77009238e+04
   7.11077985e+03   7.47950285e+03   1.37724310e+04   2.16416322e+04
   2.65548085e+03   1.43187546e+03   3.03828945e+03   1.69349722e+04
   1.78312203e-01   3.52269286e+02   6.37636260e+03   1.23752725e+04
   6.24345929e+04   3.91411446e+04   4.30064364e+04   7.54631705e+04
   3.25870170e+04   1.84886941e+04   2.51374955e+04   4.12222902e+04
   2.04197635e+04   1.29615569e+04   1.64274178e+04   2.92876951e+04
   1.26707788e+04   9.43044596e+03   1.47509922e+04   2.14879349e+04
   6.72447445e+03   3.88181433e+03   4.24265408e+03   1.55130085e+04
   2.57816354e+03   8.70998197e+02   4.78549673e+03   1.00476612e+04
   1.51948183e-01   6.21700680e+04   3.76060459e+04   3.27500073e+04
   6.17116728e+04   3.36852883e+04   1.69110999e+04   1.70441931e+04
   2.90809015e+04   2.22552044e+04   1.02433566e+04   1.05420831e+04
   1.79368221e+04   1.50982064e+04   5.47401451e+03   7.34351998e+03
   1.08278811e+04   9.74370540e+03   4.69407230e+03   2.29781350e+03
   5.99148096e+03   6.18919902e+03   1.01599582e+03   1.20104481e-03
   2.31335615e+03   3.54689944e+03   1.51741952e+03   6.96487942e+04
   4.31723622e+04   3.09934055e+04   5.81990374e+04   4.10741390e+04
   2.13744915e+04   1.62190889e+04   2.54620804e+04   2.95954391e+04
   1.33466255e+04   1.10994042e+04   1.42658670e+04   2.23994001e+04
   7.14850883e+03   6.27682706e+03   7.11136690e+03   1.70058700e+04
   9.89697568e+03   5.16678713e+03   2.69129930e+03   1.34123344e+04
   5.15354614e+03   4.63252549e-04   4.63282431e-04   1.02092643e+04
   6.82759255e+03   6.41367386e+02   7.15978975e+04   4.75224862e+04
   5.52930922e+04   9.11978975e+04   3.91683348e+04   2.51839897e+04
   3.50419558e+04   5.39064657e+04   2.56044222e+04   1.95247015e+04
   2.45898723e+04   4.04741406e+04   1.67338450e+04   1.59264354e+04
   2.30423507e+04   3.13655376e+04   9.66629567e+03   7.48251843e+03
   9.04773638e+03   2.40186424e+04   4.39873758e+03   3.96354971e+03
   1.00896504e+04   1.69320851e+04   1.03984212e+03   3.06201666e-02
   5.04702618e+03   1.21754609e+04   7.05972268e+04   4.48060678e+04
   4.32511293e+04   7.59165522e+04   3.91035940e+04   2.19713512e+04
   2.49392670e+04   3.97308978e+04   2.60459486e+04   1.49224681e+04
   1.66489644e+04   2.68414764e+04   1.75819312e+04   9.83584440e+03
   1.33277330e+04   1.82073086e+04   1.09208157e+04   6.29008751e+03
   4.89920563e+03   1.18498852e+04   6.05969223e+03   1.84429403e+03
   2.69931680e+03   6.45734011e+03   2.41799737e+03   4.09534282e-04
   2.52157124e-02   3.13308744e+03   1.74713143e+03   7.69050806e+04
   4.91130926e+04   4.01031715e+04   7.10560640e+04   4.52412372e+04
   2.50874921e+04   2.26831743e+04   3.46693101e+04   3.20915207e+04
   1.66282918e+04   1.57701555e+04   2.16811548e+04   2.35535653e+04
   1.00623107e+04   1.07735578e+04   1.29607050e+04   1.68185347e+04
   1.00782588e+04   6.31014968e+03   6.99270448e+03   1.18834960e+04
   4.51568505e+03   1.15868947e+03   2.57201042e+03   7.63859440e+03
   3.81825610e+03   5.40210739e-02   1.17639961e-03   7.39158656e+03
   6.92485260e+02   8.05096345e+04   5.19309250e+04   3.41538906e+04
   6.09096345e+04   5.09316898e+04   2.84817264e+04   1.94216497e+04
   2.69873166e+04   3.89102864e+04   1.91093728e+04   1.50017169e+04
   1.52091262e+04   3.12784271e+04   1.15243738e+04   8.67567629e+03
   7.54604557e+03   2.54492119e+04   1.66099749e+04   1.00812667e+04
   3.03559842e+03   2.14199904e+04   1.06696432e+04   2.35489823e+03
   7.09585720e+02   1.74044586e+04   1.26831970e+04   3.83608082e+03
   4.54732384e-03   1.91259642e+04   7.21280949e+03   1.73977351e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.42351484299 s
|dj| = 12430.1012498
Runtime: 6.44311308861 s
|dj| = 12430.1012498
Start evaluation of j
Updating the turbine cache
   47    87    -3.106724E+04     2.777708E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Read initial guess from cache for t=1.000000.
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.555e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.218e-02 (tol = 1.000e-10) r (rel) = 1.426e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.056e-05 (tol = 1.000e-10) r (rel) = 6.790e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 5.923e-12 (tol = 1.000e-10) r (rel) = 3.810e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 19.939171 s.
j = 1.389937e+06.
End of time loop.
Runtime: 19.893442 s.
j = 1.389937e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19306416e+03   1.65223008e+04   7.85863972e+03   1.87000000e+04
   1.51954898e+04   3.53178313e+03   3.85354784e+03   4.17698277e-03
   1.26926163e+04   2.34535478e+04   1.30069243e+04   3.08305310e+03
   7.99129447e+03   2.24146435e+04   2.29326527e+03   2.22046964e+04
   9.22475107e+03   1.62348415e+03   1.27017927e+04   1.16644208e+04
   3.66295422e+03   2.52227159e+04   1.35809478e+04   9.89149781e-02
   5.62271586e+03   1.88396499e+04   1.08190700e+04   1.30932060e+03
   1.03957577e+04   2.78049720e+03   1.45868469e+04   2.99957577e+04
   4.93941396e+02   4.59695998e+02   9.92474185e+03   1.93511770e+04
   2.06891676e+04   7.47385016e+03   8.63748997e+03   2.53343256e+04
   6.56786861e+03   1.33631550e-02   2.32758816e+03   9.74704204e+03
   2.88899916e+03   2.46679908e+04   1.01243202e+04   5.30544262e+03
   2.02190491e+04   1.08234677e+04   2.06459548e+03   3.01366952e-03
   4.95598090e+03   7.29447752e+03   1.58909550e+02   3.34521113e+04
   1.77101510e+04   3.16329454e+03   1.38521113e+04   2.14575408e+04
   9.91904217e+03   5.11631234e+02   7.56077946e+02   1.89303343e+04
   6.83567573e+03   2.20797987e+03   1.78159996e+04   7.12521944e+03
   1.82069751e+04   3.74159996e+04   3.70504116e+03   1.03203455e+03
   1.05738437e+04   2.18408289e+04   3.17712896e+01   1.95264974e+03
   6.48066701e+03   1.89355661e+04   3.01021445e+04   1.36147460e+04
   1.09013189e+04   2.97649457e+04   1.26503369e+04   2.69909770e+03
   2.68385391e+03   1.02763036e+04   7.16793526e+03   2.96395343e-05
   5.99824170e-04   5.39912508e+03   4.75704672e+03   3.50064116e+04
   1.72847785e+04   8.15744470e+03   2.48475864e+04   1.81277701e+04
   5.98216236e+03   1.21837702e+03   6.03035124e+03   1.29557485e+04
   2.29523757e+03   9.75481463e-03   1.49148053e+03   1.07986218e+04
   3.47690136e+02   4.32227682e+04   2.39403801e+04   8.55939697e+03
   2.36227682e+04   2.63827845e+04   1.18066386e+04   2.48759480e+03
   4.85081673e+03   2.12316968e+04   6.98652479e+03   2.49989132e+03
   3.34763517e+02   1.90916853e+04   3.85253767e+03   2.37014593e+02
   2.69243855e+04   1.32109745e+04   2.35805967e+04   4.65243855e+04
   8.67666837e+03   3.41027863e+03   1.30275309e+04   2.61034149e+04
   2.76326703e+03   2.84815033e+03   7.49659925e+03   2.07564557e+04
  -5.51904122e-08   4.20336546e+03   1.04943385e+04   1.88042228e+04
   3.26805069e+04   1.62641244e+04   2.14168838e+04   4.49340150e+04
   1.24257217e+04   3.99093660e+03   1.01007429e+04   2.21619644e+04
   5.42545578e+03   1.81685845e+03   4.81940843e+03   1.56303458e+04
   1.77358564e+03   1.53521507e+03   6.10651475e+03   1.26551849e+04
   2.63597587e-01   3.70838731e+04   1.87337047e+04   1.82787072e+04
   4.10732044e+04   1.60861050e+04   5.03678994e+03   7.17339281e+03
   1.74308234e+04   8.68350012e+03   1.59235637e+03   2.69931076e+03
   1.04606637e+04   4.70268402e+03   4.78908058e-02   2.54553720e+03
   7.10683206e+03   2.60607281e+03   1.62549526e-01   5.16900361e+04
   2.97207264e+04   1.47331172e+04   3.37364279e+04   3.07935105e+04
   1.41023441e+04   5.65152261e+03   1.02126424e+04   2.34457303e+04
   8.02826549e+03   4.04167861e+03   3.30224039e+03   1.95097379e+04
   3.68245584e+03   7.24000809e+02   8.27545065e-03   1.74571797e+04
   1.07603056e+04   5.24202624e+03   3.78330350e+04   2.10727981e+04
   3.06349638e+04   5.72892781e+04   1.54485592e+04   7.55140847e+03
   1.71747536e+04   3.20225075e+04   7.29502637e+03   5.48907111e+03
   1.02246012e+04   2.42338521e+04   2.70026360e+03   5.37683273e+03
   1.18811852e+04   2.01732671e+04   2.63597655e-01   2.63597607e-01
   2.25247669e+03   1.70671659e+04   4.55531574e+04   2.54399802e+04
   2.74250915e+04   5.41227359e+04   2.10875198e+04   9.05505321e+03
   1.34644752e+04   2.64180919e+04   1.18069993e+04   4.92409904e+03
   7.19459427e+03   1.74010436e+04   6.29082933e+03   2.69908647e+03
   6.60123626e+03   1.22797678e+04   2.68526736e+03   2.05632459e+02
   6.62429038e-02   8.74290215e+03   8.39517462e+02   5.50618872e+04
   3.18629846e+04   2.40122379e+04   4.90206449e+04   2.97386271e+04
   1.33695887e+04   1.07461891e+04   2.03113818e+04   1.99936881e+04
   7.15611014e+03   6.06197448e+03   1.07881271e+04   1.40978170e+04
   2.77360774e+03   3.06669622e+03   5.22975291e+03   1.01190835e+04
   4.72017236e+03   1.36731713e+03   1.94060342e+03   7.84658032e+03
   1.86159173e+03   5.91738525e+04   3.50904449e+04   2.18692432e+04
   4.48525386e+04   3.45473119e+04   1.64621773e+04   9.83165028e+03
   1.69594129e+04   2.51796594e+04   9.49244657e+03   6.45711445e+03
   7.84739254e+03   1.95922518e+04   4.30161281e+03   2.47811134e+03
   2.64411044e+03   1.59166772e+04   9.11307994e+03   4.06906194e+03
   2.48141553e-03   1.39169677e+04   5.78494520e+03   1.37642813e-02
   5.03147988e+04   3.03100872e+04   3.80649468e+04   6.80981964e+04
   2.38752764e+04   1.30010170e+04   2.18913112e+04   3.80813434e+04
   1.35258607e+04   9.28198377e+03   1.37474793e+04   2.78992218e+04
   7.13577914e+03   7.53656850e+03   1.38662583e+04   2.17719302e+04
   2.67133394e+03   1.50175352e+03   3.08439258e+03   1.70058577e+04
   4.90377356e-01   3.87748742e+02   6.40549984e+03   1.24197089e+04
   6.25563349e+04   3.92644205e+04   4.32397138e+04   7.55194835e+04
   3.27282681e+04   1.84763907e+04   2.51031278e+04   4.15332888e+04
   2.05438928e+04   1.29571664e+04   1.64030503e+04   2.93510998e+04
   1.26535775e+04   9.41202419e+03   1.47382819e+04   2.14967932e+04
   6.71469779e+03   3.92638751e+03   4.22800168e+03   1.54873266e+04
   2.55174252e+03   8.58543087e+02   4.77399069e+03   1.00183629e+04
   2.39266024e-01   6.20657574e+04   3.75534754e+04   3.28807609e+04
   6.16184895e+04   3.36564844e+04   1.68072613e+04   1.69387529e+04
   2.92942702e+04   2.22404123e+04   1.01672932e+04   1.04607585e+04
   1.79495155e+04   1.49782494e+04   5.41470372e+03   7.29542226e+03
   1.08183153e+04   9.65671986e+03   4.65468195e+03   2.23998009e+03
   5.97746249e+03   6.06193522e+03   9.54963748e+02   1.10934746e-03
   2.30776534e+03   3.54330330e+03   1.49973527e+03   6.95412611e+04
   4.31135958e+04   3.11572876e+04   5.81347809e+04   4.10349712e+04
   2.12754534e+04   1.61218385e+04   2.56969161e+04   2.95663626e+04
   1.32692338e+04   1.10230703e+04   1.42948977e+04   2.22612468e+04
   7.08973140e+03   6.23044975e+03   7.11425160e+03   1.68975029e+04
   9.82111200e+03   5.08839792e+03   2.69228767e+03   1.32203136e+04
   5.04850077e+03   1.37642610e-02   1.37642806e-02   1.01926209e+04
   6.76686844e+03   6.32438034e+02   7.15583494e+04   4.75302658e+04
   5.54697457e+04   9.11583494e+04   3.91940185e+04   2.50777559e+04
   3.49524566e+04   5.42011745e+04   2.56362092e+04   1.94557925e+04
   2.45152122e+04   4.05219713e+04   1.66229963e+04   1.58657008e+04
   2.30077398e+04   3.13750251e+04   9.58052898e+03   7.50059699e+03
   9.00318780e+03   2.40046246e+04   4.33832529e+03   3.93311527e+03
   1.00934904e+04   1.69256083e+04   9.88258484e+02   1.41210419e-01
   5.04885969e+03   1.21455872e+04   7.06800376e+04   4.48998102e+04
   4.34736974e+04   7.59195613e+04   3.92255529e+04   2.19458569e+04
   2.48762719e+04   4.00281804e+04   2.61604421e+04   1.49053004e+04
   1.66067117e+04   2.68860082e+04   1.75500516e+04   9.80871436e+03
   1.32978586e+04   1.82027768e+04   1.09034796e+04   6.32432349e+03
   4.87053144e+03   1.18237316e+04   6.00450743e+03   1.81026199e+03
   2.70020436e+03   6.43233442e+03   2.42968785e+03   1.67119551e-02
   1.99791513e-01   3.09142864e+03   1.77393592e+03   7.68127082e+04
   4.90716634e+04   4.02933872e+04   7.10002021e+04   4.52204054e+04
   2.49807029e+04   2.25819790e+04   3.49473812e+04   3.20806637e+04
   1.65479938e+04   1.56894310e+04   2.17238628e+04   2.34092561e+04
   9.99840421e+03   1.07267525e+04   1.29703907e+04   1.67027163e+04
   1.00231985e+04   6.22863776e+03   6.99672343e+03   1.17032455e+04
   4.40944972e+03   1.16759169e+03   2.57534208e+03   7.59800136e+03
   3.76019001e+03   1.37953462e-02   1.05011057e-03   7.36853350e+03
   6.59000999e+02   8.01265015e+04   5.16506577e+04   3.41036916e+04
   6.05265015e+04   5.07043964e+04   2.82403693e+04   1.91507889e+04
   2.70158505e+04   3.87398569e+04   1.89104303e+04   1.47900946e+04
   1.50732779e+04   3.10292759e+04   1.13686970e+04   8.51172798e+03
   7.42587480e+03   2.52670395e+04   1.64617567e+04   9.93010662e+03
   2.95727172e+03   2.11613099e+04   1.05135066e+04   2.32847528e+03
   6.64903005e+02   1.73933405e+04   1.26336502e+04   3.83286838e+03
   4.08136090e-01   1.91552753e+04   7.18715869e+03   1.77237796e+03]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  2.19306416e+03   1.65223008e+04   7.85863972e+03   1.87000000e+04
   1.51954898e+04   3.53178313e+03   3.85354784e+03   4.17698277e-03
   1.26926163e+04   2.34535478e+04   1.30069243e+04   3.08305310e+03
   7.99129447e+03   2.24146435e+04   2.29326527e+03   2.22046964e+04
   9.22475107e+03   1.62348415e+03   1.27017927e+04   1.16644208e+04
   3.66295422e+03   2.52227159e+04   1.35809478e+04   9.89149781e-02
   5.62271586e+03   1.88396499e+04   1.08190700e+04   1.30932060e+03
   1.03957577e+04   2.78049720e+03   1.45868469e+04   2.99957577e+04
   4.93941396e+02   4.59695998e+02   9.92474185e+03   1.93511770e+04
   2.06891676e+04   7.47385016e+03   8.63748997e+03   2.53343256e+04
   6.56786861e+03   1.33631550e-02   2.32758816e+03   9.74704204e+03
   2.88899916e+03   2.46679908e+04   1.01243202e+04   5.30544262e+03
   2.02190491e+04   1.08234677e+04   2.06459548e+03   3.01366952e-03
   4.95598090e+03   7.29447752e+03   1.58909550e+02   3.34521113e+04
   1.77101510e+04   3.16329454e+03   1.38521113e+04   2.14575408e+04
   9.91904217e+03   5.11631234e+02   7.56077946e+02   1.89303343e+04
   6.83567573e+03   2.20797987e+03   1.78159996e+04   7.12521944e+03
   1.82069751e+04   3.74159996e+04   3.70504116e+03   1.03203455e+03
   1.05738437e+04   2.18408289e+04   3.17712896e+01   1.95264974e+03
   6.48066701e+03   1.89355661e+04   3.01021445e+04   1.36147460e+04
   1.09013189e+04   2.97649457e+04   1.26503369e+04   2.69909770e+03
   2.68385391e+03   1.02763036e+04   7.16793526e+03   2.96395343e-05
   5.99824170e-04   5.39912508e+03   4.75704672e+03   3.50064116e+04
   1.72847785e+04   8.15744470e+03   2.48475864e+04   1.81277701e+04
   5.98216236e+03   1.21837702e+03   6.03035124e+03   1.29557485e+04
   2.29523757e+03   9.75481463e-03   1.49148053e+03   1.07986218e+04
   3.47690136e+02   4.32227682e+04   2.39403801e+04   8.55939697e+03
   2.36227682e+04   2.63827845e+04   1.18066386e+04   2.48759480e+03
   4.85081673e+03   2.12316968e+04   6.98652479e+03   2.49989132e+03
   3.34763517e+02   1.90916853e+04   3.85253767e+03   2.37014593e+02
   2.69243855e+04   1.32109745e+04   2.35805967e+04   4.65243855e+04
   8.67666837e+03   3.41027863e+03   1.30275309e+04   2.61034149e+04
   2.76326703e+03   2.84815033e+03   7.49659925e+03   2.07564557e+04
  -5.51904122e-08   4.20336546e+03   1.04943385e+04   1.88042228e+04
   3.26805069e+04   1.62641244e+04   2.14168838e+04   4.49340150e+04
   1.24257217e+04   3.99093660e+03   1.01007429e+04   2.21619644e+04
   5.42545578e+03   1.81685845e+03   4.81940843e+03   1.56303458e+04
   1.77358564e+03   1.53521507e+03   6.10651475e+03   1.26551849e+04
   2.63597587e-01   3.70838731e+04   1.87337047e+04   1.82787072e+04
   4.10732044e+04   1.60861050e+04   5.03678994e+03   7.17339281e+03
   1.74308234e+04   8.68350012e+03   1.59235637e+03   2.69931076e+03
   1.04606637e+04   4.70268402e+03   4.78908058e-02   2.54553720e+03
   7.10683206e+03   2.60607281e+03   1.62549526e-01   5.16900361e+04
   2.97207264e+04   1.47331172e+04   3.37364279e+04   3.07935105e+04
   1.41023441e+04   5.65152261e+03   1.02126424e+04   2.34457303e+04
   8.02826549e+03   4.04167861e+03   3.30224039e+03   1.95097379e+04
   3.68245584e+03   7.24000809e+02   8.27545065e-03   1.74571797e+04
   1.07603056e+04   5.24202624e+03   3.78330350e+04   2.10727981e+04
   3.06349638e+04   5.72892781e+04   1.54485592e+04   7.55140847e+03
   1.71747536e+04   3.20225075e+04   7.29502637e+03   5.48907111e+03
   1.02246012e+04   2.42338521e+04   2.70026360e+03   5.37683273e+03
   1.18811852e+04   2.01732671e+04   2.63597655e-01   2.63597607e-01
   2.25247669e+03   1.70671659e+04   4.55531574e+04   2.54399802e+04
   2.74250915e+04   5.41227359e+04   2.10875198e+04   9.05505321e+03
   1.34644752e+04   2.64180919e+04   1.18069993e+04   4.92409904e+03
   7.19459427e+03   1.74010436e+04   6.29082933e+03   2.69908647e+03
   6.60123626e+03   1.22797678e+04   2.68526736e+03   2.05632459e+02
   6.62429038e-02   8.74290215e+03   8.39517462e+02   5.50618872e+04
   3.18629846e+04   2.40122379e+04   4.90206449e+04   2.97386271e+04
   1.33695887e+04   1.07461891e+04   2.03113818e+04   1.99936881e+04
   7.15611014e+03   6.06197448e+03   1.07881271e+04   1.40978170e+04
   2.77360774e+03   3.06669622e+03   5.22975291e+03   1.01190835e+04
   4.72017236e+03   1.36731713e+03   1.94060342e+03   7.84658032e+03
   1.86159173e+03   5.91738525e+04   3.50904449e+04   2.18692432e+04
   4.48525386e+04   3.45473119e+04   1.64621773e+04   9.83165028e+03
   1.69594129e+04   2.51796594e+04   9.49244657e+03   6.45711445e+03
   7.84739254e+03   1.95922518e+04   4.30161281e+03   2.47811134e+03
   2.64411044e+03   1.59166772e+04   9.11307994e+03   4.06906194e+03
   2.48141553e-03   1.39169677e+04   5.78494520e+03   1.37642813e-02
   5.03147988e+04   3.03100872e+04   3.80649468e+04   6.80981964e+04
   2.38752764e+04   1.30010170e+04   2.18913112e+04   3.80813434e+04
   1.35258607e+04   9.28198377e+03   1.37474793e+04   2.78992218e+04
   7.13577914e+03   7.53656850e+03   1.38662583e+04   2.17719302e+04
   2.67133394e+03   1.50175352e+03   3.08439258e+03   1.70058577e+04
   4.90377356e-01   3.87748742e+02   6.40549984e+03   1.24197089e+04
   6.25563349e+04   3.92644205e+04   4.32397138e+04   7.55194835e+04
   3.27282681e+04   1.84763907e+04   2.51031278e+04   4.15332888e+04
   2.05438928e+04   1.29571664e+04   1.64030503e+04   2.93510998e+04
   1.26535775e+04   9.41202419e+03   1.47382819e+04   2.14967932e+04
   6.71469779e+03   3.92638751e+03   4.22800168e+03   1.54873266e+04
   2.55174252e+03   8.58543087e+02   4.77399069e+03   1.00183629e+04
   2.39266024e-01   6.20657574e+04   3.75534754e+04   3.28807609e+04
   6.16184895e+04   3.36564844e+04   1.68072613e+04   1.69387529e+04
   2.92942702e+04   2.22404123e+04   1.01672932e+04   1.04607585e+04
   1.79495155e+04   1.49782494e+04   5.41470372e+03   7.29542226e+03
   1.08183153e+04   9.65671986e+03   4.65468195e+03   2.23998009e+03
   5.97746249e+03   6.06193522e+03   9.54963748e+02   1.10934746e-03
   2.30776534e+03   3.54330330e+03   1.49973527e+03   6.95412611e+04
   4.31135958e+04   3.11572876e+04   5.81347809e+04   4.10349712e+04
   2.12754534e+04   1.61218385e+04   2.56969161e+04   2.95663626e+04
   1.32692338e+04   1.10230703e+04   1.42948977e+04   2.22612468e+04
   7.08973140e+03   6.23044975e+03   7.11425160e+03   1.68975029e+04
   9.82111200e+03   5.08839792e+03   2.69228767e+03   1.32203136e+04
   5.04850077e+03   1.37642610e-02   1.37642806e-02   1.01926209e+04
   6.76686844e+03   6.32438034e+02   7.15583494e+04   4.75302658e+04
   5.54697457e+04   9.11583494e+04   3.91940185e+04   2.50777559e+04
   3.49524566e+04   5.42011745e+04   2.56362092e+04   1.94557925e+04
   2.45152122e+04   4.05219713e+04   1.66229963e+04   1.58657008e+04
   2.30077398e+04   3.13750251e+04   9.58052898e+03   7.50059699e+03
   9.00318780e+03   2.40046246e+04   4.33832529e+03   3.93311527e+03
   1.00934904e+04   1.69256083e+04   9.88258484e+02   1.41210419e-01
   5.04885969e+03   1.21455872e+04   7.06800376e+04   4.48998102e+04
   4.34736974e+04   7.59195613e+04   3.92255529e+04   2.19458569e+04
   2.48762719e+04   4.00281804e+04   2.61604421e+04   1.49053004e+04
   1.66067117e+04   2.68860082e+04   1.75500516e+04   9.80871436e+03
   1.32978586e+04   1.82027768e+04   1.09034796e+04   6.32432349e+03
   4.87053144e+03   1.18237316e+04   6.00450743e+03   1.81026199e+03
   2.70020436e+03   6.43233442e+03   2.42968785e+03   1.67119551e-02
   1.99791513e-01   3.09142864e+03   1.77393592e+03   7.68127082e+04
   4.90716634e+04   4.02933872e+04   7.10002021e+04   4.52204054e+04
   2.49807029e+04   2.25819790e+04   3.49473812e+04   3.20806637e+04
   1.65479938e+04   1.56894310e+04   2.17238628e+04   2.34092561e+04
   9.99840421e+03   1.07267525e+04   1.29703907e+04   1.67027163e+04
   1.00231985e+04   6.22863776e+03   6.99672343e+03   1.17032455e+04
   4.40944972e+03   1.16759169e+03   2.57534208e+03   7.59800136e+03
   3.76019001e+03   1.37953462e-02   1.05011057e-03   7.36853350e+03
   6.59000999e+02   8.01265015e+04   5.16506577e+04   3.41036916e+04
   6.05265015e+04   5.07043964e+04   2.82403693e+04   1.91507889e+04
   2.70158505e+04   3.87398569e+04   1.89104303e+04   1.47900946e+04
   1.50732779e+04   3.10292759e+04   1.13686970e+04   8.51172798e+03
   7.42587480e+03   2.52670395e+04   1.64617567e+04   9.93010662e+03
   2.95727172e+03   2.11613099e+04   1.05135066e+04   2.32847528e+03
   6.64903005e+02   1.73933405e+04   1.26336502e+04   3.83286838e+03
   4.08136090e-01   1.91552753e+04   7.18715869e+03   1.77237796e+03]
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.340e+00 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.733e-02 (tol = 1.000e-10) r (rel) = 1.293e-02 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 6.340e-06 (tol = 1.000e-10) r (rel) = 4.730e-06 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 4.039e-12 (tol = 1.000e-10) r (rel) = 3.013e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 18.693875 s.
j = 1.390250e+06.
Runtime: 18.685293 s.
j = 1.390250e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19913072e+03   1.66302015e+04   7.90867032e+03   1.87000000e+04
   1.52114652e+04   3.59110710e+03   3.87030468e+03   5.75093938e-04
   1.27276022e+04   2.34703047e+04   1.29712806e+04   3.05299702e+03
   7.92415089e+03   2.23416382e+04   2.27510557e+03   2.21622112e+04
   9.19780376e+03   1.55770308e+03   1.26605778e+04   1.16376510e+04
   3.64429918e+03   2.53454588e+04   1.36309566e+04   7.64720547e-03
   5.74545883e+03   1.88550596e+04   1.07321363e+04   1.25363148e+03
   1.04278632e+04   2.78713689e+03   1.45931720e+04   3.00278632e+04
   4.96146405e+02   4.65391880e+02   9.92077990e+03   1.93206452e+04
   2.06547676e+04   7.44061177e+03   8.55143068e+03   2.52861529e+04
   6.53700715e+03   4.50212364e-04   2.32437091e+03   9.63818145e+03
   2.87623639e+03   2.46311763e+04   1.00933334e+04   5.21304418e+03
   2.01726563e+04   1.07925335e+04   2.05678840e+03   1.22023419e-04
   4.85412515e+03   7.28276363e+03   1.57990772e+02   3.35026199e+04
   1.77370416e+04   3.11592874e+03   1.39026199e+04   2.14666154e+04
   9.89920176e+03   5.20450297e+02   7.11728159e+02   1.89320621e+04
   6.81640516e+03   2.19458965e+03   1.77328963e+04   7.05788090e+03
   1.81222752e+04   3.73328963e+04   3.64747586e+03   1.03676986e+03
   1.05668740e+04   2.17230955e+04   4.20083963e+00   1.95795566e+03
   6.48600258e+03   1.89201173e+04   3.00621285e+04   1.35735517e+04
   1.07768531e+04   2.97100743e+04   1.26083877e+04   2.69885473e+03
   2.68406321e+03   1.01246723e+04   7.14287168e+03   8.98832895e-05
   8.95541636e-04   5.36381334e+03   4.77220219e+03   3.49689039e+04
   1.72482261e+04   8.04105795e+03   2.48184512e+04   1.80826443e+04
   5.96859307e+03   1.22636704e+03   5.90284271e+03   1.29241323e+04
   2.28870694e+03   7.14345220e-04   1.47183972e+03   1.08005276e+04
   3.41476721e+02   4.32547247e+04   2.39539995e+04   8.46882607e+03
   2.36547247e+04   2.63793815e+04   1.18061542e+04   2.51445191e+03
   4.75200066e+03   2.12267751e+04   6.98780695e+03   2.50756988e+03
   3.27342942e+02   1.91079231e+04   3.84308643e+03   2.38959622e+02
   2.68230383e+04   1.31207906e+04   2.34452688e+04   4.64230383e+04
   8.59357436e+03   3.40891699e+03   1.30135634e+04   2.59220565e+04
   2.70839679e+03   2.84390851e+03   7.49319250e+03   2.07102982e+04
  -2.84004500e-07   4.20914404e+03   1.04839597e+04   1.87960967e+04
   3.27007141e+04   1.62661824e+04   2.13818231e+04   4.50176356e+04
   1.24064470e+04   4.03870345e+03   1.01742108e+04   2.20795834e+04
   5.40422336e+03   1.85271965e+03   4.87357187e+03   1.56676309e+04
   1.79687137e+03   1.57008649e+03   6.14724578e+03   1.27060874e+04
   6.83870208e-03   3.69786938e+04   1.86402210e+04   1.81177401e+04
   4.09993121e+04   1.59866530e+04   5.02050235e+03   7.17448562e+03
   1.72376833e+04   8.60693808e+03   1.58131536e+03   2.69879039e+03
   1.04201407e+04   4.69579575e+03   8.00957741e-04   2.54492724e+03
   7.10466137e+03   2.59584738e+03   3.43302304e+00   5.17549032e+04
   2.97570559e+04   1.46254307e+04   3.37792427e+04   3.08137308e+04
   1.41390207e+04   5.70245694e+03   1.00776534e+04   2.34615353e+04
   8.05889939e+03   4.07427170e+03   3.28967874e+03   1.95725395e+04
   3.69901632e+03   7.42746037e+02   1.62434560e-03   1.74946863e+04
   1.08265303e+04   5.27151673e+03   3.77132049e+04   2.09808786e+04
   3.05542051e+04   5.72963005e+04   1.53396901e+04   7.57666538e+03
   1.72477160e+04   3.19041290e+04   7.21260597e+03   5.52341638e+03
   1.02900178e+04   2.42835864e+04   2.70001003e+03   5.43748931e+03
   1.19545702e+04   2.02673739e+04   6.83904254e-03   6.83878132e-03
   2.28918536e+03   1.72006338e+04   4.53712229e+04   2.52862911e+04
   2.72257884e+04   5.40251036e+04   2.09225305e+04   9.01847923e+03
   1.34652240e+04   2.61836169e+04   1.16727879e+04   4.89974506e+03
   7.19273262e+03   1.73568499e+04   6.25672008e+03   2.69879373e+03
   6.60745022e+03   1.22880331e+04   2.65534617e+03   1.75661295e+02
   3.83240383e-03   8.78981115e+03   8.49253958e+02   5.51598006e+04
   3.19170839e+04   2.39123712e+04   4.91026032e+04   2.97726458e+04
   1.34466893e+04   1.08279849e+04   2.01534569e+04   2.00152007e+04
   7.21293681e+03   6.12209646e+03   1.07811963e+04   1.41905537e+04
   2.81364350e+03   3.10095178e+03   5.23635773e+03   1.01815508e+04
   4.76554879e+03   1.40779652e+03   1.94778668e+03   7.96148492e+03
   1.90656182e+03   5.92253025e+04   3.51120781e+04   2.17350686e+04
   4.48930253e+04   3.45501810e+04   1.65070160e+04   9.89164581e+03
   1.67842861e+04   2.51779416e+04   9.52823060e+03   6.49768951e+03
   7.82590423e+03   1.96632931e+04   4.32590869e+03   2.50243293e+03
   2.64223443e+03   1.59635678e+04   9.16421545e+03   4.10719822e+03
   1.16036212e-04   1.40492116e+04   5.84201674e+03   5.99224461e-04
   5.01185371e+04   3.01228483e+04   3.77502330e+04   6.78599206e+04
   2.37014227e+04   1.29462208e+04   2.18033546e+04   3.76951213e+04
   1.33867756e+04   9.22015159e+03   1.36779855e+04   2.77241830e+04
   7.11371411e+03   7.48620068e+03   1.37834445e+04   2.16569121e+04
   2.65733960e+03   1.44003654e+03   3.04369677e+03   1.69432657e+04
   1.64125108e-01   3.56413641e+02   6.37973328e+03   1.23804577e+04
   6.24488979e+04   3.91556270e+04   4.30337764e+04   7.54697816e+04
   3.26036077e+04   1.84872320e+04   2.51334488e+04   4.12587343e+04
   2.04343383e+04   1.29610316e+04   1.64245446e+04   2.92951236e+04
   1.26687489e+04   9.42827049e+03   1.47494922e+04   2.14889591e+04
   6.72331756e+03   3.88704496e+03   4.24092953e+03   1.55099648e+04
   2.57504698e+03   8.69528130e+02   4.78411368e+03   1.00441965e+04
   1.37389010e-01   6.21577975e+04   3.75998620e+04   3.27653629e+04
   6.17007109e+04   3.36819006e+04   1.68988686e+04   1.70317761e+04
   2.91059472e+04   2.22534647e+04   1.02343981e+04   1.05325048e+04
   1.79383144e+04   1.50840692e+04   5.46702572e+03   7.33785314e+03
   1.08267552e+04   9.73344526e+03   4.68943013e+03   2.29098544e+03
   5.98983173e+03   6.17417098e+03   1.00876299e+03   1.07514972e-03
   2.31269781e+03   3.54642368e+03   1.51531346e+03   6.96361445e+04
   4.31654475e+04   3.10126543e+04   5.81914766e+04   4.10695307e+04
   2.13628305e+04   1.62076368e+04   2.54896407e+04   2.95920175e+04
   1.33375136e+04   1.10904153e+04   1.42692775e+04   2.23831265e+04
   7.14158568e+03   6.27136260e+03   7.11170350e+03   1.69930990e+04
   9.88803704e+03   5.15754164e+03   2.69141504e+03   1.33896828e+04
   5.14113396e+03   5.99106713e-04   5.99135442e-04   1.02072635e+04
   6.82042194e+03   6.40315722e+02   7.15932465e+04   4.75234008e+04
   5.53138309e+04   9.11932465e+04   3.91713545e+04   2.51714858e+04
   3.50314231e+04   5.39410569e+04   2.56081590e+04   1.95165923e+04
   2.45810863e+04   4.04797623e+04   1.67207921e+04   1.59192872e+04
   2.30382771e+04   3.13666531e+04   9.65619222e+03   7.48463738e+03
   9.04248317e+03   2.40169928e+04   4.39158821e+03   3.95993319e+03
   1.00900991e+04   1.69313231e+04   1.03373963e+03   2.89721107e-02
   5.04723982e+03   1.21719450e+04   7.06069550e+04   4.48170810e+04
   4.32772242e+04   7.59168965e+04   3.91179208e+04   2.19683319e+04
   2.49318500e+04   3.97657513e+04   2.60593957e+04   1.49204369e+04
   1.66439844e+04   2.68466927e+04   1.75781679e+04   9.83264138e+03
   1.33242135e+04   1.82067623e+04   1.09187626e+04   6.29410900e+03
   4.89582789e+03   1.18467895e+04   6.05319153e+03   1.84028115e+03
   2.69939723e+03   6.45438369e+03   2.41933439e+03   5.92459031e-04
   2.50131940e-02   3.12816203e+03   1.75027175e+03   7.68942150e+04
   4.91082177e+04   4.01255145e+04   7.10494916e+04   4.52387858e+04
   2.50749213e+04   2.26712606e+04   3.47019519e+04   3.20902421e+04
   1.66188400e+04   1.57606523e+04   2.16861739e+04   2.35365708e+04
   1.00547862e+04   1.07680451e+04   1.29618422e+04   1.68048904e+04
   1.00717686e+04   6.30054023e+03   6.99317690e+03   1.18622339e+04
   4.50313791e+03   1.15973486e+03   2.57240139e+03   7.63378007e+03
   3.81140156e+03   4.78594878e-02   1.05258293e-03   7.38887365e+03
   6.88524330e+02   8.04645201e+04   5.18979195e+04   3.41479810e+04
   6.08645201e+04   5.09049206e+04   2.84532388e+04   1.93896986e+04
   2.69906711e+04   3.88902081e+04   1.90858879e+04   1.49767382e+04
   1.51931219e+04   3.12490001e+04   1.15059759e+04   8.65631633e+03
   7.53187000e+03   2.54276609e+04   1.65924923e+04   1.00633750e+04
   3.02634484e+03   2.13894155e+04   1.06511227e+04   2.35175995e+03
   7.04286049e+02   1.74029812e+04   1.26772629e+04   3.83566957e+03
   9.65607415e-03   1.91293603e+04   7.20970554e+03   1.74356301e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.19913072e+03   1.66302015e+04   7.90867032e+03   1.87000000e+04
   1.52114652e+04   3.59110710e+03   3.87030468e+03   5.75093938e-04
   1.27276022e+04   2.34703047e+04   1.29712806e+04   3.05299702e+03
   7.92415089e+03   2.23416382e+04   2.27510557e+03   2.21622112e+04
   9.19780376e+03   1.55770308e+03   1.26605778e+04   1.16376510e+04
   3.64429918e+03   2.53454588e+04   1.36309566e+04   7.64720547e-03
   5.74545883e+03   1.88550596e+04   1.07321363e+04   1.25363148e+03
   1.04278632e+04   2.78713689e+03   1.45931720e+04   3.00278632e+04
   4.96146405e+02   4.65391880e+02   9.92077990e+03   1.93206452e+04
   2.06547676e+04   7.44061177e+03   8.55143068e+03   2.52861529e+04
   6.53700715e+03   4.50212364e-04   2.32437091e+03   9.63818145e+03
   2.87623639e+03   2.46311763e+04   1.00933334e+04   5.21304418e+03
   2.01726563e+04   1.07925335e+04   2.05678840e+03   1.22023419e-04
   4.85412515e+03   7.28276363e+03   1.57990772e+02   3.35026199e+04
   1.77370416e+04   3.11592874e+03   1.39026199e+04   2.14666154e+04
   9.89920176e+03   5.20450297e+02   7.11728159e+02   1.89320621e+04
   6.81640516e+03   2.19458965e+03   1.77328963e+04   7.05788090e+03
   1.81222752e+04   3.73328963e+04   3.64747586e+03   1.03676986e+03
   1.05668740e+04   2.17230955e+04   4.20083963e+00   1.95795566e+03
   6.48600258e+03   1.89201173e+04   3.00621285e+04   1.35735517e+04
   1.07768531e+04   2.97100743e+04   1.26083877e+04   2.69885473e+03
   2.68406321e+03   1.01246723e+04   7.14287168e+03   8.98832895e-05
   8.95541636e-04   5.36381334e+03   4.77220219e+03   3.49689039e+04
   1.72482261e+04   8.04105795e+03   2.48184512e+04   1.80826443e+04
   5.96859307e+03   1.22636704e+03   5.90284271e+03   1.29241323e+04
   2.28870694e+03   7.14345220e-04   1.47183972e+03   1.08005276e+04
   3.41476721e+02   4.32547247e+04   2.39539995e+04   8.46882607e+03
   2.36547247e+04   2.63793815e+04   1.18061542e+04   2.51445191e+03
   4.75200066e+03   2.12267751e+04   6.98780695e+03   2.50756988e+03
   3.27342942e+02   1.91079231e+04   3.84308643e+03   2.38959622e+02
   2.68230383e+04   1.31207906e+04   2.34452688e+04   4.64230383e+04
   8.59357436e+03   3.40891699e+03   1.30135634e+04   2.59220565e+04
   2.70839679e+03   2.84390851e+03   7.49319250e+03   2.07102982e+04
  -2.84004500e-07   4.20914404e+03   1.04839597e+04   1.87960967e+04
   3.27007141e+04   1.62661824e+04   2.13818231e+04   4.50176356e+04
   1.24064470e+04   4.03870345e+03   1.01742108e+04   2.20795834e+04
   5.40422336e+03   1.85271965e+03   4.87357187e+03   1.56676309e+04
   1.79687137e+03   1.57008649e+03   6.14724578e+03   1.27060874e+04
   6.83870208e-03   3.69786938e+04   1.86402210e+04   1.81177401e+04
   4.09993121e+04   1.59866530e+04   5.02050235e+03   7.17448562e+03
   1.72376833e+04   8.60693808e+03   1.58131536e+03   2.69879039e+03
   1.04201407e+04   4.69579575e+03   8.00957741e-04   2.54492724e+03
   7.10466137e+03   2.59584738e+03   3.43302304e+00   5.17549032e+04
   2.97570559e+04   1.46254307e+04   3.37792427e+04   3.08137308e+04
   1.41390207e+04   5.70245694e+03   1.00776534e+04   2.34615353e+04
   8.05889939e+03   4.07427170e+03   3.28967874e+03   1.95725395e+04
   3.69901632e+03   7.42746037e+02   1.62434560e-03   1.74946863e+04
   1.08265303e+04   5.27151673e+03   3.77132049e+04   2.09808786e+04
   3.05542051e+04   5.72963005e+04   1.53396901e+04   7.57666538e+03
   1.72477160e+04   3.19041290e+04   7.21260597e+03   5.52341638e+03
   1.02900178e+04   2.42835864e+04   2.70001003e+03   5.43748931e+03
   1.19545702e+04   2.02673739e+04   6.83904254e-03   6.83878132e-03
   2.28918536e+03   1.72006338e+04   4.53712229e+04   2.52862911e+04
   2.72257884e+04   5.40251036e+04   2.09225305e+04   9.01847923e+03
   1.34652240e+04   2.61836169e+04   1.16727879e+04   4.89974506e+03
   7.19273262e+03   1.73568499e+04   6.25672008e+03   2.69879373e+03
   6.60745022e+03   1.22880331e+04   2.65534617e+03   1.75661295e+02
   3.83240383e-03   8.78981115e+03   8.49253958e+02   5.51598006e+04
   3.19170839e+04   2.39123712e+04   4.91026032e+04   2.97726458e+04
   1.34466893e+04   1.08279849e+04   2.01534569e+04   2.00152007e+04
   7.21293681e+03   6.12209646e+03   1.07811963e+04   1.41905537e+04
   2.81364350e+03   3.10095178e+03   5.23635773e+03   1.01815508e+04
   4.76554879e+03   1.40779652e+03   1.94778668e+03   7.96148492e+03
   1.90656182e+03   5.92253025e+04   3.51120781e+04   2.17350686e+04
   4.48930253e+04   3.45501810e+04   1.65070160e+04   9.89164581e+03
   1.67842861e+04   2.51779416e+04   9.52823060e+03   6.49768951e+03
   7.82590423e+03   1.96632931e+04   4.32590869e+03   2.50243293e+03
   2.64223443e+03   1.59635678e+04   9.16421545e+03   4.10719822e+03
   1.16036212e-04   1.40492116e+04   5.84201674e+03   5.99224461e-04
   5.01185371e+04   3.01228483e+04   3.77502330e+04   6.78599206e+04
   2.37014227e+04   1.29462208e+04   2.18033546e+04   3.76951213e+04
   1.33867756e+04   9.22015159e+03   1.36779855e+04   2.77241830e+04
   7.11371411e+03   7.48620068e+03   1.37834445e+04   2.16569121e+04
   2.65733960e+03   1.44003654e+03   3.04369677e+03   1.69432657e+04
   1.64125108e-01   3.56413641e+02   6.37973328e+03   1.23804577e+04
   6.24488979e+04   3.91556270e+04   4.30337764e+04   7.54697816e+04
   3.26036077e+04   1.84872320e+04   2.51334488e+04   4.12587343e+04
   2.04343383e+04   1.29610316e+04   1.64245446e+04   2.92951236e+04
   1.26687489e+04   9.42827049e+03   1.47494922e+04   2.14889591e+04
   6.72331756e+03   3.88704496e+03   4.24092953e+03   1.55099648e+04
   2.57504698e+03   8.69528130e+02   4.78411368e+03   1.00441965e+04
   1.37389010e-01   6.21577975e+04   3.75998620e+04   3.27653629e+04
   6.17007109e+04   3.36819006e+04   1.68988686e+04   1.70317761e+04
   2.91059472e+04   2.22534647e+04   1.02343981e+04   1.05325048e+04
   1.79383144e+04   1.50840692e+04   5.46702572e+03   7.33785314e+03
   1.08267552e+04   9.73344526e+03   4.68943013e+03   2.29098544e+03
   5.98983173e+03   6.17417098e+03   1.00876299e+03   1.07514972e-03
   2.31269781e+03   3.54642368e+03   1.51531346e+03   6.96361445e+04
   4.31654475e+04   3.10126543e+04   5.81914766e+04   4.10695307e+04
   2.13628305e+04   1.62076368e+04   2.54896407e+04   2.95920175e+04
   1.33375136e+04   1.10904153e+04   1.42692775e+04   2.23831265e+04
   7.14158568e+03   6.27136260e+03   7.11170350e+03   1.69930990e+04
   9.88803704e+03   5.15754164e+03   2.69141504e+03   1.33896828e+04
   5.14113396e+03   5.99106713e-04   5.99135442e-04   1.02072635e+04
   6.82042194e+03   6.40315722e+02   7.15932465e+04   4.75234008e+04
   5.53138309e+04   9.11932465e+04   3.91713545e+04   2.51714858e+04
   3.50314231e+04   5.39410569e+04   2.56081590e+04   1.95165923e+04
   2.45810863e+04   4.04797623e+04   1.67207921e+04   1.59192872e+04
   2.30382771e+04   3.13666531e+04   9.65619222e+03   7.48463738e+03
   9.04248317e+03   2.40169928e+04   4.39158821e+03   3.95993319e+03
   1.00900991e+04   1.69313231e+04   1.03373963e+03   2.89721107e-02
   5.04723982e+03   1.21719450e+04   7.06069550e+04   4.48170810e+04
   4.32772242e+04   7.59168965e+04   3.91179208e+04   2.19683319e+04
   2.49318500e+04   3.97657513e+04   2.60593957e+04   1.49204369e+04
   1.66439844e+04   2.68466927e+04   1.75781679e+04   9.83264138e+03
   1.33242135e+04   1.82067623e+04   1.09187626e+04   6.29410900e+03
   4.89582789e+03   1.18467895e+04   6.05319153e+03   1.84028115e+03
   2.69939723e+03   6.45438369e+03   2.41933439e+03   5.92459031e-04
   2.50131940e-02   3.12816203e+03   1.75027175e+03   7.68942150e+04
   4.91082177e+04   4.01255145e+04   7.10494916e+04   4.52387858e+04
   2.50749213e+04   2.26712606e+04   3.47019519e+04   3.20902421e+04
   1.66188400e+04   1.57606523e+04   2.16861739e+04   2.35365708e+04
   1.00547862e+04   1.07680451e+04   1.29618422e+04   1.68048904e+04
   1.00717686e+04   6.30054023e+03   6.99317690e+03   1.18622339e+04
   4.50313791e+03   1.15973486e+03   2.57240139e+03   7.63378007e+03
   3.81140156e+03   4.78594878e-02   1.05258293e-03   7.38887365e+03
   6.88524330e+02   8.04645201e+04   5.18979195e+04   3.41479810e+04
   6.08645201e+04   5.09049206e+04   2.84532388e+04   1.93896986e+04
   2.69906711e+04   3.88902081e+04   1.90858879e+04   1.49767382e+04
   1.51931219e+04   3.12490001e+04   1.15059759e+04   8.65631633e+03
   7.53187000e+03   2.54276609e+04   1.65924923e+04   1.00633750e+04
   3.02634484e+03   2.13894155e+04   1.06511227e+04   2.35175995e+03
   7.04286049e+02   1.74029812e+04   1.26772629e+04   3.83566957e+03
   9.65607415e-03   1.91293603e+04   7.20970554e+03   1.74356301e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.53307819366 s
|dj| = 12428.4045681
Runtime: 5.53002810478 s
|dj| = 12428.4045681
   48    89    -3.106738E+04     2.777329E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.553e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.416e-03 (tol = 1.000e-10) r (rel) = 3.110e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.516e-08 (tol = 1.000e-10) r (rel) = 9.919e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.156e-13 (tol = 1.000e-10) r (rel) = 6.931e-13 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 16.582545 s.
j = 1.390272e+06.
Minimum distance inequality constraints (should all be > 0): [  2.18439528e+03   1.66189989e+04   7.91127825e+03   1.87000000e+04
   1.52035313e+04   3.58598301e+03   3.85592197e+03   1.53182519e-03
   1.27218503e+04   2.34559220e+04   1.29525275e+04   3.05997365e+03
   7.91797572e+03   2.23239423e+04   2.27668827e+03   2.21339148e+04
   9.20111775e+03   1.55308636e+03   1.26407679e+04   1.16317534e+04
   3.64076532e+03   2.53330267e+04   1.36402600e+04   1.21973985e-03
   5.73302674e+03   1.88557555e+04   1.07325368e+04   1.25447053e+03
   1.04650486e+04   2.82073368e+03   1.46076694e+04   3.00650486e+04
   5.17054875e+02   4.62336550e+02   9.91220432e+03   1.93332061e+04
   2.06366596e+04   7.45441467e+03   8.55802935e+03   2.52861438e+04
   6.53866227e+03   5.43316684e-03   2.33088003e+03   9.65327556e+03
   2.85631410e+03   2.46057247e+04   1.01029522e+04   5.20712987e+03
   2.01508075e+04   1.07926748e+04   2.05572019e+03   4.75665324e-04
   4.85445332e+03   7.26586618e+03   1.61540119e+02   3.35028406e+04
   1.77620596e+04   3.12281796e+03   1.39028406e+04   2.14776834e+04
   9.90160889e+03   5.24842076e+02   7.17932281e+02   1.89268019e+04
   6.82633688e+03   2.19371333e+03   1.77646736e+04   7.10003866e+03
   1.81416095e+04   3.73646736e+04   3.67726983e+03   1.04629346e+03
   1.05717432e+04   2.17443160e+04   7.04176046e-01   1.95099978e+03
   6.48455667e+03   1.89235561e+04   3.00343189e+04   1.35865895e+04
   1.07688278e+04   2.96843175e+04   1.26111995e+04   2.69854343e+03
   2.68418523e+03   1.01245831e+04   7.11382238e+03   5.06810165e-03
   4.01954243e-05   5.35823093e+03   4.76146546e+03   3.49367429e+04
   1.72595007e+04   8.02781897e+03   2.47811723e+04   1.80846345e+04
   5.96876087e+03   1.22515592e+03   5.89578406e+03   1.28989456e+04
   2.29450653e+03   1.79451423e-03   1.46248025e+03   1.07950840e+04
   3.43532067e+02   4.32426405e+04   2.39801359e+04   8.47179130e+03
   2.36426405e+04   2.63908895e+04   1.18108721e+04   2.52223463e+03
   4.75767431e+03   2.12053956e+04   6.99909485e+03   2.51106215e+03
   3.24578944e+02   1.91016895e+04   3.84372264e+03   2.37719975e+02
   2.68617966e+04   1.31780225e+04   2.34745199e+04   4.64617966e+04
   8.63660123e+03   3.43037407e+03   1.30313762e+04   2.59548352e+04
   2.70140821e+03   2.84639145e+03   7.50390465e+03   2.07206635e+04
  -1.05234221e-07   4.21038028e+03   1.04923970e+04   1.87991579e+04
   3.27603718e+04   1.63457666e+04   2.14350398e+04   4.50857437e+04
   1.24662765e+04   4.07422866e+03   1.02121736e+04   2.21354755e+04
   5.40176752e+03   1.86961717e+03   4.89953890e+03   1.56945955e+04
   1.80000547e+03   1.58257535e+03   6.16910077e+03   1.27232683e+04
   3.64484008e-03   3.69680241e+04   1.86697751e+04   1.81093242e+04
   4.09731847e+04   1.60066863e+04   5.02834434e+03   7.17446385e+03
   1.72349237e+04   8.57796070e+03   1.58144212e+03   2.69894067e+03
   1.04048673e+04   4.68582482e+03   5.36352597e-03   2.54535148e+03
   7.09496118e+03   2.59556270e+03   6.38669398e+00   5.17337136e+04
   2.97830834e+04   1.46270718e+04   3.37636452e+04   3.08228141e+04
   1.41417947e+04   5.71166001e+03   1.00849503e+04   2.34216205e+04
   8.06595991e+03   4.07808760e+03   3.28431259e+03   1.95514346e+04
   3.69948071e+03   7.44869580e+02   4.14637659e-04   1.74831138e+04
   1.08268061e+04   5.25970884e+03   3.77589434e+04   2.10560242e+04
   3.06074465e+04   5.73589434e+04   1.53959481e+04   7.61446498e+03
   1.72910196e+04   3.19653684e+04   7.20212319e+03   5.54179039e+03
   1.03232602e+04   2.43177801e+04   2.70000729e+03   5.45929946e+03
   1.19897148e+04   2.02966312e+04   3.64496695e-03   3.64487471e-03
   2.30530182e+03   1.72147944e+04   4.53302916e+04   2.52998342e+04
   2.72119415e+04   5.39891704e+04   2.09241908e+04   9.01623069e+03
   1.34647984e+04   2.61827510e+04   1.16151299e+04   4.89055128e+03
   7.19209499e+03   1.73434994e+04   6.22388558e+03   2.69843004e+03
   6.61466143e+03   1.22856177e+04   2.63510110e+03   1.60286627e+02
   7.67843590e-03   8.78682292e+03   8.46314826e+02   5.51602181e+04
   3.19661108e+04   2.39302970e+04   4.91084322e+04   2.98029275e+04
   1.34644700e+04   1.08510627e+04   2.01786871e+04   1.99746564e+04
   7.22456425e+03   6.13797539e+03   1.07846437e+04   1.41694687e+04
   2.82376164e+03   3.11733827e+03   5.24409987e+03   1.01669027e+04
   4.75523239e+03   1.40588598e+03   1.95105567e+03   7.96433407e+03
   1.90781047e+03   5.91982463e+04   3.51397710e+04   2.17356036e+04
   4.48741180e+04   3.45596375e+04   1.65099388e+04   9.90243663e+03
   1.67931138e+04   2.51236613e+04   9.53213440e+03   6.50272184e+03
   7.81824933e+03   1.96312330e+04   4.32752925e+03   2.50870137e+03
   2.64238611e+03   1.59413041e+04   9.15079412e+03   4.09605515e+03
   1.02721614e-04   1.40513732e+04   5.84032411e+03   3.23076019e-03
   5.01781307e+04   3.02228580e+04   3.78419169e+04   6.79652324e+04
   2.37748338e+04   1.30057294e+04   2.18836193e+04   3.78001861e+04
   1.33755966e+04   9.26106354e+03   1.37425142e+04   2.77960481e+04
   7.11520280e+03   7.53496274e+03   1.38544416e+04   2.17247294e+04
   2.65760868e+03   1.44237897e+03   3.07946742e+03   1.69940871e+04
   1.10024370e-02   3.72486936e+02   6.40614360e+03   1.24158795e+04
   6.24899138e+04   3.92461939e+04   4.31010990e+04   7.55389199e+04
   3.26698828e+04   1.85379677e+04   2.51980887e+04   4.13388166e+04
   2.04056100e+04   1.29932953e+04   1.64766544e+04   2.93418315e+04
   1.26583054e+04   9.46849609e+03   1.48078898e+04   2.15367599e+04
   6.71438193e+03   3.87670330e+03   4.26845051e+03   1.55450469e+04
   2.57045185e+03   8.86576264e+02   4.80048274e+03   1.00684989e+04
   6.01535049e-03   6.21711984e+04   3.76641137e+04   3.27904840e+04
   6.17137575e+04   3.37272884e+04   1.69275525e+04   1.70627201e+04
   2.91388105e+04   2.22141759e+04   1.02510274e+04   1.05562201e+04
   1.79444629e+04   1.50657383e+04   5.48470458e+03   7.36295688e+03
   1.08376762e+04   9.72044761e+03   4.67559673e+03   2.29712962e+03
   5.99481493e+03   6.17515157e+03   1.01707359e+03   7.62319424e-04
   2.31378804e+03   3.56459609e+03   1.52638296e+03   6.96283059e+04
   4.32149825e+04   3.10198235e+04   5.81768410e+04   4.11013822e+04
   2.13812738e+04   1.62272059e+04   2.55038572e+04   2.95429563e+04
   1.33505704e+04   1.11048314e+04   1.42610910e+04   2.23583924e+04
   7.15307315e+03   6.28624091e+03   7.11218058e+03   1.69769895e+04
   9.87384172e+03   5.15606653e+03   2.69102377e+03   1.33955812e+04
   5.15112752e+03   3.23071723e-03   3.23073461e-03   1.02413192e+04
   6.84444152e+03   6.42053130e+02   7.17101257e+04   4.76763458e+04
   5.54186333e+04   9.13101257e+04   3.93000367e+04   2.52655113e+04
   3.51255169e+04   5.40512440e+04   2.56219721e+04   1.95781072e+04
   2.46605589e+04   4.05435796e+04   1.67475137e+04   1.59833832e+04
   2.31169413e+04   3.14242352e+04   9.67687700e+03   7.49155605e+03
   9.09206465e+03   2.40548338e+04   4.40623146e+03   3.99447136e+03
   1.01077755e+04   1.69539380e+04   1.03858523e+03   2.58989352e-02
   5.05828361e+03   1.21910281e+04   7.05898215e+04   4.48631964e+04
   4.32915797e+04   7.59141080e+04   3.91442361e+04   2.19849828e+04
   2.49573499e+04   3.97942751e+04   2.59926489e+04   1.49249709e+04
   1.66629211e+04   2.68491678e+04   1.75379277e+04   9.84672070e+03
   1.33514216e+04   1.82192413e+04   1.08868642e+04   6.26208264e+03
   4.90022550e+03   1.18550212e+04   6.03579268e+03   1.84670627e+03
   2.69918492e+03   6.45988132e+03   2.41761937e+03   1.53942333e-02
   5.27017533e-03   3.13740364e+03   1.74833918e+03   7.68972369e+04
   4.91709361e+04   4.01379611e+04   7.10401168e+04   4.52836938e+04
   2.51023070e+04   2.26968140e+04   3.47219312e+04   3.20404265e+04
   1.66349843e+04   1.57810268e+04   2.16788608e+04   2.35126127e+04
   1.00719668e+04   1.07898102e+04   1.29637076e+04   1.67884852e+04
   1.00521569e+04   6.30526096e+03   6.99273377e+03   1.18643495e+04
   4.51834148e+03   1.15795480e+03   2.57173881e+03   7.65772257e+03
   3.82829264e+03   3.21834392e-03   7.18988465e-04   7.39948714e+03
   6.96174884e+02   8.04994633e+04   5.19849007e+04   3.41933015e+04
   6.08994633e+04   5.09675784e+04   2.84957850e+04   1.94Runtime: 16.567018 s.
386754e+04
   2.70396516e+04   3.88605911e+04   1.91219666e+04   1.50137942e+04
   1.52107308e+04   3.12386833e+04   1.15339110e+04   8.68911667e+03
   7.55187308e+03   2.54201076e+04   1.65861903e+04   1.00683895e+04
   3.04066752e+03   2.14015255e+04   1.06668708e+04   2.35733230e+03
   7.13685276e+02   1.74435423e+04   1.27007625e+04   3.83617046e+03
   1.01319052e-02   1.91354602e+04   7.21623519e+03   1.73679910e+03]
j = 1.390272e+06.
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.18439528e+03   1.66189989e+04   7.91127825e+03   1.87000000e+04
   1.52035313e+04   3.58598301e+03   3.85592197e+03   1.53182519e-03
   1.27218503e+04   2.34559220e+04   1.29525275e+04   3.05997365e+03
   7.91797572e+03   2.23239423e+04   2.27668827e+03   2.21339148e+04
   9.20111775e+03   1.55308636e+03   1.26407679e+04   1.16317534e+04
   3.64076532e+03   2.53330267e+04   1.36402600e+04   1.21973985e-03
   5.73302674e+03   1.88557555e+04   1.07325368e+04   1.25447053e+03
   1.04650486e+04   2.82073368e+03   1.46076694e+04   3.00650486e+04
   5.17054875e+02   4.62336550e+02   9.91220432e+03   1.93332061e+04
   2.06366596e+04   7.45441467e+03   8.55802935e+03   2.52861438e+04
   6.53866227e+03   5.43316684e-03   2.33088003e+03   9.65327556e+03
   2.85631410e+03   2.46057247e+04   1.01029522e+04   5.20712987e+03
   2.01508075e+04   1.07926748e+04   2.05572019e+03   4.75665324e-04
   4.85445332e+03   7.26586618e+03   1.61540119e+02   3.35028406e+04
   1.77620596e+04   3.12281796e+03   1.39028406e+04   2.14776834e+04
   9.90160889e+03   5.24842076e+02   7.17932281e+02   1.89268019e+04
   6.82633688e+03   2.19371333e+03   1.77646736e+04   7.10003866e+03
   1.81416095e+04   3.73646736e+04   3.67726983e+03   1.04629346e+03
   1.05717432e+04   2.17443160e+04   7.04176046e-01   1.95099978e+03
   6.48455667e+03   1.89235561e+04   3.00343189e+04   1.35865895e+04
   1.07688278e+04   2.96843175e+04   1.26111995e+04   2.69854343e+03
   2.68418523e+03   1.01245831e+04   7.11382238e+03   5.06810165e-03
   4.01954243e-05   5.35823093e+03   4.76146546e+03   3.49367429e+04
   1.72595007e+04   8.02781897e+03   2.47811723e+04   1.80846345e+04
   5.96876087e+03   1.22515592e+03   5.89578406e+03   1.28989456e+04
   2.29450653e+03   1.79451423e-03   1.46248025e+03   1.07950840e+04
   3.43532067e+02   4.32426405e+04   2.39801359e+04   8.47179130e+03
   2.36426405e+04   2.63908895e+04   1.18108721e+04   2.52223463e+03
   4.75767431e+03   2.12053956e+04   6.99909485e+03   2.51106215e+03
   3.24578944e+02   1.91016895e+04   3.84372264e+03   2.37719975e+02
   2.68617966e+04   1.31780225e+04   2.34745199e+04   4.64617966e+04
   8.63660123e+03   3.43037407e+03   1.30313762e+04   2.59548352e+04
   2.70140821e+03   2.84639145e+03   7.50390465e+03   2.07206635e+04
  -1.05234221e-07   4.21038028e+03   1.04923970e+04   1.87991579e+04
   3.27603718e+04   1.63457666e+04   2.14350398e+04   4.50857437e+04
   1.24662765e+04   4.07422866e+03   1.02121736e+04   2.21354755e+04
   5.40176752e+03   1.86961717e+03   4.89953890e+03   1.56945955e+04
   1.80000547e+03   1.58257535e+03   6.16910077e+03   1.27232683e+04
   3.64484008e-03   3.69680241e+04   1.86697751e+04   1.81093242e+04
   4.09731847e+04   1.60066863e+04   5.02834434e+03   7.17446385e+03
   1.72349237e+04   8.57796070e+03   1.58144212e+03   2.69894067e+03
   1.04048673e+04   4.68582482e+03   5.36352597e-03   2.54535148e+03
   7.09496118e+03   2.59556270e+03   6.38669398e+00   5.17337136e+04
   2.97830834e+04   1.46270718e+04   3.37636452e+04   3.08228141e+04
   1.41417947e+04   5.71166001e+03   1.00849503e+04   2.34216205e+04
   8.06595991e+03   4.07808760e+03   3.28431259e+03   1.95514346e+04
   3.69948071e+03   7.44869580e+02   4.14637659e-04   1.74831138e+04
   1.08268061e+04   5.25970884e+03   3.77589434e+04   2.10560242e+04
   3.06074465e+04   5.73589434e+04   1.53959481e+04   7.61446498e+03
   1.72910196e+04   3.19653684e+04   7.20212319e+03   5.54179039e+03
   1.03232602e+04   2.43177801e+04   2.70000729e+03   5.45929946e+03
   1.19897148e+04   2.02966312e+04   3.64496695e-03   3.64487471e-03
   2.30530182e+03   1.72147944e+04   4.53302916e+04   2.52998342e+04
   2.72119415e+04   5.39891704e+04   2.09241908e+04   9.01623069e+03
   1.34647984e+04   2.61827510e+04   1.16151299e+04   4.89055128e+03
   7.19209499e+03   1.73434994e+04   6.22388558e+03   2.69843004e+03
   6.61466143e+03   1.22856177e+04   2.63510110e+03   1.60286627e+02
   7.67843590e-03   8.78682292e+03   8.46314826e+02   5.51602181e+04
   3.19661108e+04   2.39302970e+04   4.91084322e+04   2.98029275e+04
   1.34644700e+04   1.08510627e+04   2.01786871e+04   1.99746564e+04
   7.22456425e+03   6.13797539e+03   1.07846437e+04   1.41694687e+04
   2.82376164e+03   3.11733827e+03   5.24409987e+03   1.01669027e+04
   4.75523239e+03   1.40588598e+03   1.95105567e+03   7.96433407e+03
   1.90781047e+03   5.91982463e+04   3.51397710e+04   2.17356036e+04
   4.48741180e+04   3.45596375e+04   1.65099388e+04   9.90243663e+03
   1.67931138e+04   2.51236613e+04   9.53213440e+03   6.50272184e+03
   7.81824933e+03   1.96312330e+04   4.32752925e+03   2.50870137e+03
   2.64238611e+03   1.59413041e+04   9.15079412e+03   4.09605515e+03
   1.02721614e-04   1.40513732e+04   5.84032411e+03   3.23076019e-03
   5.01781307e+04   3.02228580e+04   3.78419169e+04   6.79652324e+04
   2.37748338e+04   1.30057294e+04   2.18836193e+04   3.78001861e+04
   1.33755966e+04   9.26106354e+03   1.37425142e+04   2.77960481e+04
   7.11520280e+03   7.53496274e+03   1.38544416e+04   2.17247294e+04
   2.65760868e+03   1.44237897e+03   3.07946742e+03   1.69940871e+04
   1.10024370e-02   3.72486936e+02   6.40614360e+03   1.24158795e+04
   6.24899138e+04   3.92461939e+04   4.31010990e+04   7.55389199e+04
   3.26698828e+04   1.85379677e+04   2.51980887e+04   4.13388166e+04
   2.04056100e+04   1.29932953e+04   1.64766544e+04   2.93418315e+04
   1.26583054e+04   9.46849609e+03   1.48078898e+04   2.15367599e+04
   6.71438193e+03   3.87670330e+03   4.26845051e+03   1.55450469e+04
   2.57045185e+03   8.86576264e+02   4.80048274e+03   1.00684989e+04
   6.01535049e-03   6.21711984e+04   3.76641137e+04   3.27904840e+04
   6.17137575e+04   3.37272884e+04   1.69275525e+04   1.70627201e+04
   2.91388105e+04   2.22141759e+04   1.02510274e+04   1.05562201e+04
   1.79444629e+04   1.50657383e+04   5.48470458e+03   7.36295688e+03
   1.08376762e+04   9.72044761e+03   4.67559673e+03   2.29712962e+03
   5.99481493e+03   6.17515157e+03   1.01707359e+03   7.62319424e-04
   2.31378804e+03   3.56459609e+03   1.52638296e+03   6.96283059e+04
   4.32149825e+04   3.10198235e+04   5.81768410e+04   4.11013822e+04
   2.13812738e+04   1.62272059e+04   2.55038572e+04   2.95429563e+04
   1.33505704e+04   1.11048314e+04   1.42610910e+04   2.23583924e+04
   7.15307315e+03   6.28624091e+03   7.11218058e+03   1.69769895e+04
   9.87384172e+03   5.15606653e+03   2.69102377e+03   1.33955812e+04
   5.15112752e+03   3.23071723e-03   3.23073461e-03   1.02413192e+04
   6.84444152e+03   6.42053130e+02   7.17101257e+04   4.76763458e+04
   5.54186333e+04   9.13101257e+04   3.93000367e+04   2.52655113e+04
   3.51255169e+04   5.40512440e+04   2.56219721e+04   1.95781072e+04
   2.46605589e+04   4.05435796e+04   1.67475137e+04   1.59833832e+04
   2.31169413e+04   3.14242352e+04   9.67687700e+03   7.49155605e+03
   9.09206465e+03   2.40548338e+04   4.40623146e+03   3.99447136e+03
   1.01077755e+04   1.69539380e+04   1.03858523e+03   2.58989352e-02
   5.05828361e+03   1.21910281e+04   7.05898215e+04   4.48631964e+04
   4.32915797e+04   7.59141080e+04   3.91442361e+04   2.19849828e+04
   2.49573499e+04   3.97942751e+04   2.59926489e+04   1.49249709e+04
   1.66629211e+04   2.68491678e+04   1.75379277e+04   9.84672070e+03
   1.33514216e+04   1.82192413e+04   1.08868642e+04   6.26208264e+03
   4.90022550e+03   1.18550212e+04   6.03579268e+03   1.84670627e+03
   2.69918492e+03   6.45988132e+03   2.41761937e+03   1.53942333e-02
   5.27017533e-03   3.13740364e+03   1.74833918e+03   7.68972369e+04
   4.91709361e+04   4.01379611e+04   7.10401168e+04   4.52836938e+04
   2.51023070e+04   2.26968140e+04   3.47219312e+04   3.20404265e+04
   1.66349843e+04   1.57810268e+04   2.16788608e+04   2.35126127e+04
   1.00719668e+04   1.07898102e+04   1.29637076e+04   1.67884852e+04
   1.00521569e+04   6.30526096e+03   6.99273377e+03   1.18643495e+04
   4.51834148e+03   1.15795480e+03   2.57173881e+03   7.65772257e+03
   3.82829264e+03   3.21834392e-03   7.18988465e-04   7.39948714e+03
   6.96174884e+02   8.04994633e+04   5.19849007e+04   3.41933015e+04
   6.08994633e+04   5.09675784e+04   2.84957850e+04   1.94386754e+04
   2.70396516e+04   3.88605911e+04   1.91219666e+04   1.50137942e+04
   1.52107308e+04   3.12386833e+04   1.15339110e+04   8.68911667e+03
   7.55187308e+03   2.54201076e+04   1.65861903e+04   1.00683895e+04
   3.04066752e+03   2.14015255e+04   1.06668708e+04   2.35733230e+03
   7.13685276e+02   1.74435423e+04   1.27007625e+04   3.83617046e+03
   1.01319052e-02   1.91354602e+04   7.21623519e+03   1.73679910e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.75387310982 s
|dj| = 12422.3433225
Runtime: 5.74347710609 s
|dj| = 12422.3433225
   49    90    -3.106788E+04     2.775974E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.379e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.823e-04 (tol = 1.000e-10) r (rel) = 2.447e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 8.107e-09 (tol = 1.000e-10) r (rel) = 3.407e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.196e-13 (tol = 1.000e-10) r (rel) = 1.343e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 15.051508 s.
j = 1.390284e+06.
Runtime: 15.060738 s.
j = 1.390284e+06.
Minimum distance inequality constraints (should all be > 0): [  2.17955708e+03   1.66031039e+04   7.91239253e+03   1.87000000e+04
   1.52067451e+04   3.57399803e+03   3.85613535e+03   2.13818919e-03
   1.27198807e+04   2.34561354e+04   1.29466989e+04   3.06179670e+03
   7.92326433e+03   2.23183586e+04   2.27428064e+03   2.21418054e+04
   9.21451755e+03   1.56512283e+03   1.26469590e+04   1.16353829e+04
   3.64156385e+03   2.53137612e+04   1.36417580e+04   5.02527035e-04
   5.71376124e+03   1.88527769e+04   1.07383638e+04   1.26271076e+03
   1.04674555e+04   2.82455788e+03   1.46142637e+04   3.00674555e+04
   5.17788335e+02   4.61882969e+02   9.91361606e+03   1.93397478e+04
   2.06271554e+04   7.45589694e+03   8.56075044e+03   2.52685942e+04
   6.53529306e+03   1.28585676e-03   2.32463632e+03   9.65630107e+03
   2.85593933e+03   2.46053717e+04   1.01118360e+04   5.22354011e+03
   2.01558441e+04   1.07906055e+04   2.05557837e+03   1.00144633e-03
   4.87031006e+03   7.26254142e+03   1.58189917e+02   3.34802176e+04
   1.77604387e+04   3.12439424e+03   1.38802176e+04   2.14677257e+04
   9.90047876e+03   5.21703468e+02   7.19972650e+02   1.89236714e+04
   6.82277587e+03   2.19850245e+03   1.77645524e+04   7.10459520e+03
   1.81531969e+04   3.73645524e+04   3.67700046e+03   1.04748281e+03
   1.05714249e+04   2.17573422e+04   1.37466144e-04   1.95406414e+03
   6.48120443e+03   1.89263326e+04   3.00297635e+04   1.35939523e+04
   1.07909243e+04   2.96897875e+04   1.26061260e+04   2.69880663e+03
   2.68408620e+03   1.01485775e+04   7.10768189e+03   6.43988024e-03
   3.60028360e-04   5.37057702e+03   4.75646806e+03   3.49365722e+04
   1.72709738e+04   8.05018238e+03   2.47881914e+04   1.80818655e+04
   5.96912210e+03   1.22380175e+03   5.91787954e+03   1.28940476e+04
   2.29127012e+03   7.61336139e-05   1.47191586e+03   1.07903215e+04
   3.44116039e+02   4.32411674e+04   2.39932103e+04   8.49051155e+03
   2.36411674e+04   2.63897935e+04   1.18129398e+04   2.51860643e+03
   4.77478564e+03   2.12037952e+04   6.99576942e+03   2.51245453e+03
   3.30767018e+02   1.91015188e+04   3.84870014e+03   2.39453456e+02
   2.68616487e+04   1.31846323e+04   2.34921299e+04   4.64616487e+04
   8.63621240e+03   3.43308268e+03   1.30292338e+04   2.59749364e+04
   2.70000028e+03   2.85218908e+03   7.49986757e+03   2.07289938e+04
   2.51139909e-07   4.20525449e+03   1.04865956e+04   1.87992427e+04
   3.27601969e+04   1.63548889e+04   2.14563890e+04   4.50855835e+04
   1.24658184e+04   4.07773922e+03   1.02088076e+04   2.21591202e+04
   5.40000034e+03   1.87528856e+03   4.89616304e+03   1.57057111e+04
   1.80000000e+03   1.57924933e+03   6.16412117e+03   1.27234913e+04
   9.86716486e-08   3.69425090e+04   1.86641499e+04   1.81354769e+04
   4.09760563e+04   1.59860722e+04   5.02265203e+03   7.17450759e+03
   1.72688765e+04   8.55878210e+03   1.58163945e+03   2.69881953e+03
   1.04290800e+04   4.67078315e+03   5.88949754e-03   2.54973791e+03
   7.11007196e+03   2.58278457e+03   1.16887187e-02   5.17233362e+04
   2.97906456e+04   1.46491639e+04   3.37603302e+04   3.08134118e+04
   1.41394249e+04   5.70378237e+03   1.01079991e+04   2.34115166e+04
   8.06083258e+03   4.07538409e+03   3.29534795e+03   1.95437508e+04
   3.70023648e+03   7.43332015e+02   6.61018194e-04   1.74759853e+04
   1.08212775e+04   5.27164887e+03   3.77587450e+04   2.10646693e+04
   3.06310629e+04   5.73587450e+04   1.53954244e+04   7.61868255e+03
   1.72870426e+04   3.19925307e+04   7.20000041e+03   5.55031403e+03
   1.03185307e+04   2.43316551e+04   2.70000000e+03   5.45404092e+03
   1.19828697e+04   2.02969666e+04  -2.03555146e-07   1.86814759e-08
   2.29478599e+03   1.72082199e+04   4.53368495e+04   2.53173546e+04
   2.72477531e+04   5.40002188e+04   2.09277602e+04   9.02496279e+03
   1.34653493e+04   2.62215804e+04   1.16153828e+04   4.90147602e+03
   7.19294639e+03   1.73667628e+04   6.22546296e+03   2.69885725e+03
   6.61354127e+03   1.22913941e+04   2.63554361e+03   1.60998221e+02
   1.04918459e-02   8.78650429e+03   8.45624254e+02   5.51535673e+04
   3.19765661e+04   2.39565205e+04   4.91022135e+04   2.97978261e+04
   1.34667767e+04   1.08416570e+04   2.02072582e+04   1.99685935e+04
   7.22738073e+03   6.13390055e+03   1.07999600e+04   1.41668754e+04
   2.82328541e+03   3.11275311e+03   5.24303044e+03   1.01651578e+04
   4.75400100e+03   1.41457182e+03   1.94872530e+03   7.96344023e+03
   1.90887889e+03   5.91999801e+04   3.51580163e+04   2.17670411e+04
   4.48754211e+04   3.45604848e+04   1.65162110e+04   9.89679449e+03
   1.68250819e+04   2.51223097e+04   9.53597048e+03   6.50296686e+03
   7.83579571e+03   1.96321621e+04   4.33141464e+03   2.50796841e+03
   2.64321969e+03   1.59420150e+04   9.15132789e+03   4.11174753e+03
   8.82330226e-04   1.40518679e+04   5.84315838e+03   3.25284650e-04
   5.01737369e+04   3.02285684e+04   3.78578003e+04   6.79476841e+04
   2.37714821e+04   1.30062050e+04   2.18661893e+04   3.78186524e+04
   1.33708714e+04   9.26558412e+03   1.37279722e+04   2.78005926e+04
   7.11391466e+03   7.52258172e+03   1.38360752e+04   2.17113027e+04
   2.65695849e+03   1.43960723e+03   3.06702305e+03   1.69755412e+04
   2.31908200e-03   3.67527230e+02   6.39793676e+03   1.24050937e+04
   6.24763097e+04   3.92461469e+04   4.31081692e+04   7.55025063e+04
   3.26605098e+04   1.85333167e+04   2.51678323e+04   4.13481326e+04
   2.03961639e+04   1.29926985e+04   1.64534622e+04   2.93378754e+04
   1.26542982e+04   9.45073578e+03   1.47804385e+04   2.15121188e+04
   6.71243325e+03   3.87155489e+03   4.25711136e+03   1.55181844e+04
   2.57056827e+03   8.79352910e+02   4.78786011e+03   1.00500286e+04
   1.74981398e-03   6.21562948e+04   3.76685466e+04   3.28170180e+04
   6.17030258e+04   3.37155122e+04   1.69263720e+04   1.70493818e+04
   2.91701085e+04   2.22019013e+04   1.02534888e+04   1.05481424e+04
   1.79623325e+04   1.50581749e+04   5.48021178e+03   7.35491790e+03
   1.08360456e+04   9.71444917e+03   4.67116334e+03   2.30115724e+03
   5.99168576e+03   6.17072341e+03   1.01451517e+03   3.21169175e-04
   2.31377738e+03   3.55607899e+03   1.51693167e+03   6.96234297e+04
   4.32294029e+04   3.10547756e+04   5.81762763e+04   4.10963903e+04
   2.13849998e+04   1.62182857e+04   2.55416428e+04   2.95356848e+04
   1.33544894e+04   1.11020375e+04   1.42835261e+04   2.23544363e+04
   7.15393118e+03   6.28296805e+03   7.11336051e+03   1.69731884e+04
   9.87093089e+03   5.16942329e+03   2.69130311e+03   1.33919406e+04
   5.14993518e+03   3.25388654e-04   3.25344514e-04   1.02285434e+04
   6.82690604e+03   6.42042776e+02   7.16363455e+04   4.76301801e+04
   5.54004474e+04   9.12363455e+04   3.92445239e+04   2.52304229e+04
   3.50737874e+04   5.40442592e+04   2.55737155e+04   1.95570374e+04
   2.46173882e+04   4.05305960e+04   1.67112677e+04   1.59481739e+04
   2.30768093e+04   3.13944199e+04   9.64882059e+03   7.46759705e+03
   9.06439495e+03   2.40268654e+04   4.38637350e+03   3.97520549e+03
   1.00949948e+04   1.69385389e+04   1.02824897e+03   1.70780532e-02
   5.04981150e+03   1.21800908e+04   7.06138646e+04   4.48975261e+04
   4.33376931e+04   7.59238692e+04   3.91627307e+04   2.20050565e+04
   2.49543960e+04   3.98410665e+04   2.60055212e+04   1.49454687e+04
   1.66643897e+04   2.68764032e+04   1.75522771e+04   9.85016280e+03
   1.33469727e+04   1.82187539e+04   1.08990338e+04   6.27051947e+03
   4.91007677e+03   1.18493086e+04   6.04579046e+03   1.85008565e+03
   2.69937583e+03   6.45616897e+03   2.42141374e+03   5.91746183e-03
   8.23904108e-03   3.13109933e+03   1.75115572e+03   7.68841152e+04
   4.91793413e+04   4.01732310e+04   7.10350465e+04   4.52720342e+04
   2.51025530e+04   2.26839684e+04   3.47624509e+04   3.20269505e+04
   1.66385553e+04   1.57742372e+04   2.17038564e+04   2.35036937e+04
   1.00688154e+04   1.07830907e+04   1.29643336e+04   1.67804377e+04
   1.00460511e+04   6.31396658e+03   6.99222144e+03   1.18571816e+04
   4.51352933e+03   1.15795852e+03   2.57173525e+03   7.64464352e+03
   3.81393548e+03   3.25422131e-04   3.21163659e-04   7.39286531e+03
   6.89689605e+02   8.04670379e+04   5.19794831e+04   3.42071892e+04
   6.08670379e+04   5.09435938e+04   2.84851779e+04   1.94119811e+04
   2.70574178e+04   3.88388689e+04   1.91126877e+04   1.49985152e+04
   1.52177839e+04   3.12241794e+04   1.15270895e+04   8.67576186e+03
   7.54074828e+03   2.54094906e+04   1.65775328e+04   1.00821318e+04
   3.03402343e+03   2.13948018e+04   1.06638944e+04   2.35441866e+03
   7.08777337e+02   1.74285448e+04   1.26818997e+04   3.83759887e+03
   4.10593992e-03   1.91324724e+04   7.20997306e+03   1.74114218e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.17955708e+03   1.66031039e+04   7.91239253e+03   1.87000000e+04
   1.52067451e+04   3.57399803e+03   3.85613535e+03   2.13818919e-03
   1.27198807e+04   2.34561354e+04   1.29466989e+04   3.06179670e+03
   7.92326433e+03   2.23183586e+04   2.27428064e+03   2.21418054e+04
   9.21451755e+03   1.56512283e+03   1.26469590e+04   1.16353829e+04
   3.64156385e+03   2.53137612e+04   1.36417580e+04   5.02527035e-04
   5.71376124e+03   1.88527769e+04   1.07383638e+04   1.26271076e+03
   1.04674555e+04   2.82455788e+03   1.46142637e+04   3.00674555e+04
   5.17788335e+02   4.61882969e+02   9.91361606e+03   1.93397478e+04
   2.06271554e+04   7.45589694e+03   8.56075044e+03   2.52685942e+04
   6.53529306e+03   1.28585676e-03   2.32463632e+03   9.65630107e+03
   2.85593933e+03   2.46053717e+04   1.01118360e+04   5.22354011e+03
   2.01558441e+04   1.07906055e+04   2.05557837e+03   1.00144633e-03
   4.87031006e+03   7.26254142e+03   1.58189917e+02   3.34802176e+04
   1.77604387e+04   3.12439424e+03   1.38802176e+04   2.14677257e+04
   9.90047876e+03   5.21703468e+02   7.19972650e+02   1.89236714e+04
   6.82277587e+03   2.19850245e+03   1.77645524e+04   7.10459520e+03
   1.81531969e+04   3.73645524e+04   3.67700046e+03   1.04748281e+03
   1.05714249e+04   2.17573422e+04   1.37466144e-04   1.95406414e+03
   6.48120443e+03   1.89263326e+04   3.00297635e+04   1.35939523e+04
   1.07909243e+04   2.96897875e+04   1.26061260e+04   2.69880663e+03
   2.68408620e+03   1.01485775e+04   7.10768189e+03   6.43988024e-03
   3.60028360e-04   5.37057702e+03   4.75646806e+03   3.49365722e+04
   1.72709738e+04   8.05018238e+03   2.47881914e+04   1.80818655e+04
   5.96912210e+03   1.22380175e+03   5.91787954e+03   1.28940476e+04
   2.29127012e+03   7.61336139e-05   1.47191586e+03   1.07903215e+04
   3.44116039e+02   4.32411674e+04   2.39932103e+04   8.49051155e+03
   2.36411674e+04   2.63897935e+04   1.18129398e+04   2.51860643e+03
   4.77478564e+03   2.12037952e+04   6.99576942e+03   2.51245453e+03
   3.30767018e+02   1.91015188e+04   3.84870014e+03   2.39453456e+02
   2.68616487e+04   1.31846323e+04   2.34921299e+04   4.64616487e+04
   8.63621240e+03   3.43308268e+03   1.30292338e+04   2.59749364e+04
   2.70000028e+03   2.85218908e+03   7.49986757e+03   2.07289938e+04
   2.51139909e-07   4.20525449e+03   1.04865956e+04   1.87992427e+04
   3.27601969e+04   1.63548889e+04   2.14563890e+04   4.50855835e+04
   1.24658184e+04   4.07773922e+03   1.02088076e+04   2.21591202e+04
   5.40000034e+03   1.87528856e+03   4.89616304e+03   1.57057111e+04
   1.80000000e+03   1.57924933e+03   6.16412117e+03   1.27234913e+04
   9.86716486e-08   3.69425090e+04   1.86641499e+04   1.81354769e+04
   4.09760563e+04   1.59860722e+04   5.02265203e+03   7.17450759e+03
   1.72688765e+04   8.55878210e+03   1.58163945e+03   2.69881953e+03
   1.04290800e+04   4.67078315e+03   5.88949754e-03   2.54973791e+03
   7.11007196e+03   2.58278457e+03   1.16887187e-02   5.17233362e+04
   2.97906456e+04   1.46491639e+04   3.37603302e+04   3.08134118e+04
   1.41394249e+04   5.70378237e+03   1.01079991e+04   2.34115166e+04
   8.06083258e+03   4.07538409e+03   3.29534795e+03   1.95437508e+04
   3.70023648e+03   7.43332015e+02   6.61018194e-04   1.74759853e+04
   1.08212775e+04   5.27164887e+03   3.77587450e+04   2.10646693e+04
   3.06310629e+04   5.73587450e+04   1.53954244e+04   7.61868255e+03
   1.72870426e+04   3.19925307e+04   7.20000041e+03   5.55031403e+03
   1.03185307e+04   2.43316551e+04   2.70000000e+03   5.45404092e+03
   1.19828697e+04   2.02969666e+04  -2.03555146e-07   1.86814759e-08
   2.29478599e+03   1.72082199e+04   4.53368495e+04   2.53173546e+04
   2.72477531e+04   5.40002188e+04   2.09277602e+04   9.02496279e+03
   1.34653493e+04   2.62215804e+04   1.16153828e+04   4.90147602e+03
   7.19294639e+03   1.73667628e+04   6.22546296e+03   2.69885725e+03
   6.61354127e+03   1.22913941e+04   2.63554361e+03   1.60998221e+02
   1.04918459e-02   8.78650429e+03   8.45624254e+02   5.51535673e+04
   3.19765661e+04   2.39565205e+04   4.91022135e+04   2.97978261e+04
   1.34667767e+04   1.08416570e+04   2.02072582e+04   1.99685935e+04
   7.22738073e+03   6.13390055e+03   1.07999600e+04   1.41668754e+04
   2.82328541e+03   3.11275311e+03   5.24303044e+03   1.01651578e+04
   4.75400100e+03   1.41457182e+03   1.94872530e+03   7.96344023e+03
   1.90887889e+03   5.91999801e+04   3.51580163e+04   2.17670411e+04
   4.48754211e+04   3.45604848e+04   1.65162110e+04   9.89679449e+03
   1.68250819e+04   2.51223097e+04   9.53597048e+03   6.50296686e+03
   7.83579571e+03   1.96321621e+04   4.33141464e+03   2.50796841e+03
   2.64321969e+03   1.59420150e+04   9.15132789e+03   4.11174753e+03
   8.82330226e-04   1.40518679e+04   5.84315838e+03   3.25284650e-04
   5.01737369e+04   3.02285684e+04   3.78578003e+04   6.79476841e+04
   2.37714821e+04   1.30062050e+04   2.18661893e+04   3.78186524e+04
   1.33708714e+04   9.26558412e+03   1.37279722e+04   2.78005926e+04
   7.11391466e+03   7.52258172e+03   1.38360752e+04   2.17113027e+04
   2.65695849e+03   1.43960723e+03   3.06702305e+03   1.69755412e+04
   2.31908200e-03   3.67527230e+02   6.39793676e+03   1.24050937e+04
   6.24763097e+04   3.92461469e+04   4.31081692e+04   7.55025063e+04
   3.26605098e+04   1.85333167e+04   2.51678323e+04   4.13481326e+04
   2.03961639e+04   1.29926985e+04   1.64534622e+04   2.93378754e+04
   1.26542982e+04   9.45073578e+03   1.47804385e+04   2.15121188e+04
   6.71243325e+03   3.87155489e+03   4.25711136e+03   1.55181844e+04
   2.57056827e+03   8.79352910e+02   4.78786011e+03   1.00500286e+04
   1.74981398e-03   6.21562948e+04   3.76685466e+04   3.28170180e+04
   6.17030258e+04   3.37155122e+04   1.69263720e+04   1.70493818e+04
   2.91701085e+04   2.22019013e+04   1.02534888e+04   1.05481424e+04
   1.79623325e+04   1.50581749e+04   5.48021178e+03   7.35491790e+03
   1.08360456e+04   9.71444917e+03   4.67116334e+03   2.30115724e+03
   5.99168576e+03   6.17072341e+03   1.01451517e+03   3.21169175e-04
   2.31377738e+03   3.55607899e+03   1.51693167e+03   6.96234297e+04
   4.32294029e+04   3.10547756e+04   5.81762763e+04   4.10963903e+04
   2.13849998e+04   1.62182857e+04   2.55416428e+04   2.95356848e+04
   1.33544894e+04   1.11020375e+04   1.42835261e+04   2.23544363e+04
   7.15393118e+03   6.28296805e+03   7.11336051e+03   1.69731884e+04
   9.87093089e+03   5.16942329e+03   2.69130311e+03   1.33919406e+04
   5.14993518e+03   3.25388654e-04   3.25344514e-04   1.02285434e+04
   6.82690604e+03   6.42042776e+02   7.16363455e+04   4.76301801e+04
   5.54004474e+04   9.12363455e+04   3.92445239e+04   2.52304229e+04
   3.50737874e+04   5.40442592e+04   2.55737155e+04   1.95570374e+04
   2.46173882e+04   4.05305960e+04   1.67112677e+04   1.59481739e+04
   2.30768093e+04   3.13944199e+04   9.64882059e+03   7.46759705e+03
   9.06439495e+03   2.40268654e+04   4.38637350e+03   3.97520549e+03
   1.00949948e+04   1.69385389e+04   1.02824897e+03   1.70780532e-02
   5.04981150e+03   1.21800908e+04   7.06138646e+04   4.48975261e+04
   4.33376931e+04   7.59238692e+04   3.91627307e+04   2.20050565e+04
   2.49543960e+04   3.98410665e+04   2.60055212e+04   1.49454687e+04
   1.66643897e+04   2.68764032e+04   1.75522771e+04   9.85016280e+03
   1.33469727e+04   1.82187539e+04   1.08990338e+04   6.27051947e+03
   4.91007677e+03   1.18493086e+04   6.04579046e+03   1.85008565e+03
   2.69937583e+03   6.45616897e+03   2.42141374e+03   5.91746183e-03
   8.23904108e-03   3.13109933e+03   1.75115572e+03   7.68841152e+04
   4.91793413e+04   4.01732310e+04   7.10350465e+04   4.52720342e+04
   2.51025530e+04   2.26839684e+04   3.47624509e+04   3.20269505e+04
   1.66385553e+04   1.57742372e+04   2.17038564e+04   2.35036937e+04
   1.00688154e+04   1.07830907e+04   1.29643336e+04   1.67804377e+04
   1.00460511e+04   6.31396658e+03   6.99222144e+03   1.18571816e+04
   4.51352933e+03   1.15795852e+03   2.57173525e+03   7.64464352e+03
   3.81393548e+03   3.25422131e-04   3.21163659e-04   7.39286531e+03
   6.89689605e+02   8.04670379e+04   5.19794831e+04   3.42071892e+04
   6.08670379e+04   5.09435938e+04   2.84851779e+04   1.94119811e+04
   2.70574178e+04   3.88388689e+04   1.91126877e+04   1.49985152e+04
   1.52177839e+04   3.12241794e+04   1.15270895e+04   8.67576186e+03
   7.54074828e+03   2.54094906e+04   1.65775328e+04   1.00821318e+04
   3.03402343e+03   2.13948018e+04   1.06638944e+04   2.35441866e+03
   7.08777337e+02   1.74285448e+04   1.26818997e+04   3.83759887e+03
   4.10593992e-03   1.91324724e+04   7.20997306e+03   1.74114218e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.36916399002 s
|dj| = 12422.6483503
Runtime: 5.37707400322 s
|dj| = 12422.6483503
   50    91    -3.106816E+04     2.776042E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.071e-01 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.586e-04 (tol = 1.000e-10) r (rel) = 2.214e-03 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 5.041e-09 (tol = 1.000e-10) r (rel) = 2.434e-08 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.152e-13 (tol = 1.000e-10) r (rel) = 1.522e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 18.465219 s.
j = 1.390286e+06.
End of time loop.
Runtime: 18.453742 s.
j = 1.390286e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19302744e+03   1.65971040e+04   7.90140286e+03   1.87000000e+04
   1.52104184e+04   3.56883586e+03   3.86626923e+03   3.16256848e-03
   1.27206622e+04   2.34662692e+04   1.29516826e+04   3.04949753e+03
   7.93358730e+03   2.23298052e+04   2.26885434e+03   2.21468539e+04
   9.19784292e+03   1.57040640e+03   1.26498206e+04   1.16321771e+04
   3.64576256e+03   2.53062630e+04   1.36234768e+04   2.30186723e-05
   5.70626299e+03   1.88498359e+04   1.07477829e+04   1.26576369e+03
   1.04255352e+04   2.79089687e+03   1.46000059e+04   3.00255352e+04
   4.97513043e+02   4.62623060e+02   9.91699783e+03   1.93321492e+04
   2.06330126e+04   7.43741809e+03   8.57449018e+03   2.52815575e+04
   6.52688684e+03   7.44714714e-06   2.32881404e+03   9.66927313e+03
   2.86698181e+03   2.46093767e+04   1.00902380e+04   5.23101673e+03
   2.01587840e+04   1.07832520e+04   2.05744250e+03   2.51059339e-05
   4.87614607e+03   7.27496417e+03   1.60162067e+02   3.34891388e+04
   1.77407755e+04   3.13385639e+03   1.38891388e+04   2.14638605e+04
   9.90538951e+03   5.21603384e+02   7.26644594e+02   1.89307089e+04
   6.82701004e+03   2.19745795e+03   1.77617599e+04   7.08420945e+03
   1.81572536e+04   3.73617599e+04   3.66568868e+03   1.04381640e+03
   1.05717145e+04   2.17613128e+04   1.12280577e+01   1.95135746e+03
   6.48176876e+03   1.89249235e+04   3.00336296e+04   1.35673136e+04
   1.08010262e+04   2.96931750e+04   1.25949541e+04   2.69871192e+03
   2.68406269e+03   1.01574663e+04   7.13051426e+03   1.13700505e-03
   5.69057352e-06   5.36834791e+03   4.75775124e+03   3.49422144e+04
   1.72438518e+04   8.06271120e+03   2.47961692e+04   1.80713640e+04
   5.97062640e+03   1.22447997e+03   5.92896320e+03   1.29143943e+04
   2.29276233e+03   2.73254813e-04   1.47156471e+03   1.07899096e+04
   3.43309874e+02   4.32498203e+04   2.39659516e+04   8.50381183e+03
   2.36498203e+04   2.63817600e+04   1.18175204e+04   2.51915970e+03
   4.78589921e+03   2.12263013e+04   7.00001515e+03   2.51271105e+03
   3.30130724e+02   1.91030366e+04   3.84832957e+03   2.40016495e+02
   2.68582431e+04   1.31565858e+04   2.34981140e+04   4.64582431e+04
   8.61988148e+03   3.42701457e+03   1.30279815e+04   2.59810607e+04
   2.72242131e+03   2.84698835e+03   7.49907195e+03   2.07247704e+04
   2.59117314e-07   4.20524864e+03   1.04841510e+04   1.87984903e+04
   3.27564847e+04   1.63211940e+04   2.14634922e+04   4.50818713e+04
   1.24469779e+04   4.07166961e+03   1.02063787e+04   2.21663212e+04
   5.42801794e+03   1.87015952e+03   4.89448979e+03   1.57000805e+04
   1.80000000e+03   1.57851014e+03   6.16109358e+03   1.27216038e+04
   1.00118200e-07   3.69529565e+04   1.86372256e+04   1.81486756e+04
   4.09809804e+04   1.59762189e+04   5.02314217e+03   7.17436547e+03
   1.72798967e+04   8.59596161e+03   1.58092057e+03   2.69885859e+03
   1.04238638e+04   4.67620071e+03   4.42800556e-04   2.54680480e+03
   7.10641615e+03   2.58626074e+03   1.49211831e+00   5.17355512e+04
   2.97600666e+04   1.46670217e+04   3.37709573e+04   3.08044649e+04
   1.41448798e+04   5.70565263e+03   1.01236192e+04   2.34489273e+04
   8.06558821e+03   4.07724004e+03   3.29425553e+03   1.95491273e+04
   3.70161853e+03   7.44412598e+02   3.32511620e-05   1.74790247e+04
   1.08228536e+04   5.26943629e+03   3.77547262e+04   2.10289622e+04
   3.06389744e+04   5.73547262e+04   1.53740743e+04   7.61021273e+03
   1.72842486e+04   3.20008085e+04   7.23361457e+03   5.54261923e+03
   1.03163752e+04   2.43246174e+04   2.70000000e+03   5.45274603e+03
   1.19783923e+04   2.02939441e+04  -2.06348432e-07   2.68244094e-08
   2.29632076e+03   1.72089222e+04   4.53667873e+04   2.52991435e+04
   2.72656046e+04   5.40096604e+04   2.09288726e+04   9.03092579e+03
   1.34652952e+04   2.62337189e+04   1.16744302e+04   4.90252937e+03
   7.19333601e+03   1.73556872e+04   6.24128901e+03   2.69892479e+03
   6.60627166e+03   1.22798700e+04   2.64732148e+03   1.66948374e+02
   4.09257050e-03   8.77511334e+03   8.53353946e+02   5.51548399e+04
   3.19332534e+04   2.39679608e+04   4.90996025e+04   2.97775713e+04
   1.34638846e+04   1.08375503e+04   2.02177559e+04   2.00144804e+04
   7.22478655e+03   6.13144702e+03   1.07909594e+04   1.41706119e+04
   2.82215209e+03   3.10882964e+03   5.23792558e+03   1.01684555e+04
   4.75635862e+03   1.41255309e+03   1.94598935e+03   7.96629912e+03
   1.90182430e+03   5.92203110e+04   3.51286785e+04   2.17908253e+04
   4.48899589e+04   3.45546883e+04   1.65248619e+04   9.90143141e+03
   1.68459359e+04   2.51769449e+04   9.54291476e+03   6.50784519e+03
   7.83487864e+03   1.96442397e+04   4.33589264e+03   2.51022070e+03
   2.64337975e+03   1.59513235e+04   9.15817674e+03   4.11261076e+03
   2.77414760e-04   1.40584072e+04   5.83446812e+03   1.55465170e-03
   5.01645458e+04   3.01790786e+04   3.78523826e+04   6.79239173e+04
   2.37422653e+04   1.29899206e+04   2.18489705e+04   3.78117740e+04
   1.34133132e+04   9.24883282e+03   1.37140560e+04   2.77744879e+04
   7.11251921e+03   7.51175973e+03   1.38177342e+04   2.16905604e+04
   2.65626103e+03   1.43655387e+03   3.06037943e+03   1.69596772e+04
   2.84533049e-03   3.66623798e+02   6.39115256e+03   1.23964296e+04
   6.24815163e+04   3.92030367e+04   4.31261736e+04   7.55061076e+04
   3.26376789e+04   1.85270254e+04   2.51665909e+04   4.13657513e+04
   2.04559955e+04   1.29859349e+04   1.64526190e+04   2.93296124e+04
   1.26591449e+04   9.45009739e+03   1.47755135e+04   2.15074433e+04
   6.71607574e+03   3.87429740e+03   4.25643207e+03   1.55157327e+04
   2.57300662e+03   8.77746081e+02   4.78979397e+03   1.00509938e+04
   3.15101084e-03   6.21481192e+04   3.76140257e+04   3.28260547e+04
   6.16952435e+04   3.36844104e+04   1.69159475e+04   1.70416452e+04
   2.91797183e+04   2.22500499e+04   1.02443949e+04   1.05421390e+04
   1.79498422e+04   1.50566528e+04   5.47576407e+03   7.34768111e+03
   1.08288150e+04   9.71330784e+03   4.67028542e+03   2.29628168e+03
   5.98762644e+03   6.16996290e+03   1.00535261e+03   4.20124797e-04
   2.31307610e+03   3.54927784e+03   1.51677182e+03   6.96306234e+04
   4.31841298e+04   3.10780731e+04   5.81880493e+04   4.10751830e+04
   2.13840873e+04   1.62197636e+04   2.55645281e+04   2.95911509e+04
   1.33536578e+04   1.11031581e+04   1.42810629e+04   2.23576446e+04
   7.15429454e+03   6.28268385e+03   7.11343358e+03   1.69744384e+04
   9.87205145e+03   5.16546586e+03   2.69163168e+03   1.33912321e+04
   5.13500031e+03   1.55476133e-03   1.55472856e-03   1.02156353e+04
   6.82281057e+03   6.40919304e+02   7.16375222e+04   4.75813378e+04
   5.54181588e+04   9.12375222e+04   3.92159783e+04   2.52200381e+04
   3.50711928e+04   5.40624216e+04   2.56384985e+04   1.95465887e+04
   2.46152777e+04   4.05204022e+04   1.67145602e+04   1.59464469e+04
   2.30701992e+04   3.13886900e+04   9.65136882e+03   7.46977314e+03
   9.06328080e+03   2.40239682e+04   4.38817746e+03   3.97455840e+03
   1.00980557e+04   1.69397605e+04   1.03101889e+03   9.18228579e-05
   5.05068490e+03   1.21753306e+04   7.06127740e+04   4.48445550e+04
   4.33509484e+04   7.59194916e+04   3.91338231e+04   2.19957745e+04
   2.49479567e+04   3.98541096e+04   2.60667458e+04   1.49363061e+04
   1.66595392e+04   2.68627473e+04   1.75549510e+04   9.84658052e+03
   1.33388263e+04   1.82098972e+04   1.09013560e+04   6.27205593e+03
   4.90611829e+03   1.18432432e+04   6.04776109e+03   1.84233007e+03
   2.69942027e+03   6.45344641e+03   2.41910703e+03   2.38065850e-04
   3.21937311e-04   3.12660274e+03   1.75244339e+03   7.68829854e+04
   4.91239847e+04   4.01952496e+04   7.10427730e+04   4.52411048e+04
   2.50952328e+04   2.26829411e+04   3.47855732e+04   3.20858030e+04
   1.66323488e+04   1.57729327e+04   2.16990283e+04   2.35027681e+04
   1.00669892e+04   1.07806180e+04   1.29634057e+04   1.67783733e+04
   1.00450609e+04   6.30827712e+03   6.99235144e+03   1.18539786e+04
   4.49761129e+03   1.15908465e+03   2.57215877e+03   7.63284326e+03
   3.80887109e+03   1.55477346e-03   4.20115504e-04   7.38704244e+03
   6.86265463e+02   8.04452762e+04   5.19074245e+04   3.42067936e+04
   6.08452762e+04   5.09015113e+04   2.84698443e+04   1.93950797e+04
   2.70581965e+04   3.88823136e+04   1.91002768e+04   1.49852987e+04
   1.51973582e+04   3.12166680e+04   1.15171992e+04   8.66394016e+03
   7.52763386e+03   2.54039931e+04   1.65730422e+04   1.00706175e+04
   3.02490540e+03   2.13913181e+04   1.06416394e+04   2.35060786e+03
   7.02359106e+02   1.74136588e+04   1.26807939e+04   3.83736447e+03
   4.65065973e-03   1.91343865e+04   7.20898803e+03   1.74584393e+03]
Start evaluation of j
Updating the turbine cache
Minimum distance inequality constraints (should all be > 0): [  2.19302744e+03   1.65971040e+04   7.90140286e+03   1.87000000e+04
   1.52104184e+04   3.56883586e+03   3.86626923e+03   3.16256848e-03
   1.27206622e+04   2.34662692e+04   1.29516826e+04   3.04949753e+03
   7.93358730e+03   2.23298052e+04   2.26885434e+03   2.21468539e+04
   9.19784292e+03   1.57040640e+03   1.26498206e+04   1.16321771e+04
   3.64576256e+03   2.53062630e+04   1.36234768e+04   2.30186723e-05
   5.70626299e+03   1.88498359e+04   1.07477829e+04   1.26576369e+03
   1.04255352e+04   2.79089687e+03   1.46000059e+04   3.00255352e+04
   4.97513043e+02   4.62623060e+02   9.91699783e+03   1.93321492e+04
   2.06330126e+04   7.43741809e+03   8.57449018e+03   2.52815575e+04
   6.52688684e+03   7.44714714e-06   2.32881404e+03   9.66927313e+03
   2.86698181e+03   2.46093767e+04   1.00902380e+04   5.23101673e+03
   2.01587840e+04   1.07832520e+04   2.05744250e+03   2.51059339e-05
   4.87614607e+03   7.27496417e+03   1.60162067e+02   3.34891388e+04
   1.77407755e+04   3.13385639e+03   1.38891388e+04   2.14638605e+04
   9.90538951e+03   5.21603384e+02   7.26644594e+02   1.89307089e+04
   6.82701004e+03   2.19745795e+03   1.77617599e+04   7.08420945e+03
   1.81572536e+04   3.73617599e+04   3.66568868e+03   1.04381640e+03
   1.05717145e+04   2.17613128e+04   1.12280577e+01   1.95135746e+03
   6.48176876e+03   1.89249235e+04   3.00336296e+04   1.35673136e+04
   1.08010262e+04   2.96931750e+04   1.25949541e+04   2.69871192e+03
   2.68406269e+03   1.01574663e+04   7.13051426e+03   1.13700505e-03
   5.69057352e-06   5.36834791e+03   4.75775124e+03   3.49422144e+04
   1.72438518e+04   8.06271120e+03   2.47961692e+04   1.80713640e+04
   5.97062640e+03   1.22447997e+03   5.92896320e+03   1.29143943e+04
   2.29276233e+03   2.73254813e-04   1.47156471e+03   1.07899096e+04
   3.43309874e+02   4.32498203e+04   2.39659516e+04   8.50381183e+03
   2.36498203e+04   2.63817600e+04   1.18175204e+04   2.51915970e+03
   4.78589921e+03   2.12263013e+04   7.00001515e+03   2.51271105e+03
   3.30130724e+02   1.91030366e+04   3.84832957e+03   2.40016495e+02
   2.68582431e+04   1.31565858e+04   2.34981140e+04   4.64582431e+04
   8.61988148e+03   3.42701457e+03   1.30279815e+04   2.59810607e+04
   2.72242131e+03   2.84698835e+03   7.49907195e+03   2.07247704e+04
   2.59117314e-07   4.20524864e+03   1.04841510e+04   1.87984903e+04
   3.27564847e+04   1.63211940e+04   2.14634922e+04   4.50818713e+04
   1.24469779e+04   4.07166961e+03   1.02063787e+04   2.21663212e+04
   5.42801794e+03   1.87015952e+03   4.89448979e+03   1.57000805e+04
   1.80000000e+03   1.57851014e+03   6.16109358e+03   1.27216038e+04
   1.00118200e-07   3.69529565e+04   1.86372256e+04   1.81486756e+04
   4.09809804e+04   1.59762189e+04   5.02314217e+03   7.17436547e+03
   1.72798967e+04   8.59596161e+03   1.58092057e+03   2.69885859e+03
   1.04238638e+04   4.67620071e+03   4.42800556e-04   2.54680480e+03
   7.10641615e+03   2.58626074e+03   1.49211831e+00   5.17355512e+04
   2.97600666e+04   1.46670217e+04   3.37709573e+04   3.08044649e+04
   1.41448798e+04   5.70565263e+03   1.01236192e+04   2.34489273e+04
   8.06558821e+03   4.07724004e+03   3.29425553e+03   1.95491273e+04
   3.70161853e+03   7.44412598e+02   3.32511620e-05   1.74790247e+04
   1.08228536e+04   5.26943629e+03   3.77547262e+04   2.10289622e+04
   3.06389744e+04   5.73547262e+04   1.53740743e+04   7.61021273e+03
   1.72842486e+04   3.20008085e+04   7.23361457e+03   5.54261923e+03
   1.03163752e+04   2.43246174e+04   2.70000000e+03   5.45274603e+03
   1.19783923e+04   2.02939441e+04  -2.06348432e-07   2.68244094e-08
   2.29632076e+03   1.72089222e+04   4.53667873e+04   2.52991435e+04
   2.72656046e+04   5.40096604e+04   2.09288726e+04   9.03092579e+03
   1.34652952e+04   2.62337189e+04   1.16744302e+04   4.90252937e+03
   7.19333601e+03   1.73556872e+04   6.24128901e+03   2.69892479e+03
   6.60627166e+03   1.22798700e+04   2.64732148e+03   1.66948374e+02
   4.09257050e-03   8.77511334e+03   8.53353946e+02   5.51548399e+04
   3.19332534e+04   2.39679608e+04   4.90996025e+04   2.97775713e+04
   1.34638846e+04   1.08375503e+04   2.02177559e+04   2.00144804e+04
   7.22478655e+03   6.13144702e+03   1.07909594e+04   1.41706119e+04
   2.82215209e+03   3.10882964e+03   5.23792558e+03   1.01684555e+04
   4.75635862e+03   1.41255309e+03   1.94598935e+03   7.96629912e+03
   1.90182430e+03   5.92203110e+04   3.51286785e+04   2.17908253e+04
   4.48899589e+04   3.45546883e+04   1.65248619e+04   9.90143141e+03
   1.68459359e+04   2.51769449e+04   9.54291476e+03   6.50784519e+03
   7.83487864e+03   1.96442397e+04   4.33589264e+03   2.51022070e+03
   2.64337975e+03   1.59513235e+04   9.15817674e+03   4.11261076e+03
   2.77414760e-04   1.40584072e+04   5.83446812e+03   1.55465170e-03
   5.01645458e+04   3.01790786e+04   3.78523826e+04   6.79239173e+04
   2.37422653e+04   1.29899206e+04   2.18489705e+04   3.78117740e+04
   1.34133132e+04   9.24883282e+03   1.37140560e+04   2.77744879e+04
   7.11251921e+03   7.51175973e+03   1.38177342e+04   2.16905604e+04
   2.65626103e+03   1.43655387e+03   3.06037943e+03   1.69596772e+04
   2.84533049e-03   3.66623798e+02   6.39115256e+03   1.23964296e+04
   6.24815163e+04   3.92030367e+04   4.31261736e+04   7.55061076e+04
   3.26376789e+04   1.85270254e+04   2.51665909e+04   4.13657513e+04
   2.04559955e+04   1.29859349e+04   1.64526190e+04   2.93296124e+04
   1.26591449e+04   9.45009739e+03   1.47755135e+04   2.15074433e+04
   6.71607574e+03   3.87429740e+03   4.25643207e+03   1.55157327e+04
   2.57300662e+03   8.77746081e+02   4.78979397e+03   1.00509938e+04
   3.15101084e-03   6.21481192e+04   3.76140257e+04   3.28260547e+04
   6.16952435e+04   3.36844104e+04   1.69159475e+04   1.70416452e+04
   2.91797183e+04   2.22500499e+04   1.02443949e+04   1.05421390e+04
   1.79498422e+04   1.50566528e+04   5.47576407e+03   7.34768111e+03
   1.08288150e+04   9.71330784e+03   4.67028542e+03   2.29628168e+03
   5.98762644e+03   6.16996290e+03   1.00535261e+03   4.20124797e-04
   2.31307610e+03   3.54927784e+03   1.51677182e+03   6.96306234e+04
   4.31841298e+04   3.10780731e+04   5.81880493e+04   4.10751830e+04
   2.13840873e+04   1.62197636e+04   2.55645281e+04   2.95911509e+04
   1.33536578e+04   1.11031581e+04   1.42810629e+04   2.23576446e+04
   7.15429454e+03   6.28268385e+03   7.11343358e+03   1.69744384e+04
   9.87205145e+03   5.16546586e+03   2.69163168e+03   1.33912321e+04
   5.13500031e+03   1.55476133e-03   1.55472856e-03   1.02156353e+04
   6.82281057e+03   6.40919304e+02   7.16375222e+04   4.75813378e+04
   5.54181588e+04   9.12375222e+04   3.92159783e+04   2.52200381e+04
   3.50711928e+04   5.40624216e+04   2.56384985e+04   1.95465887e+04
   2.46152777e+04   4.05204022e+04   1.67145602e+04   1.59464469e+04
   2.30701992e+04   3.13886900e+04   9.65136882e+03   7.46977314e+03
   9.06328080e+03   2.40239682e+04   4.38817746e+03   3.97455840e+03
   1.00980557e+04   1.69397605e+04   1.03101889e+03   9.18228579e-05
   5.05068490e+03   1.21753306e+04   7.06127740e+04   4.48445550e+04
   4.33509484e+04   7.59194916e+04   3.91338231e+04   2.19957745e+04
   2.49479567e+04   3.98541096e+04   2.60667458e+04   1.49363061e+04
   1.66595392e+04   2.68627473e+04   1.75549510e+04   9.84658052e+03
   1.33388263e+04   1.82098972e+04   1.09013560e+04   6.27205593e+03
   4.90611829e+03   1.18432432e+04   6.04776109e+03   1.84233007e+03
   2.69942027e+03   6.45344641e+03   2.41910703e+03   2.38065850e-04
   3.21937311e-04   3.12660274e+03   1.75244339e+03   7.68829854e+04
   4.91239847e+04   4.01952496e+04   7.10427730e+04   4.52411048e+04
   2.50952328e+04   2.26829411e+04   3.47855732e+04   3.20858030e+04
   1.66323488e+04   1.57729327e+04   2.16990283e+04   2.35027681e+04
   1.00669892e+04   1.07806180e+04   1.29634057e+04   1.67783733e+04
   1.00450609e+04   6.30827712e+03   6.99235144e+03   1.18539786e+04
   4.49761129e+03   1.15908465e+03   2.57215877e+03   7.63284326e+03
   3.80887109e+03   1.55477346e-03   4.20115504e-04   7.38704244e+03
   6.86265463e+02   8.04452762e+04   5.19074245e+04   3.42067936e+04
   6.08452762e+04   5.09015113e+04   2.84698443e+04   1.93950797e+04
   2.70581965e+04   3.88823136e+04   1.91002768e+04   1.49852987e+04
   1.51973582e+04   3.12166680e+04   1.15171992e+04   8.66394016e+03
   7.52763386e+03   2.54039931e+04   1.65730422e+04   1.00706175e+04
   3.02490540e+03   2.13913181e+04   1.06416394e+04   2.35060786e+03
   7.02359106e+02   1.74136588e+04   1.26807939e+04   3.83736447e+03
   4.65065973e-03   1.91343865e+04   7.20898803e+03   1.74584393e+03]
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.277e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 9.104e-05 (tol = 1.000e-10) r (rel) = 9.814e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.013e-10 (tol = 1.000e-10) r (rel) = 2.170e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.127e-13 (tol = 1.000e-10) r (rel) = 3.371e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 18.681598 s.
j = 1.390288e+06.
Runtime: 18.677836 s.
j = 1.390288e+06.
Minimum distance inequality constraints (should all be > 0): [  2.18700711e+03   1.65997834e+04   7.90630479e+03   1.87000000e+04
   1.52087740e+04   3.57114113e+03   3.86174154e+03   1.92338258e-03
   1.27203098e+04   2.34617415e+04   1.29494563e+04   3.05498830e+03
   7.92897510e+03   2.23246922e+04   2.27127743e+03   2.21445989e+04
   9.20528799e+03   1.56804561e+03   1.26485423e+04   1.16336082e+04
   3.64388690e+03   2.53096116e+04   1.36316353e+04   2.31467585e-04
   5.70961160e+03   1.88511460e+04   1.07435742e+04   1.26439913e+03
   1.04442496e+04   2.80590706e+03   1.46063683e+04   3.00442496e+04
   5.06551080e+02   4.62279674e+02   9.91547619e+03   1.93355375e+04
   2.06303961e+04   7.44566905e+03   8.56835178e+03   2.52757670e+04
   6.53064093e+03   5.76566835e-04   2.32694770e+03   9.66347744e+03
   2.86203660e+03   2.46075878e+04   1.00998819e+04   5.22767650e+03
   2.01574708e+04   1.07865356e+04   2.05660962e+03   4.54956813e-04
   4.87353853e+03   7.26940465e+03   1.59280895e+02   3.34851538e+04
   1.77495563e+04   3.12962852e+03   1.38851538e+04   2.14655866e+04
   9.90319595e+03   5.21647961e+02   7.23662835e+02   1.89275521e+04
   6.82511866e+03   2.19792433e+03   1.77630072e+04   7.09331054e+03
   1.81554414e+04   3.73630072e+04   3.67073942e+03   1.04545350e+03
   1.05715850e+04   2.17595390e+04   6.20443777e+00   1.95256583e+03
   6.48151657e+03   1.89255523e+04   3.00319027e+04   1.35792089e+04
   1.07965134e+04   2.96916619e+04   1.25999432e+04   2.69875399e+03
   2.68407318e+03   1.01534953e+04   7.12030534e+03   3.22452015e-03
   1.62528140e-04   5.36934340e+03   4.75717799e+03   3.49396941e+04
   1.72559633e+04   8.05711404e+03   2.47926057e+04   1.80760539e+04
   5.96995443e+03   1.22417696e+03   5.92401140e+03   1.29052943e+04
   2.29209574e+03   1.17670260e-04   1.47172149e+03   1.07900933e+04
   3.43669890e+02   4.32459552e+04   2.39781246e+04   8.49786997e+03
   2.36459552e+04   2.63853477e+04   1.18154743e+04   2.51891253e+03
   4.78093392e+03   2.12162364e+04   6.99811861e+03   2.51259641e+03
   3.30414908e+02   1.91023583e+04   3.84849502e+03   2.39764989e+02
   2.68597642e+04   1.31691086e+04   2.34954409e+04   4.64597642e+04
   8.62717406e+03   3.42972440e+03   1.30285407e+04   2.59783249e+04
   2.71239822e+03   2.84931070e+03   7.49942719e+03   2.07266563e+04
   2.55553232e-07   4.20525114e+03   1.04852426e+04   1.87988260e+04
   3.27581427e+04   1.63362397e+04   2.14603193e+04   4.50835293e+04
   1.24553914e+04   4.07438011e+03   1.02074634e+04   2.21631045e+04
   5.41549511e+03   1.87244985e+03   4.89523703e+03   1.57025949e+04
   1.80000000e+03   1.57884019e+03   6.16244557e+03   1.27224465e+04
   9.94725724e-08   3.69482898e+04   1.86492492e+04   1.81427792e+04
   4.09787808e+04   1.59806192e+04   5.02292278e+03   7.17442890e+03
   1.72749732e+04   8.57934321e+03   1.58124114e+03   2.69884106e+03
   1.04261935e+04   4.67378057e+03   2.76614896e-03   2.54811469e+03
   7.10804894e+03   2.58470773e+03   8.30520533e-01   5.17300951e+04
   2.97737228e+04   1.46590442e+04   3.37662104e+04   3.08084606e+04
   1.41424431e+04   5.70481722e+03   1.01166410e+04   2.34322050e+04
   8.06346384e+03   4.07641100e+03   3.29474344e+03   1.95467254e+04
   3.70100115e+03   7.43929894e+02   3.05389877e-04   1.74776668e+04
   1.08221492e+04   5.27042449e+03   3.77565212e+04   2.10449066e+04
   3.06354404e+04   5.73565212e+04   1.53836087e+04   7.61399530e+03
   1.72854964e+04   3.19971109e+04   7.21859200e+03   5.54605557e+03
   1.03173378e+04   2.43277603e+04   2.70000000e+03   5.45332429e+03
   1.19803918e+04   2.02952938e+04  -2.05100150e-07   2.31873400e-08
   2.29563489e+03   1.72086081e+04   4.53534133e+04   2.53072763e+04
   2.72576273e+04   5.40054412e+04   2.09283744e+04   9.02825991e+03
   1.34653179e+04   2.62282932e+04   1.16480391e+04   4.90205632e+03
   7.19316030e+03   1.73606328e+04   6.23421776e+03   2.69889284e+03
   6.60951676e+03   1.22850157e+04   2.64205837e+03   1.64288253e+02
   5.93939183e-03   8.78019985e+03   8.49898983e+02   5.51542714e+04
   3.19525956e+04   2.39628505e+04   4.91007687e+04   2.97866168e+04
   1.34651758e+04   1.08393845e+04   2.02130665e+04   1.99939754e+04
   7.22594459e+03   6.13254282e+03   1.07949791e+04   1.41689429e+04
   2.82265821e+03   3.11058179e+03   5.24020542e+03   1.01669825e+04
   4.75530552e+03   1.41345461e+03   1.94721111e+03   7.96502212e+03
   1.90497351e+03   5.92112296e+04   3.51417807e+04   2.17802003e+04
   4.48834651e+04   3.45572769e+04   1.65209974e+04   9.89936016e+03
   1.68366195e+04   2.51525283e+04   9.53981252e+03   6.50566605e+03
   7.83528815e+03   1.96388445e+04   4.33389228e+03   2.50921446e+03
   2.64330814e+03   1.59471651e+04   9.15511703e+03   4.11222514e+03
   4.79039273e-04   1.40554858e+04   5.83834888e+03   6.21245951e-04
   5.01686503e+04   3.02011787e+04   3.78548016e+04   6.79345321e+04
   2.37553122e+04   1.29971921e+04   2.18566605e+04   3.78148455e+04
   1.33943481e+04   9.25631270e+03   1.37202709e+04   2.77861462e+04
   7.11314179e+03   7.51659254e+03   1.38259249e+04   2.16998238e+04
   2.65657185e+03   1.43791697e+03   3.06334610e+03   1.69667618e+04
   1.90709184e-03   3.67025665e+02   6.39418231e+03   1.24002984e+04
   6.24791907e+04   3.92222891e+04   4.31181311e+04   7.55044991e+04
   3.26478754e+04   1.85298351e+04   2.51671454e+04   4.13578810e+04
   2.04292608e+04   1.29889555e+04   1.64529956e+04   2.93333029e+04
   1.26569800e+04   9.45038253e+03   1.47777132e+04   2.15095315e+04
   6.71444869e+03   3.87307234e+03   4.25673539e+03   1.55168277e+04
   2.57191741e+03   8.78462101e+02   4.78893014e+03   1.00505625e+04
   1.74642568e-03   6.21517708e+04   3.76383730e+04   3.28220182e+04
   6.16987194e+04   3.36983002e+04   1.69206030e+04   1.70451005e+04
   2.91754258e+04   2.22285360e+04   1.02484560e+04   1.05448202e+04
   1.79554203e+04   1.50573326e+04   5.47775048e+03   7.35091305e+03
   1.08320441e+04   9.71381761e+03   4.67067754e+03   2.29845890e+03
   5.98943904e+03   6.17030257e+03   1.00944240e+03   2.72135830e-04
   2.31338853e+03   3.55231490e+03   1.51684303e+03   6.96274101e+04
   4.32043484e+04   3.10676660e+04   5.81827907e+04   4.10846547e+04
   2.13844948e+04   1.62191033e+04   2.55543050e+04   2.95663647e+04
   1.33540292e+04   1.11026574e+04   1.42821630e+04   2.23562113e+04
   7.15413213e+03   6.28281077e+03   7.11340087e+03   1.69738798e+04
   9.87155062e+03   5.16723315e+03   2.69148479e+03   1.33915482e+04
   5.14166878e+03   6.21353062e-04   6.21315222e-04   1.02213992e+04
   6.82463968e+03   6.41420679e+02   7.16369966e+04   4.76031499e+04
   5.54102474e+04   9.12369966e+04   3.92287271e+04   2.52246762e+04
   3.50723516e+04   5.40543087e+04   2.56095530e+04   1.95512553e+04
   2.46162204e+04   4.05249551e+04   1.67130895e+04   1.59472182e+04
   2.30731515e+04   3.13912492e+04   9.65023060e+03   7.46880114e+03
   9.06377825e+03   2.40252621e+04   4.38737167e+03   3.97484535e+03
   1.00966885e+04   1.69392145e+04   1.02978088e+03   7.65618216e-03
   5.05029470e+03   1.21774566e+04   7.06132611e+04   4.48682111e+04
   4.33450274e+04   7.59214469e+04   3.91467333e+04   2.19999198e+04
   2.49508328e+04   3.98482834e+04   2.60393903e+04   1.49403980e+04
   1.66617056e+04   2.68688463e+04   1.75537566e+04   9.84818048e+03
   1.33424647e+04   1.82138528e+04   1.09003187e+04   6.27136962e+03
   4.90788618e+03   1.18459521e+04   6.04688086e+03   1.84579228e+03
   2.69940042e+03   6.45466204e+03   2.42013686e+03   2.71598993e-03
   3.77863037e-03   3.12861080e+03   1.75186820e+03   7.68834897e+04
   4.91487061e+04   4.01854140e+04   7.10393216e+04   4.52549183e+04
   2.50985023e+04   2.26833995e+04   3.47752445e+04   3.20595055e+04
   1.66351208e+04   1.57735150e+04   2.17011844e+04   2.35031812e+04
   1.00678046e+04   1.07817223e+04   1.29638198e+04   1.67792951e+04
   1.00455029e+04   6.31081765e+03   6.99229293e+03   1.18554089e+04
   4.50471788e+03   1.15858111e+03   2.57196874e+03   7.63811195e+03
   3.81113278e+03   6.21374726e-04   2.72128219e-04   7.38964301e+03
   6.87794369e+02   8.04549958e+04   5.19396032e+04   3.42069703e+04
   6.08549958e+04   5.09203043e+04   2.84766917e+04   1.94026279e+04
   2.70578487e+04   3.88629030e+04   1.91058186e+04   1.49912011e+04
   1.52064798e+04   3.12200227e+04   1.15216160e+04   8.66921925e+03
   7.53349024e+03   2.54064483e+04   1.65750477e+04   1.00757592e+04
   3.02897672e+03   2.13928738e+04   1.06515759e+04   2.35230952e+03
   7.05224172e+02   1.74203069e+04   1.26812871e+04   3.83746898e+03
   3.25797503e-03   1.91335310e+04   7.20942758e+03   1.74374294e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.18700711e+03   1.65997834e+04   7.90630479e+03   1.87000000e+04
   1.52087740e+04   3.57114113e+03   3.86174154e+03   1.92338258e-03
   1.27203098e+04   2.34617415e+04   1.29494563e+04   3.05498830e+03
   7.92897510e+03   2.23246922e+04   2.27127743e+03   2.21445989e+04
   9.20528799e+03   1.56804561e+03   1.26485423e+04   1.16336082e+04
   3.64388690e+03   2.53096116e+04   1.36316353e+04   2.31467585e-04
   5.70961160e+03   1.88511460e+04   1.07435742e+04   1.26439913e+03
   1.04442496e+04   2.80590706e+03   1.46063683e+04   3.00442496e+04
   5.06551080e+02   4.62279674e+02   9.91547619e+03   1.93355375e+04
   2.06303961e+04   7.44566905e+03   8.56835178e+03   2.52757670e+04
   6.53064093e+03   5.76566835e-04   2.32694770e+03   9.66347744e+03
   2.86203660e+03   2.46075878e+04   1.00998819e+04   5.22767650e+03
   2.01574708e+04   1.07865356e+04   2.05660962e+03   4.54956813e-04
   4.87353853e+03   7.26940465e+03   1.59280895e+02   3.34851538e+04
   1.77495563e+04   3.12962852e+03   1.38851538e+04   2.14655866e+04
   9.90319595e+03   5.21647961e+02   7.23662835e+02   1.89275521e+04
   6.82511866e+03   2.19792433e+03   1.77630072e+04   7.09331054e+03
   1.81554414e+04   3.73630072e+04   3.67073942e+03   1.04545350e+03
   1.05715850e+04   2.17595390e+04   6.20443777e+00   1.95256583e+03
   6.48151657e+03   1.89255523e+04   3.00319027e+04   1.35792089e+04
   1.07965134e+04   2.96916619e+04   1.25999432e+04   2.69875399e+03
   2.68407318e+03   1.01534953e+04   7.12030534e+03   3.22452015e-03
   1.62528140e-04   5.36934340e+03   4.75717799e+03   3.49396941e+04
   1.72559633e+04   8.05711404e+03   2.47926057e+04   1.80760539e+04
   5.96995443e+03   1.22417696e+03   5.92401140e+03   1.29052943e+04
   2.29209574e+03   1.17670260e-04   1.47172149e+03   1.07900933e+04
   3.43669890e+02   4.32459552e+04   2.39781246e+04   8.49786997e+03
   2.36459552e+04   2.63853477e+04   1.18154743e+04   2.51891253e+03
   4.78093392e+03   2.12162364e+04   6.99811861e+03   2.51259641e+03
   3.30414908e+02   1.91023583e+04   3.84849502e+03   2.39764989e+02
   2.68597642e+04   1.31691086e+04   2.34954409e+04   4.64597642e+04
   8.62717406e+03   3.42972440e+03   1.30285407e+04   2.59783249e+04
   2.71239822e+03   2.84931070e+03   7.49942719e+03   2.07266563e+04
   2.55553232e-07   4.20525114e+03   1.04852426e+04   1.87988260e+04
   3.27581427e+04   1.63362397e+04   2.14603193e+04   4.50835293e+04
   1.24553914e+04   4.07438011e+03   1.02074634e+04   2.21631045e+04
   5.41549511e+03   1.87244985e+03   4.89523703e+03   1.57025949e+04
   1.80000000e+03   1.57884019e+03   6.16244557e+03   1.27224465e+04
   9.94725724e-08   3.69482898e+04   1.86492492e+04   1.81427792e+04
   4.09787808e+04   1.59806192e+04   5.02292278e+03   7.17442890e+03
   1.72749732e+04   8.57934321e+03   1.58124114e+03   2.69884106e+03
   1.04261935e+04   4.67378057e+03   2.76614896e-03   2.54811469e+03
   7.10804894e+03   2.58470773e+03   8.30520533e-01   5.17300951e+04
   2.97737228e+04   1.46590442e+04   3.37662104e+04   3.08084606e+04
   1.41424431e+04   5.70481722e+03   1.01166410e+04   2.34322050e+04
   8.06346384e+03   4.07641100e+03   3.29474344e+03   1.95467254e+04
   3.70100115e+03   7.43929894e+02   3.05389877e-04   1.74776668e+04
   1.08221492e+04   5.27042449e+03   3.77565212e+04   2.10449066e+04
   3.06354404e+04   5.73565212e+04   1.53836087e+04   7.61399530e+03
   1.72854964e+04   3.19971109e+04   7.21859200e+03   5.54605557e+03
   1.03173378e+04   2.43277603e+04   2.70000000e+03   5.45332429e+03
   1.19803918e+04   2.02952938e+04  -2.05100150e-07   2.31873400e-08
   2.29563489e+03   1.72086081e+04   4.53534133e+04   2.53072763e+04
   2.72576273e+04   5.40054412e+04   2.09283744e+04   9.02825991e+03
   1.34653179e+04   2.62282932e+04   1.16480391e+04   4.90205632e+03
   7.19316030e+03   1.73606328e+04   6.23421776e+03   2.69889284e+03
   6.60951676e+03   1.22850157e+04   2.64205837e+03   1.64288253e+02
   5.93939183e-03   8.78019985e+03   8.49898983e+02   5.51542714e+04
   3.19525956e+04   2.39628505e+04   4.91007687e+04   2.97866168e+04
   1.34651758e+04   1.08393845e+04   2.02130665e+04   1.99939754e+04
   7.22594459e+03   6.13254282e+03   1.07949791e+04   1.41689429e+04
   2.82265821e+03   3.11058179e+03   5.24020542e+03   1.01669825e+04
   4.75530552e+03   1.41345461e+03   1.94721111e+03   7.96502212e+03
   1.90497351e+03   5.92112296e+04   3.51417807e+04   2.17802003e+04
   4.48834651e+04   3.45572769e+04   1.65209974e+04   9.89936016e+03
   1.68366195e+04   2.51525283e+04   9.53981252e+03   6.50566605e+03
   7.83528815e+03   1.96388445e+04   4.33389228e+03   2.50921446e+03
   2.64330814e+03   1.59471651e+04   9.15511703e+03   4.11222514e+03
   4.79039273e-04   1.40554858e+04   5.83834888e+03   6.21245951e-04
   5.01686503e+04   3.02011787e+04   3.78548016e+04   6.79345321e+04
   2.37553122e+04   1.29971921e+04   2.18566605e+04   3.78148455e+04
   1.33943481e+04   9.25631270e+03   1.37202709e+04   2.77861462e+04
   7.11314179e+03   7.51659254e+03   1.38259249e+04   2.16998238e+04
   2.65657185e+03   1.43791697e+03   3.06334610e+03   1.69667618e+04
   1.90709184e-03   3.67025665e+02   6.39418231e+03   1.24002984e+04
   6.24791907e+04   3.92222891e+04   4.31181311e+04   7.55044991e+04
   3.26478754e+04   1.85298351e+04   2.51671454e+04   4.13578810e+04
   2.04292608e+04   1.29889555e+04   1.64529956e+04   2.93333029e+04
   1.26569800e+04   9.45038253e+03   1.47777132e+04   2.15095315e+04
   6.71444869e+03   3.87307234e+03   4.25673539e+03   1.55168277e+04
   2.57191741e+03   8.78462101e+02   4.78893014e+03   1.00505625e+04
   1.74642568e-03   6.21517708e+04   3.76383730e+04   3.28220182e+04
   6.16987194e+04   3.36983002e+04   1.69206030e+04   1.70451005e+04
   2.91754258e+04   2.22285360e+04   1.02484560e+04   1.05448202e+04
   1.79554203e+04   1.50573326e+04   5.47775048e+03   7.35091305e+03
   1.08320441e+04   9.71381761e+03   4.67067754e+03   2.29845890e+03
   5.98943904e+03   6.17030257e+03   1.00944240e+03   2.72135830e-04
   2.31338853e+03   3.55231490e+03   1.51684303e+03   6.96274101e+04
   4.32043484e+04   3.10676660e+04   5.81827907e+04   4.10846547e+04
   2.13844948e+04   1.62191033e+04   2.55543050e+04   2.95663647e+04
   1.33540292e+04   1.11026574e+04   1.42821630e+04   2.23562113e+04
   7.15413213e+03   6.28281077e+03   7.11340087e+03   1.69738798e+04
   9.87155062e+03   5.16723315e+03   2.69148479e+03   1.33915482e+04
   5.14166878e+03   6.21353062e-04   6.21315222e-04   1.02213992e+04
   6.82463968e+03   6.41420679e+02   7.16369966e+04   4.76031499e+04
   5.54102474e+04   9.12369966e+04   3.92287271e+04   2.52246762e+04
   3.50723516e+04   5.40543087e+04   2.56095530e+04   1.95512553e+04
   2.46162204e+04   4.05249551e+04   1.67130895e+04   1.59472182e+04
   2.30731515e+04   3.13912492e+04   9.65023060e+03   7.46880114e+03
   9.06377825e+03   2.40252621e+04   4.38737167e+03   3.97484535e+03
   1.00966885e+04   1.69392145e+04   1.02978088e+03   7.65618216e-03
   5.05029470e+03   1.21774566e+04   7.06132611e+04   4.48682111e+04
   4.33450274e+04   7.59214469e+04   3.91467333e+04   2.19999198e+04
   2.49508328e+04   3.98482834e+04   2.60393903e+04   1.49403980e+04
   1.66617056e+04   2.68688463e+04   1.75537566e+04   9.84818048e+03
   1.33424647e+04   1.82138528e+04   1.09003187e+04   6.27136962e+03
   4.90788618e+03   1.18459521e+04   6.04688086e+03   1.84579228e+03
   2.69940042e+03   6.45466204e+03   2.42013686e+03   2.71598993e-03
   3.77863037e-03   3.12861080e+03   1.75186820e+03   7.68834897e+04
   4.91487061e+04   4.01854140e+04   7.10393216e+04   4.52549183e+04
   2.50985023e+04   2.26833995e+04   3.47752445e+04   3.20595055e+04
   1.66351208e+04   1.57735150e+04   2.17011844e+04   2.35031812e+04
   1.00678046e+04   1.07817223e+04   1.29638198e+04   1.67792951e+04
   1.00455029e+04   6.31081765e+03   6.99229293e+03   1.18554089e+04
   4.50471788e+03   1.15858111e+03   2.57196874e+03   7.63811195e+03
   3.81113278e+03   6.21374726e-04   2.72128219e-04   7.38964301e+03
   6.87794369e+02   8.04549958e+04   5.19396032e+04   3.42069703e+04
   6.08549958e+04   5.09203043e+04   2.84766917e+04   1.94026279e+04
   2.70578487e+04   3.88629030e+04   1.91058186e+04   1.49912011e+04
   1.52064798e+04   3.12200227e+04   1.15216160e+04   8.66921925e+03
   7.53349024e+03   2.54064483e+04   1.65750477e+04   1.00757592e+04
   3.02897672e+03   2.13928738e+04   1.06515759e+04   2.35230952e+03
   7.05224172e+02   1.74203069e+04   1.26812871e+04   3.83746898e+03
   3.25797503e-03   1.91335310e+04   7.20942758e+03   1.74374294e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.70498108864 s
|dj| = 12421.4911428
Runtime: 6.70581293106 s
|dj| = 12421.4911428
   51    93    -3.106824E+04     2.775784E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 8.456e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.985e-05 (tol = 1.000e-10) r (rel) = 8.260e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.106e-10 (tol = 1.000e-10) r (rel) = 1.308e-09 (tol = 1.000e-09)
  Newton iteration 3: r (abs) = 3.184e-13 (tol = 1.000e-10) r (rel) = 3.765e-12 (tol = 1.000e-09)
  Newton solver finished in 3 iterations and 3 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 17.457651 s.
Runtime: 17.424988 s.
j = 1.390289e+06.
j = 1.390289e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19074805e+03   1.65976578e+04   7.90123693e+03   1.87000000e+04
   1.52118201e+04   3.57561113e+03   3.86626973e+03   1.62513086e-05
   1.27148965e+04   2.34662697e+04   1.29537813e+04   3.05289162e+03
   7.92468993e+03   2.23293458e+04   2.27006947e+03   2.21393843e+04
   9.19688217e+03   1.56461380e+03   1.26481934e+04   1.16266620e+04
   3.64176900e+03   2.53091670e+04   1.36286622e+04   1.43039954e-03
   5.70916702e+03   1.88502735e+04   1.07451902e+04   1.26538872e+03
   1.04482483e+04   2.80409102e+03   1.46001691e+04   3.00482483e+04
   5.05498709e+02   4.62204074e+02   9.91164953e+03   1.93366222e+04
   2.06350552e+04   7.44220360e+03   8.56275028e+03   2.52786383e+04
   6.52885330e+03   8.36951280e-05   2.32568192e+03   9.66428589e+03
   2.86246416e+03   2.46067821e+04   1.00928939e+04   5.22290360e+03
   2.01584377e+04   1.07812801e+04   2.05525063e+03   1.90717492e-04
   4.87462701e+03   7.26732011e+03   1.58509666e+02   3.34842361e+04
   1.77433153e+04   3.12712249e+03   1.38842361e+04   2.14617409e+04
   9.90298285e+03   5.22978291e+02   7.23579063e+02   1.89268725e+04
   6.82456559e+03   2.19873528e+03   1.77592005e+04   7.08481843e+03
   1.81439168e+04   3.73592005e+04   3.66442224e+03   1.04370434e+03
   1.05676267e+04   2.17583002e+04   4.23656758e+00   1.95325183e+03
   6.48037046e+03   1.89252473e+04   3.00370102e+04   1.35745054e+04
   1.07902277e+04   2.96936218e+04   1.25975236e+04   2.69875351e+03
   2.68402265e+03   1.01541175e+04   7.12105211e+03   3.68415307e-05
   4.05855754e-04   5.36894828e+03   4.75998180e+03   3.49380363e+04
   1.72468198e+04   8.05028497e+03   2.47903860e+04   1.80695627e+04
   5.96803559e+03   1.22432213e+03   5.92328535e+03   1.29031700e+04
   2.29078445e+03   1.28753524e-04   1.47138404e+03   1.07908122e+04
   3.43167960e+02   4.32459187e+04   2.39698721e+04   8.49390289e+03
   2.36459187e+04   2.63795770e+04   1.18139411e+04   2.52082290e+03
   4.78132852e+03   2.12143419e+04   6.99642628e+03   2.51323027e+03
   3.30671486e+02   1.91029128e+04   3.84704000e+03   2.39629244e+02
   2.68551215e+04   1.31576217e+04   2.34814690e+04   4.64551215e+04
   8.61805272e+03   3.42595656e+03   1.30241811e+04   2.59764142e+04
   2.70846816e+03   2.84828774e+03   7.49738231e+03   2.07257417e+04
   1.08699396e-07   4.20656488e+03   1.04855246e+04   1.87985515e+04
   3.27530820e+04   1.63231265e+04   2.14463477e+04   4.50784686e+04
   1.24448680e+04   4.06966391e+03   1.02038060e+04   2.21608578e+04
   5.41058396e+03   1.87024062e+03   4.89307169e+03   1.57013755e+04
   1.80000000e+03   1.57882476e+03   6.16240482e+03   1.27217575e+04
   4.23591473e-08   3.69541443e+04   1.86433529e+04   1.81346243e+04
   4.09810247e+04   1.59771342e+04   5.02228859e+03   7.17439952e+03
   1.72758646e+04   8.57967211e+03   1.58100156e+03   2.69879633e+03
   1.04260440e+04   4.67778482e+03   3.62244816e-06   2.54811315e+03
   7.10658527e+03   2.58716471e+03   1.84383817e+00   5.17294520e+04
   2.97628929e+04   1.46530659e+04   3.37660564e+04   3.08002015e+04
   1.41393360e+04   5.70678518e+03   1.01171363e+04   2.34286745e+04
   8.06066618e+03   4.07669759e+03   3.29519024e+03   1.95475896e+04
   3.69879146e+03   7.44083926e+02   3.10842074e-06   1.74777230e+04
   1.08218923e+04   5.26813289e+03   3.77510425e+04   2.10304251e+04
   3.06190211e+04   5.73510425e+04   1.53716832e+04   7.60820879e+03
   1.72807355e+04   3.19945282e+04   7.21269975e+03   5.54332364e+03
   1.03143941e+04   2.43262361e+04   2.70000000e+03   5.45314795e+03
   1.19802369e+04   2.02941903e+04  -8.60222826e-08   1.24804274e-08
   2.29654460e+03   1.72078565e+04   4.53555181e+04   2.52971504e+04
   2.72470342e+04   5.40069699e+04   2.09204985e+04   9.02526562e+03
   1.34651865e+04   2.62297866e+04   1.16452244e+04   4.90069093e+03
   7.19292081e+03   1.73617223e+04   6.23715353e+03   2.69884385e+03
   6.61074245e+03   1.22851171e+04   2.64388240e+03   1.65449494e+02
   1.70205421e-04   8.77973378e+03   8.50611265e+02   5.51524851e+04
   3.19387928e+04   2.39518224e+04   4.90986425e+04   2.97756715e+04
   1.34602641e+04   1.08394970e+04   2.02124377e+04   1.99889726e+04
   7.22242276e+03   6.13168440e+03   1.07947018e+04   1.41706904e+04
   2.82046659e+03   3.11085764e+03   5.23953521e+03   1.01681700e+04
   4.75614995e+03   1.41156443e+03   1.94669306e+03   7.96564965e+03
   1.90475934e+03   5.92123947e+04   3.51304960e+04   2.17727917e+04
   4.48839968e+04   3.45487871e+04   1.65178803e+04   9.90181980e+03
   1.68376370e+04   2.51493824e+04   9.53724991e+03   6.50633525e+03
   7.83615893e+03   1.96417469e+04   4.33200580e+03   2.51013635e+03
   2.64339959e+03   1.59491447e+04   9.15651767e+03   4.11027508e+03
   1.97356376e-05   1.40565425e+04   5.83837194e+03   3.75676982e-05
   5.01637296e+04   3.01855050e+04   3.78409154e+04   6.79340302e+04
   2.37415411e+04   1.29911945e+04   2.18556145e+04   3.78168308e+04
   1.33871695e+04   9.25393288e+03   1.37196757e+04   2.77889690e+04
   7.11355995e+03   7.51731152e+03   1.38289480e+04   2.17026076e+04
   2.65678011e+03   1.43884028e+03   3.06440178e+03   1.69695507e+04
   2.61361970e-04   3.67754387e+02   6.39698569e+03   1.24041320e+04
   6.24686380e+04   3.91994587e+04   4.30958109e+04   7.54940448e+04
   3.26283088e+04   1.85185104e+04   2.51605506e+04   4.13517703e+04
   2.04177753e+04   1.29812515e+04   1.64471305e+04   2.93289339e+04
   1.26553476e+04   9.44575491e+03   1.47754037e+04   2.15056851e+04
   6.71324138e+03   3.87209582e+03   4.25336522e+03   1.55138660e+04
   2.57113519e+03   8.76531258e+02   4.78808172e+03   1.00493880e+04
   3.50171509e-04   6.21528889e+04   3.76252099e+04   3.28098508e+04
   6.16979549e+04   3.36881127e+04   1.69161633e+04   1.70455119e+04
   2.91754805e+04   2.22245494e+04   1.02455091e+04   1.05442941e+04
   1.79554763e+04   1.50612627e+04   5.47605724e+03   7.35175766e+03
   1.08311983e+04   9.71689235e+03   4.67297525e+03   2.29701036e+03
   5.98846600e+03   6.17252200e+03   1.00949638e+03   5.46665474e-05
   2.31288441e+03   3.55556217e+03   1.51709855e+03   6.96263111e+04
   4.31893072e+04   3.10576024e+04   5.81826716e+04   4.10723445e+04
   2.13788731e+04   1.62210149e+04   2.55551698e+04   2.95603478e+04
   1.33497081e+04   1.11024328e+04   1.42831102e+04   2.23582130e+04
   7.15110022e+03   6.28377218e+03   7.11351120e+03   1.69750857e+04
   9.87254045e+03   5.16404657e+03   2.69154428e+03   1.33919583e+04
   5.14055690e+03   3.76139694e-05   3.76011142e-05   1.02242632e+04
   6.82370981e+03   6.40616861e+02   7.16258031e+04   4.75784112e+04
   5.53850656e+04   9.12258031e+04   3.92072619e+04   2.52118409e+04
   3.50644450e+04   5.40475223e+04   2.55966753e+04   1.95425646e+04
   2.46092539e+04   4.05199302e+04   1.67112719e+04   1.59419444e+04
   2.30703950e+04   3.13865936e+04   9.64882385e+03   7.46759983e+03
   9.05980269e+03   2.40214126e+04   4.38637581e+03   3.97207101e+03
   1.00952602e+04   1.69372652e+04   1.02867563e+03   2.66212851e-07
   5.05004876e+03   1.21755543e+04   7.06071639e+04   4.48480155e+04
   4.33275764e+04   7.59167074e+04   3.91294161e+04   2.19906611e+04
   2.49484676e+04   3.98462698e+04   2.60297110e+04   1.49341046e+04
   1.66586062e+04   2.68677653e+04   1.75540831e+04   9.84444294e+03
   1.33423708e+04   1.82124817e+04   1.09004494e+04   6.27165439e+03
   4.90462177e+03   1.18449089e+04   6.04681581e+03   1.84406973e+03
   2.69935599e+03   6.45446316e+03   2.42109247e+03   1.27338631e-04
   2.54828934e-04   3.12834855e+03   1.75123535e+03   7.68860981e+04
   4.91351076e+04   4.01750140e+04   7.10413672e+04   4.52441689e+04
   2.50941555e+04   2.26864130e+04   3.47775958e+04   3.20553079e+04
   1.66321777e+04   1.57744257e+04   2.17032680e+04   2.35081686e+04
   1.00660741e+04   1.07840554e+04   1.29645576e+04   1.67831912e+04
   1.00487490e+04   6.30887574e+03   6.99270045e+03   1.18582139e+04
   4.50467718e+03   1.15938332e+03   2.57226764e+03   7.64222288e+03
   3.81210987e+03   3.76194075e-05   5.46620291e-05   7.38972604e+03
   6.88376045e+02   8.04475017e+04   5.19187928e+04   3.41924875e+04
   6.08475017e+04   5.09031172e+04   2.84674290e+04   1.94017227e+04
   2.70537207e+04   3.88532914e+04   1.90980866e+04   1.49882145e+04
   1.52036105e+04   3.12197664e+04   1.15155137e+04   8.66753626e+03
   7.53074242e+03   2.54062607e+04   1.65748944e+04   1.00702399e+04
   3.02717377e+03   2.13927550e+04   1.06497042e+04   2.35155944e+03
   7.03970407e+02   1.74243090e+04   1.26813435e+04   3.83630843e+03
   2.19963417e-04   1.91332936e+04   7.21041371e+03   1.74413244e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.19074805e+03   1.65976578e+04   7.90123693e+03   1.87000000e+04
   1.52118201e+04   3.57561113e+03   3.86626973e+03   1.62513086e-05
   1.27148965e+04   2.34662697e+04   1.29537813e+04   3.05289162e+03
   7.92468993e+03   2.23293458e+04   2.27006947e+03   2.21393843e+04
   9.19688217e+03   1.56461380e+03   1.26481934e+04   1.16266620e+04
   3.64176900e+03   2.53091670e+04   1.36286622e+04   1.43039954e-03
   5.70916702e+03   1.88502735e+04   1.07451902e+04   1.26538872e+03
   1.04482483e+04   2.80409102e+03   1.46001691e+04   3.00482483e+04
   5.05498709e+02   4.62204074e+02   9.91164953e+03   1.93366222e+04
   2.06350552e+04   7.44220360e+03   8.56275028e+03   2.52786383e+04
   6.52885330e+03   8.36951280e-05   2.32568192e+03   9.66428589e+03
   2.86246416e+03   2.46067821e+04   1.00928939e+04   5.22290360e+03
   2.01584377e+04   1.07812801e+04   2.05525063e+03   1.90717492e-04
   4.87462701e+03   7.26732011e+03   1.58509666e+02   3.34842361e+04
   1.77433153e+04   3.12712249e+03   1.38842361e+04   2.14617409e+04
   9.90298285e+03   5.22978291e+02   7.23579063e+02   1.89268725e+04
   6.82456559e+03   2.19873528e+03   1.77592005e+04   7.08481843e+03
   1.81439168e+04   3.73592005e+04   3.66442224e+03   1.04370434e+03
   1.05676267e+04   2.17583002e+04   4.23656758e+00   1.95325183e+03
   6.48037046e+03   1.89252473e+04   3.00370102e+04   1.35745054e+04
   1.07902277e+04   2.96936218e+04   1.25975236e+04   2.69875351e+03
   2.68402265e+03   1.01541175e+04   7.12105211e+03   3.68415307e-05
   4.05855754e-04   5.36894828e+03   4.75998180e+03   3.49380363e+04
   1.72468198e+04   8.05028497e+03   2.47903860e+04   1.80695627e+04
   5.96803559e+03   1.22432213e+03   5.92328535e+03   1.29031700e+04
   2.29078445e+03   1.28753524e-04   1.47138404e+03   1.07908122e+04
   3.43167960e+02   4.32459187e+04   2.39698721e+04   8.49390289e+03
   2.36459187e+04   2.63795770e+04   1.18139411e+04   2.52082290e+03
   4.78132852e+03   2.12143419e+04   6.99642628e+03   2.51323027e+03
   3.30671486e+02   1.91029128e+04   3.84704000e+03   2.39629244e+02
   2.68551215e+04   1.31576217e+04   2.34814690e+04   4.64551215e+04
   8.61805272e+03   3.42595656e+03   1.30241811e+04   2.59764142e+04
   2.70846816e+03   2.84828774e+03   7.49738231e+03   2.07257417e+04
   1.08699396e-07   4.20656488e+03   1.04855246e+04   1.87985515e+04
   3.27530820e+04   1.63231265e+04   2.14463477e+04   4.50784686e+04
   1.24448680e+04   4.06966391e+03   1.02038060e+04   2.21608578e+04
   5.41058396e+03   1.87024062e+03   4.89307169e+03   1.57013755e+04
   1.80000000e+03   1.57882476e+03   6.16240482e+03   1.27217575e+04
   4.23591473e-08   3.69541443e+04   1.86433529e+04   1.81346243e+04
   4.09810247e+04   1.59771342e+04   5.02228859e+03   7.17439952e+03
   1.72758646e+04   8.57967211e+03   1.58100156e+03   2.69879633e+03
   1.04260440e+04   4.67778482e+03   3.62244816e-06   2.54811315e+03
   7.10658527e+03   2.58716471e+03   1.84383817e+00   5.17294520e+04
   2.97628929e+04   1.46530659e+04   3.37660564e+04   3.08002015e+04
   1.41393360e+04   5.70678518e+03   1.01171363e+04   2.34286745e+04
   8.06066618e+03   4.07669759e+03   3.29519024e+03   1.95475896e+04
   3.69879146e+03   7.44083926e+02   3.10842074e-06   1.74777230e+04
   1.08218923e+04   5.26813289e+03   3.77510425e+04   2.10304251e+04
   3.06190211e+04   5.73510425e+04   1.53716832e+04   7.60820879e+03
   1.72807355e+04   3.19945282e+04   7.21269975e+03   5.54332364e+03
   1.03143941e+04   2.43262361e+04   2.70000000e+03   5.45314795e+03
   1.19802369e+04   2.02941903e+04  -8.60222826e-08   1.24804274e-08
   2.29654460e+03   1.72078565e+04   4.53555181e+04   2.52971504e+04
   2.72470342e+04   5.40069699e+04   2.09204985e+04   9.02526562e+03
   1.34651865e+04   2.62297866e+04   1.16452244e+04   4.90069093e+03
   7.19292081e+03   1.73617223e+04   6.23715353e+03   2.69884385e+03
   6.61074245e+03   1.22851171e+04   2.64388240e+03   1.65449494e+02
   1.70205421e-04   8.77973378e+03   8.50611265e+02   5.51524851e+04
   3.19387928e+04   2.39518224e+04   4.90986425e+04   2.97756715e+04
   1.34602641e+04   1.08394970e+04   2.02124377e+04   1.99889726e+04
   7.22242276e+03   6.13168440e+03   1.07947018e+04   1.41706904e+04
   2.82046659e+03   3.11085764e+03   5.23953521e+03   1.01681700e+04
   4.75614995e+03   1.41156443e+03   1.94669306e+03   7.96564965e+03
   1.90475934e+03   5.92123947e+04   3.51304960e+04   2.17727917e+04
   4.48839968e+04   3.45487871e+04   1.65178803e+04   9.90181980e+03
   1.68376370e+04   2.51493824e+04   9.53724991e+03   6.50633525e+03
   7.83615893e+03   1.96417469e+04   4.33200580e+03   2.51013635e+03
   2.64339959e+03   1.59491447e+04   9.15651767e+03   4.11027508e+03
   1.97356376e-05   1.40565425e+04   5.83837194e+03   3.75676982e-05
   5.01637296e+04   3.01855050e+04   3.78409154e+04   6.79340302e+04
   2.37415411e+04   1.29911945e+04   2.18556145e+04   3.78168308e+04
   1.33871695e+04   9.25393288e+03   1.37196757e+04   2.77889690e+04
   7.11355995e+03   7.51731152e+03   1.38289480e+04   2.17026076e+04
   2.65678011e+03   1.43884028e+03   3.06440178e+03   1.69695507e+04
   2.61361970e-04   3.67754387e+02   6.39698569e+03   1.24041320e+04
   6.24686380e+04   3.91994587e+04   4.30958109e+04   7.54940448e+04
   3.26283088e+04   1.85185104e+04   2.51605506e+04   4.13517703e+04
   2.04177753e+04   1.29812515e+04   1.64471305e+04   2.93289339e+04
   1.26553476e+04   9.44575491e+03   1.47754037e+04   2.15056851e+04
   6.71324138e+03   3.87209582e+03   4.25336522e+03   1.55138660e+04
   2.57113519e+03   8.76531258e+02   4.78808172e+03   1.00493880e+04
   3.50171509e-04   6.21528889e+04   3.76252099e+04   3.28098508e+04
   6.16979549e+04   3.36881127e+04   1.69161633e+04   1.70455119e+04
   2.91754805e+04   2.22245494e+04   1.02455091e+04   1.05442941e+04
   1.79554763e+04   1.50612627e+04   5.47605724e+03   7.35175766e+03
   1.08311983e+04   9.71689235e+03   4.67297525e+03   2.29701036e+03
   5.98846600e+03   6.17252200e+03   1.00949638e+03   5.46665474e-05
   2.31288441e+03   3.55556217e+03   1.51709855e+03   6.96263111e+04
   4.31893072e+04   3.10576024e+04   5.81826716e+04   4.10723445e+04
   2.13788731e+04   1.62210149e+04   2.55551698e+04   2.95603478e+04
   1.33497081e+04   1.11024328e+04   1.42831102e+04   2.23582130e+04
   7.15110022e+03   6.28377218e+03   7.11351120e+03   1.69750857e+04
   9.87254045e+03   5.16404657e+03   2.69154428e+03   1.33919583e+04
   5.14055690e+03   3.76139694e-05   3.76011142e-05   1.02242632e+04
   6.82370981e+03   6.40616861e+02   7.16258031e+04   4.75784112e+04
   5.53850656e+04   9.12258031e+04   3.92072619e+04   2.52118409e+04
   3.50644450e+04   5.40475223e+04   2.55966753e+04   1.95425646e+04
   2.46092539e+04   4.05199302e+04   1.67112719e+04   1.59419444e+04
   2.30703950e+04   3.13865936e+04   9.64882385e+03   7.46759983e+03
   9.05980269e+03   2.40214126e+04   4.38637581e+03   3.97207101e+03
   1.00952602e+04   1.69372652e+04   1.02867563e+03   2.66212851e-07
   5.05004876e+03   1.21755543e+04   7.06071639e+04   4.48480155e+04
   4.33275764e+04   7.59167074e+04   3.91294161e+04   2.19906611e+04
   2.49484676e+04   3.98462698e+04   2.60297110e+04   1.49341046e+04
   1.66586062e+04   2.68677653e+04   1.75540831e+04   9.84444294e+03
   1.33423708e+04   1.82124817e+04   1.09004494e+04   6.27165439e+03
   4.90462177e+03   1.18449089e+04   6.04681581e+03   1.84406973e+03
   2.69935599e+03   6.45446316e+03   2.42109247e+03   1.27338631e-04
   2.54828934e-04   3.12834855e+03   1.75123535e+03   7.68860981e+04
   4.91351076e+04   4.01750140e+04   7.10413672e+04   4.52441689e+04
   2.50941555e+04   2.26864130e+04   3.47775958e+04   3.20553079e+04
   1.66321777e+04   1.57744257e+04   2.17032680e+04   2.35081686e+04
   1.00660741e+04   1.07840554e+04   1.29645576e+04   1.67831912e+04
   1.00487490e+04   6.30887574e+03   6.99270045e+03   1.18582139e+04
   4.50467718e+03   1.15938332e+03   2.57226764e+03   7.64222288e+03
   3.81210987e+03   3.76194075e-05   5.46620291e-05   7.38972604e+03
   6.88376045e+02   8.04475017e+04   5.19187928e+04   3.41924875e+04
   6.08475017e+04   5.09031172e+04   2.84674290e+04   1.94017227e+04
   2.70537207e+04   3.88532914e+04   1.90980866e+04   1.49882145e+04
   1.52036105e+04   3.12197664e+04   1.15155137e+04   8.66753626e+03
   7.53074242e+03   2.54062607e+04   1.65748944e+04   1.00702399e+04
   3.02717377e+03   2.13927550e+04   1.06497042e+04   2.35155944e+03
   7.03970407e+02   1.74243090e+04   1.26813435e+04   3.83630843e+03
   2.19963417e-04   1.91332936e+04   7.21041371e+03   1.74413244e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.99065995216 s
|dj| = 12420.2937535
Runtime: 5.99907016754 s
|dj| = 12420.2937535
Start evaluation of j
Updating the turbine cache
   52    94    -3.106826E+04     2.775516E+02
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 9.804e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.408e-05 (tol = 1.000e-10) r (rel) = 5.516e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.843e-11 (tol = 1.000e-10) r (rel) = 2.900e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 13.671708 s.
j = 1.390289e+06.
End of time loop.
Runtime: 13.646447 s.
j = 1.390289e+06.
Minimum distance inequality constraints (should all be > 0): [  2.18890116e+03   1.65959539e+04   7.90213388e+03   1.87000000e+04
   1.52099804e+04   3.57235885e+03   3.86374505e+03   7.84973508e-09
   1.27162568e+04   2.34637451e+04   1.29486398e+04   3.05233667e+03
   7.92590174e+03   2.23245498e+04   2.26961188e+03   2.21364245e+04
   9.19785615e+03   1.56485690e+03   1.26430347e+04   1.16280889e+04
   3.64298914e+03   2.53064087e+04   1.36287518e+04   7.84403642e-05
   5.70640867e+03   1.88503058e+04   1.07451024e+04   1.26459961e+03
   1.04424518e+04   2.80309157e+03   1.46011663e+04   3.00424518e+04
   5.04829756e+02   4.62163734e+02   9.91333479e+03   1.93361054e+04
   2.06286065e+04   7.44129041e+03   8.56338153e+03   2.52720211e+04
   6.52816803e+03   4.82105270e-06   2.32625389e+03   9.66342173e+03
   2.86273242e+03   2.45989232e+04   1.00910343e+04   5.22275953e+03
   2.01510905e+04   1.07796890e+04   2.05494423e+03   1.46495419e-04
   4.87364540e+03   7.26696064e+03   1.58368991e+02   3.34904553e+04
   1.77495737e+04   3.13269693e+03   1.38904553e+04   2.14663526e+04
   9.90417420e+03   5.23426454e+02   7.27008926e+02   1.89284653e+04
   6.82297287e+03   2.19753630e+03   1.77580820e+04   7.08727019e+03
   1.81481341e+04   3.73580820e+04   3.66634022e+03   1.04452766e+03
   1.05701230e+04   2.17597241e+04   5.62731342e+00   1.95331323e+03
   6.48015047e+03   1.89243577e+04   3.00292248e+04   1.35732008e+04
   1.07901713e+04   2.96850554e+04   1.25966075e+04   2.69875219e+03
   2.68388275e+03   1.01523858e+04   7.12164138e+03   7.31817590e-06
   2.79006827e-05   5.36456448e+03   4.75934532e+03   3.49291605e+04
   1.72445763e+04   8.05040024e+03   2.47830904e+04   1.80672747e+04
   5.96724830e+03   1.22391391e+03   5.92253078e+03   1.29022428e+04
   2.29009782e+03   2.69605234e-05   1.46825303e+03   1.07887937e+04
   3.42569674e+02   4.32492406e+04   2.39760266e+04   8.50013106e+03
   2.36492406e+04   2.63846410e+04   1.18171687e+04   2.52314216e+03
   4.78548510e+03   2.12181353e+04   6.99769975e+03   2.51513066e+03
   3.29621346e+02   1.91035030e+04   3.84635844e+03   2.40010466e+02
   2.68537574e+04   1.31609270e+04   2.34868741e+04   4.64537574e+04
   8.62082228e+03   3.42788872e+03   1.30276767e+04   2.59786104e+04
   2.71124586e+03   2.84953316e+03   7.49859790e+03   2.07230721e+04
   1.55700945e-07   4.20720929e+03   1.04847303e+04   1.87982600e+04
   3.27515951e+04   1.63268599e+04   2.14520594e+04   4.50769817e+04
   1.24480633e+04   4.07221460e+03   1.02073933e+04   2.21634402e+04
   5.41405513e+03   1.87204679e+03   4.89510002e+03   1.56978159e+04
   1.80000000e+03   1.57996470e+03   6.16251596e+03   1.27210251e+04
   6.07001311e-08   3.69475971e+04   1.86433825e+04   1.81347998e+04
   4.09715212e+04   1.59777400e+04   5.02301734e+03   7.17414443e+03
   1.72732958e+04   8.58188569e+03   1.58135587e+03   2.69880407e+03
   1.04182615e+04   4.67730334e+03   8.27337313e-05   2.54669854e+03
   7.10294021e+03   2.58768015e+03   2.30910818e+00   5.17329133e+04
   2.97703594e+04   1.46612691e+04   3.37699141e+04   3.08065199e+04
   1.41441833e+04   5.71091315e+03   1.01228728e+04   2.34342684e+04
   8.06371643e+03   4.08068388e+03   3.29323936e+03   1.95486369e+04
   3.70007128e+03   7.46369198e+02   1.98867713e-06   1.74779055e+04
   1.08217159e+04   5.26623174e+03   3.77494328e+04   2.10345838e+04
   3.06256141e+04   5.73494328e+04   1.53753043e+04   7.61124978e+03
   1.72852305e+04   3.19974968e+04   7.21686440e+03   5.54575309e+03
   1.03170453e+04   2.43217866e+04   2.70000000e+03   5.45507326e+03
   1.19806669e+04   2.02930170e+04  -1.22529400e-07   1.88929334e-08
   2.29805696e+03   1.72071741e+04   4.53441511e+04   2.52943674e+04
   2.72468029e+04   5.39953375e+04   2.09180758e+04   9.02438530e+03
   1.34648108e+04   2.62269697e+04   1.16453318e+04   4.90019881e+03
   7.19281016e+03   1.73520727e+04   6.23378976e+03   2.69879919e+03
   6.60957771e+03   1.22807995e+04   2.64189604e+03   1.64102616e+02
   1.32690458e-04   8.77738823e+03   8.50002324e+02   5.51564576e+04
   3.19480292e+04   2.39632962e+Minimum distance inequality constraints (should all be > 0): [  2.18890116e+03   1.65959539e+04   7.90213388e+03   1.87000000e+04
   1.52099804e+04   3.57235885e+03   3.86374505e+03   7.84973508e-09
   1.27162568e+04   2.34637451e+04   1.29486398e+04   3.05233667e+03
   7.92590174e+03   2.23245498e+04   2.26961188e+03   2.21364245e+04
   9.19785615e+03   1.56485690e+03   1.26430347e+04   1.16280889e+04
   3.64298914e+03   2.53064087e+04   1.36287518e+04   7.84403642e-05
   5.70640867e+03   1.88503058e+04   1.07451024e+04   1.26459961e+03
   1.04424518e+04   2.80309157e+03   1.46011663e+04   3.00424518e+04
   5.04829756e+02   4.62163734e+02   9.91333479e+03   1.93361054e+04
   2.06286065e+04   7.44129041e+03   8.56338153e+03   2.52720211e+04
   6.52816803e+03   4.82105270e-06   2.32625389e+03   9.66342173e+03
   2.86273242e+03   2.45989232e+04   1.00910343e+04   5.22275953e+03
   2.01510905e+04   1.07796890e+04   2.05494423e+03   1.46495419e-04
   4.87364540e+03   7.26696064e+03   1.58368991e+02   3.34904553e+04
   1.77495737e+04   3.13269693e+03   1.38904553e+04   2.14663526e+04
   9.90417420e+03   5.23426454e+02   7.27008926e+02   1.89284653e+04
   6.82297287e+03   2.19753630e+03   1.77580820e+04   7.08727019e+03
   1.81481341e+04   3.73580820e+04   3.66634022e+03   1.04452766e+03
   1.05701230e+04   2.17597241e+04   5.62731342e+00   1.95331323e+03
   6.48015047e+03   1.89243577e+04   3.00292248e+04   1.35732008e+04
   1.07901713e+04   2.96850554e+04   1.25966075e+04   2.69875219e+03
   2.68388275e+03   1.01523858e+04   7.12164138e+03   7.31817590e-06
   2.79006827e-05   5.36456448e+03   4.75934532e+03   3.49291605e+04
   1.72445763e+04   8.05040024e+03   2.47830904e+04   1.80672747e+04
   5.96724830e+03   1.22391391e+03   5.92253078e+03   1.29022428e+04
   2.29009782e+03   2.69605234e-05   1.46825303e+03   1.07887937e+04
   3.42569674e+02   4.32492406e+04   2.39760266e+04   8.50013106e+03
   2.36492406e+04   2.63846410e+04   1.18171687e+04   2.52314216e+03
   4.78548510e+03   2.12181353e+04   6.99769975e+03   2.51513066e+03
   3.29621346e+02   1.91035030e+04   3.84635844e+03   2.40010466e+02
   2.68537574e+04   1.31609270e+04   2.34868741e+04   4.64537574e+04
   8.62082228e+03   3.42788872e+03   1.30276767e+04   2.59786104e+04
   2.71124586e+03   2.84953316e+03   7.49859790e+03   2.07230721e+04
   1.55700945e-07   4.20720929e+03   1.04847303e+04   1.87982600e+04
   3.27515951e+04   1.63268599e+04   2.14520594e+04   4.50769817e+04
   1.24480633e+04   4.07221460e+03   1.02073933e+04   2.21634402e+04
   5.41405513e+03   1.87204679e+03   4.89510002e+03   1.56978159e+04
   1.80000000e+03   1.57996470e+03   6.16251596e+03   1.27210251e+04
   6.07001311e-08   3.69475971e+04   1.86433825e+04   1.81347998e+04
   4.09715212e+04   1.59777400e+04   5.02301734e+03   7.17414443e+03
   1.72732958e+04   8.58188569e+03   1.58135587e+03   2.69880407e+03
   1.04182615e+04   4.67730334e+03   8.27337313e-05   2.54669854e+03
   7.10294021e+03   2.58768015e+03   2.30910818e+00   5.17329133e+04
   2.97703594e+04   1.46612691e+04   3.37699141e+04   3.08065199e+04
   1.41441833e+04   5.71091315e+03   1.01228728e+04   2.34342684e+04
   8.06371643e+03   4.08068388e+03   3.29323936e+03   1.95486369e+04
   3.70007128e+03   7.46369198e+02   1.98867713e-06   1.74779055e+04
   1.08217159e+04   5.26623174e+03   3.77494328e+04   2.10345838e+04
   3.06256141e+04   5.73494328e+04   1.53753043e+04   7.61124978e+03
   1.72852305e+04   3.19974968e+04   7.21686440e+03   5.54575309e+03
   1.03170453e+04   2.43217866e+04   2.70000000e+03   5.45507326e+03
   1.19806669e+04   2.02930170e+04  -1.22529400e-07   1.88929334e-08
   2.29805696e+03   1.72071741e+04   4.53441511e+04   2.52943674e+04
   2.72468029e+04   5.39953375e+04   2.09180758e+04   9.02438530e+03
   1.34648108e+04   2.62269697e+04   1.16453318e+04   4.90019881e+03
   7.19281016e+03   1.73520727e+04   6.23378976e+03   2.69879919e+03
   6.60957771e+03   1.22807995e+04   2.64189604e+03   1.64102616e+02
   1.32690458e-04   8.77738823e+03   8.50002324e+02   5.51564576e+04
   3.19480292e+04   2.39632962e+04   4.91040527e+04   2.97835503e+04
   1.34670347e+04   1.08467073e+04   2.02206681e+04   1.99966319e+04
   7.22771271e+03   6.13821918e+03   1.07924291e+04   1.41722577e+04
   2.82436366e+03   3.11525011e+03   5.24011240e+03   1.01688165e+04
   4.75660287e+03   1.41247268e+03   1.94706956e+03   7.96537534e+03
   1.90464452e+03   5.92145563e+04   3.51380572e+04   2.17823737e+04
   4.48877417e+04   3.45550760e+04   1.65233818e+04   9.90730549e+03
   1.68445092e+04   2.51555820e+04   9.54131399e+03   6.51176604e+03
   7.83320692e+03   1.96422720e+04   4.33469283e+03   2.51383875e+03
   2.64335094e+03   1.59489270e+04   9.15622237e+03   4.10969889e+03
   2.21029020e-05   1.40555820e+04   5.83740664e+03   8.92582966e-06
   5.01626037e+04   3.01914239e+04   3.78510153e+04   6.79352195e+04
   2.37464629e+04   1.29962494e+04   2.18630168e+04   3.78232928e+04
   1.33930194e+04   9.25861388e+03   1.37254001e+04   2.77853733e+04
   7.11378067e+03   7.52176005e+03   1.38325504e+04   2.17030358e+04
   2.65689037e+03   1.43932496e+03   3.06770633e+03   1.69702996e+04
   7.18785212e-05   3.69069134e+02   6.39731465e+03   1.24044631e+04
   6.24639795e+04   3.92029861e+04   4.31018141e+04   7.54887354e+04
   3.26316053e+04   1.85220426e+04   2.51645861e+04   4.13537535e+04
   2.04229857e+04   1.29844113e+04   1.64509062e+04   2.93193390e+04
   1.26542212e+04   9.44866111e+03   1.47769011e+04   2.15013641e+04
   6.71244006e+03   3.87133626e+03   4.25533227e+03   1.55104788e+04
   2.57065892e+03   8.77861798e+02   4.78572319e+03   1.00464950e+04
   1.65023981e-04   6.21587300e+04   3.76368562e+04   3.28237851e+04
   6.17046673e+04   3.36984286e+04   1.69252107e+04   1.70550126e+04
   2.91854781e+04   2.22349094e+04   1.02530473e+04   1.05530435e+04
   1.79529223e+04   1.50643880e+04   5.48220295e+03   7.35789259e+03
   1.08320370e+04   9.71898832e+03   4.67471827e+03   2.30023672e+03
   5.98897724e+03   6.17358868e+03   1.01157531e+03   7.47364436e-06
   2.31289542e+03   3.55668683e+03   1.51612593e+03   6.96301827e+04
   4.31993730e+04   3.10695658e+04   5.81873340e+04   4.10812310e+04
   2.13868932e+04   1.62287247e+04   2.55637476e+04   2.95695704e+04
   1.33562523e+04   1.11103504e+04   1.42793833e+04   2.23603962e+04
   7.15625269e+03   6.28952350e+03   7.11345872e+03   1.69764641e+04
   9.87366321e+03   5.16586450e+03   2.69149936e+03   1.33925319e+04
   5.14218679e+03   8.99233100e-06   8.97514292e-06   1.02257567e+04
   6.82245945e+03   6.40634598e+02   7.16191059e+04   4.75809866e+04
   5.53910898e+04   9.12191059e+04   3.92096062e+04   2.52149432e+04
   3.50687154e+04   5.40492265e+04   2.56014858e+04   1.95456511e+04
   2.46131378e+04   4.05087034e+04   1.67090583e+04   1.59451642e+04
   2.30719133e+04   3.13814049e+04   9.64711068e+03   7.46613687e+03
   9.06234873e+03   2.40172465e+04   4.38516306e+03   3.97383557e+03
   1.00919039e+04   1.69335680e+04   1.02768344e+03   1.40703405e-05
   5.04814360e+03   1.21737108e+04   7.06118826e+04   4.48597704e+04
   4.33427278e+04   7.59231492e+04   3.91398048e+04   2.20003862e+04
   2.49593435e+04   3.98572048e+04   2.60407487e+04   1.49426962e+04
   1.66686778e+04   2.68645243e+04   1.75570503e+04   9.85204979e+03
   1.33497677e+04   1.82134884e+04   1.09025600e+04   6.27365634e+03
   4.90947511e+03   1.18456758e+04   6.04806964e+03   1.84770013e+03
   2.69934430e+03   6.45472074e+03   2.42219163e+03   4.59881756e-04
   1.76213421e-05   3.12878366e+03   1.75029951e+03   7.68918206e+04
   4.91475654e+04   4.01894201e+04   7.10473140e+04   4.52554747e+04
   2.51044346e+04   2.26963954e+04   3.47879230e+04   3.20672134e+04
   1.66409523e+04   1.57845401e+04   2.16992419e+04   2.35118919e+04
   1.00734574e+04   1.07915314e+04   1.29647488e+04   1.67860013e+04
   1.00511440e+04   6.31299396e+03   6.99277247e+03   1.18601107e+04
   4.50848300e+03   1.15936543e+03   2.57226084e+03   7.64449433e+03
   3.81222761e+03   9.00044506e-06   7.46660055e-06   7.38931595e+03
   6.88804794e+02   8.04464255e+04   5.19251993e+04   3.42003037e+04
   6.08464255e+04   5.09089036e+04   2.84732604e+04   1.04   4.91040527e+04   2.97835503e+04
   1.34670347e+04   1.08467073e+04   2.02206681e+04   1.99966319e+04
   7.22771271e+03   6.13821918e+03   1.07924291e+04   1.41722577e+04
   2.82436366e+03   3.11525011e+03   5.24011240e+03   1.01688165e+04
   4.75660287e+03   1.41247268e+03   1.94706956e+03   7.96537534e+03
   1.90464452e+03   5.92145563e+04   3.51380572e+04   2.17823737e+04
   4.48877417e+04   3.45550760e+04   1.65233818e+04   9.90730549e+03
   1.68445092e+04   2.51555820e+04   9.54131399e+03   6.51176604e+03
   7.83320692e+03   1.96422720e+04   4.33469283e+03   2.51383875e+03
   2.64335094e+03   1.59489270e+04   9.15622237e+03   4.10969889e+03
   2.21029020e-05   1.40555820e+04   5.83740664e+03   8.92582966e-06
   5.01626037e+04   3.01914239e+04   3.78510153e+04   6.79352195e+04
   2.37464629e+04   1.29962494e+04   2.18630168e+04   3.78232928e+04
   1.33930194e+04   9.25861388e+03   1.37254001e+04   2.77853733e+04
   7.11378067e+03   7.52176005e+03   1.38325504e+04   2.17030358e+04
   2.65689037e+03   1.43932496e+03   3.06770633e+03   1.69702996e+04
   7.18785212e-05   3.69069134e+02   6.39731465e+03   1.24044631e+04
   6.24639795e+04   3.92029861e+04   4.31018141e+04   7.54887354e+04
   3.26316053e+04   1.85220426e+04   2.51645861e+04   4.13537535e+04
   2.04229857e+04   1.29844113e+04   1.64509062e+04   2.93193390e+04
   1.26542212e+04   9.44866111e+03   1.47769011e+04   2.15013641e+04
   6.71244006e+03   3.87133626e+03   4.25533227e+03   1.55104788e+04
   2.57065892e+03   8.77861798e+02   4.78572319e+03   1.00464950e+04
   1.65023981e-04   6.21587300e+04   3.76368562e+04   3.28237851e+04
   6.17046673e+04   3.36984286e+04   1.69252107e+04   1.70550126e+04
   2.91854781e+04   2.22349094e+04   1.02530473e+04   1.05530435e+04
   1.79529223e+04   1.50643880e+04   5.48220295e+03   7.35789259e+03
   1.08320370e+04   9.71898832e+03   4.67471827e+03   2.30023672e+03
   5.98897724e+03   6.17358868e+03   1.01157531e+03   7.47364436e-06
   2.31289542e+03   3.55668683e+03   1.51612593e+03   6.96301827e+04
   4.31993730e+04   3.10695658e+04   5.81873340e+04   4.10812310e+04
   2.13868932e+04   1.62287247e+04   2.55637476e+04   2.95695704e+04
   1.33562523e+04   1.11103504e+04   1.42793833e+04   2.23603962e+04
   7.15625269e+03   6.28952350e+03   7.11345872e+03   1.69764641e+04
   9.87366321e+03   5.16586450e+03   2.69149936e+03   1.33925319e+04
   5.14218679e+03   8.99233100e-06   8.97514292e-06   1.02257567e+04
   6.82245945e+03   6.40634598e+02   7.16191059e+04   4.75809866e+04
   5.53910898e+04   9.12191059e+04   3.92096062e+04   2.52149432e+04
   3.50687154e+04   5.40492265e+04   2.56014858e+04   1.95456511e+04
   2.46131378e+04   4.05087034e+04   1.67090583e+04   1.59451642e+04
   2.30719133e+04   3.13814049e+04   9.64711068e+03   7.46613687e+03
   9.06234873e+03   2.40172465e+04   4.38516306e+03   3.97383557e+03
   1.00919039e+04   1.69335680e+04   1.02768344e+03   1.40703405e-05
   5.04814360e+03   1.21737108e+04   7.06118826e+04   4.48597704e+04
   4.33427278e+04   7.59231492e+04   3.91398048e+04   2.20003862e+04
   2.49593435e+04   3.98572048e+04   2.60407487e+04   1.49426962e+04
   1.66686778e+04   2.68645243e+04   1.75570503e+04   9.85204979e+03
   1.33497677e+04   1.82134884e+04   1.09025600e+04   6.27365634e+03
   4.90947511e+03   1.18456758e+04   6.04806964e+03   1.84770013e+03
   2.69934430e+03   6.45472074e+03   2.42219163e+03   4.59881756e-04
   1.76213421e-05   3.12878366e+03   1.75029951e+03   7.68918206e+04
   4.91475654e+04   4.01894201e+04   7.10473140e+04   4.52554747e+04
   2.51044346e+04   2.26963954e+04   3.47879230e+04   3.20672134e+04
   1.66409523e+04   1.57845401e+04   2.16992419e+04   2.35118919e+04
   1.00734574e+04   1.07915314e+04   1.29647488e+04   1.67860013e+04
   1.00511440e+04   6.31299396e+03   6.99277247e+03   1.18601107e+04
   4.50848300e+03   1.15936543e+03   2.57226084e+03   7.64449433e+03
   3.81222761e+03   9.00044506e-06   7.46660055e-06   7.38931595e+03
   6.88804794e+02   8.04464255e+04   5.19251993e+04   3.42003037e+04
   6.08464255e+04   5.09089036e+04   2.84732604e+04   1.94062792e+04
   2.70586702e+04   3.88604028e+04   1.91028270e+04   1.49942997e+04
   1.51965715e+04   3.12201980e+04   1.15192119e+04   8.67201836e+03
   7.52839811e+03   2.54065766e+04   1.65751525e+04   1.00707597e+04
   3.02563243e+03   2.13929551e+04   1.06513554e+04   2.35124646e+03
   7.03444623e+02   1.74265202e+04   1.26807703e+04   3.83649609e+03
   1.39995341e-04   1.91328662e+04   7.21185469e+03   1.74461519e+03]
Start evaluation of dj
found a tidal farm, computing gradient
94062792e+04
   2.70586702e+04   3.88604028e+04   1.91028270e+04   1.49942997e+04
   1.51965715e+04   3.12201980e+04   1.15192119e+04   8.67201836e+03
   7.52839811e+03   2.54065766e+04   1.65751525e+04   1.00707597e+04
   3.02563243e+03   2.13929551e+04   1.06513554e+04   2.35124646e+03
   7.03444623e+02   1.74265202e+04   1.26807703e+04   3.83649609e+03
   1.39995341e-04   1.91328662e+04   7.21185469e+03   1.74461519e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.74842309952 s
Runtime: 5.74869203568 s
|dj| = 12420.0735617
|dj| = 12420.0735617
   53    95    -3.106826E+04     2.775467E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.992e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 5.622e-06 (tol = 1.000e-10) r (rel) = 1.879e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 2.388e-12 (tol = 1.000e-10) r (rel) = 7.982e-11 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 13.410191 s.
j = 1.390289e+06.
Runtime: 13.407372 s.
j = 1.390289e+06.
Minimum distance inequality constraints (should all be > 0): [  2.18954954e+03   1.65966552e+04   7.90187097e+03   1.87000000e+04
   1.52108883e+04   3.57386615e+03   3.86485441e+03   2.22685946e-06
   1.27155487e+04   2.34648544e+04   1.29477803e+04   3.05101162e+03
   7.92354990e+03   2.23230580e+04   2.26869582e+03   2.21351926e+04
   9.19636706e+03   1.56353528e+03   1.26426219e+04   1.16265776e+04
   3.64228623e+03   2.53076005e+04   1.36289964e+04   2.13528515e-05
   5.70760046e+03   1.88502886e+04   1.07439065e+04   1.26421490e+03
   1.04450958e+04   2.80367045e+03   1.46006235e+04   3.00450958e+04
   5.05157839e+02   4.62146411e+02   9.91260120e+03   1.93363618e+04
   2.06279850e+04   7.43978818e+03   8.56154339e+03   2.52721358e+04
   6.52663159e+03   3.49010577e-05   2.32630593e+03   9.66292713e+03
   2.86162793e+03   2.45978832e+04   1.00893015e+04   5.22080626e+03
   2.01507029e+04   1.07779228e+04   2.05459141e+03   4.91564265e-07
   4.87286213e+03   7.26572889e+03   1.58393010e+02   3.34882427e+04
   1.77475149e+04   3.13046635e+03   1.38882427e+04   2.14645506e+04
   9.90361883e+03   5.23499820e+02   7.25683900e+02   1.89278155e+04
   6.82366441e+03   2.19796336e+03   1.77597396e+04   7.08708854e+03
   1.81467402e+04   3.73597396e+04   3.66607421e+03   1.04521910e+03
   1.05699766e+04   2.17595843e+04   5.24548372e+00   1.95303148e+03
   6.47978361e+03   1.89248122e+04   3.00283546e+04   1.35711786e+04
   1.07875174e+04   2.96846414e+04   1.25945362e+04   2.69873620e+03
   2.68388192e+03   1.01511285e+04   7.11984614e+03   1.48873949e-06
   6.01580268e-07   5.36534599e+03   4.75872354e+03   3.49278976e+04
   1.72423694e+04   8.04782283e+03   2.47823954e+04   1.80649698e+04
   5.96682290e+03   1.22393324e+03   5.92116223e+03   1.29003004e+04
   2.29010491e+03   1.63781124e-07   1.46884155e+03   1.07880127e+04
   3.42547281e+02   4.32463045e+04   2.39727901e+04   8.49644283e+03
   2.36463045e+04   2.63815896e+04   1.18162719e+04   2.52275018e+03
   4.78296679e+03   2.12159497e+04   6.99782977e+03   2.51507433e+03
   3.29602206e+02   1.91028830e+04   3.84664336e+03   2.40147222e+02
   2.68557791e+04   1.31606973e+04   2.34851870e+04   4.64557791e+04
   8.62043818e+03   3.42921894e+03   1.30280637e+04   2.59783949e+04
   2.71048335e+03   2.84969024e+03   7.49873767e+03   2.07244365e+04
   1.18163825e-07   4.20707063e+03   1.04844727e+04   1.87985663e+04
   3.27537988e+04   1.63266543e+04   2.14503752e+04   4.50791854e+04
   1.24476202e+04   4.07374688e+03   1.02081989e+04   2.21631868e+04
   5.41310228e+03   1.87255990e+03   4.89561420e+03   1.56996353e+04
   1.80000000e+03   1.58015225e+03   6.16262546e+03   1.27217945e+04
   4.61358240e-08   3.69444743e+04   1.86394320e+04   1.81312550e+04
   4.09706768e+04   1.59735515e+04   5.02241594e+03   7.17417362e+03
   1.72718768e+04   8.57804608e+03   1.58086361e+03   2.69878548e+03
   1.04200429e+04   4.67520085e+03   5.80408821e-05   2.54712092e+03
   7.10451690e+03   2.58629859e+03   1.71082679e+00   5.17297014e+04
   2.97663781e+04   1.46564190e+04   3.37664767e+04   3.08026977e+04
   1.41432120e+04   5.71017439e+03   1.01193958e+04   2.34310425e+04
   8.06348350e+03   4.08028296e+03   3.29321537e+03   1.95473403e+04
   3.70001197e+03   7.46141491e+02   6.02548312e-07   1.74775256e+04
   1.08217525e+04   5.26763829e+03   3.77518186e+04   2.10343061e+04
   3.06236337e+04   5.73518186e+04   1.53748021e+04   7.61321878e+03
   1.72861507e+04   3.19972054e+04   7.21572121e+03   5.54634900e+03
   1.03176917e+04   2.43240609e+04   2.70000000e+03   5.45541772e+03
   1.19809327e+04   2.02942495e+04  -9.29389898e-08   1.43899115e-08
   2.29739633e+03   1.72077109e+04   4.53454756e+04   2.52930679e+04
   2.72431066e+04   5.39954322e+04   2.09167909e+04   9.02577037e+03
   1.34648989e+04   2.62247785e+04   1.16435568e+04   4.90053130e+03
   7.19290285e+03   1.73532379e+04   6.23357211e+03   2.69884841e+03
   6.60926091e+03   1.22811940e+04   2.64190328e+03   1.63994055e+02
   2.25419746e-04   8.77729107e+03   8.50234451e+02   5.51536607e+04
   3.19436858e+04   2.39573259e+04   4.91006027e+04   2.97793734e+04
   1.34664456e+04   1.08455951e+04   2.02164093e+04   1.99926324e+04
   7.22708929e+03   6.13743427e+03   1.07925345e+04   1.41704865e+04
   2.82390396e+03   3.11453948e+03   5.24013143e+03   1.01678525e+04
   4.75592121e+03   1.41313467e+03   1.94705723e+03   7.96521845e+03
   1.90429514e+03   5.92114146e+04   3.51336248e+04   2.17765400e+04
   4.48840053e+04   3.45508020e+04   1.65225492e+04   9.90629946e+03
   1.68402337e+04   2.51516200e+04   9.54083656e+03   6.51110646e+03
   7.83322208e+03   1.96405446e+04   4.33437739e+03   2.51329378e+03
   2.64336048e+03   1.59480783e+04   9.15570264e+03   4.11090340e+03
   2.13707119e-06   1.40556120e+04   5.83699756e+03   1.35086520e-06
   5.01648519e+04   3.01904806e+04   3.78471409e+04   6.79358943e+04
   2.37455255e+04   1.29981895e+04   2.18631123e+04   3.78210649e+04
   1.33912787e+04   9.25892181e+03   1.37254508e+04   2.77867743e+04
   7.11363019e+03   7.52170702e+03   1.38320594e+04   2.17034989e+04
   2.65681511e+03   1.43899533e+03   3.06720491e+03   1.69701865e+04
   3.32391375e-05   3.69061147e+02   6.39693988e+03   1.24040027e+04
   6.24693047e+04   3.92046147e+04   4.31018881e+04   7.54949898e+04
   3.26325022e+04   1.85264932e+04   2.51685006e+04   4.13557473e+04
   2.04224039e+04   1.29872291e+04   1.64541179e+04   2.93252812e+04
   1.26551753e+04   9.45114352e+03   1.47796688e+04   2.15059528e+04
   6.71310216e+03   3.87202479e+03   4.25719058e+03   1.55139914e+04
   2.57102900e+03   8.78777634e+02   4.78767725e+03   1.00490211e+04
   1.17444560e-04   6.21548711e+04   3.76312590e+04   3.28165317e+04
   6.17004669e+04   3.36929676e+04   1.69241586e+04   1.70532990e+04
   2.91803028e+04   2.22295046e+04   1.02517033e+04   1.05516688e+04
   1.79529263e+04   1.50615552e+04   5.48118339e+03   7.35670586e+03
   1.08320366e+04   9.71702242e+03   4.67312242e+03   2.30027217e+03
   5.98901607e+03   6.17248963e+03   1.01074370e+03   2.31443710e-06
   2.31299590e+03   3.55572349e+03   1.51694721e+03   6.96269666e+04
   4.31943647e+04   3.10626640e+04   5.81832048e+04   4.10763724e+04
   2.13861147e+04   1.62274147e+04   2.55585987e+04   2.95647461e+04
   1.33554815e+04   1.11093951e+04   1.42794172e+04   2.23581390e+04
   7.15564549e+03   6.28864019e+03   7.11347327e+03   1.69750606e+04
   9.87251716e+03   5.16688074e+03   2.69150077e+03   1.33919822e+04
   5.14139841e+03   1.40131772e-06   1.38834980e-06   1.02248638e+04
   6.82396488e+03   6.40795117e+02   7.16272434e+04   4.75845510e+04
   5.53921357e+04   9.12272434e+04   3.92124391e+04   2.52213069e+04
   3.50737968e+04   5.40521510e+04   2.56023636e+04   1.95497089e+04
   2.46174472e+04   4.05158532e+04   1.67114578e+04   1.59486414e+04
   2.30754842e+04   3.13869186e+04   9.64896771e+03   7.46772268e+03
   9.06493387e+03   2.40215091e+04   4.38647765e+03   3.97565854e+03
   1.00946249e+04   1.69367429e+04   1.02865084e+03   2.85278368e-05
   5.04966281e+03   1.21757360e+04   7.06092137e+04   4.48546435e+04
   4.33351237e+04   7.59193861e+04   3.91348329e+04   2.20000531e+04
   2.49577027e+04   3.98517347e+04   2.60354519e+04   1.49415080e+04
   1.66673562e+04   2.68647458e+04   1.75544499e+04   9.85104116e+03
   1.33484376e+04   1.82135395e+04   1.09006742e+04   6.27192486e+03
   4.90938037e+03   1.18456745e+04   6.04689853e+03   1.84685529e+03
   2.69935266e+03   6.45474039e+03   2.42125870e+03   3.33769785e-04
   1.37283175e-05   3.12880448e+03   1.75098335e+03   7.68873819e+04
   4.91411428e+04   4.01810746e+04   7.10422739e+04   4.52491715e+04
   2.51030326e+04   2.26943235e+04   3.47816970e+04   3.20608233e+04
   1.66393004e+04   1.57828345e+04   2.16990139e+04   2.35084125e+04
   1.00721298e+04   1.07900115e+04   1.29645834e+04   1.67834354e+04
   1.00489233e+04   6.31322313e+03   6.99266449e+03   1.18584582e+04
   4.50705185e+03   1.15920489e+03   2.57220078e+03   7.64285234e+03
   3.81243972e+03   1.40747932e-06   2.30905277e-06   7.38997878e+03
   6.88656726e+02   8.04489575e+04   5.19247124e+04   3.41982602e+04
   6.08489575e+04   5.09078478e+04   2.84754362e+04   1.94086725e+04
   2.70579223e+04   3.88583247e+04   1.91047005e+04   1.49962534e+04
   1.52001728e+04   3.12199802e+04   1.15206776e+04   8.67357872e+03
   7.53105419e+03   2.54064172e+04   1.65750223e+04   1.00735037e+04
   3.02740790e+03   2.13928541e+04   1.06506745e+04   2.35177388e+03
   7.04331088e+02   1.74250329e+04   1.26815687e+04   3.83653977e+03
   1.86454477e-04   1.91332830e+04   7.21085294e+03   1.74397096e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.18954954e+03   1.65966552e+04   7.90187097e+03   1.87000000e+04
   1.52108883e+04   3.57386615e+03   3.86485441e+03   2.22685946e-06
   1.27155487e+04   2.34648544e+04   1.29477803e+04   3.05101162e+03
   7.92354990e+03   2.23230580e+04   2.26869582e+03   2.21351926e+04
   9.19636706e+03   1.56353528e+03   1.26426219e+04   1.16265776e+04
   3.64228623e+03   2.53076005e+04   1.36289964e+04   2.13528515e-05
   5.70760046e+03   1.88502886e+04   1.07439065e+04   1.26421490e+03
   1.04450958e+04   2.80367045e+03   1.46006235e+04   3.00450958e+04
   5.05157839e+02   4.62146411e+02   9.91260120e+03   1.93363618e+04
   2.06279850e+04   7.43978818e+03   8.56154339e+03   2.52721358e+04
   6.52663159e+03   3.49010577e-05   2.32630593e+03   9.66292713e+03
   2.86162793e+03   2.45978832e+04   1.00893015e+04   5.22080626e+03
   2.01507029e+04   1.07779228e+04   2.05459141e+03   4.91564265e-07
   4.87286213e+03   7.26572889e+03   1.58393010e+02   3.34882427e+04
   1.77475149e+04   3.13046635e+03   1.38882427e+04   2.14645506e+04
   9.90361883e+03   5.23499820e+02   7.25683900e+02   1.89278155e+04
   6.82366441e+03   2.19796336e+03   1.77597396e+04   7.08708854e+03
   1.81467402e+04   3.73597396e+04   3.66607421e+03   1.04521910e+03
   1.05699766e+04   2.17595843e+04   5.24548372e+00   1.95303148e+03
   6.47978361e+03   1.89248122e+04   3.00283546e+04   1.35711786e+04
   1.07875174e+04   2.96846414e+04   1.25945362e+04   2.69873620e+03
   2.68388192e+03   1.01511285e+04   7.11984614e+03   1.48873949e-06
   6.01580268e-07   5.36534599e+03   4.75872354e+03   3.49278976e+04
   1.72423694e+04   8.04782283e+03   2.47823954e+04   1.80649698e+04
   5.96682290e+03   1.22393324e+03   5.92116223e+03   1.29003004e+04
   2.29010491e+03   1.63781124e-07   1.46884155e+03   1.07880127e+04
   3.42547281e+02   4.32463045e+04   2.39727901e+04   8.49644283e+03
   2.36463045e+04   2.63815896e+04   1.18162719e+04   2.52275018e+03
   4.78296679e+03   2.12159497e+04   6.99782977e+03   2.51507433e+03
   3.29602206e+02   1.91028830e+04   3.84664336e+03   2.40147222e+02
   2.68557791e+04   1.31606973e+04   2.34851870e+04   4.64557791e+04
   8.62043818e+03   3.42921894e+03   1.30280637e+04   2.59783949e+04
   2.71048335e+03   2.84969024e+03   7.49873767e+03   2.07244365e+04
   1.18163825e-07   4.20707063e+03   1.04844727e+04   1.87985663e+04
   3.27537988e+04   1.63266543e+04   2.14503752e+04   4.50791854e+04
   1.24476202e+04   4.07374688e+03   1.02081989e+04   2.21631868e+04
   5.41310228e+03   1.87255990e+03   4.89561420e+03   1.56996353e+04
   1.80000000e+03   1.58015225e+03   6.16262546e+03   1.27217945e+04
   4.61358240e-08   3.69444743e+04   1.86394320e+04   1.81312550e+04
   4.09706768e+04   1.59735515e+04   5.02241594e+03   7.17417362e+03
   1.72718768e+04   8.57804608e+03   1.58086361e+03   2.69878548e+03
   1.04200429e+04   4.67520085e+03   5.80408821e-05   2.54712092e+03
   7.10451690e+03   2.58629859e+03   1.71082679e+00   5.17297014e+04
   2.97663781e+04   1.46564190e+04   3.37664767e+04   3.08026977e+04
   1.41432120e+04   5.71017439e+03   1.01193958e+04   2.34310425e+04
   8.06348350e+03   4.08028296e+03   3.29321537e+03   1.95473403e+04
   3.70001197e+03   7.46141491e+02   6.02548312e-07   1.74775256e+04
   1.08217525e+04   5.26763829e+03   3.77518186e+04   2.10343061e+04
   3.06236337e+04   5.73518186e+04   1.53748021e+04   7.61321878e+03
   1.72861507e+04   3.19972054e+04   7.21572121e+03   5.54634900e+03
   1.03176917e+04   2.43240609e+04   2.70000000e+03   5.45541772e+03
   1.19809327e+04   2.02942495e+04  -9.29389898e-08   1.43899115e-08
   2.29739633e+03   1.72077109e+04   4.53454756e+04   2.52930679e+04
   2.72431066e+04   5.39954322e+04   2.09167909e+04   9.02577037e+03
   1.34648989e+04   2.62247785e+04   1.16435568e+04   4.90053130e+03
   7.19290285e+03   1.73532379e+04   6.23357211e+03   2.69884841e+03
   6.60926091e+03   1.22811940e+04   2.64190328e+03   1.63994055e+02
   2.25419746e-04   8.77729107e+03   8.50234451e+02   5.51536607e+04
   3.19436858e+04   2.39573259e+04   4.91006027e+04   2.97793734e+04
   1.34664456e+04   1.08455951e+04   2.02164093e+04   1.99926324e+04
   7.22708929e+03   6.13743427e+03   1.07925345e+04   1.41704865e+04
   2.82390396e+03   3.11453948e+03   5.24013143e+03   1.01678525e+04
   4.75592121e+03   1.41313467e+03   1.94705723e+03   7.96521845e+03
   1.90429514e+03   5.92114146e+04   3.51336248e+04   2.17765400e+04
   4.48840053e+04   3.45508020e+04   1.65225492e+04   9.90629946e+03
   1.68402337e+04   2.51516200e+04   9.54083656e+03   6.51110646e+03
   7.83322208e+03   1.96405446e+04   4.33437739e+03   2.51329378e+03
   2.64336048e+03   1.59480783e+04   9.15570264e+03   4.11090340e+03
   2.13707119e-06   1.40556120e+04   5.83699756e+03   1.35086520e-06
   5.01648519e+04   3.01904806e+04   3.78471409e+04   6.79358943e+04
   2.37455255e+04   1.29981895e+04   2.18631123e+04   3.78210649e+04
   1.33912787e+04   9.25892181e+03   1.37254508e+04   2.77867743e+04
   7.11363019e+03   7.52170702e+03   1.38320594e+04   2.17034989e+04
   2.65681511e+03   1.43899533e+03   3.06720491e+03   1.69701865e+04
   3.32391375e-05   3.69061147e+02   6.39693988e+03   1.24040027e+04
   6.24693047e+04   3.92046147e+04   4.31018881e+04   7.54949898e+04
   3.26325022e+04   1.85264932e+04   2.51685006e+04   4.13557473e+04
   2.04224039e+04   1.29872291e+04   1.64541179e+04   2.93252812e+04
   1.26551753e+04   9.45114352e+03   1.47796688e+04   2.15059528e+04
   6.71310216e+03   3.87202479e+03   4.25719058e+03   1.55139914e+04
   2.57102900e+03   8.78777634e+02   4.78767725e+03   1.00490211e+04
   1.17444560e-04   6.21548711e+04   3.76312590e+04   3.28165317e+04
   6.17004669e+04   3.36929676e+04   1.69241586e+04   1.70532990e+04
   2.91803028e+04   2.22295046e+04   1.02517033e+04   1.05516688e+04
   1.79529263e+04   1.50615552e+04   5.48118339e+03   7.35670586e+03
   1.08320366e+04   9.71702242e+03   4.67312242e+03   2.30027217e+03
   5.98901607e+03   6.17248963e+03   1.01074370e+03   2.31443710e-06
   2.31299590e+03   3.55572349e+03   1.51694721e+03   6.96269666e+04
   4.31943647e+04   3.10626640e+04   5.81832048e+04   4.10763724e+04
   2.13861147e+04   1.62274147e+04   2.55585987e+04   2.95647461e+04
   1.33554815e+04   1.11093951e+04   1.42794172e+04   2.23581390e+04
   7.15564549e+03   6.28864019e+03   7.11347327e+03   1.69750606e+04
   9.87251716e+03   5.16688074e+03   2.69150077e+03   1.33919822e+04
   5.14139841e+03   1.40131772e-06   1.38834980e-06   1.02248638e+04
   6.82396488e+03   6.40795117e+02   7.16272434e+04   4.75845510e+04
   5.53921357e+04   9.12272434e+04   3.92124391e+04   2.52213069e+04
   3.50737968e+04   5.40521510e+04   2.56023636e+04   1.95497089e+04
   2.46174472e+04   4.05158532e+04   1.67114578e+04   1.59486414e+04
   2.30754842e+04   3.13869186e+04   9.64896771e+03   7.46772268e+03
   9.06493387e+03   2.40215091e+04   4.38647765e+03   3.97565854e+03
   1.00946249e+04   1.69367429e+04   1.02865084e+03   2.85278368e-05
   5.04966281e+03   1.21757360e+04   7.06092137e+04   4.48546435e+04
   4.33351237e+04   7.59193861e+04   3.91348329e+04   2.20000531e+04
   2.49577027e+04   3.98517347e+04   2.60354519e+04   1.49415080e+04
   1.66673562e+04   2.68647458e+04   1.75544499e+04   9.85104116e+03
   1.33484376e+04   1.82135395e+04   1.09006742e+04   6.27192486e+03
   4.90938037e+03   1.18456745e+04   6.04689853e+03   1.84685529e+03
   2.69935266e+03   6.45474039e+03   2.42125870e+03   3.33769785e-04
   1.37283175e-05   3.12880448e+03   1.75098335e+03   7.68873819e+04
   4.91411428e+04   4.01810746e+04   7.10422739e+04   4.52491715e+04
   2.51030326e+04   2.26943235e+04   3.47816970e+04   3.20608233e+04
   1.66393004e+04   1.57828345e+04   2.16990139e+04   2.35084125e+04
   1.00721298e+04   1.07900115e+04   1.29645834e+04   1.67834354e+04
   1.00489233e+04   6.31322313e+03   6.99266449e+03   1.18584582e+04
   4.50705185e+03   1.15920489e+03   2.57220078e+03   7.64285234e+03
   3.81243972e+03   1.40747932e-06   2.30905277e-06   7.38997878e+03
   6.88656726e+02   8.04489575e+04   5.19247124e+04   3.41982602e+04
   6.08489575e+04   5.09078478e+04   2.84754362e+04   1.94086725e+04
   2.70579223e+04   3.88583247e+04   1.91047005e+04   1.49962534e+04
   1.52001728e+04   3.12199802e+04   1.15206776e+04   8.67357872e+03
   7.53105419e+03   2.54064172e+04   1.65750223e+04   1.00735037e+04
   3.02740790e+03   2.13928541e+04   1.06506745e+04   2.35177388e+03
   7.04331088e+02   1.74250329e+04   1.26815687e+04   3.83653977e+03
   1.86454477e-04   1.91332830e+04   7.21085294e+03   1.74397096e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.32450699806 s
|dj| = 12419.8433365
Runtime: 5.32000017166 s
|dj| = 12419.8433365
Start evaluation of j
   54    96    -3.106827E+04     2.775415E+02
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.766e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 4.559e-06 (tol = 1.000e-10) r (rel) = 1.648e-04 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 1.870e-12 (tol = 1.000e-10) r (rel) = 6.760e-11 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 14.813111 s.
j = 1.390289e+06.
Runtime: 14.813434 s.
j = 1.390289e+06.
Minimum distance inequality constraints (should all be > 0): [  2.19008730e+03   1.65963947e+04   7.90177681e+03   1.87000000e+04
   1.52112637e+04   3.57322925e+03   3.86545307e+03   8.59815373e-07
   1.27159762e+04   2.34654531e+04   1.29495894e+04   3.05138479e+03
   7.92524405e+03   2.23252045e+04   2.26896279e+03   2.21364197e+04
   9.19629181e+03   1.56463767e+03   1.26440822e+04   1.16265703e+04
   3.64234167e+03   2.53071308e+04   1.36283694e+04   4.81735060e-06
   5.70713076e+03   1.88501114e+04   1.07448513e+04   1.26481608e+03
   1.04448568e+04   2.80300287e+03   1.46012403e+04   3.00448568e+04
   5.04748664e+02   4.62161322e+02   9.91248955e+03   1.93364509e+04
   2.06300473e+04   7.44017828e+03   8.56343799e+03   2.52740907e+04
   6.52708638e+03   3.89354545e-06   2.32623866e+03   9.66399972e+03
   2.86218248e+03   2.46000328e+04   1.00897334e+04   5.22258431e+03
   2.01526449e+04   1.07784666e+04   2.05473954e+03   4.00853878e-06
   4.87389124e+03   7.26634161e+03   1.58415793e+02   3.34871103e+04
   1.77459947e+04   3.13039433e+03   1.38871103e+04   2.14636051e+04
   9.90361248e+03   5.23318989e+02   7.25541430e+02   1.89277088e+04
   6.82396086e+03   2.19819983e+03   1.77592500e+04   7.08593295e+03
   1.81474661e+04   3.73592500e+04   3.66524600e+03   1.04462313e+03
   1.05693819e+04   2.17597057e+04   5.20514482e+00   1.95307358e+03
   6.47987422e+03   1.89248981e+04   3.00307814e+04   1.35716697e+04
   1.07899405e+04   2.96869423e+04   1.25951528e+04   2.69874027e+03
   2.68390038e+03   1.01526945e+04   7.12082964e+03   1.29427235e-07
   2.07932544e-07   5.36622508e+03   4.75922988e+03   3.49303545e+04
   1.72428940e+04   8.04997286e+03   2.47844478e+04   1.80657194e+04
   5.96704744e+03   1.22399301e+03   5.92253467e+03   1.29014081e+04
   2.29019563e+03   9.27219048e-07   1.46955158e+03   1.07886669e+04
   3.42620977e+02   4.32468804e+04   2.39719684e+04   8.49758704e+03
   2.36468804e+04   2.63811517e+04   1.18159262e+04   2.52239690e+03
   4.78367953e+03   2.12162466e+04   6.99754087e+03   2.51474386e+03
   3.30057677e+02   1.91030287e+04   3.84662700e+03   2.40049558e+02
   2.68551819e+04   1.31591302e+04   2.34860801e+04   4.64551819e+04
   8.61924225e+03   3.42800669e+03   1.30269817e+04   2.59785820e+04
   2.71040278e+03   2.84918106e+03   7.49827009e+03   2.07246942e+04
  -2.58776254e-07   4.20702861e+03   1.04846077e+04   1.87984942e+04
   3.27531479e+04   1.63248513e+04   2.14512821e+04   4.50785345e+04
   1.24462404e+04   4.07228910e+03   1.02069166e+04   2.21634068e+04
   5.41300161e+03   1.87175515e+03   4.89482899e+03   1.56999789e+04
   1.80000000e+03   1.57981270e+03   6.16242573e+03   1.27216135e+04
  -1.01010073e-07   3.69478552e+04   1.86404461e+04   1.81343678e+04
   4.09734419e+04   1.59747530e+04   5.02253598e+03   7.17419671e+03
   1.72738819e+04   8.57981433e+03   1.58097276e+03   2.69879062e+03
   1.04213657e+04   4.67646223e+03   4.23939036e-06   2.54713680e+03
   7.10453687e+03   2.58694772e+03   1.93956581e+00   5.17296804e+04
   2.97648062e+04   1.46577830e+04   3.37670326e+04   3.08014642e+04
   1.41419984e+04   5.70936073e+03   1.01203250e+04   2.34308957e+04
   8.06249890e+03   4.07938630e+03   3.29402431e+03   1.95471065e+04
   3.69939669e+03   7.45625951e+02   4.56854195e-06   1.74770985e+04
   1.08213358e+04   5.26697382e+03   3.77511138e+04   2.10323274e+04
   3.06246941e+04   5.73511138e+04   1.53732385e+04   7.61139026e+03
   1.72845815e+04   3.19974584e+04   7.21560043e+03   5.54528854e+03
   1.03166660e+04   2.43244904e+04   2.70000000e+03   5.45482733e+03
   1.19805484e+04   2.02939597e+04   2.03466470e-07  -3.19663513e-08
   2.29743321e+03   1.72070905e+04   4.53467738e+04   2.52925369e+04
   2.72465585e+04   5.39980198e+04   2.09163125e+04   9.02484491e+03
   1.34649024e+04   2.62274809e+04   1.16442552e+04   4.90015427e+03
   7.19285141e+03   1.73557086e+04   6.23406742e+03   2.69882599e+03
   6.60975085e+03   1.22823515e+04   2.64205578e+03   1.64214435e+02
   6.62855582e-05   8.77790131e+03   8.50044143e+02   5.51545734e+04
   3.19426072e+04   2.39594762e+04   4.91015248e+04   2.97787009e+04
   1.34652176e+04   1.08446659e+04   2.02177811e+04   1.99933476e+04
   7.22619335e+03   6.13652048e+03   1.07938454e+04   1.41711172e+04
   2.82328123e+03   3.11399615e+03   5.24016756e+03   1.01682493e+04
   4.75620290e+03   1.41257161e+03   1.94692840e+03   7.96538149e+03
   1.90475036e+03   5.92124555e+04   3.51326572e+04   2.17786379e+04
   4.48850398e+04   3.45502577e+04   1.65215316e+04   9.90552965e+03
   1.68416353e+04   2.51523828e+04   9.54002793e+03   6.51025765e+03
   7.83451828e+03   1.96411963e+04   4.33381991e+03   2.51275057e+03
   2.64342634e+03   1.59484768e+04   9.15597331e+03   4.11029834e+03
   5.34271521e-06   1.40557572e+04   5.83775213e+03   3.60516083e-07
   5.01640205e+04   3.01880650e+04   3.78482751e+04   6.79349942e+04
   2.37435889e+04   1.29957480e+04   2.18610181e+04   3.78213007e+04
   1.33911086e+04   9.25728544e+03   1.37238216e+04   2.77872945e+04
   7.11362353e+03   7.52053664e+03   1.38310929e+04   2.17029233e+04
   2.65681176e+03   1.43898090e+03   3.06658707e+03   1.69693375e+04
  -1.39256599e-07   3.68578851e+02   6.39683260e+03   1.24038428e+04
   6.24681632e+04   3.92016354e+04   4.31027816e+04   7.54935662e+04
   3.26301131e+04   1.85234242e+04   2.51657688e+04   4.13556879e+04
   2.04220909e+04   1.29849654e+04   1.64517918e+04   2.93256360e+04
   1.26550905e+04   9.44934407e+03   1.47780058e+04   2.15049270e+04
   6.71305209e+03   3.87193976e+03   4.25588230e+03   1.55128219e+04
   2.57101369e+03   8.78109269e+02   4.78724603e+03   1.00484688e+04
   6.36511345e-07   6.21551490e+04   3.76295167e+04   3.28187450e+04
   6.17011107e+04   3.36916235e+04   1.69222161e+04   1.70519351e+04
   2.91817106e+04   2.22298777e+04   1.02503043e+04   1.05503390e+04
   1.79544440e+04   1.50619422e+04   5.48016263e+03   7.35590574e+03
   1.08320689e+04   9.71724392e+03   4.67332906e+03   2.29935204e+03
   5.98887140e+03   6.17254561e+03   1.01078555e+03   2.72858506e-06
   2.31304714e+03   3.55560472e+03   1.51665792e+03   6.96280209e+04
   4.31931627e+04   3.10651471e+04   5.81843392e+04   4.10756127e+04
   2.13846556e+04   1.62263737e+04   2.55602813e+04   2.95656095e+04
   1.33543412e+04   1.11082352e+04   1.42811032e+04   2.23589359e+04
   7.15477692e+03   6.28785446e+03   7.11357083e+03   1.69756110e+04
   9.87295924e+03   5.16593679e+03   2.69151614e+03   1.33922861e+04
   5.14192243e+03   2.49768163e-07   2.77669415e-07   1.02248815e+04
   6.82365150e+03   6.40876972e+02   7.16252834e+04   4.75807663e+04
   5.53928383e+04   9.12252834e+04   3.92092446e+04   2.52174033e+04
   3.50704609e+04   5.40518691e+04   2.56015441e+04   1.95468225e+04
   2.46145712e+04   4.05161536e+04   1.67109677e+04   1.59463212e+04
   2.30734255e+04   3.13856848e+04   9.64858839e+03   7.46739876e+03
   9.06318082e+03   2.40201131e+04   4.38620912e+03   3.97442378e+03
   1.00940330e+04   1.69360669e+04   1.02849845e+03   2.41475482e-06
   5.04921192e+03   1.21753393e+04   7.06099576e+04   4.48530819e+04
   4.33378408e+04   7.59203224e+04   3.91336849e+04   2.19979809e+04
   2.49562363e+04   3.98534660e+04   2.60362155e+04   1.49400421e+04
   1.66659315e+04   2.68666170e+04   1.75552215e+04   9.84990807e+03
   1.33475487e+04   1.82136010e+04   1.09012452e+04   6.27243128e+03
   4.90836288e+03   1.18454649e+04   6.04726896e+03   1.84670681e+03
   2.69935674e+03   6.45475332e+03   2.42142458e+03   1.81447773e-05
   5.70594693e-07   3.12882006e+03   1.75084253e+03   7.68877195e+04
   4.91391953e+04   4.01835390e+04   7.10430481e+04   4.52476584e+04
   2.51007771e+04   2.26927659e+04   3.47833337e+04   3.20612627e+04
   1.66375752e+04   1.57811768e+04   2.17008247e+04   2.35088840e+04
   1.00707814e+04   1.07888871e+04   1.29645952e+04   1.67837286e+04
   1.00492084e+04   6.31184024e+03   6.99258217e+03   1.18585733e+04
   4.50708065e+03   1.15912303e+03   2.57217017e+03   7.64277667e+03
   3.81218642e+03   2.36100277e-07   2.74071442e-06   7.38964122e+03
   6.88586354e+02   8.04495245e+04   5.19230216e+04   3.42003241e+04
   6.08495245e+04   5.09067010e+04   2.84736805e+04   1.94073025e+04
   2.70592701e+04   3.88589673e+04   1.91032351e+04   1.49947224e+04
   1.52016439e+04   3.12206367e+04   1.15195273e+04   8.67243048e+03
   7.53092620e+03   2.54068976e+04   1.65754147e+04   1.00722299e+04
   3.02739609e+03   2.13931586e+04   1.06513979e+04   2.35171898e+03
   7.04239171e+02   1.74251026e+04   1.26813189e+04   3.83672122e+03
   1.26419684e-06   1.91330840e+04   7.21098668e+03   1.74412527e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.19008730e+03   1.65963947e+04   7.90177681e+03   1.87000000e+04
   1.52112637e+04   3.57322925e+03   3.86545307e+03   8.59815373e-07
   1.27159762e+04   2.34654531e+04   1.29495894e+04   3.05138479e+03
   7.92524405e+03   2.23252045e+04   2.26896279e+03   2.21364197e+04
   9.19629181e+03   1.56463767e+03   1.26440822e+04   1.16265703e+04
   3.64234167e+03   2.53071308e+04   1.36283694e+04   4.81735060e-06
   5.70713076e+03   1.88501114e+04   1.07448513e+04   1.26481608e+03
   1.04448568e+04   2.80300287e+03   1.46012403e+04   3.00448568e+04
   5.04748664e+02   4.62161322e+02   9.91248955e+03   1.93364509e+04
   2.06300473e+04   7.44017828e+03   8.56343799e+03   2.52740907e+04
   6.52708638e+03   3.89354545e-06   2.32623866e+03   9.66399972e+03
   2.86218248e+03   2.46000328e+04   1.00897334e+04   5.22258431e+03
   2.01526449e+04   1.07784666e+04   2.05473954e+03   4.00853878e-06
   4.87389124e+03   7.26634161e+03   1.58415793e+02   3.34871103e+04
   1.77459947e+04   3.13039433e+03   1.38871103e+04   2.14636051e+04
   9.90361248e+03   5.23318989e+02   7.25541430e+02   1.89277088e+04
   6.82396086e+03   2.19819983e+03   1.77592500e+04   7.08593295e+03
   1.81474661e+04   3.73592500e+04   3.66524600e+03   1.04462313e+03
   1.05693819e+04   2.17597057e+04   5.20514482e+00   1.95307358e+03
   6.47987422e+03   1.89248981e+04   3.00307814e+04   1.35716697e+04
   1.07899405e+04   2.96869423e+04   1.25951528e+04   2.69874027e+03
   2.68390038e+03   1.01526945e+04   7.12082964e+03   1.29427235e-07
   2.07932544e-07   5.36622508e+03   4.75922988e+03   3.49303545e+04
   1.72428940e+04   8.04997286e+03   2.47844478e+04   1.80657194e+04
   5.96704744e+03   1.22399301e+03   5.92253467e+03   1.29014081e+04
   2.29019563e+03   9.27219048e-07   1.46955158e+03   1.07886669e+04
   3.42620977e+02   4.32468804e+04   2.39719684e+04   8.49758704e+03
   2.36468804e+04   2.63811517e+04   1.18159262e+04   2.52239690e+03
   4.78367953e+03   2.12162466e+04   6.99754087e+03   2.51474386e+03
   3.30057677e+02   1.91030287e+04   3.84662700e+03   2.40049558e+02
   2.68551819e+04   1.31591302e+04   2.34860801e+04   4.64551819e+04
   8.61924225e+03   3.42800669e+03   1.30269817e+04   2.59785820e+04
   2.71040278e+03   2.84918106e+03   7.49827009e+03   2.07246942e+04
  -2.58776254e-07   4.20702861e+03   1.04846077e+04   1.87984942e+04
   3.27531479e+04   1.63248513e+04   2.14512821e+04   4.50785345e+04
   1.24462404e+04   4.07228910e+03   1.02069166e+04   2.21634068e+04
   5.41300161e+03   1.87175515e+03   4.89482899e+03   1.56999789e+04
   1.80000000e+03   1.57981270e+03   6.16242573e+03   1.27216135e+04
  -1.01010073e-07   3.69478552e+04   1.86404461e+04   1.81343678e+04
   4.09734419e+04   1.59747530e+04   5.02253598e+03   7.17419671e+03
   1.72738819e+04   8.57981433e+03   1.58097276e+03   2.69879062e+03
   1.04213657e+04   4.67646223e+03   4.23939036e-06   2.54713680e+03
   7.10453687e+03   2.58694772e+03   1.93956581e+00   5.17296804e+04
   2.97648062e+04   1.46577830e+04   3.37670326e+04   3.08014642e+04
   1.41419984e+04   5.70936073e+03   1.01203250e+04   2.34308957e+04
   8.06249890e+03   4.07938630e+03   3.29402431e+03   1.95471065e+04
   3.69939669e+03   7.45625951e+02   4.56854195e-06   1.74770985e+04
   1.08213358e+04   5.26697382e+03   3.77511138e+04   2.10323274e+04
   3.06246941e+04   5.73511138e+04   1.53732385e+04   7.61139026e+03
   1.72845815e+04   3.19974584e+04   7.21560043e+03   5.54528854e+03
   1.03166660e+04   2.43244904e+04   2.70000000e+03   5.45482733e+03
   1.19805484e+04   2.02939597e+04   2.03466470e-07  -3.19663513e-08
   2.29743321e+03   1.72070905e+04   4.53467738e+04   2.52925369e+04
   2.72465585e+04   5.39980198e+04   2.09163125e+04   9.02484491e+03
   1.34649024e+04   2.62274809e+04   1.16442552e+04   4.90015427e+03
   7.19285141e+03   1.73557086e+04   6.23406742e+03   2.69882599e+03
   6.60975085e+03   1.22823515e+04   2.64205578e+03   1.64214435e+02
   6.62855582e-05   8.77790131e+03   8.50044143e+02   5.51545734e+04
   3.19426072e+04   2.39594762e+04   4.91015248e+04   2.97787009e+04
   1.34652176e+04   1.08446659e+04   2.02177811e+04   1.99933476e+04
   7.22619335e+03   6.13652048e+03   1.07938454e+04   1.41711172e+04
   2.82328123e+03   3.11399615e+03   5.24016756e+03   1.01682493e+04
   4.75620290e+03   1.41257161e+03   1.94692840e+03   7.96538149e+03
   1.90475036e+03   5.92124555e+04   3.51326572e+04   2.17786379e+04
   4.48850398e+04   3.45502577e+04   1.65215316e+04   9.90552965e+03
   1.68416353e+04   2.51523828e+04   9.54002793e+03   6.51025765e+03
   7.83451828e+03   1.96411963e+04   4.33381991e+03   2.51275057e+03
   2.64342634e+03   1.59484768e+04   9.15597331e+03   4.11029834e+03
   5.34271521e-06   1.40557572e+04   5.83775213e+03   3.60516083e-07
   5.01640205e+04   3.01880650e+04   3.78482751e+04   6.79349942e+04
   2.37435889e+04   1.29957480e+04   2.18610181e+04   3.78213007e+04
   1.33911086e+04   9.25728544e+03   1.37238216e+04   2.77872945e+04
   7.11362353e+03   7.52053664e+03   1.38310929e+04   2.17029233e+04
   2.65681176e+03   1.43898090e+03   3.06658707e+03   1.69693375e+04
  -1.39256599e-07   3.68578851e+02   6.39683260e+03   1.24038428e+04
   6.24681632e+04   3.92016354e+04   4.31027816e+04   7.54935662e+04
   3.26301131e+04   1.85234242e+04   2.51657688e+04   4.13556879e+04
   2.04220909e+04   1.29849654e+04   1.64517918e+04   2.93256360e+04
   1.26550905e+04   9.44934407e+03   1.47780058e+04   2.15049270e+04
   6.71305209e+03   3.87193976e+03   4.25588230e+03   1.55128219e+04
   2.57101369e+03   8.78109269e+02   4.78724603e+03   1.00484688e+04
   6.36511345e-07   6.21551490e+04   3.76295167e+04   3.28187450e+04
   6.17011107e+04   3.36916235e+04   1.69222161e+04   1.70519351e+04
   2.91817106e+04   2.22298777e+04   1.02503043e+04   1.05503390e+04
   1.79544440e+04   1.50619422e+04   5.48016263e+03   7.35590574e+03
   1.08320689e+04   9.71724392e+03   4.67332906e+03   2.29935204e+03
   5.98887140e+03   6.17254561e+03   1.01078555e+03   2.72858506e-06
   2.31304714e+03   3.55560472e+03   1.51665792e+03   6.96280209e+04
   4.31931627e+04   3.10651471e+04   5.81843392e+04   4.10756127e+04
   2.13846556e+04   1.62263737e+04   2.55602813e+04   2.95656095e+04
   1.33543412e+04   1.11082352e+04   1.42811032e+04   2.23589359e+04
   7.15477692e+03   6.28785446e+03   7.11357083e+03   1.69756110e+04
   9.87295924e+03   5.16593679e+03   2.69151614e+03   1.33922861e+04
   5.14192243e+03   2.49768163e-07   2.77669415e-07   1.02248815e+04
   6.82365150e+03   6.40876972e+02   7.16252834e+04   4.75807663e+04
   5.53928383e+04   9.12252834e+04   3.92092446e+04   2.52174033e+04
   3.50704609e+04   5.40518691e+04   2.56015441e+04   1.95468225e+04
   2.46145712e+04   4.05161536e+04   1.67109677e+04   1.59463212e+04
   2.30734255e+04   3.13856848e+04   9.64858839e+03   7.46739876e+03
   9.06318082e+03   2.40201131e+04   4.38620912e+03   3.97442378e+03
   1.00940330e+04   1.69360669e+04   1.02849845e+03   2.41475482e-06
   5.04921192e+03   1.21753393e+04   7.06099576e+04   4.48530819e+04
   4.33378408e+04   7.59203224e+04   3.91336849e+04   2.19979809e+04
   2.49562363e+04   3.98534660e+04   2.60362155e+04   1.49400421e+04
   1.66659315e+04   2.68666170e+04   1.75552215e+04   9.84990807e+03
   1.33475487e+04   1.82136010e+04   1.09012452e+04   6.27243128e+03
   4.90836288e+03   1.18454649e+04   6.04726896e+03   1.84670681e+03
   2.69935674e+03   6.45475332e+03   2.42142458e+03   1.81447773e-05
   5.70594693e-07   3.12882006e+03   1.75084253e+03   7.68877195e+04
   4.91391953e+04   4.01835390e+04   7.10430481e+04   4.52476584e+04
   2.51007771e+04   2.26927659e+04   3.47833337e+04   3.20612627e+04
   1.66375752e+04   1.57811768e+04   2.17008247e+04   2.35088840e+04
   1.00707814e+04   1.07888871e+04   1.29645952e+04   1.67837286e+04
   1.00492084e+04   6.31184024e+03   6.99258217e+03   1.18585733e+04
   4.50708065e+03   1.15912303e+03   2.57217017e+03   7.64277667e+03
   3.81218642e+03   2.36100277e-07   2.74071442e-06   7.38964122e+03
   6.88586354e+02   8.04495245e+04   5.19230216e+04   3.42003241e+04
   6.08495245e+04   5.09067010e+04   2.84736805e+04   1.94073025e+04
   2.70592701e+04   3.88589673e+04   1.91032351e+04   1.49947224e+04
   1.52016439e+04   3.12206367e+04   1.15195273e+04   8.67243048e+03
   7.53092620e+03   2.54068976e+04   1.65754147e+04   1.00722299e+04
   3.02739609e+03   2.13931586e+04   1.06513979e+04   2.35171898e+03
   7.04239171e+02   1.74251026e+04   1.26813189e+04   3.83672122e+03
   1.26419684e-06   1.91330840e+04   7.21098668e+03   1.74412527e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 7.30263209343 s
Runtime: 7.29930210114 s
|dj| = 12419.9512846
|dj| = 12419.9512846
   55    97    -3.106827E+04     2.775440E+02
Start evaluation of j
Start evaluation of j
Updating the turbine cache
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 1.089e-02 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 6.914e-07 (tol = 1.000e-10) r (rel) = 6.351e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 4.384e-13 (tol = 1.000e-10) r (rel) = 4.027e-11 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 12.549887 s.
j = 1.390289e+06.
Runtime: 12.550175 s.
j = 1.390289e+06.
Minimum distance inequality constraints (should all be > 0): [  2.18960558e+03   1.65966337e+04   7.90193208e+03   1.87000000e+04
   1.52109664e+04   3.57371457e+03   3.86494997e+03   1.11381325e-06
   1.27156790e+04   2.34649500e+04   1.29490474e+04   3.05165196e+03
   7.92448396e+03   2.23246165e+04   2.26907486e+03   2.21363849e+04
   9.19696613e+03   1.56414333e+03   1.26437644e+04   1.16269914e+04
   3.64245238e+03   2.53075270e+04   1.36289501e+04   2.12956547e-06
   5.70752696e+03   1.88502605e+04   1.07445168e+04   1.26453509e+03
   1.04445869e+04   2.80333191e+03   1.46006129e+04   3.00445869e+04
   5.04926825e+02   4.62160335e+02   9.91270088e+03   1.93362640e+04
   2.06293472e+04   7.44054258e+03   8.56229792e+03   2.52732008e+04
   6.52726940e+03   5.56732061e-07   2.32618271e+03   9.66329933e+03
   2.86216090e+03   2.45994939e+04   1.00902305e+04   5.22174670e+03
   2.01521334e+04   1.07786735e+04   2.05473811e+03   2.03393915e-06
   4.87343498e+03   7.26628703e+03   1.58361787e+02   3.34878061e+04
   1.77471930e+04   3.13035500e+03   1.38878061e+04   2.14642890e+04
   9.90368239e+03   5.23333035e+02   7.25575603e+02   1.89278335e+04
   6.82367214e+03   2.19808542e+03   1.77593467e+04   7.08673451e+03
   1.81467889e+04   3.73593467e+04   3.66578626e+03   1.04477503e+03
   1.05696677e+04   2.17594752e+04   5.30270076e+00   1.95314561e+03
   6.47986646e+03   1.89248229e+04   3.00300656e+04   1.35722299e+04
   1.07887882e+04   2.96863219e+04   1.25953924e+04   2.69874450e+03
   2.68389150e+03   1.01520238e+04   7.12069348e+03   1.70792964e-06
   1.59558113e-07   5.36588495e+03   4.75906383e+03   3.49297509e+04
   1.72435356e+04   8.04898805e+03   2.47839620e+04   1.80659811e+04
   5.96704070e+03   1.22393712e+03   5.92194826e+03   1.29012812e+04
   2.29012698e+03   2.03354375e-07   1.46926430e+03   1.07884975e+04
   3.42611762e+02   4.32475184e+04   2.39735059e+04   8.49734455e+03
   2.36475184e+04   2.63821473e+04   1.18162966e+04   2.52261326e+03
   4.78361903e+03   2.12165780e+04   6.99761807e+03   2.51492975e+03
   3.29999808e+02   1.91030963e+04   3.84663990e+03   2.40078042e+02
   2.68552998e+04   1.31602214e+04   2.34852115e+04   4.64552998e+04
   8.62002239e+03   3.42832838e+03   1.30273551e+04   2.59782266e+04
   2.71059761e+03   2.84944392e+03   7.49839991e+03   2.07244686e+04
  -2.22879635e-07   4.20700828e+03   1.04845579e+04   1.87984608e+04
   3.27532764e+04   1.63261216e+04   2.14503635e+04   4.50786630e+04
   1.24471404e+04   4.07268716e+03   1.02072813e+04   2.21629889e+04
   5.41324507e+03   1.87207818e+03   4.89503269e+03   1.56996781e+04
   1.80000000e+03   1.57988292e+03   6.16245767e+03   1.27215297e+04
  -8.69877113e-08   3.69471841e+04   1.86412148e+04   1.81329227e+04
   4.09727499e+04   1.59751891e+04   5.02263005e+03   7.17417859e+03
   1.72729737e+04   8.57973397e+03   1.58107004e+03   2.69879229e+03
   1.04207460e+04   4.67625370e+03   2.74320428e-07   2.54707587e+03
   7.10429473e+03   2.58686975e+03   1.92299858e+00   5.17310095e+04
   2.97671786e+04   1.46575822e+04   3.37678942e+04   3.08033197e+04
   1.41430113e+04   5.70992490e+03   1.01202909e+04   2.34319222e+04
   8.06317253e+03   4.08000028e+03   3.29394115e+03   1.95477537e+04
   3.69987439e+03   7.45978632e+02   3.03216268e-06   1.74776249e+04
   1.08217151e+04   5.26722157e+03   3.77512530e+04   2.10337083e+04
   3.06236340e+04   5.73512530e+04   1.53742585e+04   7.61188174e+03
   1.72850426e+04   3.19969780e+04   7.21589253e+03   5.54574222e+03
   1.03169334e+04   2.43241143e+04   2.70000000e+03   5.45495273e+03
   1.19806184e+04   2.02938254e+04   1.75284640e-07  -2.73655587e-08
   2.29748581e+03   1.72074961e+04   4.53465896e+04   2.52938102e+04
   2.72448803e+04   5.39973591e+04   2.09172699e+04   9.02519659e+03
   1.34648847e+04   2.62263077e+04   1.16444968e+04   4.90043559e+03
   7.19286576e+03   1.73547162e+04   6.23403516e+03   2.69882902e+03
   6.60956354e+03   1.22817028e+04   2.64208977e+03   1.64193136e+02
   3.64348011e-06   8.77773703e+03   8.50144378e+02   5.51547027e+04
   3.19442994e+04   2.39584337e+04   4.91016741e+04   2.97798732e+04
   1.34657882e+04   1.08450010e+04   2.02172095e+04   1.99936908e+04
   7.22665090e+03   6.13689992e+03   1.07933620e+04   1.41710996e+04
   2.82356836e+03   3.11422846e+03   5.23996368e+03   1.01682334e+04
   4.75619149e+03   1.41269811e+03   1.94694495e+03   7.96536720e+03
   1.90457891e+03   5.92131942e+04   3.51348080e+04   2.17780748e+04
   4.48857339e+04   3.45518199e+04   1.65223649e+04   9.90606378e+03
   1.68414197e+04   2.51530419e+04   9.54064115e+03   6.51083821e+03
   7.83428920e+03   1.96414321e+04   4.33425892e+03   2.51313877e+03
   2.64337592e+03   1.59486352e+04   9.15608485e+03   4.11049454e+03
   2.81028292e-06   1.40558384e+04   5.83750698e+03   2.00302384e-06
   5.01642615e+04   3.01898410e+04   3.78473105e+04   6.79354942e+04
   2.37448956e+04   1.29965055e+04   2.18617792e+04   3.78210048e+04
   1.33915329e+04   9.25804007e+03   1.37244090e+04   2.77870616e+04
   7.11364829e+03   7.52095527e+03   1.38314982e+04   2.17029660e+04
   2.65682415e+03   1.43903516e+03   3.06687323e+03   1.69698559e+04
   7.24117854e-07   3.68787731e+02   6.39698142e+03   1.24040638e+04
   6.24680380e+04   3.92033161e+04   4.31011250e+04   7.54933575e+04
   3.26313499e+04   1.85240308e+04   2.51661154e+04   4.13546988e+04
   2.04223903e+04   1.29855691e+04   1.64521278e+04   2.93247565e+04
   1.26549605e+04   9.44960596e+03   1.47781430e+04   2.15044227e+04
   6.71295998e+03   3.87185108e+03   4.25606626e+03   1.55127839e+04
   2.57095948e+03   8.78190132e+02   4.78715660e+03   1.00482976e+04
   2.01062517e-06   6.21557982e+04   3.76317825e+04   3.28177264e+04
   6.17015346e+04   3.36933706e+04   1.69231846e+04   1.70525247e+04
   2.91811772e+04   2.22306307e+04   1.02511276e+04   1.05509599e+04
   1.79539168e+04   1.50622147e+04   5.48067221e+03   7.35628302e+03
   1.08318032e+04   9.71747109e+03   4.67349176e+03   2.29969348e+03
   5.98884219e+03   6.17272746e+03   1.01083587e+03   1.21907942e-06
   2.31295379e+03   3.55584614e+03   1.51667903e+03   6.96283490e+04
   4.31952468e+04   3.10643057e+04   5.81849743e+04   4.10770332e+04
   2.13854157e+04   1.62269429e+04   2.55599439e+04   2.95660273e+04
   1.33549767e+04   1.11088517e+04   1.42807654e+04   2.23588666e+04
   7.15524174e+03   6.28832643e+03   7.11349041e+03   1.69754919e+04
   9.87287223e+03   5.16613743e+03   2.69151417e+03   1.33921173e+04
   5.14163635e+03   1.90771220e-06   1.93196422e-06   1.02248651e+04
   6.82338050e+03   6.40727857e+02   7.16249316e+04   4.75824083e+04
   5.53908980e+04   9.12249316e+04   3.92104426e+04   2.52179892e+04
   3.50708147e+04   5.40507071e+04   2.56017440e+04   1.95474715e+04
   2.46149008e+04   4.05151156e+04   1.67107004e+04   1.59465813e+04
   2.30735586e+04   3.13850791e+04   9.64838155e+03   7.46722212e+03
   9.06338291e+03   2.40200583e+04   4.38606270e+03   3.97456809e+03
   1.00939201e+04   1.69358475e+04   1.02838099e+03   5.29748831e-08
   5.04922627e+03   1.21749934e+04   7.06101532e+04   4.48551738e+04
   4.33364533e+04   7.59205125e+04   3.91352396e+04   2.19988337e+04
   2.49567891e+04   3.98527129e+04   2.60367280e+04   1.49408494e+04
   1.66665136e+04   2.68659112e+04   1.75552273e+04   9.85039056e+03
   1.33479255e+04   1.82132446e+04   1.09012501e+04   6.27243471e+03
   4.90869675e+03   1.18454337e+04   6.04727296e+03   1.84678091e+03
   2.69935312e+03   6.45464711e+03   2.42149466e+03   4.00567387e-07
   1.03060893e-06   3.12865199e+03   1.75083065e+03   7.68887167e+04
   4.91420021e+04   4.01828706e+04   7.10441070e+04   4.52498027e+04
   2.51020843e+04   2.26937387e+04   3.47831838e+04   3.20622393e+04
   1.66387256e+04   1.57821838e+04   2.17005923e+04   2.35092539e+04
   1.00716177e+04   1.07896531e+04   1.29646021e+04   1.67840018e+04
   1.00494446e+04   6.31240494e+03   6.99268355e+03   1.18587497e+04
   4.50716546e+03   1.15927215e+03   2.57222594e+03   7.64300192e+03
   3.81217508e+03   1.89602088e-06   1.22939264e-06   7.38957175e+03
   6.88571016e+02   8.04479003e+04   5.19236529e+04   3.41978328e+04
   6.08479003e+04   5.09068359e+04   2.84734301e+04   1.94066336e+04
   2.70573622e+04   3.88583992e+04   1.91030189e+04   1.49944303e+04
   1.52000885e+04   3.12198261e+04   1.15193648e+04   8.67216006e+03
   7.52995220e+03   2.54063044e+04   1.65749301e+04   1.00720378e+04
   3.02667331e+03   2.13927827e+04   1.06508681e+04   2.35150895e+03
   7.03886038e+02   1.74251764e+04   1.26812621e+04   3.83654276e+03
   2.08492415e-05   1.91331928e+04   7.21108503e+03   1.74430598e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.18960558e+03   1.65966337e+04   7.90193208e+03   1.87000000e+04
   1.52109664e+04   3.57371457e+03   3.86494997e+03   1.11381325e-06
   1.27156790e+04   2.34649500e+04   1.29490474e+04   3.05165196e+03
   7.92448396e+03   2.23246165e+04   2.26907486e+03   2.21363849e+04
   9.19696613e+03   1.56414333e+03   1.26437644e+04   1.16269914e+04
   3.64245238e+03   2.53075270e+04   1.36289501e+04   2.12956547e-06
   5.70752696e+03   1.88502605e+04   1.07445168e+04   1.26453509e+03
   1.04445869e+04   2.80333191e+03   1.46006129e+04   3.00445869e+04
   5.04926825e+02   4.62160335e+02   9.91270088e+03   1.93362640e+04
   2.06293472e+04   7.44054258e+03   8.56229792e+03   2.52732008e+04
   6.52726940e+03   5.56732061e-07   2.32618271e+03   9.66329933e+03
   2.86216090e+03   2.45994939e+04   1.00902305e+04   5.22174670e+03
   2.01521334e+04   1.07786735e+04   2.05473811e+03   2.03393915e-06
   4.87343498e+03   7.26628703e+03   1.58361787e+02   3.34878061e+04
   1.77471930e+04   3.13035500e+03   1.38878061e+04   2.14642890e+04
   9.90368239e+03   5.23333035e+02   7.25575603e+02   1.89278335e+04
   6.82367214e+03   2.19808542e+03   1.77593467e+04   7.08673451e+03
   1.81467889e+04   3.73593467e+04   3.66578626e+03   1.04477503e+03
   1.05696677e+04   2.17594752e+04   5.30270076e+00   1.95314561e+03
   6.47986646e+03   1.89248229e+04   3.00300656e+04   1.35722299e+04
   1.07887882e+04   2.96863219e+04   1.25953924e+04   2.69874450e+03
   2.68389150e+03   1.01520238e+04   7.12069348e+03   1.70792964e-06
   1.59558113e-07   5.36588495e+03   4.75906383e+03   3.49297509e+04
   1.72435356e+04   8.04898805e+03   2.47839620e+04   1.80659811e+04
   5.96704070e+03   1.22393712e+03   5.92194826e+03   1.29012812e+04
   2.29012698e+03   2.03354375e-07   1.46926430e+03   1.07884975e+04
   3.42611762e+02   4.32475184e+04   2.39735059e+04   8.49734455e+03
   2.36475184e+04   2.63821473e+04   1.18162966e+04   2.52261326e+03
   4.78361903e+03   2.12165780e+04   6.99761807e+03   2.51492975e+03
   3.29999808e+02   1.91030963e+04   3.84663990e+03   2.40078042e+02
   2.68552998e+04   1.31602214e+04   2.34852115e+04   4.64552998e+04
   8.62002239e+03   3.42832838e+03   1.30273551e+04   2.59782266e+04
   2.71059761e+03   2.84944392e+03   7.49839991e+03   2.07244686e+04
  -2.22879635e-07   4.20700828e+03   1.04845579e+04   1.87984608e+04
   3.27532764e+04   1.63261216e+04   2.14503635e+04   4.50786630e+04
   1.24471404e+04   4.07268716e+03   1.02072813e+04   2.21629889e+04
   5.41324507e+03   1.87207818e+03   4.89503269e+03   1.56996781e+04
   1.80000000e+03   1.57988292e+03   6.16245767e+03   1.27215297e+04
  -8.69877113e-08   3.69471841e+04   1.86412148e+04   1.81329227e+04
   4.09727499e+04   1.59751891e+04   5.02263005e+03   7.17417859e+03
   1.72729737e+04   8.57973397e+03   1.58107004e+03   2.69879229e+03
   1.04207460e+04   4.67625370e+03   2.74320428e-07   2.54707587e+03
   7.10429473e+03   2.58686975e+03   1.92299858e+00   5.17310095e+04
   2.97671786e+04   1.46575822e+04   3.37678942e+04   3.08033197e+04
   1.41430113e+04   5.70992490e+03   1.01202909e+04   2.34319222e+04
   8.06317253e+03   4.08000028e+03   3.29394115e+03   1.95477537e+04
   3.69987439e+03   7.45978632e+02   3.03216268e-06   1.74776249e+04
   1.08217151e+04   5.26722157e+03   3.77512530e+04   2.10337083e+04
   3.06236340e+04   5.73512530e+04   1.53742585e+04   7.61188174e+03
   1.72850426e+04   3.19969780e+04   7.21589253e+03   5.54574222e+03
   1.03169334e+04   2.43241143e+04   2.70000000e+03   5.45495273e+03
   1.19806184e+04   2.02938254e+04   1.75284640e-07  -2.73655587e-08
   2.29748581e+03   1.72074961e+04   4.53465896e+04   2.52938102e+04
   2.72448803e+04   5.39973591e+04   2.09172699e+04   9.02519659e+03
   1.34648847e+04   2.62263077e+04   1.16444968e+04   4.90043559e+03
   7.19286576e+03   1.73547162e+04   6.23403516e+03   2.69882902e+03
   6.60956354e+03   1.22817028e+04   2.64208977e+03   1.64193136e+02
   3.64348011e-06   8.77773703e+03   8.50144378e+02   5.51547027e+04
   3.19442994e+04   2.39584337e+04   4.91016741e+04   2.97798732e+04
   1.34657882e+04   1.08450010e+04   2.02172095e+04   1.99936908e+04
   7.22665090e+03   6.13689992e+03   1.07933620e+04   1.41710996e+04
   2.82356836e+03   3.11422846e+03   5.23996368e+03   1.01682334e+04
   4.75619149e+03   1.41269811e+03   1.94694495e+03   7.96536720e+03
   1.90457891e+03   5.92131942e+04   3.51348080e+04   2.17780748e+04
   4.48857339e+04   3.45518199e+04   1.65223649e+04   9.90606378e+03
   1.68414197e+04   2.51530419e+04   9.54064115e+03   6.51083821e+03
   7.83428920e+03   1.96414321e+04   4.33425892e+03   2.51313877e+03
   2.64337592e+03   1.59486352e+04   9.15608485e+03   4.11049454e+03
   2.81028292e-06   1.40558384e+04   5.83750698e+03   2.00302384e-06
   5.01642615e+04   3.01898410e+04   3.78473105e+04   6.79354942e+04
   2.37448956e+04   1.29965055e+04   2.18617792e+04   3.78210048e+04
   1.33915329e+04   9.25804007e+03   1.37244090e+04   2.77870616e+04
   7.11364829e+03   7.52095527e+03   1.38314982e+04   2.17029660e+04
   2.65682415e+03   1.43903516e+03   3.06687323e+03   1.69698559e+04
   7.24117854e-07   3.68787731e+02   6.39698142e+03   1.24040638e+04
   6.24680380e+04   3.92033161e+04   4.31011250e+04   7.54933575e+04
   3.26313499e+04   1.85240308e+04   2.51661154e+04   4.13546988e+04
   2.04223903e+04   1.29855691e+04   1.64521278e+04   2.93247565e+04
   1.26549605e+04   9.44960596e+03   1.47781430e+04   2.15044227e+04
   6.71295998e+03   3.87185108e+03   4.25606626e+03   1.55127839e+04
   2.57095948e+03   8.78190132e+02   4.78715660e+03   1.00482976e+04
   2.01062517e-06   6.21557982e+04   3.76317825e+04   3.28177264e+04
   6.17015346e+04   3.36933706e+04   1.69231846e+04   1.70525247e+04
   2.91811772e+04   2.22306307e+04   1.02511276e+04   1.05509599e+04
   1.79539168e+04   1.50622147e+04   5.48067221e+03   7.35628302e+03
   1.08318032e+04   9.71747109e+03   4.67349176e+03   2.29969348e+03
   5.98884219e+03   6.17272746e+03   1.01083587e+03   1.21907942e-06
   2.31295379e+03   3.55584614e+03   1.51667903e+03   6.96283490e+04
   4.31952468e+04   3.10643057e+04   5.81849743e+04   4.10770332e+04
   2.13854157e+04   1.62269429e+04   2.55599439e+04   2.95660273e+04
   1.33549767e+04   1.11088517e+04   1.42807654e+04   2.23588666e+04
   7.15524174e+03   6.28832643e+03   7.11349041e+03   1.69754919e+04
   9.87287223e+03   5.16613743e+03   2.69151417e+03   1.33921173e+04
   5.14163635e+03   1.90771220e-06   1.93196422e-06   1.02248651e+04
   6.82338050e+03   6.40727857e+02   7.16249316e+04   4.75824083e+04
   5.53908980e+04   9.12249316e+04   3.92104426e+04   2.52179892e+04
   3.50708147e+04   5.40507071e+04   2.56017440e+04   1.95474715e+04
   2.46149008e+04   4.05151156e+04   1.67107004e+04   1.59465813e+04
   2.30735586e+04   3.13850791e+04   9.64838155e+03   7.46722212e+03
   9.06338291e+03   2.40200583e+04   4.38606270e+03   3.97456809e+03
   1.00939201e+04   1.69358475e+04   1.02838099e+03   5.29748831e-08
   5.04922627e+03   1.21749934e+04   7.06101532e+04   4.48551738e+04
   4.33364533e+04   7.59205125e+04   3.91352396e+04   2.19988337e+04
   2.49567891e+04   3.98527129e+04   2.60367280e+04   1.49408494e+04
   1.66665136e+04   2.68659112e+04   1.75552273e+04   9.85039056e+03
   1.33479255e+04   1.82132446e+04   1.09012501e+04   6.27243471e+03
   4.90869675e+03   1.18454337e+04   6.04727296e+03   1.84678091e+03
   2.69935312e+03   6.45464711e+03   2.42149466e+03   4.00567387e-07
   1.03060893e-06   3.12865199e+03   1.75083065e+03   7.68887167e+04
   4.91420021e+04   4.01828706e+04   7.10441070e+04   4.52498027e+04
   2.51020843e+04   2.26937387e+04   3.47831838e+04   3.20622393e+04
   1.66387256e+04   1.57821838e+04   2.17005923e+04   2.35092539e+04
   1.00716177e+04   1.07896531e+04   1.29646021e+04   1.67840018e+04
   1.00494446e+04   6.31240494e+03   6.99268355e+03   1.18587497e+04
   4.50716546e+03   1.15927215e+03   2.57222594e+03   7.64300192e+03
   3.81217508e+03   1.89602088e-06   1.22939264e-06   7.38957175e+03
   6.88571016e+02   8.04479003e+04   5.19236529e+04   3.41978328e+04
   6.08479003e+04   5.09068359e+04   2.84734301e+04   1.94066336e+04
   2.70573622e+04   3.88583992e+04   1.91030189e+04   1.49944303e+04
   1.52000885e+04   3.12198261e+04   1.15193648e+04   8.67216006e+03
   7.52995220e+03   2.54063044e+04   1.65749301e+04   1.00720378e+04
   3.02667331e+03   2.13927827e+04   1.06508681e+04   2.35150895e+03
   7.03886038e+02   1.74251764e+04   1.26812621e+04   3.83654276e+03
   2.08492415e-05   1.91331928e+04   7.21108503e+03   1.74430598e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.48155117035 s
|dj| = 12420.0395418
Runtime: 6.48892903328 s
|dj| = 12420.0395418
   56    98    -3.106827E+04     2.775459E+02
Start evaluation of j
Updating the turbine cache
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 4.774e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 1.401e-07 (tol = 1.000e-10) r (rel) = 2.935e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.262e-13 (tol = 1.000e-10) r (rel) = 6.833e-11 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
End of time loop.
Runtime: 12.346089 s.
Runtime: 12.321317 s.
j = 1.390289e+06.
j = 1.390289e+06.
Minimum distance inequality constraints (should all be > 0): [  2.18970206e+03   1.65964901e+04   7.90185834e+03   1.87000000e+04
   1.52109606e+04   3.57348821e+03   3.86499516e+03   3.31584488e-07
   1.27157738e+04   2.34649952e+04   1.29489154e+04   3.05146795e+03
   7.92457035e+03   2.23243826e+04   2.26901269e+03   2.21361651e+04
   9.19669258e+03   1.56421894e+03   1.26435462e+04   1.16268809e+04
   3.64240329e+03   2.53073117e+04   1.36287345e+04   4.16297326e-07
   5.70731172e+03   1.88502200e+04   1.07444790e+04   1.26455519e+03
   1.04445539e+04   2.80324332e+03   1.46008171e+04   3.00445539e+04
   5.04890697e+02   4.62180984e+02   9.91269291e+03   1.93363230e+04
   2.06292589e+04   7.44033271e+03   8.56262550e+03   2.52732446e+04
   6.52715597e+03   1.27566614e-06   2.32627406e+03   9.66351237e+03
   2.86211144e+03   2.45992346e+04   1.00898903e+04   5.22186809e+03
   2.01518698e+04   1.07785056e+04   2.05469165e+03   1.66806331e-07
   4.87347080e+03   7.26624365e+03   1.58396829e+02   3.34878980e+04
   1.77470496e+04   3.13058576e+03   1.38878980e+04   2.14642944e+04
   9.90362818e+03   5.23363377e+02   7.25712828e+02   1.89278495e+04
   6.82373834e+03   2.19804861e+03   1.77592318e+04   7.08654341e+03
   1.81470466e+04   3.73592318e+04   3.66568522e+03   1.04481587e+03
   1.05696961e+04   2.17595752e+04   5.28670844e+00   1.95309522e+03
   6.47987126e+03   1.89247990e+04   3.00298729e+04   1.35718880e+04
   1.07889628e+04   2.96860225e+04   1.25952456e+04   2.69873985e+03
   2.68388835e+03   1.01520598e+04   7.12068115e+03   1.28083821e-06
   2.98000487e-07   5.36574275e+03   4.75910127e+03   3.49294719e+04
   1.72431126e+04   8.04918691e+03   2.47837609e+04   1.80657416e+04
   5.96695175e+03   1.22396221e+03   5.92206085e+03   1.29011673e+04
   2.29012492e+03   1.74684601e-07   1.46920739e+03   1.07884271e+04
   3.42565068e+02   4.32469172e+04   2.39728456e+04   8.49728885e+03
   2.36469172e+04   2.63817536e+04   1.18161128e+04   2.52252797e+03
   4.78352938e+03   2.12164010e+04   6.99762856e+03   2.51488639e+03
   3.29838744e+02   1.91030361e+04   3.84659699e+03   2.40096802e+02
   2.68551597e+04   1.31599578e+04   2.34855457e+04   4.64551597e+04
   8.61987648e+03   3.42838651e+03   1.30274176e+04   2.59783808e+04
   2.71056568e+03   2.84937661e+03   7.49843785e+03   2.07243968e+04
  -3.31053798e-07   4.20706658e+03   1.04845044e+04   1.87984905e+04
   3.27531237e+04   1.63258028e+04   2.14507206e+04   4.50785103e+04
   1.24469721e+04   4.07273501e+03   1.02073611e+04   2.21631702e+04
   5.41320516e+03   1.87202695e+03   4.89508640e+03   1.56995823e+04
   1.80000000e+03   1.57993185e+03   6.16242705e+03   1.27216044e+04
  -1.29141881e-07   3.69467637e+04   1.86406727e+04   1.81331270e+04
   4.09723689e+04   1.59748417e+04   5.02255455e+03   7.17417688e+03
   1.72730475e+04   8.57956955e+03   1.58097725e+03   2.69879002e+03
   1.04205800e+04   4.67617178e+03   4.29368470e-07   2.54703910e+03
   7.10436801e+03   2.58682775e+03   1.90824942e+00   5.17301360e+04
   2.97662350e+04   1.46574776e+04   3.37671511e+04   3.08026472e+04
   1.41426559e+04   5.70974262e+03   1.01201523e+04   2.34315017e+04
   8.06298836e+03   4.07984692e+03   3.29363845e+03   1.95474712e+04
   3.69970491e+03   7.45891066e+02   4.26883730e-07   1.74774379e+04
   1.08216000e+04   5.26717107e+03   3.77510877e+04   2.10333722e+04
   3.06240449e+04   5.73510876e+04   1.53740677e+04   7.61195715e+03
   1.72851391e+04   3.19971863e+04   7.21584464e+03   5.54565800e+03
   1.03170044e+04   2.43239946e+04   2.70000000e+03   5.45503188e+03
   1.19805817e+04   2.02939450e+04   2.60338311e-07  -4.07434300e-08
   2.29748371e+03   1.72074045e+04   4.53461965e+04   2.52932436e+04
   2.72451386e+04   5.39969450e+04   2.09169138e+04   9.02514831e+03
   1.34648833e+04   2.62263916e+04   1.16443371e+04   4.90029951e+03
   7.19286467e+03   1.73544636e+04   6.23396272e+03   2.69883089e+03
   6.60948962e+03   1.22817945e+04   2.64204871e+03   1.64163868e+02
  -1.58718990e-07   8.77768836e+03   8.50134702e+02   5.51542772e+04
   3.19436586e+04   2.39586998e+04   4.91012898e+04   2.97794760e+04
   1.34656884e+04   1.08450207e+04   2.02173365e+04   1.99934944e+04
   7.22654930e+03   6.13690811e+03   1.07931267e+04   1.41709922e+04
   2.82353018e+03   3.11419863e+03   5.24010193e+03   1.01681555e+04
   4.75613602e+03   1.41270866e+03   1.94698861e+03   7.96531885e+03
   1.90455598e+03   5.92122857e+04   3.51337832e+04   2.17779942e+04
   4.48849172e+04   3.45510856e+04   1.65219973e+04   9.90585648e+03
   1.68412683e+04   2.51525807e+04   9.54038439e+03   6.51066133e+03
   7.83387632e+03   1.96411193e+04   4.33406493e+03   2.51299687e+03
   2.64338528e+03   1.59484139e+04   9.15592627e+03   4.11042407e+03
   2.77412937e-08   1.40557085e+04   5.83743750e+03   1.42067574e-06
   5.01640690e+04   3.01894262e+04   3.78477837e+04   6.79352936e+04
   2.37446594e+04   1.29965898e+04   2.18619018e+04   3.78212565e+04
   1.33914683e+04   9.25794163e+03   1.37245064e+04   2.77868861e+04
   7.11364751e+03   7.52104520e+03   1.38314750e+04   2.17031647e+04
   2.65682376e+03   1.43903346e+03   3.06690856e+03   1.69698556e+04
  -2.58020464e-07   3.68805624e+02   6.39695878e+03   1.24040206e+04
   6.24679063e+04   3.92029047e+04   4.31017731e+04   7.54932941e+04
   3.26311324e+04   1.85241767e+04   2.51663633e+04   4.13551229e+04
   2.04223542e+04   1.29855323e+04   1.64523302e+04   2.93246540e+04
   1.26549902e+04   9.44976052e+03   1.47782242e+04   2.15047950e+04
   6.71297885e+03   3.87187722e+03   4.25618151e+03   1.55129635e+04
   2.57096752e+03   8.78255215e+02   4.78721329e+03   1.00484091e+04
  -1.70487510e-07   6.21553196e+04   3.76310723e+04   3.28180380e+04
   6.17011061e+04   3.36929095e+04   1.69230866e+04   1.70525481e+04
   2.91813237e+04   2.22303941e+04   1.02509713e+04   1.05509721e+04
   1.79536272e+04   1.50620807e+04   5.48064411e+03   7.35623594e+03
   1.08319919e+04   9.71736831e+03   4.67341391e+03   2.29970793e+03
   5.98892311e+03   6.17265592e+03   1.01081948e+03  -2.38468260e-07
   2.31299432e+03   3.55580385e+03   1.51669927e+03   6.96277295e+04
   4.31943917e+04   3.10643414e+04   5.81841710e+04   4.10765198e+04
   2.13852322e+04   1.62267960e+04   2.55598221e+04   2.95657871e+04
   1.33548036e+04   1.11087530e+04   1.42802572e+04   2.23587682e+04
   7.15513199e+03   6.28818553e+03   7.11350862e+03   1.69754635e+04
   9.87284456e+03   5.16617065e+03   2.69150895e+03   1.33921587e+04
   5.14168148e+03   1.27909232e-06   1.31489321e-06   1.02249602e+04
   6.82356295e+03   6.40792606e+02   7.16249677e+04   4.75821101e+04
   5.53916959e+04   9.12249677e+04   3.92103384e+04   2.52182600e+04
   3.50711485e+04   5.40512302e+04   2.56018162e+04   1.95474756e+04
   2.46151835e+04   4.05150238e+04   1.67108298e+04   1.59468168e+04
   2.30736727e+04   3.13855264e+04   9.64848168e+03   7.46730763e+03
   9.06355834e+03   2.40202791e+04   4.38613358e+03   3.97469085e+03
   1.00939930e+04   1.69359941e+04   1.02842427e+03  -1.09330813e-07
   5.04925835e+03   1.21752314e+04   7.06097415e+04   4.48544873e+04
   4.33368589e+04   7.59201037e+04   3.91348093e+04   2.19988006e+04
   2.49568522e+04   3.98529111e+04   2.60365312e+04   1.49406852e+04
   1.66665641e+04   2.68655863e+04   1.75551351e+04   9.85040347e+03
   1.33478789e+04   1.82134870e+04   1.09011796e+04   6.27237563e+03
   4.90874171e+03   1.18455458e+04   6.04722419e+03   1.84679532e+03
   2.69935355e+03   6.45471739e+03   2.42146512e+03   2.07448238e-07
  -1.44472551e-07   3.12876582e+03   1.75084113e+03   7.68879793e+04
   4.91410128e+04   4.01828870e+04   7.10431946e+04   4.52491606e+04
   2.51018378e+04   2.26935308e+04   3.47830168e+04   3.20618942e+04
   1.66384330e+04   1.57820244e+04   2.16999651e+04   2.35090642e+04
   1.00714533e+04   1.07894302e+04   1.29646060e+04   1.67838837e+04
   1.00493298e+04   6.31237730e+03   6.99265084e+03   1.18587031e+04
   4.50715237e+03   1.15920740e+03   2.57220172e+03   7.64301268e+03
   3.81225633e+03   1.26168857e-06  -2.23064035e-07   7.38970417e+03
   6.88619661e+02   8.04484375e+04   5.19236842e+04   3.41988513e+04
   6.08484375e+04   5.09071064e+04   2.84738437e+04   1.94072044e+04
   2.70581664e+04   3.88587500e+04   1.91033734e+04   1.49948964e+04
   1.52002670e+04   3.12201621e+04   1.15196367e+04   8.67250626e+03
   7.53050301e+03   2.54065503e+04   1.65751310e+04   1.00723305e+04
   3.02706460e+03   2.13929385e+04   1.06510028e+04   2.35164352e+03
   7.04112289e+02   1.74252368e+04   1.26813134e+04   3.83659884e+03
   7.28577402e-06   1.91331506e+04   7.21103472e+03   1.74416272e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.18970206e+03   1.65964901e+04   7.90185834e+03   1.87000000e+04
   1.52109606e+04   3.57348821e+03   3.86499516e+03   3.31584488e-07
   1.27157738e+04   2.34649952e+04   1.29489154e+04   3.05146795e+03
   7.92457035e+03   2.23243826e+04   2.26901269e+03   2.21361651e+04
   9.19669258e+03   1.56421894e+03   1.26435462e+04   1.16268809e+04
   3.64240329e+03   2.53073117e+04   1.36287345e+04   4.16297326e-07
   5.70731172e+03   1.88502200e+04   1.07444790e+04   1.26455519e+03
   1.04445539e+04   2.80324332e+03   1.46008171e+04   3.00445539e+04
   5.04890697e+02   4.62180984e+02   9.91269291e+03   1.93363230e+04
   2.06292589e+04   7.44033271e+03   8.56262550e+03   2.52732446e+04
   6.52715597e+03   1.27566614e-06   2.32627406e+03   9.66351237e+03
   2.86211144e+03   2.45992346e+04   1.00898903e+04   5.22186809e+03
   2.01518698e+04   1.07785056e+04   2.05469165e+03   1.66806331e-07
   4.87347080e+03   7.26624365e+03   1.58396829e+02   3.34878980e+04
   1.77470496e+04   3.13058576e+03   1.38878980e+04   2.14642944e+04
   9.90362818e+03   5.23363377e+02   7.25712828e+02   1.89278495e+04
   6.82373834e+03   2.19804861e+03   1.77592318e+04   7.08654341e+03
   1.81470466e+04   3.73592318e+04   3.66568522e+03   1.04481587e+03
   1.05696961e+04   2.17595752e+04   5.28670844e+00   1.95309522e+03
   6.47987126e+03   1.89247990e+04   3.00298729e+04   1.35718880e+04
   1.07889628e+04   2.96860225e+04   1.25952456e+04   2.69873985e+03
   2.68388835e+03   1.01520598e+04   7.12068115e+03   1.28083821e-06
   2.98000487e-07   5.36574275e+03   4.75910127e+03   3.49294719e+04
   1.72431126e+04   8.04918691e+03   2.47837609e+04   1.80657416e+04
   5.96695175e+03   1.22396221e+03   5.92206085e+03   1.29011673e+04
   2.29012492e+03   1.74684601e-07   1.46920739e+03   1.07884271e+04
   3.42565068e+02   4.32469172e+04   2.39728456e+04   8.49728885e+03
   2.36469172e+04   2.63817536e+04   1.18161128e+04   2.52252797e+03
   4.78352938e+03   2.12164010e+04   6.99762856e+03   2.51488639e+03
   3.29838744e+02   1.91030361e+04   3.84659699e+03   2.40096802e+02
   2.68551597e+04   1.31599578e+04   2.34855457e+04   4.64551597e+04
   8.61987648e+03   3.42838651e+03   1.30274176e+04   2.59783808e+04
   2.71056568e+03   2.84937661e+03   7.49843785e+03   2.07243968e+04
  -3.31053798e-07   4.20706658e+03   1.04845044e+04   1.87984905e+04
   3.27531237e+04   1.63258028e+04   2.14507206e+04   4.50785103e+04
   1.24469721e+04   4.07273501e+03   1.02073611e+04   2.21631702e+04
   5.41320516e+03   1.87202695e+03   4.89508640e+03   1.56995823e+04
   1.80000000e+03   1.57993185e+03   6.16242705e+03   1.27216044e+04
  -1.29141881e-07   3.69467637e+04   1.86406727e+04   1.81331270e+04
   4.09723689e+04   1.59748417e+04   5.02255455e+03   7.17417688e+03
   1.72730475e+04   8.57956955e+03   1.58097725e+03   2.69879002e+03
   1.04205800e+04   4.67617178e+03   4.29368470e-07   2.54703910e+03
   7.10436801e+03   2.58682775e+03   1.90824942e+00   5.17301360e+04
   2.97662350e+04   1.46574776e+04   3.37671511e+04   3.08026472e+04
   1.41426559e+04   5.70974262e+03   1.01201523e+04   2.34315017e+04
   8.06298836e+03   4.07984692e+03   3.29363845e+03   1.95474712e+04
   3.69970491e+03   7.45891066e+02   4.26883730e-07   1.74774379e+04
   1.08216000e+04   5.26717107e+03   3.77510877e+04   2.10333722e+04
   3.06240449e+04   5.73510876e+04   1.53740677e+04   7.61195715e+03
   1.72851391e+04   3.19971863e+04   7.21584464e+03   5.54565800e+03
   1.03170044e+04   2.43239946e+04   2.70000000e+03   5.45503188e+03
   1.19805817e+04   2.02939450e+04   2.60338311e-07  -4.07434300e-08
   2.29748371e+03   1.72074045e+04   4.53461965e+04   2.52932436e+04
   2.72451386e+04   5.39969450e+04   2.09169138e+04   9.02514831e+03
   1.34648833e+04   2.62263916e+04   1.16443371e+04   4.90029951e+03
   7.19286467e+03   1.73544636e+04   6.23396272e+03   2.69883089e+03
   6.60948962e+03   1.22817945e+04   2.64204871e+03   1.64163868e+02
  -1.58718990e-07   8.77768836e+03   8.50134702e+02   5.51542772e+04
   3.19436586e+04   2.39586998e+04   4.91012898e+04   2.97794760e+04
   1.34656884e+04   1.08450207e+04   2.02173365e+04   1.99934944e+04
   7.22654930e+03   6.13690811e+03   1.07931267e+04   1.41709922e+04
   2.82353018e+03   3.11419863e+03   5.24010193e+03   1.01681555e+04
   4.75613602e+03   1.41270866e+03   1.94698861e+03   7.96531885e+03
   1.90455598e+03   5.92122857e+04   3.51337832e+04   2.17779942e+04
   4.48849172e+04   3.45510856e+04   1.65219973e+04   9.90585648e+03
   1.68412683e+04   2.51525807e+04   9.54038439e+03   6.51066133e+03
   7.83387632e+03   1.96411193e+04   4.33406493e+03   2.51299687e+03
   2.64338528e+03   1.59484139e+04   9.15592627e+03   4.11042407e+03
   2.77412937e-08   1.40557085e+04   5.83743750e+03   1.42067574e-06
   5.01640690e+04   3.01894262e+04   3.78477837e+04   6.79352936e+04
   2.37446594e+04   1.29965898e+04   2.18619018e+04   3.78212565e+04
   1.33914683e+04   9.25794163e+03   1.37245064e+04   2.77868861e+04
   7.11364751e+03   7.52104520e+03   1.38314750e+04   2.17031647e+04
   2.65682376e+03   1.43903346e+03   3.06690856e+03   1.69698556e+04
  -2.58020464e-07   3.68805624e+02   6.39695878e+03   1.24040206e+04
   6.24679063e+04   3.92029047e+04   4.31017731e+04   7.54932941e+04
   3.26311324e+04   1.85241767e+04   2.51663633e+04   4.13551229e+04
   2.04223542e+04   1.29855323e+04   1.64523302e+04   2.93246540e+04
   1.26549902e+04   9.44976052e+03   1.47782242e+04   2.15047950e+04
   6.71297885e+03   3.87187722e+03   4.25618151e+03   1.55129635e+04
   2.57096752e+03   8.78255215e+02   4.78721329e+03   1.00484091e+04
  -1.70487510e-07   6.21553196e+04   3.76310723e+04   3.28180380e+04
   6.17011061e+04   3.36929095e+04   1.69230866e+04   1.70525481e+04
   2.91813237e+04   2.22303941e+04   1.02509713e+04   1.05509721e+04
   1.79536272e+04   1.50620807e+04   5.48064411e+03   7.35623594e+03
   1.08319919e+04   9.71736831e+03   4.67341391e+03   2.29970793e+03
   5.98892311e+03   6.17265592e+03   1.01081948e+03  -2.38468260e-07
   2.31299432e+03   3.55580385e+03   1.51669927e+03   6.96277295e+04
   4.31943917e+04   3.10643414e+04   5.81841710e+04   4.10765198e+04
   2.13852322e+04   1.62267960e+04   2.55598221e+04   2.95657871e+04
   1.33548036e+04   1.11087530e+04   1.42802572e+04   2.23587682e+04
   7.15513199e+03   6.28818553e+03   7.11350862e+03   1.69754635e+04
   9.87284456e+03   5.16617065e+03   2.69150895e+03   1.33921587e+04
   5.14168148e+03   1.27909232e-06   1.31489321e-06   1.02249602e+04
   6.82356295e+03   6.40792606e+02   7.16249677e+04   4.75821101e+04
   5.53916959e+04   9.12249677e+04   3.92103384e+04   2.52182600e+04
   3.50711485e+04   5.40512302e+04   2.56018162e+04   1.95474756e+04
   2.46151835e+04   4.05150238e+04   1.67108298e+04   1.59468168e+04
   2.30736727e+04   3.13855264e+04   9.64848168e+03   7.46730763e+03
   9.06355834e+03   2.40202791e+04   4.38613358e+03   3.97469085e+03
   1.00939930e+04   1.69359941e+04   1.02842427e+03  -1.09330813e-07
   5.04925835e+03   1.21752314e+04   7.06097415e+04   4.48544873e+04
   4.33368589e+04   7.59201037e+04   3.91348093e+04   2.19988006e+04
   2.49568522e+04   3.98529111e+04   2.60365312e+04   1.49406852e+04
   1.66665641e+04   2.68655863e+04   1.75551351e+04   9.85040347e+03
   1.33478789e+04   1.82134870e+04   1.09011796e+04   6.27237563e+03
   4.90874171e+03   1.18455458e+04   6.04722419e+03   1.84679532e+03
   2.69935355e+03   6.45471739e+03   2.42146512e+03   2.07448238e-07
  -1.44472551e-07   3.12876582e+03   1.75084113e+03   7.68879793e+04
   4.91410128e+04   4.01828870e+04   7.10431946e+04   4.52491606e+04
   2.51018378e+04   2.26935308e+04   3.47830168e+04   3.20618942e+04
   1.66384330e+04   1.57820244e+04   2.16999651e+04   2.35090642e+04
   1.00714533e+04   1.07894302e+04   1.29646060e+04   1.67838837e+04
   1.00493298e+04   6.31237730e+03   6.99265084e+03   1.18587031e+04
   4.50715237e+03   1.15920740e+03   2.57220172e+03   7.64301268e+03
   3.81225633e+03   1.26168857e-06  -2.23064035e-07   7.38970417e+03
   6.88619661e+02   8.04484375e+04   5.19236842e+04   3.41988513e+04
   6.08484375e+04   5.09071064e+04   2.84738437e+04   1.94072044e+04
   2.70581664e+04   3.88587500e+04   1.91033734e+04   1.49948964e+04
   1.52002670e+04   3.12201621e+04   1.15196367e+04   8.67250626e+03
   7.53050301e+03   2.54065503e+04   1.65751310e+04   1.00723305e+04
   3.02706460e+03   2.13929385e+04   1.06510028e+04   2.35164352e+03
   7.04112289e+02   1.74252368e+04   1.26813134e+04   3.83659884e+03
   7.28577402e-06   1.91331506e+04   7.21103472e+03   1.74416272e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 5.71651101112 s
|dj| = 12419.954659
   57    99    -3.106827E+04     2.775440E+02
Start evaluation of j
Updating the turbine cache
Runtime: 5.72969794273 s
|dj| = 12419.954659
Start evaluation of j
Updating the turbine cache
Building individual turbine power friction functions for caching purposes...
Building individual turbine power friction functions for caching purposes...
found a tidal farm, computing functional
found a tidal farm, computing functional
Solve a steady-state shallow water problem
Solve a steady-state shallow water problem
Solving linear system of size 101016 x 101016 (PETSc Krylov solver).
Start of time loop
Start of time loop
Read initial guess from cache for t=1.000000.
Read initial guess from cache for t=1.000000.
Solve shallow water equations.
Solve shallow water equations.
Solving nonlinear variational problem.
Solving nonlinear variational problem.
  Newton iteration 0: r (abs) = 2.079e-03 (tol = 1.000e-10) r (rel) = 1.000e+00 (tol = 1.000e-09)
  Newton iteration 1: r (abs) = 2.325e-08 (tol = 1.000e-10) r (rel) = 1.118e-05 (tol = 1.000e-09)
  Newton iteration 2: r (abs) = 3.261e-13 (tol = 1.000e-10) r (rel) = 1.568e-10 (tol = 1.000e-09)
  Newton solver finished in 2 iterations and 2 linear solver iterations.
Cache solution t=1.000000 as next initial guess.
Cache solution t=1.000000 as next initial guess.
Write state to disk...
Write state to disk...
Solving linear system of size 22492 x 22492 (PETSc Krylov solver).
Solving linear system of size 11246 x 11246 (PETSc Krylov solver).
End of time loop.
Runtime: 13.508807 s.
j = 1.390289e+06.
End of time loop.
Runtime: 13.481295 s.
j = 1.390289e+06.
Minimum distance inequality constraints (should all be > 0): [  2.18972639e+03   1.65965321e+04   7.90187149e+03   1.87000000e+04
   1.52110150e+04   3.57354580e+03   3.86505402e+03   2.27952341e-08
   1.27157607e+04   2.34650540e+04   1.29490000e+04   3.05148364e+03
   7.92458648e+03   2.23245125e+04   2.26900123e+03   2.21362063e+04
   9.19668807e+03   1.56421518e+03   1.26436405e+04   1.16268363e+04
   3.64239967e+03   2.53073716e+04   1.36287643e+04   1.06800258e-07
   5.70737165e+03   1.88502186e+04   1.07445163e+04   1.26456866e+03
   1.04446648e+04   2.80326399e+03   1.46008113e+04   3.00446648e+04
   5.04897748e+02   4.62168203e+02   9.91265215e+03   1.93363307e+04
   2.06293470e+04   7.44034446e+03   8.56260235e+03   2.52733345e+04
   6.52714152e+03   1.66049517e-07   2.32625345e+03   9.66350861e+03
   2.86209895e+03   2.45993448e+04   1.00899223e+04   5.22187120e+03
   2.01519997e+04   1.07784971e+04   2.05470174e+03   1.08582299e-07
   4.87348757e+03   7.26622781e+03   1.58392138e+02   3.34877684e+04
   1.77469571e+04   3.13047375e+03   1.38877684e+04   2.14641935e+04
   9.90364292e+03   5.23357402e+02   7.25640129e+02   1.89278177e+04
   6.82376528e+03   2.19808195e+03   1.77593249e+04   7.08654688e+03
   1.81470191e+04   3.73593249e+04   3.66567365e+03   1.04479961e+03
   1.05696554e+04   2.17595721e+04   5.27589763e+00   1.95309453e+03
   6.47985869e+03   1.89248252e+04   3.00299885e+04   1.35719135e+04
   1.07889659e+04   2.96861756e+04   1.25952251e+04   2.69874062e+03
   2.68389012e+03   1.01520862e+04   7.12065102e+03   1.06633934e-07
   6.87571173e-08   5.36583577e+03   4.75908596e+03   3.49295826e+04
   1.72431466e+04   8.04914816e+03   2.47838309e+04   1.80657424e+04
   5.96697885e+03   1.22395367e+03   5.92203388e+03   1.29011715e+04
   2.29013817e+03   9.42688985e-08   1.46925281e+03   1.07884545e+04
   3.42585982e+02   4.32471357e+04   2.39729568e+04   8.49734007e+03
   2.36471357e+04   2.63818011e+04   1.18161702e+04   2.52257232e+03
   4.78357893e+03   2.12164188e+04   6.99764459e+03   2.51490474e+03
   3.29925027e+02   1.91030504e+04   3.84661312e+03   2.40086993e+02
   2.68552733e+04   1.31599643e+04   2.34855123e+04   4.64552733e+04
   8.61985978e+03   3.42836487e+03   1.30273755e+04   2.59783760e+04
   2.71054409e+03   2.84937689e+03   7.49841848e+03   2.07244754e+04
  -1.71880856e-07   4.20704659e+03   1.04845370e+04   1.87984835e+04
   3.27532475e+04   1.63258163e+04   2.14506872e+04   4.50786341e+04
   1.24469528e+04   4.07271908e+03   1.02073281e+04   2.21631646e+04
   5.41317818e+03   1.87202805e+03   4.89506729e+03   1.56996872e+04
   1.80000000e+03   1.57991648e+03   6.16245467e+03   1.27215866e+04
  -6.70573854e-08   3.69469457e+04   1.86407333e+04   1.81331350e+04
   4.09725547e+04   1.59748556e+04   5.02256939e+03   7.17417917e+03
   1.72730757e+04   8.57956352e+03   1.58099389e+03   2.69879049e+03
   1.04207152e+04   4.67618536e+03   4.93414518e-08   2.54706930e+03
   7.10435808e+03   2.58683225e+03   1.90890987e+00   5.17303501e+04
   2.97663323e+04   1.46575321e+04   3.37674024e+04   3.08026688e+04
   1.41426972e+04   5.70979231e+03   1.01202172e+04   2.34314900e+04
   8.06300220e+03   4.07986323e+03   3.29379528e+03   1.95474683e+04
   3.69971783e+03   7.45900029e+02   1.22744495e-07   1.74774151e+04
   1.08215742e+04   5.26715223e+03   3.77512217e+04   2.10333816e+04
   3.06240056e+04   5.73512217e+04   1.53740459e+04   7.61193012e+03
   1.72850955e+04   3.19971799e+04   7.21581227e+03   5.54565925e+03
   1.03169783e+04   2.43241257e+04   2.70000000e+03   5.45500722e+03
   1.19806195e+04   2.02939165e+04   1.35145228e-07  -2.11074394e-08
   2.29747913e+03   1.72073620e+04   4.53463308e+04   2.52932615e+04
   2.72451394e+04   5.39971401e+04   2.09168773e+04   9.02513352e+03
   1.34648854e+04   2.62264326e+04   1.16442860e+04   4.90031050e+03
   7.19286355e+03   1.73546675e+04   6.23394828e+03   2.69883006e+03
   6.60954957e+03   1.22818011e+04   2.64203325e+03   1.64159183e+02
  -5.74771093e-08   8.77768852e+03   8.50118225e+02   5.51545355e+04
   3.19437733e+04   2.39587181e+04   4.91015071e+04   2.97795338e+04
   1.34657435e+04   1.08450481e+04   2.02173665e+04   1.99935234e+04
   7.22659453e+03   6.13692329e+03   1.07933181e+04   1.41710499e+04
   2.82355443e+03   3.11423253e+03   5.24006715e+03   1.01682019e+04
   4.75616915e+03   1.41272260e+03   1.94695579e+03   7.96535391e+03
   1.90459653e+03   5.92126877e+04   3.51340183e+04   2.17781143e+04
   4.48852636e+04   3.45512502e+04   1.65221393e+04   9.90596536e+03
   1.68413826e+04   2.51526949e+04   9.54048953e+03   6.51073937e+03
   7.83411836e+03   1.96412424e+04   4.33414124e+03   2.51306345e+03
   2.64339280e+03   1.59485076e+04   9.15599501e+03   4.11046998e+03
   1.37524012e-07   1.40557729e+04   5.83750737e+03   2.60232810e-07
   5.01642042e+04   3.01894159e+04   3.78476767e+04   6.79353689e+04
   2.37446204e+04   1.29965360e+04   2.18618067e+04   3.78211776e+04
   1.33914168e+04   9.25791534e+03   1.37244319e+04   2.77870012e+04
   7.11364179e+03   7.52098383e+03   1.38314666e+04   2.17030517e+04
   2.65682089e+03   1.43902091e+03   3.06687053e+03   1.69697371e+04
  -8.63173000e-08   3.68775678e+02   6.39694371e+03   1.24040035e+04
   6.24681114e+04   3.92029499e+04   4.31017402e+04   7.54934849e+04
   3.26311268e+04   1.85241639e+04   2.51663356e+04   4.13551231e+04
   2.04223232e+04   1.29855471e+04   1.64523034e+04   2.93248839e+04
   1.26550071e+04   9.44974025e+03   1.47782678e+04   2.15047280e+04
   6.71299196e+03   3.87188575e+03   4.25616608e+03   1.55128883e+04
   2.57097680e+03   8.78250478e+02   4.78721812e+03   1.00484060e+04
  -1.06589141e-07   6.21554859e+04   3.76311040e+04   3.28180086e+04
   6.17012850e+04   3.36928799e+04   1.69230763e+04   1.70525373e+04
   2.91813268e+04   2.22303443e+04   1.02509771e+04   1.05509512e+04
   1.79538457e+04   1.50620780e+04   5.48063463e+03   7.35626661e+03
   1.08319412e+04   9.71736456e+03   4.67341194e+03   2.29969247e+03
   5.98887809e+03   6.17265108e+03   1.01083074e+03  -5.87789373e-08
   2.31299255e+03   3.55577209e+03   1.51669090e+03   6.96280604e+04
   4.31945610e+04   3.10644442e+04   5.81845263e+04   4.10766035e+04
   2.13853197e+04   1.62268918e+04   2.55599414e+04   2.95658231e+04
   1.33548782e+04   1.11088101e+04   1.42805636e+04   2.23588295e+04
   7.15518511e+03   6.28826307e+03   7.11351848e+03   1.69755016e+04
   9.87287572e+03   5.16618814e+03   2.69151286e+03   1.33921738e+04
   5.14172210e+03   1.86745297e-07   2.05399829e-07   1.02249108e+04
   6.82353277e+03   6.40789769e+02   7.16251508e+04   4.75821262e+04
   5.53916419e+04   9.12251508e+04   3.92103037e+04   2.52182196e+04
   3.50711012e+04   5.40512193e+04   2.56017574e+04   1.95474790e+04
   2.46151406e+04   4.05152816e+04   1.67108295e+04   1.59467806e+04
   2.30737228e+04   3.13854459e+04   9.64848148e+03   7.46730747e+03
   9.06353160e+03   2.40201884e+04   4.38613345e+03   3.97467180e+03
   1.00940004e+04   1.69359872e+04   1.02843112e+03  -1.29810701e-07
   5.04925082e+03   1.21751905e+04   7.06099746e+04   4.48545568e+04
   4.33368458e+04   7.59203263e+04   3.91348171e+04   2.19988082e+04
   2.49568501e+04   3.98529291e+04   2.60365088e+04   1.49407132e+04
   1.66665521e+04   2.68658528e+04   1.75551630e+04   9.85040020e+03
   1.33479293e+04   1.82134252e+04   1.09012018e+04   6.27239303e+03
   4.90873281e+03   1.18454818e+04   6.04724065e+03   1.84680945e+03
   2.69935415e+03   6.45470120e+03   2.42145993e+03  -7.20003754e-08
  -9.00326995e-08   3.12873868e+03   1.75084363e+03   7.68882210e+04
   4.91411019e+04   4.01829449e+04   7.10435144e+04   4.52491598e+04
   2.51018627e+04   2.26935912e+04   3.47831119e+04   3.20618543e+04
   1.66384710e+04   1.57820482e+04   2.17003014e+04   2.35090678e+04
   1.00714755e+04   1.07895074e+04   1.29646027e+04   1.67838745e+04
   1.00493288e+04   6.31236824e+03   6.99264539e+03   1.18586812e+04
   4.50716655e+03   1.15921023e+03   2.57220278e+03   7.64294936e+03
   3.81221577e+03   1.77738229e-07  -5.08068752e-08   7.38965113e+03
   6.88594761e+02   8.04486219e+04   5.19237406e+04   3.41988287e+04
   6.08486219e+04   5.09070865e+04   2.84738609e+04   1.94072199e+04
   2.70581672e+04   3.88587076e+04   1.91033849e+04   1.49948851e+04
   1.52004964e+04   3.12201689e+04   1.15196467e+04   8.67251778e+03
   7.53044310e+03   2.54065552e+04   1.65751350e+04   1.00723177e+04
   3.02702874e+03   2.13929416e+04   1.06510476e+04   2.35161975e+03
   7.04072343e+02   1.74251833e+04   1.26813016e+04   3.83660518e+03
   1.90493665e-09   1.91331493e+04   7.21102990e+03   1.74419566e+03]
Start evaluation of dj
found a tidal farm, computing gradient
Minimum distance inequality constraints (should all be > 0): [  2.18972639e+03   1.65965321e+04   7.90187149e+03   1.87000000e+04
   1.52110150e+04   3.57354580e+03   3.86505402e+03   2.27952341e-08
   1.27157607e+04   2.34650540e+04   1.29490000e+04   3.05148364e+03
   7.92458648e+03   2.23245125e+04   2.26900123e+03   2.21362063e+04
   9.19668807e+03   1.56421518e+03   1.26436405e+04   1.16268363e+04
   3.64239967e+03   2.53073716e+04   1.36287643e+04   1.06800258e-07
   5.70737165e+03   1.88502186e+04   1.07445163e+04   1.26456866e+03
   1.04446648e+04   2.80326399e+03   1.46008113e+04   3.00446648e+04
   5.04897748e+02   4.62168203e+02   9.91265215e+03   1.93363307e+04
   2.06293470e+04   7.44034446e+03   8.56260235e+03   2.52733345e+04
   6.52714152e+03   1.66049517e-07   2.32625345e+03   9.66350861e+03
   2.86209895e+03   2.45993448e+04   1.00899223e+04   5.22187120e+03
   2.01519997e+04   1.07784971e+04   2.05470174e+03   1.08582299e-07
   4.87348757e+03   7.26622781e+03   1.58392138e+02   3.34877684e+04
   1.77469571e+04   3.13047375e+03   1.38877684e+04   2.14641935e+04
   9.90364292e+03   5.23357402e+02   7.25640129e+02   1.89278177e+04
   6.82376528e+03   2.19808195e+03   1.77593249e+04   7.08654688e+03
   1.81470191e+04   3.73593249e+04   3.66567365e+03   1.04479961e+03
   1.05696554e+04   2.17595721e+04   5.27589763e+00   1.95309453e+03
   6.47985869e+03   1.89248252e+04   3.00299885e+04   1.35719135e+04
   1.07889659e+04   2.96861756e+04   1.25952251e+04   2.69874062e+03
   2.68389012e+03   1.01520862e+04   7.12065102e+03   1.06633934e-07
   6.87571173e-08   5.36583577e+03   4.75908596e+03   3.49295826e+04
   1.72431466e+04   8.04914816e+03   2.47838309e+04   1.80657424e+04
   5.96697885e+03   1.22395367e+03   5.92203388e+03   1.29011715e+04
   2.29013817e+03   9.42688985e-08   1.46925281e+03   1.07884545e+04
   3.42585982e+02   4.32471357e+04   2.39729568e+04   8.49734007e+03
   2.36471357e+04   2.63818011e+04   1.18161702e+04   2.52257232e+03
   4.78357893e+03   2.12164188e+04   6.99764459e+03   2.51490474e+03
   3.29925027e+02   1.91030504e+04   3.84661312e+03   2.40086993e+02
   2.68552733e+04   1.31599643e+04   2.34855123e+04   4.64552733e+04
   8.61985978e+03   3.42836487e+03   1.30273755e+04   2.59783760e+04
   2.71054409e+03   2.84937689e+03   7.49841848e+03   2.07244754e+04
  -1.71880856e-07   4.20704659e+03   1.04845370e+04   1.87984835e+04
   3.27532475e+04   1.63258163e+04   2.14506872e+04   4.50786341e+04
   1.24469528e+04   4.07271908e+03   1.02073281e+04   2.21631646e+04
   5.41317818e+03   1.87202805e+03   4.89506729e+03   1.56996872e+04
   1.80000000e+03   1.57991648e+03   6.16245467e+03   1.27215866e+04
  -6.70573854e-08   3.69469457e+04   1.86407333e+04   1.81331350e+04
   4.09725547e+04   1.59748556e+04   5.02256939e+03   7.17417917e+03
   1.72730757e+04   8.57956352e+03   1.58099389e+03   2.69879049e+03
   1.04207152e+04   4.67618536e+03   4.93414518e-08   2.54706930e+03
   7.10435808e+03   2.58683225e+03   1.90890987e+00   5.17303501e+04
   2.97663323e+04   1.46575321e+04   3.37674024e+04   3.08026688e+04
   1.41426972e+04   5.70979231e+03   1.01202172e+04   2.34314900e+04
   8.06300220e+03   4.07986323e+03   3.29379528e+03   1.95474683e+04
   3.69971783e+03   7.45900029e+02   1.22744495e-07   1.74774151e+04
   1.08215742e+04   5.26715223e+03   3.77512217e+04   2.10333816e+04
   3.06240056e+04   5.73512217e+04   1.53740459e+04   7.61193012e+03
   1.72850955e+04   3.19971799e+04   7.21581227e+03   5.54565925e+03
   1.03169783e+04   2.43241257e+04   2.70000000e+03   5.45500722e+03
   1.19806195e+04   2.02939165e+04   1.35145228e-07  -2.11074394e-08
   2.29747913e+03   1.72073620e+04   4.53463308e+04   2.52932615e+04
   2.72451394e+04   5.39971401e+04   2.09168773e+04   9.02513352e+03
   1.34648854e+04   2.62264326e+04   1.16442860e+04   4.90031050e+03
   7.19286355e+03   1.73546675e+04   6.23394828e+03   2.69883006e+03
   6.60954957e+03   1.22818011e+04   2.64203325e+03   1.64159183e+02
  -5.74771093e-08   8.77768852e+03   8.50118225e+02   5.51545355e+04
   3.19437733e+04   2.39587181e+04   4.91015071e+04   2.97795338e+04
   1.34657435e+04   1.08450481e+04   2.02173665e+04   1.99935234e+04
   7.22659453e+03   6.13692329e+03   1.07933181e+04   1.41710499e+04
   2.82355443e+03   3.11423253e+03   5.24006715e+03   1.01682019e+04
   4.75616915e+03   1.41272260e+03   1.94695579e+03   7.96535391e+03
   1.90459653e+03   5.92126877e+04   3.51340183e+04   2.17781143e+04
   4.48852636e+04   3.45512502e+04   1.65221393e+04   9.90596536e+03
   1.68413826e+04   2.51526949e+04   9.54048953e+03   6.51073937e+03
   7.83411836e+03   1.96412424e+04   4.33414124e+03   2.51306345e+03
   2.64339280e+03   1.59485076e+04   9.15599501e+03   4.11046998e+03
   1.37524012e-07   1.40557729e+04   5.83750737e+03   2.60232810e-07
   5.01642042e+04   3.01894159e+04   3.78476767e+04   6.79353689e+04
   2.37446204e+04   1.29965360e+04   2.18618067e+04   3.78211776e+04
   1.33914168e+04   9.25791534e+03   1.37244319e+04   2.77870012e+04
   7.11364179e+03   7.52098383e+03   1.38314666e+04   2.17030517e+04
   2.65682089e+03   1.43902091e+03   3.06687053e+03   1.69697371e+04
  -8.63173000e-08   3.68775678e+02   6.39694371e+03   1.24040035e+04
   6.24681114e+04   3.92029499e+04   4.31017402e+04   7.54934849e+04
   3.26311268e+04   1.85241639e+04   2.51663356e+04   4.13551231e+04
   2.04223232e+04   1.29855471e+04   1.64523034e+04   2.93248839e+04
   1.26550071e+04   9.44974025e+03   1.47782678e+04   2.15047280e+04
   6.71299196e+03   3.87188575e+03   4.25616608e+03   1.55128883e+04
   2.57097680e+03   8.78250478e+02   4.78721812e+03   1.00484060e+04
  -1.06589141e-07   6.21554859e+04   3.76311040e+04   3.28180086e+04
   6.17012850e+04   3.36928799e+04   1.69230763e+04   1.70525373e+04
   2.91813268e+04   2.22303443e+04   1.02509771e+04   1.05509512e+04
   1.79538457e+04   1.50620780e+04   5.48063463e+03   7.35626661e+03
   1.08319412e+04   9.71736456e+03   4.67341194e+03   2.29969247e+03
   5.98887809e+03   6.17265108e+03   1.01083074e+03  -5.87789373e-08
   2.31299255e+03   3.55577209e+03   1.51669090e+03   6.96280604e+04
   4.31945610e+04   3.10644442e+04   5.81845263e+04   4.10766035e+04
   2.13853197e+04   1.62268918e+04   2.55599414e+04   2.95658231e+04
   1.33548782e+04   1.11088101e+04   1.42805636e+04   2.23588295e+04
   7.15518511e+03   6.28826307e+03   7.11351848e+03   1.69755016e+04
   9.87287572e+03   5.16618814e+03   2.69151286e+03   1.33921738e+04
   5.14172210e+03   1.86745297e-07   2.05399829e-07   1.02249108e+04
   6.82353277e+03   6.40789769e+02   7.16251508e+04   4.75821262e+04
   5.53916419e+04   9.12251508e+04   3.92103037e+04   2.52182196e+04
   3.50711012e+04   5.40512193e+04   2.56017574e+04   1.95474790e+04
   2.46151406e+04   4.05152816e+04   1.67108295e+04   1.59467806e+04
   2.30737228e+04   3.13854459e+04   9.64848148e+03   7.46730747e+03
   9.06353160e+03   2.40201884e+04   4.38613345e+03   3.97467180e+03
   1.00940004e+04   1.69359872e+04   1.02843112e+03  -1.29810701e-07
   5.04925082e+03   1.21751905e+04   7.06099746e+04   4.48545568e+04
   4.33368458e+04   7.59203263e+04   3.91348171e+04   2.19988082e+04
   2.49568501e+04   3.98529291e+04   2.60365088e+04   1.49407132e+04
   1.66665521e+04   2.68658528e+04   1.75551630e+04   9.85040020e+03
   1.33479293e+04   1.82134252e+04   1.09012018e+04   6.27239303e+03
   4.90873281e+03   1.18454818e+04   6.04724065e+03   1.84680945e+03
   2.69935415e+03   6.45470120e+03   2.42145993e+03  -7.20003754e-08
  -9.00326995e-08   3.12873868e+03   1.75084363e+03   7.68882210e+04
   4.91411019e+04   4.01829449e+04   7.10435144e+04   4.52491598e+04
   2.51018627e+04   2.26935912e+04   3.47831119e+04   3.20618543e+04
   1.66384710e+04   1.57820482e+04   2.17003014e+04   2.35090678e+04
   1.00714755e+04   1.07895074e+04   1.29646027e+04   1.67838745e+04
   1.00493288e+04   6.31236824e+03   6.99264539e+03   1.18586812e+04
   4.50716655e+03   1.15921023e+03   2.57220278e+03   7.64294936e+03
   3.81221577e+03   1.77738229e-07  -5.08068752e-08   7.38965113e+03
   6.88594761e+02   8.04486219e+04   5.19237406e+04   3.41988287e+04
   6.08486219e+04   5.09070865e+04   2.84738609e+04   1.94072199e+04
   2.70581672e+04   3.88587076e+04   1.91033849e+04   1.49948851e+04
   1.52004964e+04   3.12201689e+04   1.15196467e+04   8.67251778e+03
   7.53044310e+03   2.54065552e+04   1.65751350e+04   1.00723177e+04
   3.02702874e+03   2.13929416e+04   1.06510476e+04   2.35161975e+03
   7.04072343e+02   1.74251833e+04   1.26813016e+04   3.83660518e+03
   1.90493665e-09   1.91331493e+04   7.21102990e+03   1.74419566e+03]
Start evaluation of dj
found a tidal farm, computing gradient
found a tidal farm, computing _dj
found a tidal farm, computing _dj
Runtime: 6.24351215363 s
|dj| = 12419.9679001
Runtime: 6.26243209839 s
|dj| = 12419.9679001
   58   100    -3.106827E+04     2.775443E+02
Optimization terminated successfully.    (Exit mode 0)
            Current function value: -31068.2659869
            Iterations: 58
            Function evaluations: 100
            Gradient evaluations: 58
